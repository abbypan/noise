
### -----------start test --------: 'N',
###                                 undef,
###                                 undef

### -----------start test --------: 'N',
###                                 undef,
###                                 undef

### init a_hs

### init a_hs
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 1,
    message_pattens => [["e", "es"]],
    msg_id => 0,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => "Noise_N_secp256r1_AESGCM_SHA256\0",
      h  => pack("H*","5122d7db16f328beef51c179246347d527a4f4ba9233a649657fd8106764de06"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 1,
    message_pattens => [["e", "es"]],
    msg_id => 0,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => "Noise_N_secp256r1_AESGCM_SHA256\0",
      h  => pack("H*","5122d7db16f328beef51c179246347d527a4f4ba9233a649657fd8106764de06"),
    },
    who => "a",
  },
)


### a send msg to b
### a send msg to b

### $a_msg_src: 'init.syn'

### $a_msg_src: 'init.syn'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '035310b3e6fafd6dec1463eafd5d6edfbfef7aa58402f1165254fc69013dc6942c'

### public compressed: '035310b3e6fafd6dec1463eafd5d6edfbfef7aa58402f1165254fc69013dc6942c'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOkaCbxaPgctNwRZBkWL1/eoiJwGA30L2hHUI2Ard5FJoAoGCCqGSM49
',
###             'AwEHoUQDQgAEUxCz5vr9bewUY+r9XW7fv+96pYQC8RZSVPxpAT3GlCxVJsAqEOxu
',
###             'AZzYWqN4dkjEp0LNMN+Naqa6VRH8Yq4BIw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOkaCbxaPgctNwRZBkWL1/eoiJwGA30L2hHUI2Ard5FJoAoGCCqGSM49
',
###             'AwEHoUQDQgAEUxCz5vr9bewUY+r9XW7fv+96pYQC8RZSVPxpAT3GlCxVJsAqEOxu
',
###             'AZzYWqN4dkjEp0LNMN+Naqa6VRH8Yq4BIw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '5d772f6fd4550361bd7e9796797f551d4bcfdcead3b28f0a2566f2214b9f200d'
### z: '5d772f6fd4550361bd7e9796797f551d4bcfdcead3b28f0a2566f2214b9f200d'

### noise encrypt

### noise encrypt
### key: '852d392a02110c3679cbbcd5669f88ea7fdaad4d79fa4cb2300db429b04c16a0'
### key: '852d392a02110c3679cbbcd5669f88ea7fdaad4d79fa4cb2300db429b04c16a0'
### iv: '5db264082cb932d2c1cb220f'
### iv: '5db264082cb932d2c1cb220f'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '6c84553e1b8e03e5f6f3220f'
### iv_xor: '6c84553e1b8e03e5f6f3220f'
### aad: '6bf049f478de7bf5de8d428f013c330d461c045c59f50bfaca97fb18291d1ab2'
### aad: '6bf049f478de7bf5de8d428f013c330d461c045c59f50bfaca97fb18291d1ab2'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '79c38b8358484a88'
### ciphertext: '79c38b8358484a88'
### authtag: '254181e49146d3269170d4f964ff5630'
### authtag: '254181e49146d3269170d4f964ff5630'
### cipherinfo: '834a3136313637373137373850254181e49146d3269170d4f964ff56304879c38b8358484a88'
### cipherinfo: '834a3136313637373137373850254181e49146d3269170d4f964ff56304879c38b8358484a88'

### a_msg: '825821035310b3e6fafd6dec1463eafd5d6edfbfef7aa58402f1165254fc69013dc6942c5826834a3136313637373137373850254181e49146d3269170d4f964ff56304879c38b8358484a88'

### a_msg: '825821035310b3e6fafd6dec1463eafd5d6edfbfef7aa58402f1165254fc69013dc6942c5826834a3136313637373137373850254181e49146d3269170d4f964ff56304879c38b8358484a88'
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","035310b3e6fafd6dec1463eafd5d6edfbfef7aa58402f1165254fc69013dc6942c"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "N",
    initiator => 1,
    message_pattens => [["e", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","7bb1a2910a89450440d3aa2d126e68cbc130b8a071b56c6b83c489f324a78bca"),
      h => pack("H*","4a323aa07d875e0fe449fa4f98d16a5e24c652ea40663473021c5d64477e685f"),
      hasK => 1,
      k => pack("H*","6f1b72647e3c0481a1b10104adf456b700ab4e613d93c8761528a4a1cd402a94"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","67869ce0e9c05a26d483b0178a7b7c37aee5a169e8b76886d4969ec3d0ffbc45"),
  },
  {
    hasK => 1,
    k => pack("H*","87a61f5f57c89006716ddb6e569a634bb07889601c8ec86e01fb66d7900a3d4d"),
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","035310b3e6fafd6dec1463eafd5d6edfbfef7aa58402f1165254fc69013dc6942c"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "N",
    initiator => 1,
    message_pattens => [["e", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","7bb1a2910a89450440d3aa2d126e68cbc130b8a071b56c6b83c489f324a78bca"),
      h => pack("H*","4a323aa07d875e0fe449fa4f98d16a5e24c652ea40663473021c5d64477e685f"),
      hasK => 1,
      k => pack("H*","6f1b72647e3c0481a1b10104adf456b700ab4e613d93c8761528a4a1cd402a94"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","67869ce0e9c05a26d483b0178a7b7c37aee5a169e8b76886d4969ec3d0ffbc45"),
  },
  {
    hasK => 1,
    k => pack("H*","87a61f5f57c89006716ddb6e569a634bb07889601c8ec86e01fb66d7900a3d4d"),
  },
)


### init b_hs
### init b_hs
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 0,
    message_pattens => [["e", "es"]],
    msg_id => 0,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => "Noise_N_secp256r1_AESGCM_SHA256\0",
      h  => pack("H*","5122d7db16f328beef51c179246347d527a4f4ba9233a649657fd8106764de06"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 0,
    message_pattens => [["e", "es"]],
    msg_id => 0,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => "Noise_N_secp256r1_AESGCM_SHA256\0",
      h  => pack("H*","5122d7db16f328beef51c179246347d527a4f4ba9233a649657fd8106764de06"),
    },
    who => "b",
  },
)

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEUxCz5vr9bewUY+r9XW7fv+96pYQC
',
###           '8RZSVPxpAT3GlCxVJsAqEOxuAZzYWqN4dkjEp0LNMN+Naqa6VRH8Yq4BIw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEUxCz5vr9bewUY+r9XW7fv+96pYQC
',
###           '8RZSVPxpAT3GlCxVJsAqEOxuAZzYWqN4dkjEp0LNMN+Naqa6VRH8Yq4BIw==
',
###           '-----END PUBLIC KEY-----
'
### z: '5d772f6fd4550361bd7e9796797f551d4bcfdcead3b28f0a2566f2214b9f200d'
### z: '5d772f6fd4550361bd7e9796797f551d4bcfdcead3b28f0a2566f2214b9f200d'


### noise decrypt
### noise decrypt
### key: '852d392a02110c3679cbbcd5669f88ea7fdaad4d79fa4cb2300db429b04c16a0'
### key: '852d392a02110c3679cbbcd5669f88ea7fdaad4d79fa4cb2300db429b04c16a0'
### iv: '5db264082cb932d2c1cb220f'
### iv: '5db264082cb932d2c1cb220f'
### aad: '6bf049f478de7bf5de8d428f013c330d461c045c59f50bfaca97fb18291d1ab2'
### aad: '6bf049f478de7bf5de8d428f013c330d461c045c59f50bfaca97fb18291d1ab2'
### cipherinfo: '834a3136313637373137373850254181e49146d3269170d4f964ff56304879c38b8358484a88'
### cipherinfo: '834a3136313637373137373850254181e49146d3269170d4f964ff56304879c38b8358484a88'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '6c84553e1b8e03e5f6f3220f'
### iv_xor: '6c84553e1b8e03e5f6f3220f'
### authtag: '254181e49146d3269170d4f964ff5630'
### authtag: '254181e49146d3269170d4f964ff5630'
### ciphertext: '79c38b8358484a88'
### ciphertext: '79c38b8358484a88'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'

### b_recv_a_msg: 'init.syn'

### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 0,
    message_pattens => [["e", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","035310b3e6fafd6dec1463eafd5d6edfbfef7aa58402f1165254fc69013dc6942c"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","7bb1a2910a89450440d3aa2d126e68cbc130b8a071b56c6b83c489f324a78bca"),
      h => pack("H*","4a323aa07d875e0fe449fa4f98d16a5e24c652ea40663473021c5d64477e685f"),
      hasK => 1,
      k => pack("H*","6f1b72647e3c0481a1b10104adf456b700ab4e613d93c8761528a4a1cd402a94"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","67869ce0e9c05a26d483b0178a7b7c37aee5a169e8b76886d4969ec3d0ffbc45"),
  },
  {
    hasK => 1,
    k => pack("H*","87a61f5f57c89006716ddb6e569a634bb07889601c8ec86e01fb66d7900a3d4d"),
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 0,
    message_pattens => [["e", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","035310b3e6fafd6dec1463eafd5d6edfbfef7aa58402f1165254fc69013dc6942c"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","7bb1a2910a89450440d3aa2d126e68cbc130b8a071b56c6b83c489f324a78bca"),
      h => pack("H*","4a323aa07d875e0fe449fa4f98d16a5e24c652ea40663473021c5d64477e685f"),
      hasK => 1,
      k => pack("H*","6f1b72647e3c0481a1b10104adf456b700ab4e613d93c8761528a4a1cd402a94"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","67869ce0e9c05a26d483b0178a7b7c37aee5a169e8b76886d4969ec3d0ffbc45"),
  },
  {
    hasK => 1,
    k => pack("H*","87a61f5f57c89006716ddb6e569a634bb07889601c8ec86e01fb66d7900a3d4d"),
  },
)

### a send comm msg to b

### a send comm msg to b


### noise encrypt
### noise encrypt
### key: '33c0dd4a9252c9666dced0dc3f60a80bc27de7c8d8c9475aa7e24c987c9f49d7'
### key: '33c0dd4a9252c9666dced0dc3f60a80bc27de7c8d8c9475aa7e24c987c9f49d7'
### iv: '5c85284b2bf93b9c0dcaa753'
### iv: '5c85284b2bf93b9c0dcaa753'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '6db3197d1cce0aab3af2a753'
### iv_xor: '6db3197d1cce0aab3af2a753'
### aad: '4a323aa07d875e0fe449fa4f98d16a5e24c652ea40663473021c5d64477e685f'
### aad: '4a323aa07d875e0fe449fa4f98d16a5e24c652ea40663473021c5d64477e685f'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '9fde1b217b893341e8a67d5138596216a33b6ded22e7379acb3e7319c1e01c6ea44fe08eba26cb1a4edfcff3b1c702730c9e64'
### ciphertext: '9fde1b217b893341e8a67d5138596216a33b6ded22e7379acb3e7319c1e01c6ea44fe08eba26cb1a4edfcff3b1c702730c9e64'
### authtag: 'ea1458be02a43d5ec867fc3e39d89265'
### authtag: 'ea1458be02a43d5ec867fc3e39d89265'
### cipherinfo: '834a3136313637373137373850ea1458be02a43d5ec867fc3e39d8926558339fde1b217b893341e8a67d5138596216a33b6ded22e7379acb3e7319c1e01c6ea44fe08eba26cb1a4edfcff3b1c702730c9e64'
### cipherinfo: '834a3136313637373137373850ea1458be02a43d5ec867fc3e39d8926558339fde1b217b893341e8a67d5138596216a33b6ded22e7379acb3e7319c1e01c6ea44fe08eba26cb1a4edfcff3b1c702730c9e64'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '33c0dd4a9252c9666dced0dc3f60a80bc27de7c8d8c9475aa7e24c987c9f49d7'
### key: '33c0dd4a9252c9666dced0dc3f60a80bc27de7c8d8c9475aa7e24c987c9f49d7'
### iv: '5c85284b2bf93b9c0dcaa753'
### iv: '5c85284b2bf93b9c0dcaa753'
### aad: '4a323aa07d875e0fe449fa4f98d16a5e24c652ea40663473021c5d64477e685f'
### aad: '4a323aa07d875e0fe449fa4f98d16a5e24c652ea40663473021c5d64477e685f'
### cipherinfo: '834a3136313637373137373850ea1458be02a43d5ec867fc3e39d8926558339fde1b217b893341e8a67d5138596216a33b6ded22e7379acb3e7319c1e01c6ea44fe08eba26cb1a4edfcff3b1c702730c9e64'
### cipherinfo: '834a3136313637373137373850ea1458be02a43d5ec867fc3e39d8926558339fde1b217b893341e8a67d5138596216a33b6ded22e7379acb3e7319c1e01c6ea44fe08eba26cb1a4edfcff3b1c702730c9e64'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '6db3197d1cce0aab3af2a753'
### iv_xor: '6db3197d1cce0aab3af2a753'
### authtag: 'ea1458be02a43d5ec867fc3e39d89265'
### authtag: 'ea1458be02a43d5ec867fc3e39d89265'
### ciphertext: '9fde1b217b893341e8a67d5138596216a33b6ded22e7379acb3e7319c1e01c6ea44fe08eba26cb1a4edfcff3b1c702730c9e64'
### ciphertext: '9fde1b217b893341e8a67d5138596216a33b6ded22e7379acb3e7319c1e01c6ea44fe08eba26cb1a4edfcff3b1c702730c9e64'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b send comm msg to a

### b send comm msg to a


### noise encrypt
### noise encrypt
### key: '923f88af8731491cae76a4f4fc8da4904afdae54f0669ef89b7aa9d8513607bb'
### key: '923f88af8731491cae76a4f4fc8da4904afdae54f0669ef89b7aa9d8513607bb'
### iv: 'df434de2c1f816b44bcd5f5b'
### iv: 'df434de2c1f816b44bcd5f5b'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'ee757cd4f6cf27837cf55f5b'
### iv_xor: 'ee757cd4f6cf27837cf55f5b'
### aad: '4a323aa07d875e0fe449fa4f98d16a5e24c652ea40663473021c5d64477e685f'
### aad: '4a323aa07d875e0fe449fa4f98d16a5e24c652ea40663473021c5d64477e685f'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '3951e94090418426313797eb4efbfcb2b41094262009ce4bfce6da7924b8fdca2c17ce93acd50c466fbee40186da34'
### ciphertext: '3951e94090418426313797eb4efbfcb2b41094262009ce4bfce6da7924b8fdca2c17ce93acd50c466fbee40186da34'
### authtag: '24eeaeef9fe1476808e4d3e7b59b439a'
### authtag: '24eeaeef9fe1476808e4d3e7b59b439a'
### cipherinfo: '834a313631363737313737385024eeaeef9fe1476808e4d3e7b59b439a582f3951e94090418426313797eb4efbfcb2b41094262009ce4bfce6da7924b8fdca2c17ce93acd50c466fbee40186da34'
### cipherinfo: '834a313631363737313737385024eeaeef9fe1476808e4d3e7b59b439a582f3951e94090418426313797eb4efbfcb2b41094262009ce4bfce6da7924b8fdca2c17ce93acd50c466fbee40186da34'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '923f88af8731491cae76a4f4fc8da4904afdae54f0669ef89b7aa9d8513607bb'
### key: '923f88af8731491cae76a4f4fc8da4904afdae54f0669ef89b7aa9d8513607bb'
### iv: 'df434de2c1f816b44bcd5f5b'
### iv: 'df434de2c1f816b44bcd5f5b'
### aad: '4a323aa07d875e0fe449fa4f98d16a5e24c652ea40663473021c5d64477e685f'
### aad: '4a323aa07d875e0fe449fa4f98d16a5e24c652ea40663473021c5d64477e685f'
### cipherinfo: '834a313631363737313737385024eeaeef9fe1476808e4d3e7b59b439a582f3951e94090418426313797eb4efbfcb2b41094262009ce4bfce6da7924b8fdca2c17ce93acd50c466fbee40186da34'
### cipherinfo: '834a313631363737313737385024eeaeef9fe1476808e4d3e7b59b439a582f3951e94090418426313797eb4efbfcb2b41094262009ce4bfce6da7924b8fdca2c17ce93acd50c466fbee40186da34'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'ee757cd4f6cf27837cf55f5b'
### iv_xor: 'ee757cd4f6cf27837cf55f5b'
### authtag: '24eeaeef9fe1476808e4d3e7b59b439a'
### authtag: '24eeaeef9fe1476808e4d3e7b59b439a'
### ciphertext: '3951e94090418426313797eb4efbfcb2b41094262009ce4bfce6da7924b8fdca2c17ce93acd50c466fbee40186da34'
### ciphertext: '3951e94090418426313797eb4efbfcb2b41094262009ce4bfce6da7924b8fdca2c17ce93acd50c466fbee40186da34'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'N',
###                               undef,
###                               undef

### -----------end test --------: 'N',
###                               undef,
###                               undef

### -----------start test --------: 'N',
###                                 'test_psk',
###                                 0

### -----------start test --------: 'N',
###                                 'test_psk',
###                                 0

### init a_hs

### init a_hs
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 1,
    message_pattens => [["psk", "e", "es"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","80ba8731247a7e2307f2cadb33975afc5897a2e7e3d3eeee3471d9e40f9a6b2d"),
      h  => pack("H*","edeeabd3d3407158ba6ae57fdcf4ec52115d19b97f4b4f98d0111c559653b457"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 1,
    message_pattens => [["psk", "e", "es"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","80ba8731247a7e2307f2cadb33975afc5897a2e7e3d3eeee3471d9e40f9a6b2d"),
      h  => pack("H*","edeeabd3d3407158ba6ae57fdcf4ec52115d19b97f4b4f98d0111c559653b457"),
    },
    who => "a",
  },
)

### a send msg to b

### a send msg to b

### $a_msg_src: 'init.syn'

### $a_msg_src: 'init.syn'

### write message pattern: 'psk'

### write message pattern: 'psk'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '024768c788b0fd6b129a117cca27f8c64823a3452416099b3137cb9154eb9ea80e'

### public compressed: '024768c788b0fd6b129a117cca27f8c64823a3452416099b3137cb9154eb9ea80e'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBX/qB8J4Tb9Dy9b7oa5OKHenRaHId0+sNiSIQU3pZYQoAoGCCqGSM49
',
###             'AwEHoUQDQgAER2jHiLD9axKaEXzKJ/jGSCOjRSQWCZsxN8uRVOueqA7S8lKB9AlA
',
###             'vAvktzt+ZNR++GEv5/f9tVoF/JVKkHvA2A==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBX/qB8J4Tb9Dy9b7oa5OKHenRaHId0+sNiSIQU3pZYQoAoGCCqGSM49
',
###             'AwEHoUQDQgAER2jHiLD9axKaEXzKJ/jGSCOjRSQWCZsxN8uRVOueqA7S8lKB9AlA
',
###             'vAvktzt+ZNR++GEv5/f9tVoF/JVKkHvA2A==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'da04b2991d76fec626b05fd34529a5487bceb198c15f597b54560394e2a2f48a'
### z: 'da04b2991d76fec626b05fd34529a5487bceb198c15f597b54560394e2a2f48a'

### noise encrypt

### noise encrypt
### key: '5ea81cff81162fc9e2439d497d870b3cc5b719a02202f3615a81fa96516cb732'
### key: '5ea81cff81162fc9e2439d497d870b3cc5b719a02202f3615a81fa96516cb732'
### iv: '8680cf7b825f16caa20c97d6'
### iv: '8680cf7b825f16caa20c97d6'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'b7b6fe4db56827fd953497d6'
### iv_xor: 'b7b6fe4db56827fd953497d6'
### aad: 'f0319e5b784529d18c612c44e1f16b5e61237eb009325b88aca6c76a9ed9d9cf'
### aad: 'f0319e5b784529d18c612c44e1f16b5e61237eb009325b88aca6c76a9ed9d9cf'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '88231fd6a7b9e47b'
### ciphertext: '88231fd6a7b9e47b'
### authtag: 'e540f5a1e774bc7b9c24e27c9fd49cae'
### authtag: 'e540f5a1e774bc7b9c24e27c9fd49cae'
### cipherinfo: '834a3136313637373137373850e540f5a1e774bc7b9c24e27c9fd49cae4888231fd6a7b9e47b'
### cipherinfo: '834a3136313637373137373850e540f5a1e774bc7b9c24e27c9fd49cae4888231fd6a7b9e47b'

### a_msg: '825821024768c788b0fd6b129a117cca27f8c64823a3452416099b3137cb9154eb9ea80e5826834a3136313637373137373850e540f5a1e774bc7b9c24e27c9fd49cae4888231fd6a7b9e47b'

### a_msg: '825821024768c788b0fd6b129a117cca27f8c64823a3452416099b3137cb9154eb9ea80e5826834a3136313637373137373850e540f5a1e774bc7b9c24e27c9fd49cae4888231fd6a7b9e47b'
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","024768c788b0fd6b129a117cca27f8c64823a3452416099b3137cb9154eb9ea80e"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "N",
    initiator => 1,
    message_pattens => [["psk", "e", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","2a4e2c1a86832e04af57c90a3ceff77ce39a2735778824b8490e0ea8a6d6a3df"),
      h => pack("H*","1ff92b328311f1d66c54dd91c71539431a362ebd33b3ad025d66437c3e60d6db"),
      hasK => 1,
      k => pack("H*","5db470a7463c1136d1a435cfc1ea7c2ae93845844609541be09cf1beb9d6856b"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","4dbb9616b3fc6a1295122bb163f282981fffd74310c078aff0eb2717db00d382"),
  },
  {
    hasK => 1,
    k => pack("H*","1dc25d04349885eb1ac9faa05f817c3f06b7c1ab3d95d86d1081dc1faf2c6181"),
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","024768c788b0fd6b129a117cca27f8c64823a3452416099b3137cb9154eb9ea80e"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "N",
    initiator => 1,
    message_pattens => [["psk", "e", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","2a4e2c1a86832e04af57c90a3ceff77ce39a2735778824b8490e0ea8a6d6a3df"),
      h => pack("H*","1ff92b328311f1d66c54dd91c71539431a362ebd33b3ad025d66437c3e60d6db"),
      hasK => 1,
      k => pack("H*","5db470a7463c1136d1a435cfc1ea7c2ae93845844609541be09cf1beb9d6856b"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","4dbb9616b3fc6a1295122bb163f282981fffd74310c078aff0eb2717db00d382"),
  },
  {
    hasK => 1,
    k => pack("H*","1dc25d04349885eb1ac9faa05f817c3f06b7c1ab3d95d86d1081dc1faf2c6181"),
  },
)

### init b_hs

### init b_hs
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 0,
    message_pattens => [["psk", "e", "es"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","80ba8731247a7e2307f2cadb33975afc5897a2e7e3d3eeee3471d9e40f9a6b2d"),
      h  => pack("H*","edeeabd3d3407158ba6ae57fdcf4ec52115d19b97f4b4f98d0111c559653b457"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 0,
    message_pattens => [["psk", "e", "es"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","80ba8731247a7e2307f2cadb33975afc5897a2e7e3d3eeee3471d9e40f9a6b2d"),
      h  => pack("H*","edeeabd3d3407158ba6ae57fdcf4ec52115d19b97f4b4f98d0111c559653b457"),
    },
    who => "b",
  },
)

### b recv msg from a

### b recv msg from a

### read message pattern: 'psk'

### read message pattern: 'psk'

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAER2jHiLD9axKaEXzKJ/jGSCOjRSQW
',
###           'CZsxN8uRVOueqA7S8lKB9AlAvAvktzt+ZNR++GEv5/f9tVoF/JVKkHvA2A==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAER2jHiLD9axKaEXzKJ/jGSCOjRSQW
',
###           'CZsxN8uRVOueqA7S8lKB9AlAvAvktzt+ZNR++GEv5/f9tVoF/JVKkHvA2A==
',
###           '-----END PUBLIC KEY-----
'
### z: 'da04b2991d76fec626b05fd34529a5487bceb198c15f597b54560394e2a2f48a'
### z: 'da04b2991d76fec626b05fd34529a5487bceb198c15f597b54560394e2a2f48a'

### noise decrypt

### noise decrypt
### key: '5ea81cff81162fc9e2439d497d870b3cc5b719a02202f3615a81fa96516cb732'
### key: '5ea81cff81162fc9e2439d497d870b3cc5b719a02202f3615a81fa96516cb732'
### iv: '8680cf7b825f16caa20c97d6'
### iv: '8680cf7b825f16caa20c97d6'
### aad: 'f0319e5b784529d18c612c44e1f16b5e61237eb009325b88aca6c76a9ed9d9cf'
### aad: 'f0319e5b784529d18c612c44e1f16b5e61237eb009325b88aca6c76a9ed9d9cf'
### cipherinfo: '834a3136313637373137373850e540f5a1e774bc7b9c24e27c9fd49cae4888231fd6a7b9e47b'
### cipherinfo: '834a3136313637373137373850e540f5a1e774bc7b9c24e27c9fd49cae4888231fd6a7b9e47b'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'b7b6fe4db56827fd953497d6'
### iv_xor: 'b7b6fe4db56827fd953497d6'
### authtag: 'e540f5a1e774bc7b9c24e27c9fd49cae'
### authtag: 'e540f5a1e774bc7b9c24e27c9fd49cae'
### ciphertext: '88231fd6a7b9e47b'
### ciphertext: '88231fd6a7b9e47b'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'

### b_recv_a_msg: 'init.syn'

### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 0,
    message_pattens => [["psk", "e", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","024768c788b0fd6b129a117cca27f8c64823a3452416099b3137cb9154eb9ea80e"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","2a4e2c1a86832e04af57c90a3ceff77ce39a2735778824b8490e0ea8a6d6a3df"),
      h => pack("H*","1ff92b328311f1d66c54dd91c71539431a362ebd33b3ad025d66437c3e60d6db"),
      hasK => 1,
      k => pack("H*","5db470a7463c1136d1a435cfc1ea7c2ae93845844609541be09cf1beb9d6856b"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","4dbb9616b3fc6a1295122bb163f282981fffd74310c078aff0eb2717db00d382"),
  },
  {
    hasK => 1,
    k => pack("H*","1dc25d04349885eb1ac9faa05f817c3f06b7c1ab3d95d86d1081dc1faf2c6181"),
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 0,
    message_pattens => [["psk", "e", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","024768c788b0fd6b129a117cca27f8c64823a3452416099b3137cb9154eb9ea80e"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","2a4e2c1a86832e04af57c90a3ceff77ce39a2735778824b8490e0ea8a6d6a3df"),
      h => pack("H*","1ff92b328311f1d66c54dd91c71539431a362ebd33b3ad025d66437c3e60d6db"),
      hasK => 1,
      k => pack("H*","5db470a7463c1136d1a435cfc1ea7c2ae93845844609541be09cf1beb9d6856b"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","4dbb9616b3fc6a1295122bb163f282981fffd74310c078aff0eb2717db00d382"),
  },
  {
    hasK => 1,
    k => pack("H*","1dc25d04349885eb1ac9faa05f817c3f06b7c1ab3d95d86d1081dc1faf2c6181"),
  },
)

### a send comm msg to b

### a send comm msg to b


### noise encrypt
### noise encrypt
### key: 'aa4f982819c2efe4fbf62305c64ece4090ee88ab1085344c08dacd0573d66ff4'
### key: 'aa4f982819c2efe4fbf62305c64ece4090ee88ab1085344c08dacd0573d66ff4'
### iv: 'ae390b74315c428b788c2d88'
### iv: 'ae390b74315c428b788c2d88'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '9f0f3a42066b73bc4fb42d88'
### iv_xor: '9f0f3a42066b73bc4fb42d88'
### aad: '1ff92b328311f1d66c54dd91c71539431a362ebd33b3ad025d66437c3e60d6db'
### aad: '1ff92b328311f1d66c54dd91c71539431a362ebd33b3ad025d66437c3e60d6db'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '15b01711c7d72f2e6f933fc7cd203b4cd41612b0c6f22d77f1c0b22f9200cc480712549e5dfa9be79d2524f07b5b5082b66921'
### ciphertext: '15b01711c7d72f2e6f933fc7cd203b4cd41612b0c6f22d77f1c0b22f9200cc480712549e5dfa9be79d2524f07b5b5082b66921'
### authtag: 'd811d74804ab8d3fc47e83d2925065fa'
### authtag: 'd811d74804ab8d3fc47e83d2925065fa'
### cipherinfo: '834a3136313637373137373850d811d74804ab8d3fc47e83d2925065fa583315b01711c7d72f2e6f933fc7cd203b4cd41612b0c6f22d77f1c0b22f9200cc480712549e5dfa9be79d2524f07b5b5082b66921'
### cipherinfo: '834a3136313637373137373850d811d74804ab8d3fc47e83d2925065fa583315b01711c7d72f2e6f933fc7cd203b4cd41612b0c6f22d77f1c0b22f9200cc480712549e5dfa9be79d2524f07b5b5082b66921'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: 'aa4f982819c2efe4fbf62305c64ece4090ee88ab1085344c08dacd0573d66ff4'
### key: 'aa4f982819c2efe4fbf62305c64ece4090ee88ab1085344c08dacd0573d66ff4'
### iv: 'ae390b74315c428b788c2d88'
### iv: 'ae390b74315c428b788c2d88'
### aad: '1ff92b328311f1d66c54dd91c71539431a362ebd33b3ad025d66437c3e60d6db'
### aad: '1ff92b328311f1d66c54dd91c71539431a362ebd33b3ad025d66437c3e60d6db'
### cipherinfo: '834a3136313637373137373850d811d74804ab8d3fc47e83d2925065fa583315b01711c7d72f2e6f933fc7cd203b4cd41612b0c6f22d77f1c0b22f9200cc480712549e5dfa9be79d2524f07b5b5082b66921'
### cipherinfo: '834a3136313637373137373850d811d74804ab8d3fc47e83d2925065fa583315b01711c7d72f2e6f933fc7cd203b4cd41612b0c6f22d77f1c0b22f9200cc480712549e5dfa9be79d2524f07b5b5082b66921'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '9f0f3a42066b73bc4fb42d88'
### iv_xor: '9f0f3a42066b73bc4fb42d88'
### authtag: 'd811d74804ab8d3fc47e83d2925065fa'
### authtag: 'd811d74804ab8d3fc47e83d2925065fa'
### ciphertext: '15b01711c7d72f2e6f933fc7cd203b4cd41612b0c6f22d77f1c0b22f9200cc480712549e5dfa9be79d2524f07b5b5082b66921'
### ciphertext: '15b01711c7d72f2e6f933fc7cd203b4cd41612b0c6f22d77f1c0b22f9200cc480712549e5dfa9be79d2524f07b5b5082b66921'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b send comm msg to a

### b send comm msg to a


### noise encrypt
### noise encrypt
### key: '93987a78488706d62fcd7e70522cd89286192607ec1e0e7def2b8acfb161efb6'
### key: '93987a78488706d62fcd7e70522cd89286192607ec1e0e7def2b8acfb161efb6'
### iv: 'd42d9d2f857dca5870fce332'
### iv: 'd42d9d2f857dca5870fce332'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'e51bac19b24afb6f47c4e332'
### iv_xor: 'e51bac19b24afb6f47c4e332'
### aad: '1ff92b328311f1d66c54dd91c71539431a362ebd33b3ad025d66437c3e60d6db'
### aad: '1ff92b328311f1d66c54dd91c71539431a362ebd33b3ad025d66437c3e60d6db'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '5c2bcb74b5dec56cbff8040e6c877aee0ee3693937290aa100f7886afeeae458085d7a4bfb46a7dde09eb2d3522086'
### ciphertext: '5c2bcb74b5dec56cbff8040e6c877aee0ee3693937290aa100f7886afeeae458085d7a4bfb46a7dde09eb2d3522086'
### authtag: '53cf3158924f14151aa3320b9f8dc9d6'
### authtag: '53cf3158924f14151aa3320b9f8dc9d6'
### cipherinfo: '834a313631363737313737385053cf3158924f14151aa3320b9f8dc9d6582f5c2bcb74b5dec56cbff8040e6c877aee0ee3693937290aa100f7886afeeae458085d7a4bfb46a7dde09eb2d3522086'
### cipherinfo: '834a313631363737313737385053cf3158924f14151aa3320b9f8dc9d6582f5c2bcb74b5dec56cbff8040e6c877aee0ee3693937290aa100f7886afeeae458085d7a4bfb46a7dde09eb2d3522086'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '93987a78488706d62fcd7e70522cd89286192607ec1e0e7def2b8acfb161efb6'
### key: '93987a78488706d62fcd7e70522cd89286192607ec1e0e7def2b8acfb161efb6'
### iv: 'd42d9d2f857dca5870fce332'
### iv: 'd42d9d2f857dca5870fce332'
### aad: '1ff92b328311f1d66c54dd91c71539431a362ebd33b3ad025d66437c3e60d6db'
### aad: '1ff92b328311f1d66c54dd91c71539431a362ebd33b3ad025d66437c3e60d6db'
### cipherinfo: '834a313631363737313737385053cf3158924f14151aa3320b9f8dc9d6582f5c2bcb74b5dec56cbff8040e6c877aee0ee3693937290aa100f7886afeeae458085d7a4bfb46a7dde09eb2d3522086'
### cipherinfo: '834a313631363737313737385053cf3158924f14151aa3320b9f8dc9d6582f5c2bcb74b5dec56cbff8040e6c877aee0ee3693937290aa100f7886afeeae458085d7a4bfb46a7dde09eb2d3522086'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'e51bac19b24afb6f47c4e332'
### iv_xor: 'e51bac19b24afb6f47c4e332'
### authtag: '53cf3158924f14151aa3320b9f8dc9d6'
### authtag: '53cf3158924f14151aa3320b9f8dc9d6'
### ciphertext: '5c2bcb74b5dec56cbff8040e6c877aee0ee3693937290aa100f7886afeeae458085d7a4bfb46a7dde09eb2d3522086'
### ciphertext: '5c2bcb74b5dec56cbff8040e6c877aee0ee3693937290aa100f7886afeeae458085d7a4bfb46a7dde09eb2d3522086'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'N',
###                               'test_psk',
###                               0
### -----------end test --------: 'N',
###                               'test_psk',
###                               0

### -----------start test --------: 'N',
###                                 'test_psk',
###                                 1

### -----------start test --------: 'N',
###                                 'test_psk',
###                                 1

### init a_hs

### init a_hs
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 1,
    message_pattens => [["e", "es", "psk"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","5b5ba9531f6781ac7fea3df8dba4290d0131906b9be3312a7e71db656d0118b8"),
      h  => pack("H*","0d1cca270f8fe51b0ab1960aabbe9ba8c8d55a00beeeaf899a7c4494f6944e19"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 1,
    message_pattens => [["e", "es", "psk"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","5b5ba9531f6781ac7fea3df8dba4290d0131906b9be3312a7e71db656d0118b8"),
      h  => pack("H*","0d1cca270f8fe51b0ab1960aabbe9ba8c8d55a00beeeaf899a7c4494f6944e19"),
    },
    who => "a",
  },
)

### a send msg to b

### a send msg to b

### $a_msg_src: 'init.syn'

### $a_msg_src: 'init.syn'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '0317d814195031e0b27c3c90d87e78b8652f1ae3b143a1ab9d93ac78def184a8df'

### public compressed: '0317d814195031e0b27c3c90d87e78b8652f1ae3b143a1ab9d93ac78def184a8df'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIIDKKgxCx8n0HOYst5ljI0Y5kXZE1KAwRMcVHhbPP4/SoAoGCCqGSM49
',
###             'AwEHoUQDQgAEF9gUGVAx4LJ8PJDYfni4ZS8a47FDoaudk6x43vGEqN/VzqDR2eCC
',
###             'bKkH8l46DViUQkFhOqvpA9f63qnbZttSyw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIIDKKgxCx8n0HOYst5ljI0Y5kXZE1KAwRMcVHhbPP4/SoAoGCCqGSM49
',
###             'AwEHoUQDQgAEF9gUGVAx4LJ8PJDYfni4ZS8a47FDoaudk6x43vGEqN/VzqDR2eCC
',
###             'bKkH8l46DViUQkFhOqvpA9f63qnbZttSyw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '6b93fbc38901bd4561eef7cf281c4ef4db4c1a991c9557d24d39c0ffcae55791'
### z: '6b93fbc38901bd4561eef7cf281c4ef4db4c1a991c9557d24d39c0ffcae55791'

### write message pattern: 'psk'

### write message pattern: 'psk'

### noise encrypt

### noise encrypt
### key: '9437c61873c0c1b3e39ce7dc8d076ba93a454cdba17f9b0d670e22079e1923fa'
### key: '9437c61873c0c1b3e39ce7dc8d076ba93a454cdba17f9b0d670e22079e1923fa'
### iv: '36169e0899c226bca7bf2966'
### iv: '36169e0899c226bca7bf2966'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '0720af3eaef5178b90872966'
### iv_xor: '0720af3eaef5178b90872966'
### aad: '22f66e12474975319ed32cc34878b80af451043a505cc11d996650ed1f6f672e'
### aad: '22f66e12474975319ed32cc34878b80af451043a505cc11d996650ed1f6f672e'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: 'fdb8f4f09c1a0591'
### ciphertext: 'fdb8f4f09c1a0591'
### authtag: '67ad0e7f34c82fea0053510cd5e16901'
### authtag: '67ad0e7f34c82fea0053510cd5e16901'
### cipherinfo: '834a313631363737313737385067ad0e7f34c82fea0053510cd5e1690148fdb8f4f09c1a0591'
### cipherinfo: '834a313631363737313737385067ad0e7f34c82fea0053510cd5e1690148fdb8f4f09c1a0591'

### a_msg: '8258210317d814195031e0b27c3c90d87e78b8652f1ae3b143a1ab9d93ac78def184a8df5826834a313631363737313737385067ad0e7f34c82fea0053510cd5e1690148fdb8f4f09c1a0591'

### a_msg: '8258210317d814195031e0b27c3c90d87e78b8652f1ae3b143a1ab9d93ac78def184a8df5826834a313631363737313737385067ad0e7f34c82fea0053510cd5e1690148fdb8f4f09c1a0591'
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0317d814195031e0b27c3c90d87e78b8652f1ae3b143a1ab9d93ac78def184a8df"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "N",
    initiator => 1,
    message_pattens => [["e", "es", "psk"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","62b66bd6ee6eddf6a7526a52f642df08588f7cbbaa9ede208739cda992475dc0"),
      h => pack("H*","ead62dfe2ca3235cf8946bf46cae6d917d3e315e8ca799c832f94e5f11d3afcc"),
      hasK => 1,
      k => pack("H*","521eb4fd6793b4f53ce8e35be86bf2ee080a15f2f4ab01cdd7b1b5afe23abc8f"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","c4f21626573dc51c7621910c623b274b64a27787441654ddbbef8ed3ad9d3802"),
  },
  {
    hasK => 1,
    k => pack("H*","3a4d7d71e1a03635c62871fec9cfbb75030ba9ccbbd72894073d3e8b67149e17"),
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0317d814195031e0b27c3c90d87e78b8652f1ae3b143a1ab9d93ac78def184a8df"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "N",
    initiator => 1,
    message_pattens => [["e", "es", "psk"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","62b66bd6ee6eddf6a7526a52f642df08588f7cbbaa9ede208739cda992475dc0"),
      h => pack("H*","ead62dfe2ca3235cf8946bf46cae6d917d3e315e8ca799c832f94e5f11d3afcc"),
      hasK => 1,
      k => pack("H*","521eb4fd6793b4f53ce8e35be86bf2ee080a15f2f4ab01cdd7b1b5afe23abc8f"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","c4f21626573dc51c7621910c623b274b64a27787441654ddbbef8ed3ad9d3802"),
  },
  {
    hasK => 1,
    k => pack("H*","3a4d7d71e1a03635c62871fec9cfbb75030ba9ccbbd72894073d3e8b67149e17"),
  },
)

### init b_hs

### init b_hs
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 0,
    message_pattens => [["e", "es", "psk"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","5b5ba9531f6781ac7fea3df8dba4290d0131906b9be3312a7e71db656d0118b8"),
      h  => pack("H*","0d1cca270f8fe51b0ab1960aabbe9ba8c8d55a00beeeaf899a7c4494f6944e19"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 0,
    message_pattens => [["e", "es", "psk"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","5b5ba9531f6781ac7fea3df8dba4290d0131906b9be3312a7e71db656d0118b8"),
      h  => pack("H*","0d1cca270f8fe51b0ab1960aabbe9ba8c8d55a00beeeaf899a7c4494f6944e19"),
    },
    who => "b",
  },
)

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEF9gUGVAx4LJ8PJDYfni4ZS8a47FD
',
###           'oaudk6x43vGEqN/VzqDR2eCCbKkH8l46DViUQkFhOqvpA9f63qnbZttSyw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEF9gUGVAx4LJ8PJDYfni4ZS8a47FD
',
###           'oaudk6x43vGEqN/VzqDR2eCCbKkH8l46DViUQkFhOqvpA9f63qnbZttSyw==
',
###           '-----END PUBLIC KEY-----
'
### z: '6b93fbc38901bd4561eef7cf281c4ef4db4c1a991c9557d24d39c0ffcae55791'
### z: '6b93fbc38901bd4561eef7cf281c4ef4db4c1a991c9557d24d39c0ffcae55791'

### read message pattern: 'psk'

### read message pattern: 'psk'

### noise decrypt

### noise decrypt
### key: '9437c61873c0c1b3e39ce7dc8d076ba93a454cdba17f9b0d670e22079e1923fa'
### key: '9437c61873c0c1b3e39ce7dc8d076ba93a454cdba17f9b0d670e22079e1923fa'
### iv: '36169e0899c226bca7bf2966'
### iv: '36169e0899c226bca7bf2966'
### aad: '22f66e12474975319ed32cc34878b80af451043a505cc11d996650ed1f6f672e'
### aad: '22f66e12474975319ed32cc34878b80af451043a505cc11d996650ed1f6f672e'
### cipherinfo: '834a313631363737313737385067ad0e7f34c82fea0053510cd5e1690148fdb8f4f09c1a0591'
### cipherinfo: '834a313631363737313737385067ad0e7f34c82fea0053510cd5e1690148fdb8f4f09c1a0591'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '0720af3eaef5178b90872966'
### iv_xor: '0720af3eaef5178b90872966'
### authtag: '67ad0e7f34c82fea0053510cd5e16901'
### authtag: '67ad0e7f34c82fea0053510cd5e16901'
### ciphertext: 'fdb8f4f09c1a0591'
### ciphertext: 'fdb8f4f09c1a0591'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'

### b_recv_a_msg: 'init.syn'

### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 0,
    message_pattens => [["e", "es", "psk"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","0317d814195031e0b27c3c90d87e78b8652f1ae3b143a1ab9d93ac78def184a8df"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","62b66bd6ee6eddf6a7526a52f642df08588f7cbbaa9ede208739cda992475dc0"),
      h => pack("H*","ead62dfe2ca3235cf8946bf46cae6d917d3e315e8ca799c832f94e5f11d3afcc"),
      hasK => 1,
      k => pack("H*","521eb4fd6793b4f53ce8e35be86bf2ee080a15f2f4ab01cdd7b1b5afe23abc8f"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","c4f21626573dc51c7621910c623b274b64a27787441654ddbbef8ed3ad9d3802"),
  },
  {
    hasK => 1,
    k => pack("H*","3a4d7d71e1a03635c62871fec9cfbb75030ba9ccbbd72894073d3e8b67149e17"),
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "N",
    initiator => 0,
    message_pattens => [["e", "es", "psk"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","0317d814195031e0b27c3c90d87e78b8652f1ae3b143a1ab9d93ac78def184a8df"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","62b66bd6ee6eddf6a7526a52f642df08588f7cbbaa9ede208739cda992475dc0"),
      h => pack("H*","ead62dfe2ca3235cf8946bf46cae6d917d3e315e8ca799c832f94e5f11d3afcc"),
      hasK => 1,
      k => pack("H*","521eb4fd6793b4f53ce8e35be86bf2ee080a15f2f4ab01cdd7b1b5afe23abc8f"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","c4f21626573dc51c7621910c623b274b64a27787441654ddbbef8ed3ad9d3802"),
  },
  {
    hasK => 1,
    k => pack("H*","3a4d7d71e1a03635c62871fec9cfbb75030ba9ccbbd72894073d3e8b67149e17"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '6820f360a9d66eabe38cd29d72071633e0d252dd25141f6affc2f8f7c0b16ac0'
### key: '6820f360a9d66eabe38cd29d72071633e0d252dd25141f6affc2f8f7c0b16ac0'
### iv: '18bbbe38cb9f15fb3be6c865'
### iv: '18bbbe38cb9f15fb3be6c865'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '298d8f0efca824cc0cdec865'
### iv_xor: '298d8f0efca824cc0cdec865'
### aad: 'ead62dfe2ca3235cf8946bf46cae6d917d3e315e8ca799c832f94e5f11d3afcc'
### aad: 'ead62dfe2ca3235cf8946bf46cae6d917d3e315e8ca799c832f94e5f11d3afcc'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '1ac497b5e5d0979e0e0fe6943c03ef5378f7c6b63e1bc092cabfcf3861ab0dc653e3c16ccb8d907810e031dcb7a319d2cea472'
### ciphertext: '1ac497b5e5d0979e0e0fe6943c03ef5378f7c6b63e1bc092cabfcf3861ab0dc653e3c16ccb8d907810e031dcb7a319d2cea472'
### authtag: '7a6e73fef6f49d1c9b21122d65d916c5'
### authtag: '7a6e73fef6f49d1c9b21122d65d916c5'
### cipherinfo: '834a31363136373731373738507a6e73fef6f49d1c9b21122d65d916c558331ac497b5e5d0979e0e0fe6943c03ef5378f7c6b63e1bc092cabfcf3861ab0dc653e3c16ccb8d907810e031dcb7a319d2cea472'
### cipherinfo: '834a31363136373731373738507a6e73fef6f49d1c9b21122d65d916c558331ac497b5e5d0979e0e0fe6943c03ef5378f7c6b63e1bc092cabfcf3861ab0dc653e3c16ccb8d907810e031dcb7a319d2cea472'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '6820f360a9d66eabe38cd29d72071633e0d252dd25141f6affc2f8f7c0b16ac0'
### key: '6820f360a9d66eabe38cd29d72071633e0d252dd25141f6affc2f8f7c0b16ac0'
### iv: '18bbbe38cb9f15fb3be6c865'
### iv: '18bbbe38cb9f15fb3be6c865'
### aad: 'ead62dfe2ca3235cf8946bf46cae6d917d3e315e8ca799c832f94e5f11d3afcc'
### aad: 'ead62dfe2ca3235cf8946bf46cae6d917d3e315e8ca799c832f94e5f11d3afcc'
### cipherinfo: '834a31363136373731373738507a6e73fef6f49d1c9b21122d65d916c558331ac497b5e5d0979e0e0fe6943c03ef5378f7c6b63e1bc092cabfcf3861ab0dc653e3c16ccb8d907810e031dcb7a319d2cea472'
### cipherinfo: '834a31363136373731373738507a6e73fef6f49d1c9b21122d65d916c558331ac497b5e5d0979e0e0fe6943c03ef5378f7c6b63e1bc092cabfcf3861ab0dc653e3c16ccb8d907810e031dcb7a319d2cea472'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '298d8f0efca824cc0cdec865'
### iv_xor: '298d8f0efca824cc0cdec865'
### authtag: '7a6e73fef6f49d1c9b21122d65d916c5'
### authtag: '7a6e73fef6f49d1c9b21122d65d916c5'
### ciphertext: '1ac497b5e5d0979e0e0fe6943c03ef5378f7c6b63e1bc092cabfcf3861ab0dc653e3c16ccb8d907810e031dcb7a319d2cea472'
### ciphertext: '1ac497b5e5d0979e0e0fe6943c03ef5378f7c6b63e1bc092cabfcf3861ab0dc653e3c16ccb8d907810e031dcb7a319d2cea472'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b send comm msg to a

### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '7903aa0e368ba67c2d0381d9b36446846b6ffebed6a55b82b0e8a10966f16503'
### key: '7903aa0e368ba67c2d0381d9b36446846b6ffebed6a55b82b0e8a10966f16503'
### iv: '5be24e8a5cc25ab1f13048cd'
### iv: '5be24e8a5cc25ab1f13048cd'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '6ad47fbc6bf56b86c60848cd'
### iv_xor: '6ad47fbc6bf56b86c60848cd'
### aad: 'ead62dfe2ca3235cf8946bf46cae6d917d3e315e8ca799c832f94e5f11d3afcc'
### aad: 'ead62dfe2ca3235cf8946bf46cae6d917d3e315e8ca799c832f94e5f11d3afcc'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'af157a02814931cba7173d00e29a40d17f8a4a639694e43fd8e1961360bde5f9ffce86635631a431eeda938a99c7ae'
### ciphertext: 'af157a02814931cba7173d00e29a40d17f8a4a639694e43fd8e1961360bde5f9ffce86635631a431eeda938a99c7ae'
### authtag: '21712c0819e095a0d13bce1cf275db34'
### authtag: '21712c0819e095a0d13bce1cf275db34'
### cipherinfo: '834a313631363737313737385021712c0819e095a0d13bce1cf275db34582faf157a02814931cba7173d00e29a40d17f8a4a639694e43fd8e1961360bde5f9ffce86635631a431eeda938a99c7ae'
### cipherinfo: '834a313631363737313737385021712c0819e095a0d13bce1cf275db34582faf157a02814931cba7173d00e29a40d17f8a4a639694e43fd8e1961360bde5f9ffce86635631a431eeda938a99c7ae'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '7903aa0e368ba67c2d0381d9b36446846b6ffebed6a55b82b0e8a10966f16503'
### key: '7903aa0e368ba67c2d0381d9b36446846b6ffebed6a55b82b0e8a10966f16503'
### iv: '5be24e8a5cc25ab1f13048cd'
### iv: '5be24e8a5cc25ab1f13048cd'
### aad: 'ead62dfe2ca3235cf8946bf46cae6d917d3e315e8ca799c832f94e5f11d3afcc'
### aad: 'ead62dfe2ca3235cf8946bf46cae6d917d3e315e8ca799c832f94e5f11d3afcc'
### cipherinfo: '834a313631363737313737385021712c0819e095a0d13bce1cf275db34582faf157a02814931cba7173d00e29a40d17f8a4a639694e43fd8e1961360bde5f9ffce86635631a431eeda938a99c7ae'
### cipherinfo: '834a313631363737313737385021712c0819e095a0d13bce1cf275db34582faf157a02814931cba7173d00e29a40d17f8a4a639694e43fd8e1961360bde5f9ffce86635631a431eeda938a99c7ae'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '6ad47fbc6bf56b86c60848cd'
### iv_xor: '6ad47fbc6bf56b86c60848cd'
### authtag: '21712c0819e095a0d13bce1cf275db34'
### authtag: '21712c0819e095a0d13bce1cf275db34'
### ciphertext: 'af157a02814931cba7173d00e29a40d17f8a4a639694e43fd8e1961360bde5f9ffce86635631a431eeda938a99c7ae'
### ciphertext: 'af157a02814931cba7173d00e29a40d17f8a4a639694e43fd8e1961360bde5f9ffce86635631a431eeda938a99c7ae'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'N',
###                               'test_psk',
###                               1

### -----------end test --------: 'N',
###                               'test_psk',
###                               1

### -----------start test --------: 'K',
###                                 undef,
###                                 undef

### -----------start test --------: 'K',
###                                 undef,
###                                 undef

### init a_hs

### init a_hs
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 1,
    message_pattens => [["e", "es", "ss"]],
    msg_id => 0,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => "Noise_K_secp256r1_AESGCM_SHA256\0",
      h  => pack("H*","3f41c8dbd0856fb6cb1966bb7bdaa1be23523534651f850a5c232f38fc8a25c8"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 1,
    message_pattens => [["e", "es", "ss"]],
    msg_id => 0,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => "Noise_K_secp256r1_AESGCM_SHA256\0",
      h  => pack("H*","3f41c8dbd0856fb6cb1966bb7bdaa1be23523534651f850a5c232f38fc8a25c8"),
    },
    who => "a",
  },
)

### a send msg to b

### a send msg to b

### $a_msg_src: 'init.syn'

### $a_msg_src: 'init.syn'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '03b3d02115985422861dd9ae942cbf0990d4f5c44c5c61eb341f6caaa4088b437e'

### public compressed: '03b3d02115985422861dd9ae942cbf0990d4f5c44c5c61eb341f6caaa4088b437e'

### write message pattern: 'es'

### write message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOX6OchEl8FPaPKm42UHyvT+k7zhkyah1JR9tzAxzp5OoAoGCCqGSM49
',
###             'AwEHoUQDQgAEs9AhFZhUIoYd2a6ULL8JkNT1xExcYes0H2yqpAiLQ35clGxTKUTE
',
###             'tJGPYIYwo82yeQFQDAN+KIY+CrFZjlLiPQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOX6OchEl8FPaPKm42UHyvT+k7zhkyah1JR9tzAxzp5OoAoGCCqGSM49
',
###             'AwEHoUQDQgAEs9AhFZhUIoYd2a6ULL8JkNT1xExcYes0H2yqpAiLQ35clGxTKUTE
',
###             'tJGPYIYwo82yeQFQDAN+KIY+CrFZjlLiPQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '6a14eea5672360f5691ca6e683cbbcb57e10fd3dadc2ac388fa789cdfedcf4cb'
### z: '6a14eea5672360f5691ca6e683cbbcb57e10fd3dadc2ac388fa789cdfedcf4cb'

### write message pattern: 'ss'

### write message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### noise encrypt
### noise encrypt
### key: '43a8b7d87860a37cfc42404466997e704e28ab96c189d5ce73ab26cbdf472c69'
### key: '43a8b7d87860a37cfc42404466997e704e28ab96c189d5ce73ab26cbdf472c69'
### iv: 'cde8f7692b325a9bfe4ce49e'
### iv: 'cde8f7692b325a9bfe4ce49e'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'fcdec65f1c056bacc974e49e'
### iv_xor: 'fcdec65f1c056bacc974e49e'
### aad: '355d32334f7466175f7f705872d18430dd6e8c93139f545d31c94cd4ba31cc8b'
### aad: '355d32334f7466175f7f705872d18430dd6e8c93139f545d31c94cd4ba31cc8b'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '48d060b37273837b'
### ciphertext: '48d060b37273837b'
### authtag: 'b7aae49917b10de7006409ea01fcbf76'
### authtag: 'b7aae49917b10de7006409ea01fcbf76'
### cipherinfo: '834a3136313637373137373850b7aae49917b10de7006409ea01fcbf764848d060b37273837b'
### cipherinfo: '834a3136313637373137373850b7aae49917b10de7006409ea01fcbf764848d060b37273837b'


### a_msg: '82582103b3d02115985422861dd9ae942cbf0990d4f5c44c5c61eb341f6caaa4088b437e5826834a3136313637373137373850b7aae49917b10de7006409ea01fcbf764848d060b37273837b'
### a_msg: '82582103b3d02115985422861dd9ae942cbf0990d4f5c44c5c61eb341f6caaa4088b437e5826834a3136313637373137373850b7aae49917b10de7006409ea01fcbf764848d060b37273837b'
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03b3d02115985422861dd9ae942cbf0990d4f5c44c5c61eb341f6caaa4088b437e"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "K",
    initiator => 1,
    message_pattens => [["e", "es", "ss"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","212057834c6f83fb8fcfd6810623bd9ae2dd2e472e37eb5b3a3562ce32962dc9"),
      h => pack("H*","c39ab8f51d86b904296164bd6797d07ba66df2f64f1a1a46169551330490dd61"),
      hasK => 1,
      k => pack("H*","653e50d46c9a2f807095dd38d0de3e17d63cbc283a99a9126af51515cd583cdf"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","c203447914e31f27b84a0d9f44854f1035d23bc91b90d32e0d348c90b692d9cc"),
  },
  {
    hasK => 1,
    k => pack("H*","78ba5504ad8dbaa1ffd10a0bdc1071e65a755491753ae4b1583cdd8653206b42"),
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03b3d02115985422861dd9ae942cbf0990d4f5c44c5c61eb341f6caaa4088b437e"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "K",
    initiator => 1,
    message_pattens => [["e", "es", "ss"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","212057834c6f83fb8fcfd6810623bd9ae2dd2e472e37eb5b3a3562ce32962dc9"),
      h => pack("H*","c39ab8f51d86b904296164bd6797d07ba66df2f64f1a1a46169551330490dd61"),
      hasK => 1,
      k => pack("H*","653e50d46c9a2f807095dd38d0de3e17d63cbc283a99a9126af51515cd583cdf"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","c203447914e31f27b84a0d9f44854f1035d23bc91b90d32e0d348c90b692d9cc"),
  },
  {
    hasK => 1,
    k => pack("H*","78ba5504ad8dbaa1ffd10a0bdc1071e65a755491753ae4b1583cdd8653206b42"),
  },
)


### init b_hs
### init b_hs
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 0,
    message_pattens => [["e", "es", "ss"]],
    msg_id => 0,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => "Noise_K_secp256r1_AESGCM_SHA256\0",
      h  => pack("H*","3f41c8dbd0856fb6cb1966bb7bdaa1be23523534651f850a5c232f38fc8a25c8"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 0,
    message_pattens => [["e", "es", "ss"]],
    msg_id => 0,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => "Noise_K_secp256r1_AESGCM_SHA256\0",
      h  => pack("H*","3f41c8dbd0856fb6cb1966bb7bdaa1be23523534651f850a5c232f38fc8a25c8"),
    },
    who => "b",
  },
)

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEs9AhFZhUIoYd2a6ULL8JkNT1xExc
',
###           'Yes0H2yqpAiLQ35clGxTKUTEtJGPYIYwo82yeQFQDAN+KIY+CrFZjlLiPQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEs9AhFZhUIoYd2a6ULL8JkNT1xExc
',
###           'Yes0H2yqpAiLQ35clGxTKUTEtJGPYIYwo82yeQFQDAN+KIY+CrFZjlLiPQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '6a14eea5672360f5691ca6e683cbbcb57e10fd3dadc2ac388fa789cdfedcf4cb'
### z: '6a14eea5672360f5691ca6e683cbbcb57e10fd3dadc2ac388fa789cdfedcf4cb'

### read message pattern: 'ss'

### read message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### noise decrypt
### noise decrypt
### key: '43a8b7d87860a37cfc42404466997e704e28ab96c189d5ce73ab26cbdf472c69'
### key: '43a8b7d87860a37cfc42404466997e704e28ab96c189d5ce73ab26cbdf472c69'
### iv: 'cde8f7692b325a9bfe4ce49e'
### iv: 'cde8f7692b325a9bfe4ce49e'
### aad: '355d32334f7466175f7f705872d18430dd6e8c93139f545d31c94cd4ba31cc8b'
### aad: '355d32334f7466175f7f705872d18430dd6e8c93139f545d31c94cd4ba31cc8b'
### cipherinfo: '834a3136313637373137373850b7aae49917b10de7006409ea01fcbf764848d060b37273837b'
### cipherinfo: '834a3136313637373137373850b7aae49917b10de7006409ea01fcbf764848d060b37273837b'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'fcdec65f1c056bacc974e49e'
### iv_xor: 'fcdec65f1c056bacc974e49e'
### authtag: 'b7aae49917b10de7006409ea01fcbf76'
### authtag: 'b7aae49917b10de7006409ea01fcbf76'
### ciphertext: '48d060b37273837b'
### ciphertext: '48d060b37273837b'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'


### b_recv_a_msg: 'init.syn'
### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 0,
    message_pattens => [["e", "es", "ss"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","03b3d02115985422861dd9ae942cbf0990d4f5c44c5c61eb341f6caaa4088b437e"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","212057834c6f83fb8fcfd6810623bd9ae2dd2e472e37eb5b3a3562ce32962dc9"),
      h => pack("H*","c39ab8f51d86b904296164bd6797d07ba66df2f64f1a1a46169551330490dd61"),
      hasK => 1,
      k => pack("H*","653e50d46c9a2f807095dd38d0de3e17d63cbc283a99a9126af51515cd583cdf"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","c203447914e31f27b84a0d9f44854f1035d23bc91b90d32e0d348c90b692d9cc"),
  },
  {
    hasK => 1,
    k => pack("H*","78ba5504ad8dbaa1ffd10a0bdc1071e65a755491753ae4b1583cdd8653206b42"),
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 0,
    message_pattens => [["e", "es", "ss"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","03b3d02115985422861dd9ae942cbf0990d4f5c44c5c61eb341f6caaa4088b437e"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","212057834c6f83fb8fcfd6810623bd9ae2dd2e472e37eb5b3a3562ce32962dc9"),
      h => pack("H*","c39ab8f51d86b904296164bd6797d07ba66df2f64f1a1a46169551330490dd61"),
      hasK => 1,
      k => pack("H*","653e50d46c9a2f807095dd38d0de3e17d63cbc283a99a9126af51515cd583cdf"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","c203447914e31f27b84a0d9f44854f1035d23bc91b90d32e0d348c90b692d9cc"),
  },
  {
    hasK => 1,
    k => pack("H*","78ba5504ad8dbaa1ffd10a0bdc1071e65a755491753ae4b1583cdd8653206b42"),
  },
)


### a send comm msg to b
### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '18f85d10cbcf1bd5b3a32a7232c6e1ad97126b42a0448d4e6c59752ec96eb2cd'
### key: '18f85d10cbcf1bd5b3a32a7232c6e1ad97126b42a0448d4e6c59752ec96eb2cd'
### iv: 'e4817930e4d4aa550ce05a19'
### iv: 'e4817930e4d4aa550ce05a19'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'd5b74806d3e39b623bd85a19'
### iv_xor: 'd5b74806d3e39b623bd85a19'
### aad: 'c39ab8f51d86b904296164bd6797d07ba66df2f64f1a1a46169551330490dd61'
### aad: 'c39ab8f51d86b904296164bd6797d07ba66df2f64f1a1a46169551330490dd61'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '466185d7868d3b733a7a65672bbc5daf9171f3161e461b5fc1fe1ca669dd1c39630fd3fcc4bfaadf6790db67b9276f41eb031a'
### ciphertext: '466185d7868d3b733a7a65672bbc5daf9171f3161e461b5fc1fe1ca669dd1c39630fd3fcc4bfaadf6790db67b9276f41eb031a'
### authtag: 'd1dfee222a7f541f48b2392bbf78cdd1'
### authtag: 'd1dfee222a7f541f48b2392bbf78cdd1'
### cipherinfo: '834a3136313637373137373850d1dfee222a7f541f48b2392bbf78cdd15833466185d7868d3b733a7a65672bbc5daf9171f3161e461b5fc1fe1ca669dd1c39630fd3fcc4bfaadf6790db67b9276f41eb031a'
### cipherinfo: '834a3136313637373137373850d1dfee222a7f541f48b2392bbf78cdd15833466185d7868d3b733a7a65672bbc5daf9171f3161e461b5fc1fe1ca669dd1c39630fd3fcc4bfaadf6790db67b9276f41eb031a'

### b recv comm msg from a

### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: '18f85d10cbcf1bd5b3a32a7232c6e1ad97126b42a0448d4e6c59752ec96eb2cd'
### key: '18f85d10cbcf1bd5b3a32a7232c6e1ad97126b42a0448d4e6c59752ec96eb2cd'
### iv: 'e4817930e4d4aa550ce05a19'
### iv: 'e4817930e4d4aa550ce05a19'
### aad: 'c39ab8f51d86b904296164bd6797d07ba66df2f64f1a1a46169551330490dd61'
### aad: 'c39ab8f51d86b904296164bd6797d07ba66df2f64f1a1a46169551330490dd61'
### cipherinfo: '834a3136313637373137373850d1dfee222a7f541f48b2392bbf78cdd15833466185d7868d3b733a7a65672bbc5daf9171f3161e461b5fc1fe1ca669dd1c39630fd3fcc4bfaadf6790db67b9276f41eb031a'
### cipherinfo: '834a3136313637373137373850d1dfee222a7f541f48b2392bbf78cdd15833466185d7868d3b733a7a65672bbc5daf9171f3161e461b5fc1fe1ca669dd1c39630fd3fcc4bfaadf6790db67b9276f41eb031a'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'd5b74806d3e39b623bd85a19'
### iv_xor: 'd5b74806d3e39b623bd85a19'
### authtag: 'd1dfee222a7f541f48b2392bbf78cdd1'
### authtag: 'd1dfee222a7f541f48b2392bbf78cdd1'
### ciphertext: '466185d7868d3b733a7a65672bbc5daf9171f3161e461b5fc1fe1ca669dd1c39630fd3fcc4bfaadf6790db67b9276f41eb031a'
### ciphertext: '466185d7868d3b733a7a65672bbc5daf9171f3161e461b5fc1fe1ca669dd1c39630fd3fcc4bfaadf6790db67b9276f41eb031a'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'


### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '11d9bfb7eafb06878ba9e0b0ea6b9e132080f248b00d30106bfd26cd4be11dcf'
### key: '11d9bfb7eafb06878ba9e0b0ea6b9e132080f248b00d30106bfd26cd4be11dcf'
### iv: 'c24b4b57972de9536cb35bb3'
### iv: 'c24b4b57972de9536cb35bb3'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'f37d7a61a01ad8645b8b5bb3'
### iv_xor: 'f37d7a61a01ad8645b8b5bb3'
### aad: 'c39ab8f51d86b904296164bd6797d07ba66df2f64f1a1a46169551330490dd61'
### aad: 'c39ab8f51d86b904296164bd6797d07ba66df2f64f1a1a46169551330490dd61'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '94808e706f41804057c1b98007806e477d85bcea27d560512b91bf17781083025a74eeacc6a8fc5c1d226073b5e5e3'
### ciphertext: '94808e706f41804057c1b98007806e477d85bcea27d560512b91bf17781083025a74eeacc6a8fc5c1d226073b5e5e3'
### authtag: '2c0011a54c2e19ee8fdb174d305c9775'
### authtag: '2c0011a54c2e19ee8fdb174d305c9775'
### cipherinfo: '834a31363136373731373738502c0011a54c2e19ee8fdb174d305c9775582f94808e706f41804057c1b98007806e477d85bcea27d560512b91bf17781083025a74eeacc6a8fc5c1d226073b5e5e3'
### cipherinfo: '834a31363136373731373738502c0011a54c2e19ee8fdb174d305c9775582f94808e706f41804057c1b98007806e477d85bcea27d560512b91bf17781083025a74eeacc6a8fc5c1d226073b5e5e3'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '11d9bfb7eafb06878ba9e0b0ea6b9e132080f248b00d30106bfd26cd4be11dcf'
### key: '11d9bfb7eafb06878ba9e0b0ea6b9e132080f248b00d30106bfd26cd4be11dcf'
### iv: 'c24b4b57972de9536cb35bb3'
### iv: 'c24b4b57972de9536cb35bb3'
### aad: 'c39ab8f51d86b904296164bd6797d07ba66df2f64f1a1a46169551330490dd61'
### aad: 'c39ab8f51d86b904296164bd6797d07ba66df2f64f1a1a46169551330490dd61'
### cipherinfo: '834a31363136373731373738502c0011a54c2e19ee8fdb174d305c9775582f94808e706f41804057c1b98007806e477d85bcea27d560512b91bf17781083025a74eeacc6a8fc5c1d226073b5e5e3'
### cipherinfo: '834a31363136373731373738502c0011a54c2e19ee8fdb174d305c9775582f94808e706f41804057c1b98007806e477d85bcea27d560512b91bf17781083025a74eeacc6a8fc5c1d226073b5e5e3'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'f37d7a61a01ad8645b8b5bb3'
### iv_xor: 'f37d7a61a01ad8645b8b5bb3'
### authtag: '2c0011a54c2e19ee8fdb174d305c9775'
### authtag: '2c0011a54c2e19ee8fdb174d305c9775'
### ciphertext: '94808e706f41804057c1b98007806e477d85bcea27d560512b91bf17781083025a74eeacc6a8fc5c1d226073b5e5e3'
### ciphertext: '94808e706f41804057c1b98007806e477d85bcea27d560512b91bf17781083025a74eeacc6a8fc5c1d226073b5e5e3'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'K',
###                               undef,
###                               undef

### -----------end test --------: 'K',
###                               undef,
###                               undef

### -----------start test --------: 'K',
###                                 'test_psk',
###                                 0

### -----------start test --------: 'K',
###                                 'test_psk',
###                                 0

### init a_hs

### init a_hs
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 1,
    message_pattens => [["psk", "e", "es", "ss"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","bf69632863943204f11283fb6f35efb04f3b67aa6928feac950eac389be8dc59"),
      h  => pack("H*","71bb1a14c377d8d909631cc607d441a916419f6a53d99e57ec3c948a230ef722"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 1,
    message_pattens => [["psk", "e", "es", "ss"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","bf69632863943204f11283fb6f35efb04f3b67aa6928feac950eac389be8dc59"),
      h  => pack("H*","71bb1a14c377d8d909631cc607d441a916419f6a53d99e57ec3c948a230ef722"),
    },
    who => "a",
  },
)

### a send msg to b

### a send msg to b

### $a_msg_src: 'init.syn'

### $a_msg_src: 'init.syn'

### write message pattern: 'psk'

### write message pattern: 'psk'

### write message pattern: 'e'

### write message pattern: 'e'


### public compressed: '03949ab4ca39ba0588611f1c6166d3fafbee78a4a47d1ada0069cced3b983de7e2'
### public compressed: '03949ab4ca39ba0588611f1c6166d3fafbee78a4a47d1ada0069cced3b983de7e2'


### write message pattern: 'es'
### write message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBmywMdyeVqBxGGq2CE6qpUgENePNIaubCHg52ieLkn7oAoGCCqGSM49
',
###             'AwEHoUQDQgAElJq0yjm6BYhhHxxhZtP6++54pKR9GtoAacztO5g95+Iloe8kkSNs
',
###             'rTe/XuJ/XR59XMFeGTJyzWp+l6r61/QupQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBmywMdyeVqBxGGq2CE6qpUgENePNIaubCHg52ieLkn7oAoGCCqGSM49
',
###             'AwEHoUQDQgAElJq0yjm6BYhhHxxhZtP6++54pKR9GtoAacztO5g95+Iloe8kkSNs
',
###             'rTe/XuJ/XR59XMFeGTJyzWp+l6r61/QupQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '19011644ab5f29ab6598d89ad48ef6d2ba6fe9ea71ad9bcd3737a8e1e810453f'
### z: '19011644ab5f29ab6598d89ad48ef6d2ba6fe9ea71ad9bcd3737a8e1e810453f'

### write message pattern: 'ss'

### write message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### noise encrypt

### noise encrypt
### key: 'd3ced527be6a9f606479f45b2aed103c0894b2e42ddb2c1be0387b2616b5a82f'
### key: 'd3ced527be6a9f606479f45b2aed103c0894b2e42ddb2c1be0387b2616b5a82f'
### iv: '93bd5c16af5192418bb10db5'
### iv: '93bd5c16af5192418bb10db5'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'a28b6d209866a376bc890db5'
### iv_xor: 'a28b6d209866a376bc890db5'
### aad: '3389dd4f9d1833b2c71a78a5683bb3b2920c4978fac083f46beacae520cac7d2'
### aad: '3389dd4f9d1833b2c71a78a5683bb3b2920c4978fac083f46beacae520cac7d2'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: 'fd12d6e4e8ef9d7d'
### ciphertext: 'fd12d6e4e8ef9d7d'
### authtag: 'fd6543dbe88121c2a53f16d5556c7291'
### authtag: 'fd6543dbe88121c2a53f16d5556c7291'
### cipherinfo: '834a3136313637373137373850fd6543dbe88121c2a53f16d5556c729148fd12d6e4e8ef9d7d'
### cipherinfo: '834a3136313637373137373850fd6543dbe88121c2a53f16d5556c729148fd12d6e4e8ef9d7d'


### a_msg: '82582103949ab4ca39ba0588611f1c6166d3fafbee78a4a47d1ada0069cced3b983de7e25826834a3136313637373137373850fd6543dbe88121c2a53f16d5556c729148fd12d6e4e8ef9d7d'
### a_msg: '82582103949ab4ca39ba0588611f1c6166d3fafbee78a4a47d1ada0069cced3b983de7e25826834a3136313637373137373850fd6543dbe88121c2a53f16d5556c729148fd12d6e4e8ef9d7d'
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03949ab4ca39ba0588611f1c6166d3fafbee78a4a47d1ada0069cced3b983de7e2"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "K",
    initiator => 1,
    message_pattens => [["psk", "e", "es", "ss"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","3e38222e89ce02a6dace15814e58736cb9313f18c00f615f8d7c6dc372502fae"),
      h => pack("H*","01f80b0dd9882fbe52f395cf1b4e73cddf8bef475046eff76badace53d4aa7ce"),
      hasK => 1,
      k => pack("H*","df987a7d85a14d3ee924fcc63ddf25f4a34c9936e5bd6daa924b0c0b6724f0fa"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","71f0f270cbd2e87d96b9addb837d5107735176525553d3d7d9fb8def8e4af624"),
  },
  {
    hasK => 1,
    k => pack("H*","ce358b3ccb946eb57d344d5db63960e5e2a424ccf02d6feed4f4266b2af05db5"),
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03949ab4ca39ba0588611f1c6166d3fafbee78a4a47d1ada0069cced3b983de7e2"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "K",
    initiator => 1,
    message_pattens => [["psk", "e", "es", "ss"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","3e38222e89ce02a6dace15814e58736cb9313f18c00f615f8d7c6dc372502fae"),
      h => pack("H*","01f80b0dd9882fbe52f395cf1b4e73cddf8bef475046eff76badace53d4aa7ce"),
      hasK => 1,
      k => pack("H*","df987a7d85a14d3ee924fcc63ddf25f4a34c9936e5bd6daa924b0c0b6724f0fa"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","71f0f270cbd2e87d96b9addb837d5107735176525553d3d7d9fb8def8e4af624"),
  },
  {
    hasK => 1,
    k => pack("H*","ce358b3ccb946eb57d344d5db63960e5e2a424ccf02d6feed4f4266b2af05db5"),
  },
)

### init b_hs

### init b_hs
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 0,
    message_pattens => [["psk", "e", "es", "ss"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","bf69632863943204f11283fb6f35efb04f3b67aa6928feac950eac389be8dc59"),
      h  => pack("H*","71bb1a14c377d8d909631cc607d441a916419f6a53d99e57ec3c948a230ef722"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 0,
    message_pattens => [["psk", "e", "es", "ss"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","bf69632863943204f11283fb6f35efb04f3b67aa6928feac950eac389be8dc59"),
      h  => pack("H*","71bb1a14c377d8d909631cc607d441a916419f6a53d99e57ec3c948a230ef722"),
    },
    who => "b",
  },
)

### b recv msg from a

### b recv msg from a

### read message pattern: 'psk'

### read message pattern: 'psk'

### read message pattern: 'e'

### read message pattern: 'e'


### read message pattern: 'es'
### read message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAElJq0yjm6BYhhHxxhZtP6++54pKR9
',
###           'GtoAacztO5g95+Iloe8kkSNsrTe/XuJ/XR59XMFeGTJyzWp+l6r61/QupQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAElJq0yjm6BYhhHxxhZtP6++54pKR9
',
###           'GtoAacztO5g95+Iloe8kkSNsrTe/XuJ/XR59XMFeGTJyzWp+l6r61/QupQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '19011644ab5f29ab6598d89ad48ef6d2ba6fe9ea71ad9bcd3737a8e1e810453f'
### z: '19011644ab5f29ab6598d89ad48ef6d2ba6fe9ea71ad9bcd3737a8e1e810453f'

### read message pattern: 'ss'

### read message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### noise decrypt

### noise decrypt
### key: 'd3ced527be6a9f606479f45b2aed103c0894b2e42ddb2c1be0387b2616b5a82f'
### key: 'd3ced527be6a9f606479f45b2aed103c0894b2e42ddb2c1be0387b2616b5a82f'
### iv: '93bd5c16af5192418bb10db5'
### iv: '93bd5c16af5192418bb10db5'
### aad: '3389dd4f9d1833b2c71a78a5683bb3b2920c4978fac083f46beacae520cac7d2'
### aad: '3389dd4f9d1833b2c71a78a5683bb3b2920c4978fac083f46beacae520cac7d2'
### cipherinfo: '834a3136313637373137373850fd6543dbe88121c2a53f16d5556c729148fd12d6e4e8ef9d7d'
### cipherinfo: '834a3136313637373137373850fd6543dbe88121c2a53f16d5556c729148fd12d6e4e8ef9d7d'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'a28b6d209866a376bc890db5'
### iv_xor: 'a28b6d209866a376bc890db5'
### authtag: 'fd6543dbe88121c2a53f16d5556c7291'
### authtag: 'fd6543dbe88121c2a53f16d5556c7291'
### ciphertext: 'fd12d6e4e8ef9d7d'
### ciphertext: 'fd12d6e4e8ef9d7d'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'

### b_recv_a_msg: 'init.syn'

### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 0,
    message_pattens => [["psk", "e", "es", "ss"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","03949ab4ca39ba0588611f1c6166d3fafbee78a4a47d1ada0069cced3b983de7e2"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","3e38222e89ce02a6dace15814e58736cb9313f18c00f615f8d7c6dc372502fae"),
      h => pack("H*","01f80b0dd9882fbe52f395cf1b4e73cddf8bef475046eff76badace53d4aa7ce"),
      hasK => 1,
      k => pack("H*","df987a7d85a14d3ee924fcc63ddf25f4a34c9936e5bd6daa924b0c0b6724f0fa"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","71f0f270cbd2e87d96b9addb837d5107735176525553d3d7d9fb8def8e4af624"),
  },
  {
    hasK => 1,
    k => pack("H*","ce358b3ccb946eb57d344d5db63960e5e2a424ccf02d6feed4f4266b2af05db5"),
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 0,
    message_pattens => [["psk", "e", "es", "ss"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","03949ab4ca39ba0588611f1c6166d3fafbee78a4a47d1ada0069cced3b983de7e2"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","3e38222e89ce02a6dace15814e58736cb9313f18c00f615f8d7c6dc372502fae"),
      h => pack("H*","01f80b0dd9882fbe52f395cf1b4e73cddf8bef475046eff76badace53d4aa7ce"),
      hasK => 1,
      k => pack("H*","df987a7d85a14d3ee924fcc63ddf25f4a34c9936e5bd6daa924b0c0b6724f0fa"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","71f0f270cbd2e87d96b9addb837d5107735176525553d3d7d9fb8def8e4af624"),
  },
  {
    hasK => 1,
    k => pack("H*","ce358b3ccb946eb57d344d5db63960e5e2a424ccf02d6feed4f4266b2af05db5"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '18f642808892633d1f2c94379173498375622ad16db08e376f9809d33541b285'
### key: '18f642808892633d1f2c94379173498375622ad16db08e376f9809d33541b285'
### iv: '1954313df8d33f7ee3618d1e'
### iv: '1954313df8d33f7ee3618d1e'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '2862000bcfe40e49d4598d1e'
### iv_xor: '2862000bcfe40e49d4598d1e'
### aad: '01f80b0dd9882fbe52f395cf1b4e73cddf8bef475046eff76badace53d4aa7ce'
### aad: '01f80b0dd9882fbe52f395cf1b4e73cddf8bef475046eff76badace53d4aa7ce'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '8a6c807f94de4fbd543e124467efbbaf139ee7b2bc08dd546a1ba132f5ba519262fc8738717e8954f5b188ec736b3f7ccf1b16'
### ciphertext: '8a6c807f94de4fbd543e124467efbbaf139ee7b2bc08dd546a1ba132f5ba519262fc8738717e8954f5b188ec736b3f7ccf1b16'
### authtag: 'bfb8ec4dddc81acc515ca119e7d8af0f'
### authtag: 'bfb8ec4dddc81acc515ca119e7d8af0f'
### cipherinfo: '834a3136313637373137373850bfb8ec4dddc81acc515ca119e7d8af0f58338a6c807f94de4fbd543e124467efbbaf139ee7b2bc08dd546a1ba132f5ba519262fc8738717e8954f5b188ec736b3f7ccf1b16'
### cipherinfo: '834a3136313637373137373850bfb8ec4dddc81acc515ca119e7d8af0f58338a6c807f94de4fbd543e124467efbbaf139ee7b2bc08dd546a1ba132f5ba519262fc8738717e8954f5b188ec736b3f7ccf1b16'


### b recv comm msg from a
### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '18f642808892633d1f2c94379173498375622ad16db08e376f9809d33541b285'
### key: '18f642808892633d1f2c94379173498375622ad16db08e376f9809d33541b285'
### iv: '1954313df8d33f7ee3618d1e'
### iv: '1954313df8d33f7ee3618d1e'
### aad: '01f80b0dd9882fbe52f395cf1b4e73cddf8bef475046eff76badace53d4aa7ce'
### aad: '01f80b0dd9882fbe52f395cf1b4e73cddf8bef475046eff76badace53d4aa7ce'
### cipherinfo: '834a3136313637373137373850bfb8ec4dddc81acc515ca119e7d8af0f58338a6c807f94de4fbd543e124467efbbaf139ee7b2bc08dd546a1ba132f5ba519262fc8738717e8954f5b188ec736b3f7ccf1b16'
### cipherinfo: '834a3136313637373137373850bfb8ec4dddc81acc515ca119e7d8af0f58338a6c807f94de4fbd543e124467efbbaf139ee7b2bc08dd546a1ba132f5ba519262fc8738717e8954f5b188ec736b3f7ccf1b16'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '2862000bcfe40e49d4598d1e'
### iv_xor: '2862000bcfe40e49d4598d1e'
### authtag: 'bfb8ec4dddc81acc515ca119e7d8af0f'
### authtag: 'bfb8ec4dddc81acc515ca119e7d8af0f'
### ciphertext: '8a6c807f94de4fbd543e124467efbbaf139ee7b2bc08dd546a1ba132f5ba519262fc8738717e8954f5b188ec736b3f7ccf1b16'
### ciphertext: '8a6c807f94de4fbd543e124467efbbaf139ee7b2bc08dd546a1ba132f5ba519262fc8738717e8954f5b188ec736b3f7ccf1b16'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b send comm msg to a

### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '580afe3827eac29587d793ec3ccce9ed64617c093701d0fa5220005b0a58f53f'
### key: '580afe3827eac29587d793ec3ccce9ed64617c093701d0fa5220005b0a58f53f'
### iv: '1cdda4ec5c121e5bc277363a'
### iv: '1cdda4ec5c121e5bc277363a'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '2deb95da6b252f6cf54f363a'
### iv_xor: '2deb95da6b252f6cf54f363a'
### aad: '01f80b0dd9882fbe52f395cf1b4e73cddf8bef475046eff76badace53d4aa7ce'
### aad: '01f80b0dd9882fbe52f395cf1b4e73cddf8bef475046eff76badace53d4aa7ce'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '493894863f766387f2077021c1133ace52f2ee946a8cce015fdff6d6ed0c3cd65080eb5b493e309c8813a423b9e9b8'
### ciphertext: '493894863f766387f2077021c1133ace52f2ee946a8cce015fdff6d6ed0c3cd65080eb5b493e309c8813a423b9e9b8'
### authtag: 'c5491f27b67dabd44e3d39293c2c60d6'
### authtag: 'c5491f27b67dabd44e3d39293c2c60d6'
### cipherinfo: '834a3136313637373137373850c5491f27b67dabd44e3d39293c2c60d6582f493894863f766387f2077021c1133ace52f2ee946a8cce015fdff6d6ed0c3cd65080eb5b493e309c8813a423b9e9b8'
### cipherinfo: '834a3136313637373137373850c5491f27b67dabd44e3d39293c2c60d6582f493894863f766387f2077021c1133ace52f2ee946a8cce015fdff6d6ed0c3cd65080eb5b493e309c8813a423b9e9b8'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '580afe3827eac29587d793ec3ccce9ed64617c093701d0fa5220005b0a58f53f'
### key: '580afe3827eac29587d793ec3ccce9ed64617c093701d0fa5220005b0a58f53f'
### iv: '1cdda4ec5c121e5bc277363a'
### iv: '1cdda4ec5c121e5bc277363a'
### aad: '01f80b0dd9882fbe52f395cf1b4e73cddf8bef475046eff76badace53d4aa7ce'
### aad: '01f80b0dd9882fbe52f395cf1b4e73cddf8bef475046eff76badace53d4aa7ce'
### cipherinfo: '834a3136313637373137373850c5491f27b67dabd44e3d39293c2c60d6582f493894863f766387f2077021c1133ace52f2ee946a8cce015fdff6d6ed0c3cd65080eb5b493e309c8813a423b9e9b8'
### cipherinfo: '834a3136313637373137373850c5491f27b67dabd44e3d39293c2c60d6582f493894863f766387f2077021c1133ace52f2ee946a8cce015fdff6d6ed0c3cd65080eb5b493e309c8813a423b9e9b8'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '2deb95da6b252f6cf54f363a'
### iv_xor: '2deb95da6b252f6cf54f363a'
### authtag: 'c5491f27b67dabd44e3d39293c2c60d6'
### authtag: 'c5491f27b67dabd44e3d39293c2c60d6'
### ciphertext: '493894863f766387f2077021c1133ace52f2ee946a8cce015fdff6d6ed0c3cd65080eb5b493e309c8813a423b9e9b8'
### ciphertext: '493894863f766387f2077021c1133ace52f2ee946a8cce015fdff6d6ed0c3cd65080eb5b493e309c8813a423b9e9b8'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'K',
###                               'test_psk',
###                               0

### -----------end test --------: 'K',
###                               'test_psk',
###                               0

### -----------start test --------: 'K',
###                                 'test_psk',
###                                 1

### -----------start test --------: 'K',
###                                 'test_psk',
###                                 1

### init a_hs

### init a_hs
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 1,
    message_pattens => [["e", "es", "ss", "psk"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","0f21ef89bfedddde2821d66eb9fb938bd632a5cb61bed6d42b3b5d00544d0932"),
      h  => pack("H*","1d96ac3f0b5f6ff001856e2b403205726c7d160ba33ac76ba1adc13ae7ab64a6"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 1,
    message_pattens => [["e", "es", "ss", "psk"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","0f21ef89bfedddde2821d66eb9fb938bd632a5cb61bed6d42b3b5d00544d0932"),
      h  => pack("H*","1d96ac3f0b5f6ff001856e2b403205726c7d160ba33ac76ba1adc13ae7ab64a6"),
    },
    who => "a",
  },
)

### a send msg to b

### a send msg to b

### $a_msg_src: 'init.syn'

### $a_msg_src: 'init.syn'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '0361a8c1a2159076fac5b9c32666955164d5f7922854bd1193dffc381030d494dc'

### public compressed: '0361a8c1a2159076fac5b9c32666955164d5f7922854bd1193dffc381030d494dc'

### write message pattern: 'es'

### write message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPijMuicx5ajC0jynY63ejUzVBpKQuVWIfb3GRKopr/QoAoGCCqGSM49
',
###             'AwEHoUQDQgAEYajBohWQdvrFucMmZpVRZNX3kihUvRGT3/w4EDDUlNwp0Bh1WQfm
',
###             'xHUQFBe85AQsolTF8/p9DMuekpVI3R0VMw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPijMuicx5ajC0jynY63ejUzVBpKQuVWIfb3GRKopr/QoAoGCCqGSM49
',
###             'AwEHoUQDQgAEYajBohWQdvrFucMmZpVRZNX3kihUvRGT3/w4EDDUlNwp0Bh1WQfm
',
###             'xHUQFBe85AQsolTF8/p9DMuekpVI3R0VMw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '6809c16b28d3c24979cb7fce50172b660a178f7c2a0b86e556ed710ed0046364'
### z: '6809c16b28d3c24979cb7fce50172b660a178f7c2a0b86e556ed710ed0046364'

### write message pattern: 'ss'

### write message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### write message pattern: 'psk'

### write message pattern: 'psk'


### noise encrypt
### noise encrypt
### key: 'a07a68660351dcbda45c5d23340e116428ac12ea4f85428a697582ff864d4fe3'
### key: 'a07a68660351dcbda45c5d23340e116428ac12ea4f85428a697582ff864d4fe3'
### iv: 'b6451f1bc35d0fdea7fa3df3'
### iv: 'b6451f1bc35d0fdea7fa3df3'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '87732e2df46a3ee990c23df3'
### iv_xor: '87732e2df46a3ee990c23df3'
### aad: '2e782347cfd1b21eb7c81c17d8d109b722d4224bb331925930869867bea4d5d1'
### aad: '2e782347cfd1b21eb7c81c17d8d109b722d4224bb331925930869867bea4d5d1'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '96328f58872caca4'
### ciphertext: '96328f58872caca4'
### authtag: '1cec7145c6861a7c8236b806c998a337'
### authtag: '1cec7145c6861a7c8236b806c998a337'
### cipherinfo: '834a31363136373731373738501cec7145c6861a7c8236b806c998a3374896328f58872caca4'
### cipherinfo: '834a31363136373731373738501cec7145c6861a7c8236b806c998a3374896328f58872caca4'


### a_msg: '8258210361a8c1a2159076fac5b9c32666955164d5f7922854bd1193dffc381030d494dc5826834a31363136373731373738501cec7145c6861a7c8236b806c998a3374896328f58872caca4'
### a_msg: '8258210361a8c1a2159076fac5b9c32666955164d5f7922854bd1193dffc381030d494dc5826834a31363136373731373738501cec7145c6861a7c8236b806c998a3374896328f58872caca4'
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0361a8c1a2159076fac5b9c32666955164d5f7922854bd1193dffc381030d494dc"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "K",
    initiator => 1,
    message_pattens => [["e", "es", "ss", "psk"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","53bcc037accfe666d236c33091ad7c28371808b3708d8b93f996e28a09190fd4"),
      h => pack("H*","d1aee9a7727133f5097107751daab956f4b12d9ef2ade8fefb1703b8405aac69"),
      hasK => 1,
      k => pack("H*","3a0cb47ce8291b38201f558c40ebdc9c349c2690c5e5ca51d6a2326a0e911276"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","ea453dfbebdde89d60ccf2cdf460edf51b0c643aac24e050e701aaa0507ac66e"),
  },
  {
    hasK => 1,
    k => pack("H*","bb82dc33cd767255ee09557e62be6b35d7d4afd3633e6e2a1f3ecc3c7997bbcb"),
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0361a8c1a2159076fac5b9c32666955164d5f7922854bd1193dffc381030d494dc"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "K",
    initiator => 1,
    message_pattens => [["e", "es", "ss", "psk"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","53bcc037accfe666d236c33091ad7c28371808b3708d8b93f996e28a09190fd4"),
      h => pack("H*","d1aee9a7727133f5097107751daab956f4b12d9ef2ade8fefb1703b8405aac69"),
      hasK => 1,
      k => pack("H*","3a0cb47ce8291b38201f558c40ebdc9c349c2690c5e5ca51d6a2326a0e911276"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","ea453dfbebdde89d60ccf2cdf460edf51b0c643aac24e050e701aaa0507ac66e"),
  },
  {
    hasK => 1,
    k => pack("H*","bb82dc33cd767255ee09557e62be6b35d7d4afd3633e6e2a1f3ecc3c7997bbcb"),
  },
)


### init b_hs
### init b_hs
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 0,
    message_pattens => [["e", "es", "ss", "psk"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","0f21ef89bfedddde2821d66eb9fb938bd632a5cb61bed6d42b3b5d00544d0932"),
      h  => pack("H*","1d96ac3f0b5f6ff001856e2b403205726c7d160ba33ac76ba1adc13ae7ab64a6"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 0,
    message_pattens => [["e", "es", "ss", "psk"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","0f21ef89bfedddde2821d66eb9fb938bd632a5cb61bed6d42b3b5d00544d0932"),
      h  => pack("H*","1d96ac3f0b5f6ff001856e2b403205726c7d160ba33ac76ba1adc13ae7ab64a6"),
    },
    who => "b",
  },
)


### b recv msg from a
### b recv msg from a


### read message pattern: 'e'
### read message pattern: 'e'


### read message pattern: 'es'
### read message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEYajBohWQdvrFucMmZpVRZNX3kihU
',
###           'vRGT3/w4EDDUlNwp0Bh1WQfmxHUQFBe85AQsolTF8/p9DMuekpVI3R0VMw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEYajBohWQdvrFucMmZpVRZNX3kihU
',
###           'vRGT3/w4EDDUlNwp0Bh1WQfmxHUQFBe85AQsolTF8/p9DMuekpVI3R0VMw==
',
###           '-----END PUBLIC KEY-----
'
### z: '6809c16b28d3c24979cb7fce50172b660a178f7c2a0b86e556ed710ed0046364'
### z: '6809c16b28d3c24979cb7fce50172b660a178f7c2a0b86e556ed710ed0046364'

### read message pattern: 'ss'

### read message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### read message pattern: 'psk'
### read message pattern: 'psk'


### noise decrypt
### noise decrypt
### key: 'a07a68660351dcbda45c5d23340e116428ac12ea4f85428a697582ff864d4fe3'
### key: 'a07a68660351dcbda45c5d23340e116428ac12ea4f85428a697582ff864d4fe3'
### iv: 'b6451f1bc35d0fdea7fa3df3'
### iv: 'b6451f1bc35d0fdea7fa3df3'
### aad: '2e782347cfd1b21eb7c81c17d8d109b722d4224bb331925930869867bea4d5d1'
### aad: '2e782347cfd1b21eb7c81c17d8d109b722d4224bb331925930869867bea4d5d1'
### cipherinfo: '834a31363136373731373738501cec7145c6861a7c8236b806c998a3374896328f58872caca4'
### cipherinfo: '834a31363136373731373738501cec7145c6861a7c8236b806c998a3374896328f58872caca4'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '87732e2df46a3ee990c23df3'
### iv_xor: '87732e2df46a3ee990c23df3'
### authtag: '1cec7145c6861a7c8236b806c998a337'
### authtag: '1cec7145c6861a7c8236b806c998a337'
### ciphertext: '96328f58872caca4'
### ciphertext: '96328f58872caca4'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'


### b_recv_a_msg: 'init.syn'
### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 0,
    message_pattens => [["e", "es", "ss", "psk"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","0361a8c1a2159076fac5b9c32666955164d5f7922854bd1193dffc381030d494dc"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","53bcc037accfe666d236c33091ad7c28371808b3708d8b93f996e28a09190fd4"),
      h => pack("H*","d1aee9a7727133f5097107751daab956f4b12d9ef2ade8fefb1703b8405aac69"),
      hasK => 1,
      k => pack("H*","3a0cb47ce8291b38201f558c40ebdc9c349c2690c5e5ca51d6a2326a0e911276"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","ea453dfbebdde89d60ccf2cdf460edf51b0c643aac24e050e701aaa0507ac66e"),
  },
  {
    hasK => 1,
    k => pack("H*","bb82dc33cd767255ee09557e62be6b35d7d4afd3633e6e2a1f3ecc3c7997bbcb"),
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "K",
    initiator => 0,
    message_pattens => [["e", "es", "ss", "psk"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","0361a8c1a2159076fac5b9c32666955164d5f7922854bd1193dffc381030d494dc"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","53bcc037accfe666d236c33091ad7c28371808b3708d8b93f996e28a09190fd4"),
      h => pack("H*","d1aee9a7727133f5097107751daab956f4b12d9ef2ade8fefb1703b8405aac69"),
      hasK => 1,
      k => pack("H*","3a0cb47ce8291b38201f558c40ebdc9c349c2690c5e5ca51d6a2326a0e911276"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","ea453dfbebdde89d60ccf2cdf460edf51b0c643aac24e050e701aaa0507ac66e"),
  },
  {
    hasK => 1,
    k => pack("H*","bb82dc33cd767255ee09557e62be6b35d7d4afd3633e6e2a1f3ecc3c7997bbcb"),
  },
)


### a send comm msg to b
### a send comm msg to b


### noise encrypt
### noise encrypt
### key: '9cde9ae75fddb0652524058f73c6c11138df620e715d89f724060ad121a26f77'
### key: '9cde9ae75fddb0652524058f73c6c11138df620e715d89f724060ad121a26f77'
### iv: '42fa27de46c7dff8ae5a0dd7'
### iv: '42fa27de46c7dff8ae5a0dd7'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '73cc16e871f0eecf99620dd7'
### iv_xor: '73cc16e871f0eecf99620dd7'
### aad: 'd1aee9a7727133f5097107751daab956f4b12d9ef2ade8fefb1703b8405aac69'
### aad: 'd1aee9a7727133f5097107751daab956f4b12d9ef2ade8fefb1703b8405aac69'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '0f96ec146210fb7d68663569d06b0821fc7467b03b6bf82ae97836bdff53875087fe416769ffff9c2b3c1da381ead7043d4712'
### ciphertext: '0f96ec146210fb7d68663569d06b0821fc7467b03b6bf82ae97836bdff53875087fe416769ffff9c2b3c1da381ead7043d4712'
### authtag: 'f332a23098bccea0bfcccbe8ad5f2a14'
### authtag: 'f332a23098bccea0bfcccbe8ad5f2a14'
### cipherinfo: '834a3136313637373137373850f332a23098bccea0bfcccbe8ad5f2a1458330f96ec146210fb7d68663569d06b0821fc7467b03b6bf82ae97836bdff53875087fe416769ffff9c2b3c1da381ead7043d4712'
### cipherinfo: '834a3136313637373137373850f332a23098bccea0bfcccbe8ad5f2a1458330f96ec146210fb7d68663569d06b0821fc7467b03b6bf82ae97836bdff53875087fe416769ffff9c2b3c1da381ead7043d4712'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '9cde9ae75fddb0652524058f73c6c11138df620e715d89f724060ad121a26f77'
### key: '9cde9ae75fddb0652524058f73c6c11138df620e715d89f724060ad121a26f77'
### iv: '42fa27de46c7dff8ae5a0dd7'
### iv: '42fa27de46c7dff8ae5a0dd7'
### aad: 'd1aee9a7727133f5097107751daab956f4b12d9ef2ade8fefb1703b8405aac69'
### aad: 'd1aee9a7727133f5097107751daab956f4b12d9ef2ade8fefb1703b8405aac69'
### cipherinfo: '834a3136313637373137373850f332a23098bccea0bfcccbe8ad5f2a1458330f96ec146210fb7d68663569d06b0821fc7467b03b6bf82ae97836bdff53875087fe416769ffff9c2b3c1da381ead7043d4712'
### cipherinfo: '834a3136313637373137373850f332a23098bccea0bfcccbe8ad5f2a1458330f96ec146210fb7d68663569d06b0821fc7467b03b6bf82ae97836bdff53875087fe416769ffff9c2b3c1da381ead7043d4712'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '73cc16e871f0eecf99620dd7'
### iv_xor: '73cc16e871f0eecf99620dd7'
### authtag: 'f332a23098bccea0bfcccbe8ad5f2a14'
### authtag: 'f332a23098bccea0bfcccbe8ad5f2a14'
### ciphertext: '0f96ec146210fb7d68663569d06b0821fc7467b03b6bf82ae97836bdff53875087fe416769ffff9c2b3c1da381ead7043d4712'
### ciphertext: '0f96ec146210fb7d68663569d06b0821fc7467b03b6bf82ae97836bdff53875087fe416769ffff9c2b3c1da381ead7043d4712'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b send comm msg to a

### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '0f005105af34cf6d6b4bfac8d37eb05c0a4802fe3c91fceed420acbbb2c6ec30'
### key: '0f005105af34cf6d6b4bfac8d37eb05c0a4802fe3c91fceed420acbbb2c6ec30'
### iv: 'f54832e7484132b4cce175d1'
### iv: 'f54832e7484132b4cce175d1'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'c47e03d17f760383fbd975d1'
### iv_xor: 'c47e03d17f760383fbd975d1'
### aad: 'd1aee9a7727133f5097107751daab956f4b12d9ef2ade8fefb1703b8405aac69'
### aad: 'd1aee9a7727133f5097107751daab956f4b12d9ef2ade8fefb1703b8405aac69'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '4ff6769e061fac848b5c3309a3273ed8129c66070a41494b0f7ce8994a961b1a16fa0626ed4fdc833bddbbfc823ad3'
### ciphertext: '4ff6769e061fac848b5c3309a3273ed8129c66070a41494b0f7ce8994a961b1a16fa0626ed4fdc833bddbbfc823ad3'
### authtag: '334880e573b915c4cd0a6a965075f652'
### authtag: '334880e573b915c4cd0a6a965075f652'
### cipherinfo: '834a3136313637373137373850334880e573b915c4cd0a6a965075f652582f4ff6769e061fac848b5c3309a3273ed8129c66070a41494b0f7ce8994a961b1a16fa0626ed4fdc833bddbbfc823ad3'
### cipherinfo: '834a3136313637373137373850334880e573b915c4cd0a6a965075f652582f4ff6769e061fac848b5c3309a3273ed8129c66070a41494b0f7ce8994a961b1a16fa0626ed4fdc833bddbbfc823ad3'


### a recv comm msg from b
### a recv comm msg from b


### noise decrypt
### noise decrypt
### key: '0f005105af34cf6d6b4bfac8d37eb05c0a4802fe3c91fceed420acbbb2c6ec30'
### key: '0f005105af34cf6d6b4bfac8d37eb05c0a4802fe3c91fceed420acbbb2c6ec30'
### iv: 'f54832e7484132b4cce175d1'
### iv: 'f54832e7484132b4cce175d1'
### aad: 'd1aee9a7727133f5097107751daab956f4b12d9ef2ade8fefb1703b8405aac69'
### aad: 'd1aee9a7727133f5097107751daab956f4b12d9ef2ade8fefb1703b8405aac69'
### cipherinfo: '834a3136313637373137373850334880e573b915c4cd0a6a965075f652582f4ff6769e061fac848b5c3309a3273ed8129c66070a41494b0f7ce8994a961b1a16fa0626ed4fdc833bddbbfc823ad3'
### cipherinfo: '834a3136313637373137373850334880e573b915c4cd0a6a965075f652582f4ff6769e061fac848b5c3309a3273ed8129c66070a41494b0f7ce8994a961b1a16fa0626ed4fdc833bddbbfc823ad3'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'c47e03d17f760383fbd975d1'
### iv_xor: 'c47e03d17f760383fbd975d1'
### authtag: '334880e573b915c4cd0a6a965075f652'
### authtag: '334880e573b915c4cd0a6a965075f652'
### ciphertext: '4ff6769e061fac848b5c3309a3273ed8129c66070a41494b0f7ce8994a961b1a16fa0626ed4fdc833bddbbfc823ad3'
### ciphertext: '4ff6769e061fac848b5c3309a3273ed8129c66070a41494b0f7ce8994a961b1a16fa0626ed4fdc833bddbbfc823ad3'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'K',
###                               'test_psk',
###                               1
### -----------end test --------: 'K',
###                               'test_psk',
###                               1


### -----------start test --------: 'X',
###                                 undef,
###                                 undef
### -----------start test --------: 'X',
###                                 undef,
###                                 undef

### init a_hs

### init a_hs
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 1,
    message_pattens => [["e", "es", "s", "ss"]],
    msg_id => 0,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => "Noise_X_secp256r1_AESGCM_SHA256\0",
      h  => pack("H*","97ed976cc796d80c34e2732a71ac1a71316639102a060ac9a2763296d579a19e"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 1,
    message_pattens => [["e", "es", "s", "ss"]],
    msg_id => 0,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => "Noise_X_secp256r1_AESGCM_SHA256\0",
      h  => pack("H*","97ed976cc796d80c34e2732a71ac1a71316639102a060ac9a2763296d579a19e"),
    },
    who => "a",
  },
)

### a send msg to b

### a send msg to b

### $a_msg_src: 'init.syn'

### $a_msg_src: 'init.syn'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '02d16d532dd9abb2f28a73a4142f49f6ab5b6285ff169e63806569176ad772a370'

### public compressed: '02d16d532dd9abb2f28a73a4142f49f6ab5b6285ff169e63806569176ad772a370'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOP/Z5hFHky4xCSDIvy5rXuWbEUlTCmFiA5DTCR97RUQoAoGCCqGSM49
',
###             'AwEHoUQDQgAE0W1TLdmrsvKKc6QUL0n2q1tihf8WnmOAZWkXatdyo3AfvuvOuYSu
',
###             '7yoB3H+gRVUXahnuTu3jcjG5IfuI/8IYyg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOP/Z5hFHky4xCSDIvy5rXuWbEUlTCmFiA5DTCR97RUQoAoGCCqGSM49
',
###             'AwEHoUQDQgAE0W1TLdmrsvKKc6QUL0n2q1tihf8WnmOAZWkXatdyo3AfvuvOuYSu
',
###             '7yoB3H+gRVUXahnuTu3jcjG5IfuI/8IYyg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '7ff33ce718143fe66f3b10ecc19e4331f62a0f418496057749a86df42e534159'
### z: '7ff33ce718143fe66f3b10ecc19e4331f62a0f418496057749a86df42e534159'


### write message pattern: 's'
### write message pattern: 's'


### noise encrypt
### noise encrypt
### key: '19bff6e5a40ae125bd9138b1a1b2c5e68b2c3f1e286b19d5abb1fde7c4e52171'
### key: '19bff6e5a40ae125bd9138b1a1b2c5e68b2c3f1e286b19d5abb1fde7c4e52171'
### iv: '2e169b5bae78b0d64f5bf028'
### iv: '2e169b5bae78b0d64f5bf028'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '1f20aa6d994f81e17863f028'
### iv_xor: '1f20aa6d994f81e17863f028'
### aad: 'b1714525a93135d0887311f3e33d6db352987b36b5ca155ae6591f2c90434e69'
### aad: 'b1714525a93135d0887311f3e33d6db352987b36b5ca155ae6591f2c90434e69'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: '9da872c54dd9f7fab1fd1d3b1efa961ff3b1d8d2b7f06535fe912ba40ce6a62b1b8745e61c6a01ed'
### ciphertext: '9da872c54dd9f7fab1fd1d3b1efa961ff3b1d8d2b7f06535fe912ba40ce6a62b1b8745e61c6a01ed'
### authtag: '4b3d706d122388d816ee8fca79fb4b0d'
### authtag: '4b3d706d122388d816ee8fca79fb4b0d'
### cipherinfo: '834a31363136373731373738504b3d706d122388d816ee8fca79fb4b0d58289da872c54dd9f7fab1fd1d3b1efa961ff3b1d8d2b7f06535fe912ba40ce6a62b1b8745e61c6a01ed'
### cipherinfo: '834a31363136373731373738504b3d706d122388d816ee8fca79fb4b0d58289da872c54dd9f7fab1fd1d3b1efa961ff3b1d8d2b7f06535fe912ba40ce6a62b1b8745e61c6a01ed'


### write message pattern: 'ss'
### write message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### noise encrypt
### noise encrypt
### key: '2bf9a8a477d05d8a393ca7dff92ae24d331356779496d2769184a7fd52dcd9ab'
### key: '2bf9a8a477d05d8a393ca7dff92ae24d331356779496d2769184a7fd52dcd9ab'
### iv: '5f96cf5832f573efd3a129d5'
### iv: '5f96cf5832f573efd3a129d5'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '6ea0fe6e05c242d8e49929d5'
### iv_xor: '6ea0fe6e05c242d8e49929d5'
### aad: '5c7dec52f3018b41927a9f98919ad859803af6469b3db00a155418830d0596e2'
### aad: '5c7dec52f3018b41927a9f98919ad859803af6469b3db00a155418830d0596e2'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: 'c54a83c014bf6d07'
### ciphertext: 'c54a83c014bf6d07'
### authtag: 'c9c64febe1986fda0374c61490759747'
### authtag: 'c9c64febe1986fda0374c61490759747'
### cipherinfo: '834a3136313637373137373850c9c64febe1986fda0374c6149075974748c54a83c014bf6d07'
### cipherinfo: '834a3136313637373137373850c9c64febe1986fda0374c6149075974748c54a83c014bf6d07'


### a_msg: '83582102d16d532dd9abb2f28a73a4142f49f6ab5b6285ff169e63806569176ad772a3705847834a31363136373731373738504b3d706d122388d816ee8fca79fb4b0d58289da872c54dd9f7fab1fd1d3b1efa961ff3b1d8d2b7f06535fe912ba40ce6a62b1b8745e61c6a01ed5826834a3136313637373137373850c9c64febe1986fda0374c6149075974748c54a83c014bf6d07'
### a_msg: '83582102d16d532dd9abb2f28a73a4142f49f6ab5b6285ff169e63806569176ad772a3705847834a31363136373731373738504b3d706d122388d816ee8fca79fb4b0d58289da872c54dd9f7fab1fd1d3b1efa961ff3b1d8d2b7f06535fe912ba40ce6a62b1b8745e61c6a01ed5826834a3136313637373137373850c9c64febe1986fda0374c6149075974748c54a83c014bf6d07'
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02d16d532dd9abb2f28a73a4142f49f6ab5b6285ff169e63806569176ad772a370"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "X",
    initiator => 1,
    message_pattens => [["e", "es", "s", "ss"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","49b8ed34d5ce241c42adc7e26fbf9e0882d70ad60cb5917e301fff64a907a18c"),
      h => pack("H*","b15ed29172531415967bd8f594937804b0dbb737518bc65363667ca04d456c54"),
      hasK => 1,
      k => pack("H*","263706e570e5034ccd6a9373f7d912586cb418b3be5e59aaa97cf4b23d6ee1ba"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","ac4ccb3f89932169fa6adeb073f5f16058bdf6a3486c02c391161337f075d614"),
  },
  {
    hasK => 1,
    k => pack("H*","ca77506d42ec954b90517150f7c9cd8cebf8d68385ee56a9409d16cd0d700e2b"),
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02d16d532dd9abb2f28a73a4142f49f6ab5b6285ff169e63806569176ad772a370"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "X",
    initiator => 1,
    message_pattens => [["e", "es", "s", "ss"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","49b8ed34d5ce241c42adc7e26fbf9e0882d70ad60cb5917e301fff64a907a18c"),
      h => pack("H*","b15ed29172531415967bd8f594937804b0dbb737518bc65363667ca04d456c54"),
      hasK => 1,
      k => pack("H*","263706e570e5034ccd6a9373f7d912586cb418b3be5e59aaa97cf4b23d6ee1ba"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","ac4ccb3f89932169fa6adeb073f5f16058bdf6a3486c02c391161337f075d614"),
  },
  {
    hasK => 1,
    k => pack("H*","ca77506d42ec954b90517150f7c9cd8cebf8d68385ee56a9409d16cd0d700e2b"),
  },
)


### init b_hs
### init b_hs
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 0,
    message_pattens => [["e", "es", "s", "ss"]],
    msg_id => 0,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => "Noise_X_secp256r1_AESGCM_SHA256\0",
      h  => pack("H*","97ed976cc796d80c34e2732a71ac1a71316639102a060ac9a2763296d579a19e"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 0,
    message_pattens => [["e", "es", "s", "ss"]],
    msg_id => 0,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => "Noise_X_secp256r1_AESGCM_SHA256\0",
      h  => pack("H*","97ed976cc796d80c34e2732a71ac1a71316639102a060ac9a2763296d579a19e"),
    },
    who => "b",
  },
)


### b recv msg from a
### b recv msg from a


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE0W1TLdmrsvKKc6QUL0n2q1tihf8W
',
###           'nmOAZWkXatdyo3AfvuvOuYSu7yoB3H+gRVUXahnuTu3jcjG5IfuI/8IYyg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE0W1TLdmrsvKKc6QUL0n2q1tihf8W
',
###           'nmOAZWkXatdyo3AfvuvOuYSu7yoB3H+gRVUXahnuTu3jcjG5IfuI/8IYyg==
',
###           '-----END PUBLIC KEY-----
'
### z: '7ff33ce718143fe66f3b10ecc19e4331f62a0f418496057749a86df42e534159'
### z: '7ff33ce718143fe66f3b10ecc19e4331f62a0f418496057749a86df42e534159'

### read message pattern: 's'

### read message pattern: 's'


### noise decrypt
### noise decrypt
### key: '19bff6e5a40ae125bd9138b1a1b2c5e68b2c3f1e286b19d5abb1fde7c4e52171'
### key: '19bff6e5a40ae125bd9138b1a1b2c5e68b2c3f1e286b19d5abb1fde7c4e52171'
### iv: '2e169b5bae78b0d64f5bf028'
### iv: '2e169b5bae78b0d64f5bf028'
### aad: 'b1714525a93135d0887311f3e33d6db352987b36b5ca155ae6591f2c90434e69'
### aad: 'b1714525a93135d0887311f3e33d6db352987b36b5ca155ae6591f2c90434e69'
### cipherinfo: '834a31363136373731373738504b3d706d122388d816ee8fca79fb4b0d58289da872c54dd9f7fab1fd1d3b1efa961ff3b1d8d2b7f06535fe912ba40ce6a62b1b8745e61c6a01ed'
### cipherinfo: '834a31363136373731373738504b3d706d122388d816ee8fca79fb4b0d58289da872c54dd9f7fab1fd1d3b1efa961ff3b1d8d2b7f06535fe912ba40ce6a62b1b8745e61c6a01ed'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '1f20aa6d994f81e17863f028'
### iv_xor: '1f20aa6d994f81e17863f028'
### authtag: '4b3d706d122388d816ee8fca79fb4b0d'
### authtag: '4b3d706d122388d816ee8fca79fb4b0d'
### ciphertext: '9da872c54dd9f7fab1fd1d3b1efa961ff3b1d8d2b7f06535fe912ba40ce6a62b1b8745e61c6a01ed'
### ciphertext: '9da872c54dd9f7fab1fd1d3b1efa961ff3b1d8d2b7f06535fe912ba40ce6a62b1b8745e61c6a01ed'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'


### read message pattern: 'ss'
### read message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### noise decrypt

### noise decrypt
### key: '2bf9a8a477d05d8a393ca7dff92ae24d331356779496d2769184a7fd52dcd9ab'
### key: '2bf9a8a477d05d8a393ca7dff92ae24d331356779496d2769184a7fd52dcd9ab'
### iv: '5f96cf5832f573efd3a129d5'
### iv: '5f96cf5832f573efd3a129d5'
### aad: '5c7dec52f3018b41927a9f98919ad859803af6469b3db00a155418830d0596e2'
### aad: '5c7dec52f3018b41927a9f98919ad859803af6469b3db00a155418830d0596e2'
### cipherinfo: '834a3136313637373137373850c9c64febe1986fda0374c6149075974748c54a83c014bf6d07'
### cipherinfo: '834a3136313637373137373850c9c64febe1986fda0374c6149075974748c54a83c014bf6d07'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '6ea0fe6e05c242d8e49929d5'
### iv_xor: '6ea0fe6e05c242d8e49929d5'
### authtag: 'c9c64febe1986fda0374c61490759747'
### authtag: 'c9c64febe1986fda0374c61490759747'
### ciphertext: 'c54a83c014bf6d07'
### ciphertext: 'c54a83c014bf6d07'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'


### b_recv_a_msg: 'init.syn'
### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 0,
    message_pattens => [["e", "es", "s", "ss"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","02d16d532dd9abb2f28a73a4142f49f6ab5b6285ff169e63806569176ad772a370"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","49b8ed34d5ce241c42adc7e26fbf9e0882d70ad60cb5917e301fff64a907a18c"),
      h => pack("H*","b15ed29172531415967bd8f594937804b0dbb737518bc65363667ca04d456c54"),
      hasK => 1,
      k => pack("H*","263706e570e5034ccd6a9373f7d912586cb418b3be5e59aaa97cf4b23d6ee1ba"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","ac4ccb3f89932169fa6adeb073f5f16058bdf6a3486c02c391161337f075d614"),
  },
  {
    hasK => 1,
    k => pack("H*","ca77506d42ec954b90517150f7c9cd8cebf8d68385ee56a9409d16cd0d700e2b"),
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 0,
    message_pattens => [["e", "es", "s", "ss"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","02d16d532dd9abb2f28a73a4142f49f6ab5b6285ff169e63806569176ad772a370"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","49b8ed34d5ce241c42adc7e26fbf9e0882d70ad60cb5917e301fff64a907a18c"),
      h => pack("H*","b15ed29172531415967bd8f594937804b0dbb737518bc65363667ca04d456c54"),
      hasK => 1,
      k => pack("H*","263706e570e5034ccd6a9373f7d912586cb418b3be5e59aaa97cf4b23d6ee1ba"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","ac4ccb3f89932169fa6adeb073f5f16058bdf6a3486c02c391161337f075d614"),
  },
  {
    hasK => 1,
    k => pack("H*","ca77506d42ec954b90517150f7c9cd8cebf8d68385ee56a9409d16cd0d700e2b"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '55a21d8f6263ea24c27e917711f1497da3e002e17af7fafb5ded66e79d0ec1e7'
### key: '55a21d8f6263ea24c27e917711f1497da3e002e17af7fafb5ded66e79d0ec1e7'
### iv: '98dff124d83f60862eb58674'
### iv: '98dff124d83f60862eb58674'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'a9e9c012ef0851b1198d8674'
### iv_xor: 'a9e9c012ef0851b1198d8674'
### aad: 'b15ed29172531415967bd8f594937804b0dbb737518bc65363667ca04d456c54'
### aad: 'b15ed29172531415967bd8f594937804b0dbb737518bc65363667ca04d456c54'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'f716894c08f73d065399f6d5569e544fca7b870a7a230252e42a96ad42eb9c5af11c31b5528aa7d448480d24467c10d7ad235a'
### ciphertext: 'f716894c08f73d065399f6d5569e544fca7b870a7a230252e42a96ad42eb9c5af11c31b5528aa7d448480d24467c10d7ad235a'
### authtag: '28d1a40c0f55cb09de686117f69e84ea'
### authtag: '28d1a40c0f55cb09de686117f69e84ea'
### cipherinfo: '834a313631363737313737385028d1a40c0f55cb09de686117f69e84ea5833f716894c08f73d065399f6d5569e544fca7b870a7a230252e42a96ad42eb9c5af11c31b5528aa7d448480d24467c10d7ad235a'
### cipherinfo: '834a313631363737313737385028d1a40c0f55cb09de686117f69e84ea5833f716894c08f73d065399f6d5569e544fca7b870a7a230252e42a96ad42eb9c5af11c31b5528aa7d448480d24467c10d7ad235a'


### b recv comm msg from a
### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: '55a21d8f6263ea24c27e917711f1497da3e002e17af7fafb5ded66e79d0ec1e7'
### key: '55a21d8f6263ea24c27e917711f1497da3e002e17af7fafb5ded66e79d0ec1e7'
### iv: '98dff124d83f60862eb58674'
### iv: '98dff124d83f60862eb58674'
### aad: 'b15ed29172531415967bd8f594937804b0dbb737518bc65363667ca04d456c54'
### aad: 'b15ed29172531415967bd8f594937804b0dbb737518bc65363667ca04d456c54'
### cipherinfo: '834a313631363737313737385028d1a40c0f55cb09de686117f69e84ea5833f716894c08f73d065399f6d5569e544fca7b870a7a230252e42a96ad42eb9c5af11c31b5528aa7d448480d24467c10d7ad235a'
### cipherinfo: '834a313631363737313737385028d1a40c0f55cb09de686117f69e84ea5833f716894c08f73d065399f6d5569e544fca7b870a7a230252e42a96ad42eb9c5af11c31b5528aa7d448480d24467c10d7ad235a'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'a9e9c012ef0851b1198d8674'
### iv_xor: 'a9e9c012ef0851b1198d8674'
### authtag: '28d1a40c0f55cb09de686117f69e84ea'
### authtag: '28d1a40c0f55cb09de686117f69e84ea'
### ciphertext: 'f716894c08f73d065399f6d5569e544fca7b870a7a230252e42a96ad42eb9c5af11c31b5528aa7d448480d24467c10d7ad235a'
### ciphertext: 'f716894c08f73d065399f6d5569e544fca7b870a7a230252e42a96ad42eb9c5af11c31b5528aa7d448480d24467c10d7ad235a'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'


### b send comm msg to a
### b send comm msg to a


### noise encrypt
### noise encrypt
### key: '954ba0eac0fe81ad2fe587220d14fb1dd71349b75a7e8bfda42cefff350cbb3c'
### key: '954ba0eac0fe81ad2fe587220d14fb1dd71349b75a7e8bfda42cefff350cbb3c'
### iv: '199ddabe5c5058d3a156df48'
### iv: '199ddabe5c5058d3a156df48'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '28abeb886b6769e4966edf48'
### iv_xor: '28abeb886b6769e4966edf48'
### aad: 'b15ed29172531415967bd8f594937804b0dbb737518bc65363667ca04d456c54'
### aad: 'b15ed29172531415967bd8f594937804b0dbb737518bc65363667ca04d456c54'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '017f4224b2c5cdd2216556f49ae92e3650026a7376e26d2852e3f55ce270159050399050d454d317a5d507651b4fb3'
### ciphertext: '017f4224b2c5cdd2216556f49ae92e3650026a7376e26d2852e3f55ce270159050399050d454d317a5d507651b4fb3'
### authtag: '031cf12aeeb31f1d82301fe43bb1c366'
### authtag: '031cf12aeeb31f1d82301fe43bb1c366'
### cipherinfo: '834a3136313637373137373850031cf12aeeb31f1d82301fe43bb1c366582f017f4224b2c5cdd2216556f49ae92e3650026a7376e26d2852e3f55ce270159050399050d454d317a5d507651b4fb3'
### cipherinfo: '834a3136313637373137373850031cf12aeeb31f1d82301fe43bb1c366582f017f4224b2c5cdd2216556f49ae92e3650026a7376e26d2852e3f55ce270159050399050d454d317a5d507651b4fb3'

### a recv comm msg from b

### a recv comm msg from b


### noise decrypt
### noise decrypt
### key: '954ba0eac0fe81ad2fe587220d14fb1dd71349b75a7e8bfda42cefff350cbb3c'
### key: '954ba0eac0fe81ad2fe587220d14fb1dd71349b75a7e8bfda42cefff350cbb3c'
### iv: '199ddabe5c5058d3a156df48'
### iv: '199ddabe5c5058d3a156df48'
### aad: 'b15ed29172531415967bd8f594937804b0dbb737518bc65363667ca04d456c54'
### aad: 'b15ed29172531415967bd8f594937804b0dbb737518bc65363667ca04d456c54'
### cipherinfo: '834a3136313637373137373850031cf12aeeb31f1d82301fe43bb1c366582f017f4224b2c5cdd2216556f49ae92e3650026a7376e26d2852e3f55ce270159050399050d454d317a5d507651b4fb3'
### cipherinfo: '834a3136313637373137373850031cf12aeeb31f1d82301fe43bb1c366582f017f4224b2c5cdd2216556f49ae92e3650026a7376e26d2852e3f55ce270159050399050d454d317a5d507651b4fb3'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '28abeb886b6769e4966edf48'
### iv_xor: '28abeb886b6769e4966edf48'
### authtag: '031cf12aeeb31f1d82301fe43bb1c366'
### authtag: '031cf12aeeb31f1d82301fe43bb1c366'
### ciphertext: '017f4224b2c5cdd2216556f49ae92e3650026a7376e26d2852e3f55ce270159050399050d454d317a5d507651b4fb3'
### ciphertext: '017f4224b2c5cdd2216556f49ae92e3650026a7376e26d2852e3f55ce270159050399050d454d317a5d507651b4fb3'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'X',
###                               undef,
###                               undef

### -----------end test --------: 'X',
###                               undef,
###                               undef

### -----------start test --------: 'X',
###                                 'test_psk',
###                                 0

### -----------start test --------: 'X',
###                                 'test_psk',
###                                 0

### init a_hs

### init a_hs
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 1,
    message_pattens => [["psk", "e", "es", "s", "ss"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","3a1a0be4945009096ea4863a3ef83645ad877df7c18dab66359e0da265be94c0"),
      h  => pack("H*","74a3508b972aa7fd178316c8ec4e1ba4903a334509c80efe06bec048973661fb"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 1,
    message_pattens => [["psk", "e", "es", "s", "ss"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","3a1a0be4945009096ea4863a3ef83645ad877df7c18dab66359e0da265be94c0"),
      h  => pack("H*","74a3508b972aa7fd178316c8ec4e1ba4903a334509c80efe06bec048973661fb"),
    },
    who => "a",
  },
)

### a send msg to b

### a send msg to b

### $a_msg_src: 'init.syn'

### $a_msg_src: 'init.syn'

### write message pattern: 'psk'

### write message pattern: 'psk'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '02434a8679437248ae9a340f3bb4e281f94fc0c881c70c3374c525f3eaee736b5e'

### public compressed: '02434a8679437248ae9a340f3bb4e281f94fc0c881c70c3374c525f3eaee736b5e'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIHCPQ5nXtr7gSU3hXKud6IxoHZr0JuWmKcj/rUU2YzVqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEQ0qGeUNySK6aNA87tOKB+U/AyIHHDDN0xSXz6u5za16po2ncFJ84
',
###             '/GCLkwrJ/nEqwiXYWgYAj2cVw8IP9IMeQg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIHCPQ5nXtr7gSU3hXKud6IxoHZr0JuWmKcj/rUU2YzVqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEQ0qGeUNySK6aNA87tOKB+U/AyIHHDDN0xSXz6u5za16po2ncFJ84
',
###             '/GCLkwrJ/nEqwiXYWgYAj2cVw8IP9IMeQg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '6cf171284253c8f2e7688d7dda7465f1ce9c3af3ccde5332d4357d25f1a230be'
### z: '6cf171284253c8f2e7688d7dda7465f1ce9c3af3ccde5332d4357d25f1a230be'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '7e7e8741480b3590c00491582997fe25365f2d144202b96edc88a18d7ad79b47'
### key: '7e7e8741480b3590c00491582997fe25365f2d144202b96edc88a18d7ad79b47'
### iv: '7fb80f0b6fad91c0b8b2592a'
### iv: '7fb80f0b6fad91c0b8b2592a'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '4e8e3e3d589aa0f78f8a592a'
### iv_xor: '4e8e3e3d589aa0f78f8a592a'
### aad: 'a44308ee29799b577b18c3dcc6ad2b6496f36f8916326b1ff12dc9a7e7daa586'
### aad: 'a44308ee29799b577b18c3dcc6ad2b6496f36f8916326b1ff12dc9a7e7daa586'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: '882cbd0878ab054752edec2e8a94c1abfb4bd5ac42231411d0a6aeac26e69673077f3363a6f071b9'
### ciphertext: '882cbd0878ab054752edec2e8a94c1abfb4bd5ac42231411d0a6aeac26e69673077f3363a6f071b9'
### authtag: '9b8c0efa40b01fb91be1b6d2284280d8'
### authtag: '9b8c0efa40b01fb91be1b6d2284280d8'
### cipherinfo: '834a31363136373731373738509b8c0efa40b01fb91be1b6d2284280d85828882cbd0878ab054752edec2e8a94c1abfb4bd5ac42231411d0a6aeac26e69673077f3363a6f071b9'
### cipherinfo: '834a31363136373731373738509b8c0efa40b01fb91be1b6d2284280d85828882cbd0878ab054752edec2e8a94c1abfb4bd5ac42231411d0a6aeac26e69673077f3363a6f071b9'


### write message pattern: 'ss'
### write message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### noise encrypt
### noise encrypt
### key: 'f10e3492bc471b6e363507a1f1dbbaace0fac91e4f40a166358033c187be934d'
### key: 'f10e3492bc471b6e363507a1f1dbbaace0fac91e4f40a166358033c187be934d'
### iv: '82f72c6257f12c834195462b'
### iv: '82f72c6257f12c834195462b'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'b3c11d5460c61db476ad462b'
### iv_xor: 'b3c11d5460c61db476ad462b'
### aad: '43e00a557922424a5fccf9c5fb28f483deb1de46166a701e441c07711f7b1108'
### aad: '43e00a557922424a5fccf9c5fb28f483deb1de46166a701e441c07711f7b1108'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '22afd70c46a7a3b3'
### ciphertext: '22afd70c46a7a3b3'
### authtag: 'fe60befc93bdb39a6dd1cbb636d51030'
### authtag: 'fe60befc93bdb39a6dd1cbb636d51030'
### cipherinfo: '834a3136313637373137373850fe60befc93bdb39a6dd1cbb636d510304822afd70c46a7a3b3'
### cipherinfo: '834a3136313637373137373850fe60befc93bdb39a6dd1cbb636d510304822afd70c46a7a3b3'


### a_msg: '83582102434a8679437248ae9a340f3bb4e281f94fc0c881c70c3374c525f3eaee736b5e5847834a31363136373731373738509b8c0efa40b01fb91be1b6d2284280d85828882cbd0878ab054752edec2e8a94c1abfb4bd5ac42231411d0a6aeac26e69673077f3363a6f071b95826834a3136313637373137373850fe60befc93bdb39a6dd1cbb636d510304822afd70c46a7a3b3'
### a_msg: '83582102434a8679437248ae9a340f3bb4e281f94fc0c881c70c3374c525f3eaee736b5e5847834a31363136373731373738509b8c0efa40b01fb91be1b6d2284280d85828882cbd0878ab054752edec2e8a94c1abfb4bd5ac42231411d0a6aeac26e69673077f3363a6f071b95826834a3136313637373137373850fe60befc93bdb39a6dd1cbb636d510304822afd70c46a7a3b3'
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02434a8679437248ae9a340f3bb4e281f94fc0c881c70c3374c525f3eaee736b5e"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "X",
    initiator => 1,
    message_pattens => [["psk", "e", "es", "s", "ss"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","0553f4bf5a404e12f40ddb27329bc61fa30cbb179fb4b787a3932f4429c93cbb"),
      h => pack("H*","ef70828a8485234f1166ca0af73876cd8fe208b50a4430f5c7b3f62666d236a7"),
      hasK => 1,
      k => pack("H*","76f0658d6a6bd928c95d029594d1e29a901f1bc73ea7e109fe8451d941b29b03"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","537c4ad1e4cd4c1cc6d1759370e7c11600a93b664678348364cbbdc0eb2bed92"),
  },
  {
    hasK => 1,
    k => pack("H*","058b78c1a466bf559943151e6c3361c06f2f1ed368a924670d7a3aa9a430bdff"),
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02434a8679437248ae9a340f3bb4e281f94fc0c881c70c3374c525f3eaee736b5e"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "X",
    initiator => 1,
    message_pattens => [["psk", "e", "es", "s", "ss"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","0553f4bf5a404e12f40ddb27329bc61fa30cbb179fb4b787a3932f4429c93cbb"),
      h => pack("H*","ef70828a8485234f1166ca0af73876cd8fe208b50a4430f5c7b3f62666d236a7"),
      hasK => 1,
      k => pack("H*","76f0658d6a6bd928c95d029594d1e29a901f1bc73ea7e109fe8451d941b29b03"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","537c4ad1e4cd4c1cc6d1759370e7c11600a93b664678348364cbbdc0eb2bed92"),
  },
  {
    hasK => 1,
    k => pack("H*","058b78c1a466bf559943151e6c3361c06f2f1ed368a924670d7a3aa9a430bdff"),
  },
)


### init b_hs
### init b_hs
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 0,
    message_pattens => [["psk", "e", "es", "s", "ss"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","3a1a0be4945009096ea4863a3ef83645ad877df7c18dab66359e0da265be94c0"),
      h  => pack("H*","74a3508b972aa7fd178316c8ec4e1ba4903a334509c80efe06bec048973661fb"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 0,
    message_pattens => [["psk", "e", "es", "s", "ss"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","3a1a0be4945009096ea4863a3ef83645ad877df7c18dab66359e0da265be94c0"),
      h  => pack("H*","74a3508b972aa7fd178316c8ec4e1ba4903a334509c80efe06bec048973661fb"),
    },
    who => "b",
  },
)

### b recv msg from a

### b recv msg from a

### read message pattern: 'psk'

### read message pattern: 'psk'


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQ0qGeUNySK6aNA87tOKB+U/AyIHH
',
###           'DDN0xSXz6u5za16po2ncFJ84/GCLkwrJ/nEqwiXYWgYAj2cVw8IP9IMeQg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQ0qGeUNySK6aNA87tOKB+U/AyIHH
',
###           'DDN0xSXz6u5za16po2ncFJ84/GCLkwrJ/nEqwiXYWgYAj2cVw8IP9IMeQg==
',
###           '-----END PUBLIC KEY-----
'
### z: '6cf171284253c8f2e7688d7dda7465f1ce9c3af3ccde5332d4357d25f1a230be'
### z: '6cf171284253c8f2e7688d7dda7465f1ce9c3af3ccde5332d4357d25f1a230be'

### read message pattern: 's'

### read message pattern: 's'


### noise decrypt
### noise decrypt
### key: '7e7e8741480b3590c00491582997fe25365f2d144202b96edc88a18d7ad79b47'
### key: '7e7e8741480b3590c00491582997fe25365f2d144202b96edc88a18d7ad79b47'
### iv: '7fb80f0b6fad91c0b8b2592a'
### iv: '7fb80f0b6fad91c0b8b2592a'
### aad: 'a44308ee29799b577b18c3dcc6ad2b6496f36f8916326b1ff12dc9a7e7daa586'
### aad: 'a44308ee29799b577b18c3dcc6ad2b6496f36f8916326b1ff12dc9a7e7daa586'
### cipherinfo: '834a31363136373731373738509b8c0efa40b01fb91be1b6d2284280d85828882cbd0878ab054752edec2e8a94c1abfb4bd5ac42231411d0a6aeac26e69673077f3363a6f071b9'
### cipherinfo: '834a31363136373731373738509b8c0efa40b01fb91be1b6d2284280d85828882cbd0878ab054752edec2e8a94c1abfb4bd5ac42231411d0a6aeac26e69673077f3363a6f071b9'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '4e8e3e3d589aa0f78f8a592a'
### iv_xor: '4e8e3e3d589aa0f78f8a592a'
### authtag: '9b8c0efa40b01fb91be1b6d2284280d8'
### authtag: '9b8c0efa40b01fb91be1b6d2284280d8'
### ciphertext: '882cbd0878ab054752edec2e8a94c1abfb4bd5ac42231411d0a6aeac26e69673077f3363a6f071b9'
### ciphertext: '882cbd0878ab054752edec2e8a94c1abfb4bd5ac42231411d0a6aeac26e69673077f3363a6f071b9'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'


### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'


### read message pattern: 'ss'
### read message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### noise decrypt
### noise decrypt
### key: 'f10e3492bc471b6e363507a1f1dbbaace0fac91e4f40a166358033c187be934d'
### key: 'f10e3492bc471b6e363507a1f1dbbaace0fac91e4f40a166358033c187be934d'
### iv: '82f72c6257f12c834195462b'
### iv: '82f72c6257f12c834195462b'
### aad: '43e00a557922424a5fccf9c5fb28f483deb1de46166a701e441c07711f7b1108'
### aad: '43e00a557922424a5fccf9c5fb28f483deb1de46166a701e441c07711f7b1108'
### cipherinfo: '834a3136313637373137373850fe60befc93bdb39a6dd1cbb636d510304822afd70c46a7a3b3'
### cipherinfo: '834a3136313637373137373850fe60befc93bdb39a6dd1cbb636d510304822afd70c46a7a3b3'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'b3c11d5460c61db476ad462b'
### iv_xor: 'b3c11d5460c61db476ad462b'
### authtag: 'fe60befc93bdb39a6dd1cbb636d51030'
### authtag: 'fe60befc93bdb39a6dd1cbb636d51030'
### ciphertext: '22afd70c46a7a3b3'
### ciphertext: '22afd70c46a7a3b3'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'


### b_recv_a_msg: 'init.syn'
### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 0,
    message_pattens => [["psk", "e", "es", "s", "ss"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","02434a8679437248ae9a340f3bb4e281f94fc0c881c70c3374c525f3eaee736b5e"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","0553f4bf5a404e12f40ddb27329bc61fa30cbb179fb4b787a3932f4429c93cbb"),
      h => pack("H*","ef70828a8485234f1166ca0af73876cd8fe208b50a4430f5c7b3f62666d236a7"),
      hasK => 1,
      k => pack("H*","76f0658d6a6bd928c95d029594d1e29a901f1bc73ea7e109fe8451d941b29b03"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","537c4ad1e4cd4c1cc6d1759370e7c11600a93b664678348364cbbdc0eb2bed92"),
  },
  {
    hasK => 1,
    k => pack("H*","058b78c1a466bf559943151e6c3361c06f2f1ed368a924670d7a3aa9a430bdff"),
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 0,
    message_pattens => [["psk", "e", "es", "s", "ss"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","02434a8679437248ae9a340f3bb4e281f94fc0c881c70c3374c525f3eaee736b5e"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","0553f4bf5a404e12f40ddb27329bc61fa30cbb179fb4b787a3932f4429c93cbb"),
      h => pack("H*","ef70828a8485234f1166ca0af73876cd8fe208b50a4430f5c7b3f62666d236a7"),
      hasK => 1,
      k => pack("H*","76f0658d6a6bd928c95d029594d1e29a901f1bc73ea7e109fe8451d941b29b03"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","537c4ad1e4cd4c1cc6d1759370e7c11600a93b664678348364cbbdc0eb2bed92"),
  },
  {
    hasK => 1,
    k => pack("H*","058b78c1a466bf559943151e6c3361c06f2f1ed368a924670d7a3aa9a430bdff"),
  },
)


### a send comm msg to b
### a send comm msg to b

### noise encrypt

### noise encrypt
### key: 'd2c1032efecce036162ab4837e7ca1ffe64208e2538ca921915c75c0df88dfd3'
### key: 'd2c1032efecce036162ab4837e7ca1ffe64208e2538ca921915c75c0df88dfd3'
### iv: 'be37ced5ec953d3117490b27'
### iv: 'be37ced5ec953d3117490b27'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '8f01ffe3dba20c0620710b27'
### iv_xor: '8f01ffe3dba20c0620710b27'
### aad: 'ef70828a8485234f1166ca0af73876cd8fe208b50a4430f5c7b3f62666d236a7'
### aad: 'ef70828a8485234f1166ca0af73876cd8fe208b50a4430f5c7b3f62666d236a7'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '628f2d44bd66d5a096eb7a891b0460f06398088bf6bec79eb219f890da8b716afa504b261c854fc4fc1548d791e5f2d5c16100'
### ciphertext: '628f2d44bd66d5a096eb7a891b0460f06398088bf6bec79eb219f890da8b716afa504b261c854fc4fc1548d791e5f2d5c16100'
### authtag: '774d412c07f41fea973393d017d18440'
### authtag: '774d412c07f41fea973393d017d18440'
### cipherinfo: '834a3136313637373137373850774d412c07f41fea973393d017d184405833628f2d44bd66d5a096eb7a891b0460f06398088bf6bec79eb219f890da8b716afa504b261c854fc4fc1548d791e5f2d5c16100'
### cipherinfo: '834a3136313637373137373850774d412c07f41fea973393d017d184405833628f2d44bd66d5a096eb7a891b0460f06398088bf6bec79eb219f890da8b716afa504b261c854fc4fc1548d791e5f2d5c16100'


### b recv comm msg from a
### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: 'd2c1032efecce036162ab4837e7ca1ffe64208e2538ca921915c75c0df88dfd3'
### key: 'd2c1032efecce036162ab4837e7ca1ffe64208e2538ca921915c75c0df88dfd3'
### iv: 'be37ced5ec953d3117490b27'
### iv: 'be37ced5ec953d3117490b27'
### aad: 'ef70828a8485234f1166ca0af73876cd8fe208b50a4430f5c7b3f62666d236a7'
### aad: 'ef70828a8485234f1166ca0af73876cd8fe208b50a4430f5c7b3f62666d236a7'
### cipherinfo: '834a3136313637373137373850774d412c07f41fea973393d017d184405833628f2d44bd66d5a096eb7a891b0460f06398088bf6bec79eb219f890da8b716afa504b261c854fc4fc1548d791e5f2d5c16100'
### cipherinfo: '834a3136313637373137373850774d412c07f41fea973393d017d184405833628f2d44bd66d5a096eb7a891b0460f06398088bf6bec79eb219f890da8b716afa504b261c854fc4fc1548d791e5f2d5c16100'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '8f01ffe3dba20c0620710b27'
### iv_xor: '8f01ffe3dba20c0620710b27'
### authtag: '774d412c07f41fea973393d017d18440'
### authtag: '774d412c07f41fea973393d017d18440'
### ciphertext: '628f2d44bd66d5a096eb7a891b0460f06398088bf6bec79eb219f890da8b716afa504b261c854fc4fc1548d791e5f2d5c16100'
### ciphertext: '628f2d44bd66d5a096eb7a891b0460f06398088bf6bec79eb219f890da8b716afa504b261c854fc4fc1548d791e5f2d5c16100'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b send comm msg to a

### b send comm msg to a


### noise encrypt
### noise encrypt
### key: 'de1b30b7ca93e23a5fe08cb88afb9062039fd1a21ac8d3a116a63cd4afb61d12'
### key: 'de1b30b7ca93e23a5fe08cb88afb9062039fd1a21ac8d3a116a63cd4afb61d12'
### iv: '9ccc4e5a78f7e80fa237d4c5'
### iv: '9ccc4e5a78f7e80fa237d4c5'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'adfa7f6c4fc0d938950fd4c5'
### iv_xor: 'adfa7f6c4fc0d938950fd4c5'
### aad: 'ef70828a8485234f1166ca0af73876cd8fe208b50a4430f5c7b3f62666d236a7'
### aad: 'ef70828a8485234f1166ca0af73876cd8fe208b50a4430f5c7b3f62666d236a7'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'eb4cfaf4f98ae933d41c85e9110e840c41735af1d06f88c92a904674bad94cdee87b878aa601602acdc00b12734151'
### ciphertext: 'eb4cfaf4f98ae933d41c85e9110e840c41735af1d06f88c92a904674bad94cdee87b878aa601602acdc00b12734151'
### authtag: 'ee916bf8d17eda3478b621d90e857d3f'
### authtag: 'ee916bf8d17eda3478b621d90e857d3f'
### cipherinfo: '834a3136313637373137373850ee916bf8d17eda3478b621d90e857d3f582feb4cfaf4f98ae933d41c85e9110e840c41735af1d06f88c92a904674bad94cdee87b878aa601602acdc00b12734151'
### cipherinfo: '834a3136313637373137373850ee916bf8d17eda3478b621d90e857d3f582feb4cfaf4f98ae933d41c85e9110e840c41735af1d06f88c92a904674bad94cdee87b878aa601602acdc00b12734151'


### a recv comm msg from b
### a recv comm msg from b


### noise decrypt
### noise decrypt
### key: 'de1b30b7ca93e23a5fe08cb88afb9062039fd1a21ac8d3a116a63cd4afb61d12'
### key: 'de1b30b7ca93e23a5fe08cb88afb9062039fd1a21ac8d3a116a63cd4afb61d12'
### iv: '9ccc4e5a78f7e80fa237d4c5'
### iv: '9ccc4e5a78f7e80fa237d4c5'
### aad: 'ef70828a8485234f1166ca0af73876cd8fe208b50a4430f5c7b3f62666d236a7'
### aad: 'ef70828a8485234f1166ca0af73876cd8fe208b50a4430f5c7b3f62666d236a7'
### cipherinfo: '834a3136313637373137373850ee916bf8d17eda3478b621d90e857d3f582feb4cfaf4f98ae933d41c85e9110e840c41735af1d06f88c92a904674bad94cdee87b878aa601602acdc00b12734151'
### cipherinfo: '834a3136313637373137373850ee916bf8d17eda3478b621d90e857d3f582feb4cfaf4f98ae933d41c85e9110e840c41735af1d06f88c92a904674bad94cdee87b878aa601602acdc00b12734151'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'adfa7f6c4fc0d938950fd4c5'
### iv_xor: 'adfa7f6c4fc0d938950fd4c5'
### authtag: 'ee916bf8d17eda3478b621d90e857d3f'
### authtag: 'ee916bf8d17eda3478b621d90e857d3f'
### ciphertext: 'eb4cfaf4f98ae933d41c85e9110e840c41735af1d06f88c92a904674bad94cdee87b878aa601602acdc00b12734151'
### ciphertext: 'eb4cfaf4f98ae933d41c85e9110e840c41735af1d06f88c92a904674bad94cdee87b878aa601602acdc00b12734151'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'X',
###                               'test_psk',
###                               0

### -----------end test --------: 'X',
###                               'test_psk',
###                               0

### -----------start test --------: 'X',
###                                 'test_psk',
###                                 1

### -----------start test --------: 'X',
###                                 'test_psk',
###                                 1

### init a_hs

### init a_hs
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 1,
    message_pattens => [["e", "es", "s", "ss", "psk"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","391de2f80f075602d4bcaf23f2eeedaabd417a7c5e976d0c392dd659334b7d67"),
      h  => pack("H*","279b6cdf7a26ff16d42202ac420586465a003cc00e772c2d27b793375112861a"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 1,
    message_pattens => [["e", "es", "s", "ss", "psk"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","391de2f80f075602d4bcaf23f2eeedaabd417a7c5e976d0c392dd659334b7d67"),
      h  => pack("H*","279b6cdf7a26ff16d42202ac420586465a003cc00e772c2d27b793375112861a"),
    },
    who => "a",
  },
)

### a send msg to b

### a send msg to b

### $a_msg_src: 'init.syn'

### $a_msg_src: 'init.syn'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '02ea326501ca515d9ea8816601f8303d35f909635bddb2631c9cf1e4cc55658041'

### public compressed: '02ea326501ca515d9ea8816601f8303d35f909635bddb2631c9cf1e4cc55658041'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIA324UgG/XlhKmUGYZNklRm4VCOiX7E6S9vP+COQdUUPoAoGCCqGSM49
',
###             'AwEHoUQDQgAE6jJlAcpRXZ6ogWYB+DA9NfkJY1vdsmMcnPHkzFVlgEGHC8PQdnWO
',
###             'CvEuNpI6HNIy21Uj3T8gqE8yGHPdKbAt4g==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIA324UgG/XlhKmUGYZNklRm4VCOiX7E6S9vP+COQdUUPoAoGCCqGSM49
',
###             'AwEHoUQDQgAE6jJlAcpRXZ6ogWYB+DA9NfkJY1vdsmMcnPHkzFVlgEGHC8PQdnWO
',
###             'CvEuNpI6HNIy21Uj3T8gqE8yGHPdKbAt4g==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '25169c01fca12d51126f5e4a4ecef99251d43b53d323908e88a8a023321a3346'
### z: '25169c01fca12d51126f5e4a4ecef99251d43b53d323908e88a8a023321a3346'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '10a822ab06b375ee0c611e47668330be7c6883097a6b3906535704f70afde17e'
### key: '10a822ab06b375ee0c611e47668330be7c6883097a6b3906535704f70afde17e'
### iv: '1d07094cebb7758e7d8c7910'
### iv: '1d07094cebb7758e7d8c7910'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '2c31387adc8044b94ab47910'
### iv_xor: '2c31387adc8044b94ab47910'
### aad: 'd8e380bcc23cde2fd05c8476a64ab50abed6f54107c65ee0882c418596866139'
### aad: 'd8e380bcc23cde2fd05c8476a64ab50abed6f54107c65ee0882c418596866139'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: '8abd8fbadf41f3392deee8d3dea7f16d105eef8a54488c628862e0d1c128bb78a41613b709be4e33'
### ciphertext: '8abd8fbadf41f3392deee8d3dea7f16d105eef8a54488c628862e0d1c128bb78a41613b709be4e33'
### authtag: '8f338fe3d2d89fb194ff35cd782ee730'
### authtag: '8f338fe3d2d89fb194ff35cd782ee730'
### cipherinfo: '834a31363136373731373738508f338fe3d2d89fb194ff35cd782ee73058288abd8fbadf41f3392deee8d3dea7f16d105eef8a54488c628862e0d1c128bb78a41613b709be4e33'
### cipherinfo: '834a31363136373731373738508f338fe3d2d89fb194ff35cd782ee73058288abd8fbadf41f3392deee8d3dea7f16d105eef8a54488c628862e0d1c128bb78a41613b709be4e33'

### write message pattern: 'ss'

### write message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### write message pattern: 'psk'

### write message pattern: 'psk'


### noise encrypt
### noise encrypt
### key: 'ff733d6e0c1462180e8f208df6a86cdcc49a801eda1322dba960bc39ec69b62a'
### key: 'ff733d6e0c1462180e8f208df6a86cdcc49a801eda1322dba960bc39ec69b62a'
### iv: 'aafaa4655ffd0928121f8501'
### iv: 'aafaa4655ffd0928121f8501'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '9bcc955368ca381f25278501'
### iv_xor: '9bcc955368ca381f25278501'
### aad: 'f3561b44f8a17da258aed16503ee41d488526f011db04cff5c04effb47f63ff1'
### aad: 'f3561b44f8a17da258aed16503ee41d488526f011db04cff5c04effb47f63ff1'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '809803694a66a89e'
### ciphertext: '809803694a66a89e'
### authtag: '2e4fb0a41dc06af45072761e512de7f2'
### authtag: '2e4fb0a41dc06af45072761e512de7f2'
### cipherinfo: '834a31363136373731373738502e4fb0a41dc06af45072761e512de7f248809803694a66a89e'
### cipherinfo: '834a31363136373731373738502e4fb0a41dc06af45072761e512de7f248809803694a66a89e'

### a_msg: '83582102ea326501ca515d9ea8816601f8303d35f909635bddb2631c9cf1e4cc556580415847834a31363136373731373738508f338fe3d2d89fb194ff35cd782ee73058288abd8fbadf41f3392deee8d3dea7f16d105eef8a54488c628862e0d1c128bb78a41613b709be4e335826834a31363136373731373738502e4fb0a41dc06af45072761e512de7f248809803694a66a89e'

### a_msg: '83582102ea326501ca515d9ea8816601f8303d35f909635bddb2631c9cf1e4cc556580415847834a31363136373731373738508f338fe3d2d89fb194ff35cd782ee73058288abd8fbadf41f3392deee8d3dea7f16d105eef8a54488c628862e0d1c128bb78a41613b709be4e335826834a31363136373731373738502e4fb0a41dc06af45072761e512de7f248809803694a66a89e'
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02ea326501ca515d9ea8816601f8303d35f909635bddb2631c9cf1e4cc55658041"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "X",
    initiator => 1,
    message_pattens => [["e", "es", "s", "ss", "psk"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","6f58186005db89832d67d23a42af1a3888ead84fe10099cc92bf2d73690c78f4"),
      h => pack("H*","19320788bf9578b4b64125bbadabb3f37b69db22a97741c33cbf2f272118a946"),
      hasK => 1,
      k => pack("H*","470dbe47782500cd1807cbe439e9233fcf1c8f8a003deafac232ac52fb8b0ff1"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","c2ea4deb78d43a3c8b921054d8b7f58656508764f2f6ecba91f5dcd989d2102b"),
  },
  {
    hasK => 1,
    k => pack("H*","d8d64c11ef528978890a9c6dec0817ae69f098e610ef16f2528860228a5e0e4d"),
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02ea326501ca515d9ea8816601f8303d35f909635bddb2631c9cf1e4cc55658041"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "X",
    initiator => 1,
    message_pattens => [["e", "es", "s", "ss", "psk"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","6f58186005db89832d67d23a42af1a3888ead84fe10099cc92bf2d73690c78f4"),
      h => pack("H*","19320788bf9578b4b64125bbadabb3f37b69db22a97741c33cbf2f272118a946"),
      hasK => 1,
      k => pack("H*","470dbe47782500cd1807cbe439e9233fcf1c8f8a003deafac232ac52fb8b0ff1"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","c2ea4deb78d43a3c8b921054d8b7f58656508764f2f6ecba91f5dcd989d2102b"),
  },
  {
    hasK => 1,
    k => pack("H*","d8d64c11ef528978890a9c6dec0817ae69f098e610ef16f2528860228a5e0e4d"),
  },
)

### init b_hs

### init b_hs
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 0,
    message_pattens => [["e", "es", "s", "ss", "psk"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","391de2f80f075602d4bcaf23f2eeedaabd417a7c5e976d0c392dd659334b7d67"),
      h  => pack("H*","279b6cdf7a26ff16d42202ac420586465a003cc00e772c2d27b793375112861a"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 0,
    message_pattens => [["e", "es", "s", "ss", "psk"]],
    msg_id => 0,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","391de2f80f075602d4bcaf23f2eeedaabd417a7c5e976d0c392dd659334b7d67"),
      h  => pack("H*","279b6cdf7a26ff16d42202ac420586465a003cc00e772c2d27b793375112861a"),
    },
    who => "b",
  },
)

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'


### read message pattern: 'es'
### read message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE6jJlAcpRXZ6ogWYB+DA9NfkJY1vd
',
###           'smMcnPHkzFVlgEGHC8PQdnWOCvEuNpI6HNIy21Uj3T8gqE8yGHPdKbAt4g==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE6jJlAcpRXZ6ogWYB+DA9NfkJY1vd
',
###           'smMcnPHkzFVlgEGHC8PQdnWOCvEuNpI6HNIy21Uj3T8gqE8yGHPdKbAt4g==
',
###           '-----END PUBLIC KEY-----
'
### z: '25169c01fca12d51126f5e4a4ecef99251d43b53d323908e88a8a023321a3346'
### z: '25169c01fca12d51126f5e4a4ecef99251d43b53d323908e88a8a023321a3346'

### read message pattern: 's'

### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: '10a822ab06b375ee0c611e47668330be7c6883097a6b3906535704f70afde17e'
### key: '10a822ab06b375ee0c611e47668330be7c6883097a6b3906535704f70afde17e'
### iv: '1d07094cebb7758e7d8c7910'
### iv: '1d07094cebb7758e7d8c7910'
### aad: 'd8e380bcc23cde2fd05c8476a64ab50abed6f54107c65ee0882c418596866139'
### aad: 'd8e380bcc23cde2fd05c8476a64ab50abed6f54107c65ee0882c418596866139'
### cipherinfo: '834a31363136373731373738508f338fe3d2d89fb194ff35cd782ee73058288abd8fbadf41f3392deee8d3dea7f16d105eef8a54488c628862e0d1c128bb78a41613b709be4e33'
### cipherinfo: '834a31363136373731373738508f338fe3d2d89fb194ff35cd782ee73058288abd8fbadf41f3392deee8d3dea7f16d105eef8a54488c628862e0d1c128bb78a41613b709be4e33'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '2c31387adc8044b94ab47910'
### iv_xor: '2c31387adc8044b94ab47910'
### authtag: '8f338fe3d2d89fb194ff35cd782ee730'
### authtag: '8f338fe3d2d89fb194ff35cd782ee730'
### ciphertext: '8abd8fbadf41f3392deee8d3dea7f16d105eef8a54488c628862e0d1c128bb78a41613b709be4e33'
### ciphertext: '8abd8fbadf41f3392deee8d3dea7f16d105eef8a54488c628862e0d1c128bb78a41613b709be4e33'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'


### read message pattern: 'ss'
### read message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### read message pattern: 'psk'

### read message pattern: 'psk'

### noise decrypt

### noise decrypt
### key: 'ff733d6e0c1462180e8f208df6a86cdcc49a801eda1322dba960bc39ec69b62a'
### key: 'ff733d6e0c1462180e8f208df6a86cdcc49a801eda1322dba960bc39ec69b62a'
### iv: 'aafaa4655ffd0928121f8501'
### iv: 'aafaa4655ffd0928121f8501'
### aad: 'f3561b44f8a17da258aed16503ee41d488526f011db04cff5c04effb47f63ff1'
### aad: 'f3561b44f8a17da258aed16503ee41d488526f011db04cff5c04effb47f63ff1'
### cipherinfo: '834a31363136373731373738502e4fb0a41dc06af45072761e512de7f248809803694a66a89e'
### cipherinfo: '834a31363136373731373738502e4fb0a41dc06af45072761e512de7f248809803694a66a89e'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '9bcc955368ca381f25278501'
### iv_xor: '9bcc955368ca381f25278501'
### authtag: '2e4fb0a41dc06af45072761e512de7f2'
### authtag: '2e4fb0a41dc06af45072761e512de7f2'
### ciphertext: '809803694a66a89e'
### ciphertext: '809803694a66a89e'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'

### b_recv_a_msg: 'init.syn'

### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 0,
    message_pattens => [["e", "es", "s", "ss", "psk"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","02ea326501ca515d9ea8816601f8303d35f909635bddb2631c9cf1e4cc55658041"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","6f58186005db89832d67d23a42af1a3888ead84fe10099cc92bf2d73690c78f4"),
      h => pack("H*","19320788bf9578b4b64125bbadabb3f37b69db22a97741c33cbf2f272118a946"),
      hasK => 1,
      k => pack("H*","470dbe47782500cd1807cbe439e9233fcf1c8f8a003deafac232ac52fb8b0ff1"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","c2ea4deb78d43a3c8b921054d8b7f58656508764f2f6ecba91f5dcd989d2102b"),
  },
  {
    hasK => 1,
    k => pack("H*","d8d64c11ef528978890a9c6dec0817ae69f098e610ef16f2528860228a5e0e4d"),
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "X",
    initiator => 0,
    message_pattens => [["e", "es", "s", "ss", "psk"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","02ea326501ca515d9ea8816601f8303d35f909635bddb2631c9cf1e4cc55658041"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","6f58186005db89832d67d23a42af1a3888ead84fe10099cc92bf2d73690c78f4"),
      h => pack("H*","19320788bf9578b4b64125bbadabb3f37b69db22a97741c33cbf2f272118a946"),
      hasK => 1,
      k => pack("H*","470dbe47782500cd1807cbe439e9233fcf1c8f8a003deafac232ac52fb8b0ff1"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","c2ea4deb78d43a3c8b921054d8b7f58656508764f2f6ecba91f5dcd989d2102b"),
  },
  {
    hasK => 1,
    k => pack("H*","d8d64c11ef528978890a9c6dec0817ae69f098e610ef16f2528860228a5e0e4d"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: 'b772e7e01a3cbf878658e9ab3a625270efb508fba0955352b9a0e8988e07ad99'
### key: 'b772e7e01a3cbf878658e9ab3a625270efb508fba0955352b9a0e8988e07ad99'
### iv: '9e7654027708b6a3d12d79a9'
### iv: '9e7654027708b6a3d12d79a9'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'af406534403f8794e61579a9'
### iv_xor: 'af406534403f8794e61579a9'
### aad: '19320788bf9578b4b64125bbadabb3f37b69db22a97741c33cbf2f272118a946'
### aad: '19320788bf9578b4b64125bbadabb3f37b69db22a97741c33cbf2f272118a946'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'dbf967d35b7cc74cf18222c547beb021fd50e711340386cc9835f3175e88969735556e3804b2ed9af4c55102fad6504f0fe4dc'
### ciphertext: 'dbf967d35b7cc74cf18222c547beb021fd50e711340386cc9835f3175e88969735556e3804b2ed9af4c55102fad6504f0fe4dc'
### authtag: '97d5f2b5cfd77217b6f490130f630ec8'
### authtag: '97d5f2b5cfd77217b6f490130f630ec8'
### cipherinfo: '834a313631363737313737385097d5f2b5cfd77217b6f490130f630ec85833dbf967d35b7cc74cf18222c547beb021fd50e711340386cc9835f3175e88969735556e3804b2ed9af4c55102fad6504f0fe4dc'
### cipherinfo: '834a313631363737313737385097d5f2b5cfd77217b6f490130f630ec85833dbf967d35b7cc74cf18222c547beb021fd50e711340386cc9835f3175e88969735556e3804b2ed9af4c55102fad6504f0fe4dc'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: 'b772e7e01a3cbf878658e9ab3a625270efb508fba0955352b9a0e8988e07ad99'
### key: 'b772e7e01a3cbf878658e9ab3a625270efb508fba0955352b9a0e8988e07ad99'
### iv: '9e7654027708b6a3d12d79a9'
### iv: '9e7654027708b6a3d12d79a9'
### aad: '19320788bf9578b4b64125bbadabb3f37b69db22a97741c33cbf2f272118a946'
### aad: '19320788bf9578b4b64125bbadabb3f37b69db22a97741c33cbf2f272118a946'
### cipherinfo: '834a313631363737313737385097d5f2b5cfd77217b6f490130f630ec85833dbf967d35b7cc74cf18222c547beb021fd50e711340386cc9835f3175e88969735556e3804b2ed9af4c55102fad6504f0fe4dc'
### cipherinfo: '834a313631363737313737385097d5f2b5cfd77217b6f490130f630ec85833dbf967d35b7cc74cf18222c547beb021fd50e711340386cc9835f3175e88969735556e3804b2ed9af4c55102fad6504f0fe4dc'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'af406534403f8794e61579a9'
### iv_xor: 'af406534403f8794e61579a9'
### authtag: '97d5f2b5cfd77217b6f490130f630ec8'
### authtag: '97d5f2b5cfd77217b6f490130f630ec8'
### ciphertext: 'dbf967d35b7cc74cf18222c547beb021fd50e711340386cc9835f3175e88969735556e3804b2ed9af4c55102fad6504f0fe4dc'
### ciphertext: 'dbf967d35b7cc74cf18222c547beb021fd50e711340386cc9835f3175e88969735556e3804b2ed9af4c55102fad6504f0fe4dc'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b send comm msg to a

### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '908b94d649dc7bbd1a93c39c1e4d43809f06c2ceec40d22bf3bf27e2903f6bad'
### key: '908b94d649dc7bbd1a93c39c1e4d43809f06c2ceec40d22bf3bf27e2903f6bad'
### iv: '8981053e6b4708ff8e8eba9e'
### iv: '8981053e6b4708ff8e8eba9e'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'b8b734085c7039c8b9b6ba9e'
### iv_xor: 'b8b734085c7039c8b9b6ba9e'
### aad: '19320788bf9578b4b64125bbadabb3f37b69db22a97741c33cbf2f272118a946'
### aad: '19320788bf9578b4b64125bbadabb3f37b69db22a97741c33cbf2f272118a946'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '83bc5b7b7f47239c634aa2dabab465543966254ad856f06acb6921b2a1e1b4e3547d1565e4c6afb9cbaf29fe0abf41'
### ciphertext: '83bc5b7b7f47239c634aa2dabab465543966254ad856f06acb6921b2a1e1b4e3547d1565e4c6afb9cbaf29fe0abf41'
### authtag: 'dacf25384a704fbc33fe15da811becf7'
### authtag: 'dacf25384a704fbc33fe15da811becf7'
### cipherinfo: '834a3136313637373137373850dacf25384a704fbc33fe15da811becf7582f83bc5b7b7f47239c634aa2dabab465543966254ad856f06acb6921b2a1e1b4e3547d1565e4c6afb9cbaf29fe0abf41'
### cipherinfo: '834a3136313637373137373850dacf25384a704fbc33fe15da811becf7582f83bc5b7b7f47239c634aa2dabab465543966254ad856f06acb6921b2a1e1b4e3547d1565e4c6afb9cbaf29fe0abf41'


### a recv comm msg from b
### a recv comm msg from b


### noise decrypt
### noise decrypt
### key: '908b94d649dc7bbd1a93c39c1e4d43809f06c2ceec40d22bf3bf27e2903f6bad'
### key: '908b94d649dc7bbd1a93c39c1e4d43809f06c2ceec40d22bf3bf27e2903f6bad'
### iv: '8981053e6b4708ff8e8eba9e'
### iv: '8981053e6b4708ff8e8eba9e'
### aad: '19320788bf9578b4b64125bbadabb3f37b69db22a97741c33cbf2f272118a946'
### aad: '19320788bf9578b4b64125bbadabb3f37b69db22a97741c33cbf2f272118a946'
### cipherinfo: '834a3136313637373137373850dacf25384a704fbc33fe15da811becf7582f83bc5b7b7f47239c634aa2dabab465543966254ad856f06acb6921b2a1e1b4e3547d1565e4c6afb9cbaf29fe0abf41'
### cipherinfo: '834a3136313637373137373850dacf25384a704fbc33fe15da811becf7582f83bc5b7b7f47239c634aa2dabab465543966254ad856f06acb6921b2a1e1b4e3547d1565e4c6afb9cbaf29fe0abf41'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'b8b734085c7039c8b9b6ba9e'
### iv_xor: 'b8b734085c7039c8b9b6ba9e'
### authtag: 'dacf25384a704fbc33fe15da811becf7'
### authtag: 'dacf25384a704fbc33fe15da811becf7'
### ciphertext: '83bc5b7b7f47239c634aa2dabab465543966254ad856f06acb6921b2a1e1b4e3547d1565e4c6afb9cbaf29fe0abf41'
### ciphertext: '83bc5b7b7f47239c634aa2dabab465543966254ad856f06acb6921b2a1e1b4e3547d1565e4c6afb9cbaf29fe0abf41'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'X',
###                               'test_psk',
###                               1

### -----------end test --------: 'X',
###                               'test_psk',
###                               1

### -----------start test --------: 'NN',
###                                 undef,
###                                 undef

### -----------start test --------: 'NN',
###                                 undef,
###                                 undef

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NN",
  initiator => 1,
  message_pattens => [["e"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => "Noise_NN_secp256r1_AESGCM_SHA256",
    h  => pack("H*","b4d7a57f37abfc0a885808bfe29388b34ef2356f4fe1ee7b9ae78c3c3f0dd686"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NN",
  initiator => 1,
  message_pattens => [["e"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => "Noise_NN_secp256r1_AESGCM_SHA256",
    h  => pack("H*","b4d7a57f37abfc0a885808bfe29388b34ef2356f4fe1ee7b9ae78c3c3f0dd686"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '02ef55b9a62b886d1b897232dded76698663ba511cf9fe718dd7695abdb918cc5f'

### public compressed: '02ef55b9a62b886d1b897232dded76698663ba511cf9fe718dd7695abdb918cc5f'
(
  "a_msg",
  pack("H*","82582102ef55b9a62b886d1b897232dded76698663ba511cf9fe718dd7695abdb918cc5f48696e69742e73796e"),
)
(
  "a_msg",
  pack("H*","82582102ef55b9a62b886d1b897232dded76698663ba511cf9fe718dd7695abdb918cc5f48696e69742e73796e"),
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02ef55b9a62b886d1b897232dded76698663ba511cf9fe718dd7695abdb918cc5f"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 1,
    message_pattens => [["e"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => "Noise_NN_secp256r1_AESGCM_SHA256",
      h  => pack("H*","6e99ddcf6e9cfe0ab012ed55213a8909574ace9d960c387f806a3911e67a9a60"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02ef55b9a62b886d1b897232dded76698663ba511cf9fe718dd7695abdb918cc5f"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 1,
    message_pattens => [["e"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => "Noise_NN_secp256r1_AESGCM_SHA256",
      h  => pack("H*","6e99ddcf6e9cfe0ab012ed55213a8909574ace9d960c387f806a3911e67a9a60"),
    },
    who => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NN",
  initiator => 0,
  message_pattens => [["e"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => "Noise_NN_secp256r1_AESGCM_SHA256",
    h  => pack("H*","b4d7a57f37abfc0a885808bfe29388b34ef2356f4fe1ee7b9ae78c3c3f0dd686"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NN",
  initiator => 0,
  message_pattens => [["e"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => "Noise_NN_secp256r1_AESGCM_SHA256",
    h  => pack("H*","b4d7a57f37abfc0a885808bfe29388b34ef2356f4fe1ee7b9ae78c3c3f0dd686"),
  },
  who => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "NN",
    initiator => 0,
    message_pattens => [["e"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","02ef55b9a62b886d1b897232dded76698663ba511cf9fe718dd7695abdb918cc5f"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => "Noise_NN_secp256r1_AESGCM_SHA256",
      h  => pack("H*","6e99ddcf6e9cfe0ab012ed55213a8909574ace9d960c387f806a3911e67a9a60"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "NN",
    initiator => 0,
    message_pattens => [["e"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","02ef55b9a62b886d1b897232dded76698663ba511cf9fe718dd7695abdb918cc5f"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => "Noise_NN_secp256r1_AESGCM_SHA256",
      h  => pack("H*","6e99ddcf6e9cfe0ab012ed55213a8909574ace9d960c387f806a3911e67a9a60"),
    },
    who => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '021a643d78d4b4e478bc12c98acc82c472de3067a7378e8c2fddd2056768ff4fcd'

### public compressed: '021a643d78d4b4e478bc12c98acc82c472de3067a7378e8c2fddd2056768ff4fcd'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIORCblDkdfYBUbCLMtzl/A/R2ttbiuYUEbU/HlmN5aL3oAoGCCqGSM49
',
###             'AwEHoUQDQgAEGmQ9eNS05Hi8EsmKzILEct4wZ6c3jowv3dIFZ2j/T829nEHqq5+A
',
###             'GX8e4Z3eDjqScSD/k+gTOyWKyyghsgvdFg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIORCblDkdfYBUbCLMtzl/A/R2ttbiuYUEbU/HlmN5aL3oAoGCCqGSM49
',
###             'AwEHoUQDQgAEGmQ9eNS05Hi8EsmKzILEct4wZ6c3jowv3dIFZ2j/T829nEHqq5+A
',
###             'GX8e4Z3eDjqScSD/k+gTOyWKyyghsgvdFg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE71W5piuIbRuJcjLd7XZphmO6URz5
',
###           '/nGN12lavbkYzF94XiaO4Gx0fRE4xv73fwjPUNpgKRXVNHZ7BCCsv9kNCA==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE71W5piuIbRuJcjLd7XZphmO6URz5
',
###           '/nGN12lavbkYzF94XiaO4Gx0fRE4xv73fwjPUNpgKRXVNHZ7BCCsv9kNCA==
',
###           '-----END PUBLIC KEY-----
'
### z: '0cb35490eef911357387c7ab9f9024a5b936090c3fce308c919e52221a047971'
### z: '0cb35490eef911357387c7ab9f9024a5b936090c3fce308c919e52221a047971'

### noise encrypt

### noise encrypt
### key: 'acc73f0627713ab84b77e1f18ca439cf678291604ead3d7569f3b81f8651ce82'
### key: 'acc73f0627713ab84b77e1f18ca439cf678291604ead3d7569f3b81f8651ce82'
### iv: '338697f7da6eedfe6e3b3643'
### iv: '338697f7da6eedfe6e3b3643'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '02b0a6c1ed59dcc959033643'
### iv_xor: '02b0a6c1ed59dcc959033643'
### aad: '15eb0bed9c31d5bfb371001cb1eef1d01602053a73f413ee5069fe5af3c7f62f'
### aad: '15eb0bed9c31d5bfb371001cb1eef1d01602053a73f413ee5069fe5af3c7f62f'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '0793a4f3c85ed6d9'
### ciphertext: '0793a4f3c85ed6d9'
### authtag: 'ba386ba520f4510356c4b018a3ba819c'
### authtag: 'ba386ba520f4510356c4b018a3ba819c'
### cipherinfo: '834a3136313637373137373850ba386ba520f4510356c4b018a3ba819c480793a4f3c85ed6d9'
### cipherinfo: '834a3136313637373137373850ba386ba520f4510356c4b018a3ba819c480793a4f3c85ed6d9'

### b_msg: '825821021a643d78d4b4e478bc12c98acc82c472de3067a7378e8c2fddd2056768ff4fcd5826834a3136313637373137373850ba386ba520f4510356c4b018a3ba819c480793a4f3c85ed6d9'

### b_msg: '825821021a643d78d4b4e478bc12c98acc82c472de3067a7378e8c2fddd2056768ff4fcd5826834a3136313637373137373850ba386ba520f4510356c4b018a3ba819c480793a4f3c85ed6d9'
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","021a643d78d4b4e478bc12c98acc82c472de3067a7378e8c2fddd2056768ff4fcd"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 0,
    message_pattens => [["e"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","02ef55b9a62b886d1b897232dded76698663ba511cf9fe718dd7695abdb918cc5f"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","45245acfc1d24e14299715f10fd539adafdbf433f402f3f3006c26f2bf8f300f"),
      h => pack("H*","aacfe8d71d27ab827c2ec86aed6d4c4c48b6f19e45e7b791428bccbd665e41f1"),
      hasK => 1,
      k => pack("H*","938a334bedfd5f08fce31470581fd658e0762bb5c73287fa8aee245844b26a6e"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","c37c375e6cff2cc6426a424dbf506a0fca1f1a7b38f5626eda4345f042792893"),
  },
  {
    hasK => 1,
    k => pack("H*","b341fb7fdbb39003f7125d4d8d215598558b0b3d937f2578a92bf090106c1fc8"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","021a643d78d4b4e478bc12c98acc82c472de3067a7378e8c2fddd2056768ff4fcd"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 0,
    message_pattens => [["e"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","02ef55b9a62b886d1b897232dded76698663ba511cf9fe718dd7695abdb918cc5f"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","45245acfc1d24e14299715f10fd539adafdbf433f402f3f3006c26f2bf8f300f"),
      h => pack("H*","aacfe8d71d27ab827c2ec86aed6d4c4c48b6f19e45e7b791428bccbd665e41f1"),
      hasK => 1,
      k => pack("H*","938a334bedfd5f08fce31470581fd658e0762bb5c73287fa8aee245844b26a6e"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","c37c375e6cff2cc6426a424dbf506a0fca1f1a7b38f5626eda4345f042792893"),
  },
  {
    hasK => 1,
    k => pack("H*","b341fb7fdbb39003f7125d4d8d215598558b0b3d937f2578a92bf090106c1fc8"),
  },
)


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b


### read message pattern: 'e'
### read message pattern: 'e'


### read message pattern: 'ee'
### read message pattern: 'ee'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBRiEmOfU83BsEfVyl2szq5LKYbSlo6O/XOBtdVeoj46oAoGCCqGSM49
',
###             'AwEHoUQDQgAE71W5piuIbRuJcjLd7XZphmO6URz5/nGN12lavbkYzF94XiaO4Gx0
',
###             'fRE4xv73fwjPUNpgKRXVNHZ7BCCsv9kNCA==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBRiEmOfU83BsEfVyl2szq5LKYbSlo6O/XOBtdVeoj46oAoGCCqGSM49
',
###             'AwEHoUQDQgAE71W5piuIbRuJcjLd7XZphmO6URz5/nGN12lavbkYzF94XiaO4Gx0
',
###             'fRE4xv73fwjPUNpgKRXVNHZ7BCCsv9kNCA==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEGmQ9eNS05Hi8EsmKzILEct4wZ6c3
',
###           'jowv3dIFZ2j/T829nEHqq5+AGX8e4Z3eDjqScSD/k+gTOyWKyyghsgvdFg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEGmQ9eNS05Hi8EsmKzILEct4wZ6c3
',
###           'jowv3dIFZ2j/T829nEHqq5+AGX8e4Z3eDjqScSD/k+gTOyWKyyghsgvdFg==
',
###           '-----END PUBLIC KEY-----
'
### z: '0cb35490eef911357387c7ab9f9024a5b936090c3fce308c919e52221a047971'
### z: '0cb35490eef911357387c7ab9f9024a5b936090c3fce308c919e52221a047971'

### noise decrypt

### noise decrypt
### key: 'acc73f0627713ab84b77e1f18ca439cf678291604ead3d7569f3b81f8651ce82'
### key: 'acc73f0627713ab84b77e1f18ca439cf678291604ead3d7569f3b81f8651ce82'
### iv: '338697f7da6eedfe6e3b3643'
### iv: '338697f7da6eedfe6e3b3643'
### aad: '15eb0bed9c31d5bfb371001cb1eef1d01602053a73f413ee5069fe5af3c7f62f'
### aad: '15eb0bed9c31d5bfb371001cb1eef1d01602053a73f413ee5069fe5af3c7f62f'
### cipherinfo: '834a3136313637373137373850ba386ba520f4510356c4b018a3ba819c480793a4f3c85ed6d9'
### cipherinfo: '834a3136313637373137373850ba386ba520f4510356c4b018a3ba819c480793a4f3c85ed6d9'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '02b0a6c1ed59dcc959033643'
### iv_xor: '02b0a6c1ed59dcc959033643'
### authtag: 'ba386ba520f4510356c4b018a3ba819c'
### authtag: 'ba386ba520f4510356c4b018a3ba819c'
### ciphertext: '0793a4f3c85ed6d9'
### ciphertext: '0793a4f3c85ed6d9'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02ef55b9a62b886d1b897232dded76698663ba511cf9fe718dd7695abdb918cc5f"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 1,
    message_pattens => [["e"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","021a643d78d4b4e478bc12c98acc82c472de3067a7378e8c2fddd2056768ff4fcd"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","45245acfc1d24e14299715f10fd539adafdbf433f402f3f3006c26f2bf8f300f"),
      h => pack("H*","aacfe8d71d27ab827c2ec86aed6d4c4c48b6f19e45e7b791428bccbd665e41f1"),
      hasK => 1,
      k => pack("H*","938a334bedfd5f08fce31470581fd658e0762bb5c73287fa8aee245844b26a6e"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","c37c375e6cff2cc6426a424dbf506a0fca1f1a7b38f5626eda4345f042792893"),
  },
  {
    hasK => 1,
    k => pack("H*","b341fb7fdbb39003f7125d4d8d215598558b0b3d937f2578a92bf090106c1fc8"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02ef55b9a62b886d1b897232dded76698663ba511cf9fe718dd7695abdb918cc5f"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 1,
    message_pattens => [["e"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","021a643d78d4b4e478bc12c98acc82c472de3067a7378e8c2fddd2056768ff4fcd"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","45245acfc1d24e14299715f10fd539adafdbf433f402f3f3006c26f2bf8f300f"),
      h => pack("H*","aacfe8d71d27ab827c2ec86aed6d4c4c48b6f19e45e7b791428bccbd665e41f1"),
      hasK => 1,
      k => pack("H*","938a334bedfd5f08fce31470581fd658e0762bb5c73287fa8aee245844b26a6e"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","c37c375e6cff2cc6426a424dbf506a0fca1f1a7b38f5626eda4345f042792893"),
  },
  {
    hasK => 1,
    k => pack("H*","b341fb7fdbb39003f7125d4d8d215598558b0b3d937f2578a92bf090106c1fc8"),
  },
)


### a send comm msg to b
### a send comm msg to b


### noise encrypt
### noise encrypt
### key: '3f3ec8acd4f2180a99c3b91aa686edbc507560b326ac2463c6b9e84767ef26f5'
### key: '3f3ec8acd4f2180a99c3b91aa686edbc507560b326ac2463c6b9e84767ef26f5'
### iv: '81bbcf800556379077965b1c'
### iv: '81bbcf800556379077965b1c'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'b08dfeb6326106a740ae5b1c'
### iv_xor: 'b08dfeb6326106a740ae5b1c'
### aad: 'aacfe8d71d27ab827c2ec86aed6d4c4c48b6f19e45e7b791428bccbd665e41f1'
### aad: 'aacfe8d71d27ab827c2ec86aed6d4c4c48b6f19e45e7b791428bccbd665e41f1'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '6d7937d139a39f0a95c47253274de5aa034829dff672154134e00941e351387cdb2680d49e00afe45bd3b193df6451d7a3e0ff'
### ciphertext: '6d7937d139a39f0a95c47253274de5aa034829dff672154134e00941e351387cdb2680d49e00afe45bd3b193df6451d7a3e0ff'
### authtag: '1c1ef8eaaab04430b6f73c8e84876479'
### authtag: '1c1ef8eaaab04430b6f73c8e84876479'
### cipherinfo: '834a31363136373731373738501c1ef8eaaab04430b6f73c8e8487647958336d7937d139a39f0a95c47253274de5aa034829dff672154134e00941e351387cdb2680d49e00afe45bd3b193df6451d7a3e0ff'
### cipherinfo: '834a31363136373731373738501c1ef8eaaab04430b6f73c8e8487647958336d7937d139a39f0a95c47253274de5aa034829dff672154134e00941e351387cdb2680d49e00afe45bd3b193df6451d7a3e0ff'


### b recv comm msg from a
### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: '3f3ec8acd4f2180a99c3b91aa686edbc507560b326ac2463c6b9e84767ef26f5'
### key: '3f3ec8acd4f2180a99c3b91aa686edbc507560b326ac2463c6b9e84767ef26f5'
### iv: '81bbcf800556379077965b1c'
### iv: '81bbcf800556379077965b1c'
### aad: 'aacfe8d71d27ab827c2ec86aed6d4c4c48b6f19e45e7b791428bccbd665e41f1'
### aad: 'aacfe8d71d27ab827c2ec86aed6d4c4c48b6f19e45e7b791428bccbd665e41f1'
### cipherinfo: '834a31363136373731373738501c1ef8eaaab04430b6f73c8e8487647958336d7937d139a39f0a95c47253274de5aa034829dff672154134e00941e351387cdb2680d49e00afe45bd3b193df6451d7a3e0ff'
### cipherinfo: '834a31363136373731373738501c1ef8eaaab04430b6f73c8e8487647958336d7937d139a39f0a95c47253274de5aa034829dff672154134e00941e351387cdb2680d49e00afe45bd3b193df6451d7a3e0ff'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'b08dfeb6326106a740ae5b1c'
### iv_xor: 'b08dfeb6326106a740ae5b1c'
### authtag: '1c1ef8eaaab04430b6f73c8e84876479'
### authtag: '1c1ef8eaaab04430b6f73c8e84876479'
### ciphertext: '6d7937d139a39f0a95c47253274de5aa034829dff672154134e00941e351387cdb2680d49e00afe45bd3b193df6451d7a3e0ff'
### ciphertext: '6d7937d139a39f0a95c47253274de5aa034829dff672154134e00941e351387cdb2680d49e00afe45bd3b193df6451d7a3e0ff'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '6d8dbe94913cf1e8ccaf383f8afa9c13237b3a2eaab6aa1eec71076f505a5b26'
### key: '6d8dbe94913cf1e8ccaf383f8afa9c13237b3a2eaab6aa1eec71076f505a5b26'
### iv: 'd1513767b51788239bf0cc16'
### iv: 'd1513767b51788239bf0cc16'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'e06706518220b914acc8cc16'
### iv_xor: 'e06706518220b914acc8cc16'
### aad: 'aacfe8d71d27ab827c2ec86aed6d4c4c48b6f19e45e7b791428bccbd665e41f1'
### aad: 'aacfe8d71d27ab827c2ec86aed6d4c4c48b6f19e45e7b791428bccbd665e41f1'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '24da317d2acd8dd951e3b8d5545bf054d78aabd8ac052439a3d028816e00fabcc8b366c3ed463ed297ae19d0dce2f7'
### ciphertext: '24da317d2acd8dd951e3b8d5545bf054d78aabd8ac052439a3d028816e00fabcc8b366c3ed463ed297ae19d0dce2f7'
### authtag: 'a080f9d5405280bf0debbb6077ca60cc'
### authtag: 'a080f9d5405280bf0debbb6077ca60cc'
### cipherinfo: '834a3136313637373137373850a080f9d5405280bf0debbb6077ca60cc582f24da317d2acd8dd951e3b8d5545bf054d78aabd8ac052439a3d028816e00fabcc8b366c3ed463ed297ae19d0dce2f7'
### cipherinfo: '834a3136313637373137373850a080f9d5405280bf0debbb6077ca60cc582f24da317d2acd8dd951e3b8d5545bf054d78aabd8ac052439a3d028816e00fabcc8b366c3ed463ed297ae19d0dce2f7'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '6d8dbe94913cf1e8ccaf383f8afa9c13237b3a2eaab6aa1eec71076f505a5b26'
### key: '6d8dbe94913cf1e8ccaf383f8afa9c13237b3a2eaab6aa1eec71076f505a5b26'
### iv: 'd1513767b51788239bf0cc16'
### iv: 'd1513767b51788239bf0cc16'
### aad: 'aacfe8d71d27ab827c2ec86aed6d4c4c48b6f19e45e7b791428bccbd665e41f1'
### aad: 'aacfe8d71d27ab827c2ec86aed6d4c4c48b6f19e45e7b791428bccbd665e41f1'
### cipherinfo: '834a3136313637373137373850a080f9d5405280bf0debbb6077ca60cc582f24da317d2acd8dd951e3b8d5545bf054d78aabd8ac052439a3d028816e00fabcc8b366c3ed463ed297ae19d0dce2f7'
### cipherinfo: '834a3136313637373137373850a080f9d5405280bf0debbb6077ca60cc582f24da317d2acd8dd951e3b8d5545bf054d78aabd8ac052439a3d028816e00fabcc8b366c3ed463ed297ae19d0dce2f7'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'e06706518220b914acc8cc16'
### iv_xor: 'e06706518220b914acc8cc16'
### authtag: 'a080f9d5405280bf0debbb6077ca60cc'
### authtag: 'a080f9d5405280bf0debbb6077ca60cc'
### ciphertext: '24da317d2acd8dd951e3b8d5545bf054d78aabd8ac052439a3d028816e00fabcc8b366c3ed463ed297ae19d0dce2f7'
### ciphertext: '24da317d2acd8dd951e3b8d5545bf054d78aabd8ac052439a3d028816e00fabcc8b366c3ed463ed297ae19d0dce2f7'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'NN',
###                               undef,
###                               undef

### -----------end test --------: 'NN',
###                               undef,
###                               undef

### -----------start test --------: 'NN',
###                                 'test_psk',
###                                 0

### -----------start test --------: 'NN',
###                                 'test_psk',
###                                 0

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NN",
  initiator => 1,
  message_pattens => [["psk", "e"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","0d27d2d1c578d75a6c17579b8dcf74e910ace2ee9e92247cbdce7991a1e05655"),
    h  => pack("H*","19cc5936b038c10ed2dbc285bf8010a8cfac30f06f852fb43acebf50724c2af2"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NN",
  initiator => 1,
  message_pattens => [["psk", "e"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","0d27d2d1c578d75a6c17579b8dcf74e910ace2ee9e92247cbdce7991a1e05655"),
    h  => pack("H*","19cc5936b038c10ed2dbc285bf8010a8cfac30f06f852fb43acebf50724c2af2"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'psk'

### write message pattern: 'psk'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '02e0df6c9a1ec5d97d8d76865671c2fc95e691c2b31ba75c2d8280905386ccd859'

### public compressed: '02e0df6c9a1ec5d97d8d76865671c2fc95e691c2b31ba75c2d8280905386ccd859'

### noise encrypt

### noise encrypt
### key: '85f834dfb25f33b73a55271309ade93bc5bbb2206ca4f4e078e6f03c66b19552'
### key: '85f834dfb25f33b73a55271309ade93bc5bbb2206ca4f4e078e6f03c66b19552'
### iv: '21feef71ed74ebd212b0f545'
### iv: '21feef71ed74ebd212b0f545'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '10c8de47da43dae52588f545'
### iv_xor: '10c8de47da43dae52588f545'
### aad: 'c29782ed32ba6cb94f4efda9fb1d7c2c43372a82eec2a71b1e2b5f4b1f8c098a'
### aad: 'c29782ed32ba6cb94f4efda9fb1d7c2c43372a82eec2a71b1e2b5f4b1f8c098a'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '672cc61a51220201'
### ciphertext: '672cc61a51220201'
### authtag: 'e2dd6afbcd43d389307e261c6d25c116'
### authtag: 'e2dd6afbcd43d389307e261c6d25c116'
### cipherinfo: '834a3136313637373137373850e2dd6afbcd43d389307e261c6d25c11648672cc61a51220201'
### cipherinfo: '834a3136313637373137373850e2dd6afbcd43d389307e261c6d25c11648672cc61a51220201'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAuDfbJoexdl9jXaGVnHC/JXmkcKzG6dcLYKAkFOGzNhZWCaDSjE2MTY3NzE3NzhQ4t1q+81D04kwfiYcbSXBFkhnLMYaUSICAQ=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAuDfbJoexdl9jXaGVnHC/JXmkcKzG6dcLYKAkFOGzNhZWCaDSjE2MTY3NzE3NzhQ4t1q+81D04kwfiYcbSXBFkhnLMYaUSICAQ=="),
  );
}
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02e0df6c9a1ec5d97d8d76865671c2fc95e691c2b31ba75c2d8280905386ccd859"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 1,
    message_pattens => [["psk", "e"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","e69df66d0eeb0c8912c98e3c3303425b13f993948386e1b69e4ab88439807dd4"),
      h => pack("H*","4a004331f66d415c6ddfc90081864b29f256225a96149f489d2868eb7af154c3"),
      hasK => 1,
      k => pack("H*","98bef4061f3450b7fee635efe47016840ccf4aaffc0f33df64c21649977020cc"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02e0df6c9a1ec5d97d8d76865671c2fc95e691c2b31ba75c2d8280905386ccd859"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 1,
    message_pattens => [["psk", "e"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","e69df66d0eeb0c8912c98e3c3303425b13f993948386e1b69e4ab88439807dd4"),
      h => pack("H*","4a004331f66d415c6ddfc90081864b29f256225a96149f489d2868eb7af154c3"),
      hasK => 1,
      k => pack("H*","98bef4061f3450b7fee635efe47016840ccf4aaffc0f33df64c21649977020cc"),
    },
    who => "a",
  },
)


### b read message from a
### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NN",
  initiator => 0,
  message_pattens => [["psk", "e"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","0d27d2d1c578d75a6c17579b8dcf74e910ace2ee9e92247cbdce7991a1e05655"),
    h  => pack("H*","19cc5936b038c10ed2dbc285bf8010a8cfac30f06f852fb43acebf50724c2af2"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NN",
  initiator => 0,
  message_pattens => [["psk", "e"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","0d27d2d1c578d75a6c17579b8dcf74e910ace2ee9e92247cbdce7991a1e05655"),
    h  => pack("H*","19cc5936b038c10ed2dbc285bf8010a8cfac30f06f852fb43acebf50724c2af2"),
  },
  who => "b",
}


### b recv msg from a
### b recv msg from a


### read message pattern: 'psk'
### read message pattern: 'psk'


### read message pattern: 'e'
### read message pattern: 'e'

### noise decrypt

### noise decrypt
### key: '85f834dfb25f33b73a55271309ade93bc5bbb2206ca4f4e078e6f03c66b19552'
### key: '85f834dfb25f33b73a55271309ade93bc5bbb2206ca4f4e078e6f03c66b19552'
### iv: '21feef71ed74ebd212b0f545'
### iv: '21feef71ed74ebd212b0f545'
### aad: 'c29782ed32ba6cb94f4efda9fb1d7c2c43372a82eec2a71b1e2b5f4b1f8c098a'
### aad: 'c29782ed32ba6cb94f4efda9fb1d7c2c43372a82eec2a71b1e2b5f4b1f8c098a'
### cipherinfo: '834a3136313637373137373850e2dd6afbcd43d389307e261c6d25c11648672cc61a51220201'
### cipherinfo: '834a3136313637373137373850e2dd6afbcd43d389307e261c6d25c11648672cc61a51220201'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '10c8de47da43dae52588f545'
### iv_xor: '10c8de47da43dae52588f545'
### authtag: 'e2dd6afbcd43d389307e261c6d25c116'
### authtag: 'e2dd6afbcd43d389307e261c6d25c116'
### ciphertext: '672cc61a51220201'
### ciphertext: '672cc61a51220201'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "NN",
    initiator => 0,
    message_pattens => [["psk", "e"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","02e0df6c9a1ec5d97d8d76865671c2fc95e691c2b31ba75c2d8280905386ccd859"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","e69df66d0eeb0c8912c98e3c3303425b13f993948386e1b69e4ab88439807dd4"),
      h => pack("H*","4a004331f66d415c6ddfc90081864b29f256225a96149f489d2868eb7af154c3"),
      hasK => 1,
      k => pack("H*","98bef4061f3450b7fee635efe47016840ccf4aaffc0f33df64c21649977020cc"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "NN",
    initiator => 0,
    message_pattens => [["psk", "e"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","02e0df6c9a1ec5d97d8d76865671c2fc95e691c2b31ba75c2d8280905386ccd859"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","e69df66d0eeb0c8912c98e3c3303425b13f993948386e1b69e4ab88439807dd4"),
      h => pack("H*","4a004331f66d415c6ddfc90081864b29f256225a96149f489d2868eb7af154c3"),
      hasK => 1,
      k => pack("H*","98bef4061f3450b7fee635efe47016840ccf4aaffc0f33df64c21649977020cc"),
    },
    who => "b",
  },
)


### b write_message to a
### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '02899d587cd6650e3e9aae754d16beb2d01d6d78aec5d17a4a3f0af8e7ec843a5e'

### public compressed: '02899d587cd6650e3e9aae754d16beb2d01d6d78aec5d17a4a3f0af8e7ec843a5e'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDE5sMCG5Er1vrnOgxh70R1iOH1RQuC5zE07y3c3IFJwoAoGCCqGSM49
',
###             'AwEHoUQDQgAEiZ1YfNZlDj6arnVNFr6y0B1teK7F0XpKPwr45+yEOl5AE0sz1D73
',
###             'NyY1ut8vb3LgN0lt5UAk5tGgUvl3XuyP+A==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDE5sMCG5Er1vrnOgxh70R1iOH1RQuC5zE07y3c3IFJwoAoGCCqGSM49
',
###             'AwEHoUQDQgAEiZ1YfNZlDj6arnVNFr6y0B1teK7F0XpKPwr45+yEOl5AE0sz1D73
',
###             'NyY1ut8vb3LgN0lt5UAk5tGgUvl3XuyP+A==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE4N9smh7F2X2NdoZWccL8leaRwrMb
',
###           'p1wtgoCQU4bM2Fm/oT0wJB4jSNUS65Ro4ID1l5iPSc0KqXQ8lGFY+k3L4A==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE4N9smh7F2X2NdoZWccL8leaRwrMb
',
###           'p1wtgoCQU4bM2Fm/oT0wJB4jSNUS65Ro4ID1l5iPSc0KqXQ8lGFY+k3L4A==
',
###           '-----END PUBLIC KEY-----
'
### z: '181fa49bdd4e06bcb647176873600ed836dcbcac5c51670048ff5fb175e48576'
### z: '181fa49bdd4e06bcb647176873600ed836dcbcac5c51670048ff5fb175e48576'

### noise encrypt

### noise encrypt
### key: '91f30844b81c6d975697621de4a4a0479028cfa36a0edc132b96845a7defe645'
### key: '91f30844b81c6d975697621de4a4a0479028cfa36a0edc132b96845a7defe645'
### iv: 'df9469bf90a4d5fb803a122d'
### iv: 'df9469bf90a4d5fb803a122d'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'eea25889a793e4ccb702122d'
### iv_xor: 'eea25889a793e4ccb702122d'
### aad: '837f8a47386b82da29a1d32970a7824ad75ae290e7e74235179b61337e3810f4'
### aad: '837f8a47386b82da29a1d32970a7824ad75ae290e7e74235179b61337e3810f4'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '621b5e8e4494d676'
### ciphertext: '621b5e8e4494d676'
### authtag: 'bdd56684aa34a230529acfebd80bf11b'
### authtag: 'bdd56684aa34a230529acfebd80bf11b'
### cipherinfo: '834a3136313637373137373850bdd56684aa34a230529acfebd80bf11b48621b5e8e4494d676'
### cipherinfo: '834a3136313637373137373850bdd56684aa34a230529acfebd80bf11b48621b5e8e4494d676'


### b_msg: '82582102899d587cd6650e3e9aae754d16beb2d01d6d78aec5d17a4a3f0af8e7ec843a5e5826834a3136313637373137373850bdd56684aa34a230529acfebd80bf11b48621b5e8e4494d676'
### b_msg: '82582102899d587cd6650e3e9aae754d16beb2d01d6d78aec5d17a4a3f0af8e7ec843a5e5826834a3136313637373137373850bdd56684aa34a230529acfebd80bf11b48621b5e8e4494d676'
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02899d587cd6650e3e9aae754d16beb2d01d6d78aec5d17a4a3f0af8e7ec843a5e"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 0,
    message_pattens => [["psk", "e"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","02e0df6c9a1ec5d97d8d76865671c2fc95e691c2b31ba75c2d8280905386ccd859"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","731088233b1d733ca3c8f89404ceb2e4b4f255a5cbff38b8a7628d7947c39c79"),
      h => pack("H*","6e602db3bd426d09a0a2616596f19c61709a4731a3d009d073f4ef9c4bb9ac85"),
      hasK => 1,
      k => pack("H*","226aea22380422bea25fa0ff19498ef5feeb755128447cab7614d91b83893605"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","f54b7a99f01346aeddfbc36d500267eff5970f8921b3bdc8a7bd8d40825d57a0"),
  },
  {
    hasK => 1,
    k => pack("H*","8b1b91f454dbb7d28609c3e3440edd79b85ad0beb0ccb67c64afd83ad9a3fee5"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02899d587cd6650e3e9aae754d16beb2d01d6d78aec5d17a4a3f0af8e7ec843a5e"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 0,
    message_pattens => [["psk", "e"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","02e0df6c9a1ec5d97d8d76865671c2fc95e691c2b31ba75c2d8280905386ccd859"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","731088233b1d733ca3c8f89404ceb2e4b4f255a5cbff38b8a7628d7947c39c79"),
      h => pack("H*","6e602db3bd426d09a0a2616596f19c61709a4731a3d009d073f4ef9c4bb9ac85"),
      hasK => 1,
      k => pack("H*","226aea22380422bea25fa0ff19498ef5feeb755128447cab7614d91b83893605"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","f54b7a99f01346aeddfbc36d500267eff5970f8921b3bdc8a7bd8d40825d57a0"),
  },
  {
    hasK => 1,
    k => pack("H*","8b1b91f454dbb7d28609c3e3440edd79b85ad0beb0ccb67c64afd83ad9a3fee5"),
  },
)

### a read_message from b

### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOsWcLVQyFpY7IVj3zvawsst1KOLssz1KOzyEmACoyAxoAoGCCqGSM49
',
###             'AwEHoUQDQgAE4N9smh7F2X2NdoZWccL8leaRwrMbp1wtgoCQU4bM2Fm/oT0wJB4j
',
###             'SNUS65Ro4ID1l5iPSc0KqXQ8lGFY+k3L4A==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOsWcLVQyFpY7IVj3zvawsst1KOLssz1KOzyEmACoyAxoAoGCCqGSM49
',
###             'AwEHoUQDQgAE4N9smh7F2X2NdoZWccL8leaRwrMbp1wtgoCQU4bM2Fm/oT0wJB4j
',
###             'SNUS65Ro4ID1l5iPSc0KqXQ8lGFY+k3L4A==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEiZ1YfNZlDj6arnVNFr6y0B1teK7F
',
###           '0XpKPwr45+yEOl5AE0sz1D73NyY1ut8vb3LgN0lt5UAk5tGgUvl3XuyP+A==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEiZ1YfNZlDj6arnVNFr6y0B1teK7F
',
###           '0XpKPwr45+yEOl5AE0sz1D73NyY1ut8vb3LgN0lt5UAk5tGgUvl3XuyP+A==
',
###           '-----END PUBLIC KEY-----
'
### z: '181fa49bdd4e06bcb647176873600ed836dcbcac5c51670048ff5fb175e48576'
### z: '181fa49bdd4e06bcb647176873600ed836dcbcac5c51670048ff5fb175e48576'

### noise decrypt

### noise decrypt
### key: '91f30844b81c6d975697621de4a4a0479028cfa36a0edc132b96845a7defe645'
### key: '91f30844b81c6d975697621de4a4a0479028cfa36a0edc132b96845a7defe645'
### iv: 'df9469bf90a4d5fb803a122d'
### iv: 'df9469bf90a4d5fb803a122d'
### aad: '837f8a47386b82da29a1d32970a7824ad75ae290e7e74235179b61337e3810f4'
### aad: '837f8a47386b82da29a1d32970a7824ad75ae290e7e74235179b61337e3810f4'
### cipherinfo: '834a3136313637373137373850bdd56684aa34a230529acfebd80bf11b48621b5e8e4494d676'
### cipherinfo: '834a3136313637373137373850bdd56684aa34a230529acfebd80bf11b48621b5e8e4494d676'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'eea25889a793e4ccb702122d'
### iv_xor: 'eea25889a793e4ccb702122d'
### authtag: 'bdd56684aa34a230529acfebd80bf11b'
### authtag: 'bdd56684aa34a230529acfebd80bf11b'
### ciphertext: '621b5e8e4494d676'
### ciphertext: '621b5e8e4494d676'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02e0df6c9a1ec5d97d8d76865671c2fc95e691c2b31ba75c2d8280905386ccd859"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 1,
    message_pattens => [["psk", "e"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","02899d587cd6650e3e9aae754d16beb2d01d6d78aec5d17a4a3f0af8e7ec843a5e"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","731088233b1d733ca3c8f89404ceb2e4b4f255a5cbff38b8a7628d7947c39c79"),
      h => pack("H*","6e602db3bd426d09a0a2616596f19c61709a4731a3d009d073f4ef9c4bb9ac85"),
      hasK => 1,
      k => pack("H*","226aea22380422bea25fa0ff19498ef5feeb755128447cab7614d91b83893605"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","f54b7a99f01346aeddfbc36d500267eff5970f8921b3bdc8a7bd8d40825d57a0"),
  },
  {
    hasK => 1,
    k => pack("H*","8b1b91f454dbb7d28609c3e3440edd79b85ad0beb0ccb67c64afd83ad9a3fee5"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02e0df6c9a1ec5d97d8d76865671c2fc95e691c2b31ba75c2d8280905386ccd859"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 1,
    message_pattens => [["psk", "e"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","02899d587cd6650e3e9aae754d16beb2d01d6d78aec5d17a4a3f0af8e7ec843a5e"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","731088233b1d733ca3c8f89404ceb2e4b4f255a5cbff38b8a7628d7947c39c79"),
      h => pack("H*","6e602db3bd426d09a0a2616596f19c61709a4731a3d009d073f4ef9c4bb9ac85"),
      hasK => 1,
      k => pack("H*","226aea22380422bea25fa0ff19498ef5feeb755128447cab7614d91b83893605"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","f54b7a99f01346aeddfbc36d500267eff5970f8921b3bdc8a7bd8d40825d57a0"),
  },
  {
    hasK => 1,
    k => pack("H*","8b1b91f454dbb7d28609c3e3440edd79b85ad0beb0ccb67c64afd83ad9a3fee5"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: 'a2f17dbc8b6e98bf45dca9b4bedc49fa8e11db335848be6ef70ff79f96f9eb9b'
### key: 'a2f17dbc8b6e98bf45dca9b4bedc49fa8e11db335848be6ef70ff79f96f9eb9b'
### iv: '63574bb2c093a3a55f538c41'
### iv: '63574bb2c093a3a55f538c41'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '52617a84f7a49292686b8c41'
### iv_xor: '52617a84f7a49292686b8c41'
### aad: '6e602db3bd426d09a0a2616596f19c61709a4731a3d009d073f4ef9c4bb9ac85'
### aad: '6e602db3bd426d09a0a2616596f19c61709a4731a3d009d073f4ef9c4bb9ac85'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '947a92d51eff31be7b5cb190449d73e34b47b836f395f1e84fa379dfac08390ebe9084be4d4092abdff56fc10e922bfd12ebc9'
### ciphertext: '947a92d51eff31be7b5cb190449d73e34b47b836f395f1e84fa379dfac08390ebe9084be4d4092abdff56fc10e922bfd12ebc9'
### authtag: 'e14a7e737989ddeef02477f61afc0aa1'
### authtag: 'e14a7e737989ddeef02477f61afc0aa1'
### cipherinfo: '834a3136313637373137373850e14a7e737989ddeef02477f61afc0aa15833947a92d51eff31be7b5cb190449d73e34b47b836f395f1e84fa379dfac08390ebe9084be4d4092abdff56fc10e922bfd12ebc9'
### cipherinfo: '834a3136313637373137373850e14a7e737989ddeef02477f61afc0aa15833947a92d51eff31be7b5cb190449d73e34b47b836f395f1e84fa379dfac08390ebe9084be4d4092abdff56fc10e922bfd12ebc9'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: 'a2f17dbc8b6e98bf45dca9b4bedc49fa8e11db335848be6ef70ff79f96f9eb9b'
### key: 'a2f17dbc8b6e98bf45dca9b4bedc49fa8e11db335848be6ef70ff79f96f9eb9b'
### iv: '63574bb2c093a3a55f538c41'
### iv: '63574bb2c093a3a55f538c41'
### aad: '6e602db3bd426d09a0a2616596f19c61709a4731a3d009d073f4ef9c4bb9ac85'
### aad: '6e602db3bd426d09a0a2616596f19c61709a4731a3d009d073f4ef9c4bb9ac85'
### cipherinfo: '834a3136313637373137373850e14a7e737989ddeef02477f61afc0aa15833947a92d51eff31be7b5cb190449d73e34b47b836f395f1e84fa379dfac08390ebe9084be4d4092abdff56fc10e922bfd12ebc9'
### cipherinfo: '834a3136313637373137373850e14a7e737989ddeef02477f61afc0aa15833947a92d51eff31be7b5cb190449d73e34b47b836f395f1e84fa379dfac08390ebe9084be4d4092abdff56fc10e922bfd12ebc9'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '52617a84f7a49292686b8c41'
### iv_xor: '52617a84f7a49292686b8c41'
### authtag: 'e14a7e737989ddeef02477f61afc0aa1'
### authtag: 'e14a7e737989ddeef02477f61afc0aa1'
### ciphertext: '947a92d51eff31be7b5cb190449d73e34b47b836f395f1e84fa379dfac08390ebe9084be4d4092abdff56fc10e922bfd12ebc9'
### ciphertext: '947a92d51eff31be7b5cb190449d73e34b47b836f395f1e84fa379dfac08390ebe9084be4d4092abdff56fc10e922bfd12ebc9'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '4a1a10898d76907e89fd2b43f81942679ad93dc6ae239c4c68276d8284466ad3'
### key: '4a1a10898d76907e89fd2b43f81942679ad93dc6ae239c4c68276d8284466ad3'
### iv: '5f81de8ff69ef6942e7220c3'
### iv: '5f81de8ff69ef6942e7220c3'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '6eb7efb9c1a9c7a3194a20c3'
### iv_xor: '6eb7efb9c1a9c7a3194a20c3'
### aad: '6e602db3bd426d09a0a2616596f19c61709a4731a3d009d073f4ef9c4bb9ac85'
### aad: '6e602db3bd426d09a0a2616596f19c61709a4731a3d009d073f4ef9c4bb9ac85'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'abda93b850878f6c32c01482ea2e0efa7ae329a18f2fa9262ee15d35a503579e28ab9daf0c3a154363a05ccf574acd'
### ciphertext: 'abda93b850878f6c32c01482ea2e0efa7ae329a18f2fa9262ee15d35a503579e28ab9daf0c3a154363a05ccf574acd'
### authtag: 'cc4ca2ff770a13f937c8244fb70c5d85'
### authtag: 'cc4ca2ff770a13f937c8244fb70c5d85'
### cipherinfo: '834a3136313637373137373850cc4ca2ff770a13f937c8244fb70c5d85582fabda93b850878f6c32c01482ea2e0efa7ae329a18f2fa9262ee15d35a503579e28ab9daf0c3a154363a05ccf574acd'
### cipherinfo: '834a3136313637373137373850cc4ca2ff770a13f937c8244fb70c5d85582fabda93b850878f6c32c01482ea2e0efa7ae329a18f2fa9262ee15d35a503579e28ab9daf0c3a154363a05ccf574acd'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '4a1a10898d76907e89fd2b43f81942679ad93dc6ae239c4c68276d8284466ad3'
### key: '4a1a10898d76907e89fd2b43f81942679ad93dc6ae239c4c68276d8284466ad3'
### iv: '5f81de8ff69ef6942e7220c3'
### iv: '5f81de8ff69ef6942e7220c3'
### aad: '6e602db3bd426d09a0a2616596f19c61709a4731a3d009d073f4ef9c4bb9ac85'
### aad: '6e602db3bd426d09a0a2616596f19c61709a4731a3d009d073f4ef9c4bb9ac85'
### cipherinfo: '834a3136313637373137373850cc4ca2ff770a13f937c8244fb70c5d85582fabda93b850878f6c32c01482ea2e0efa7ae329a18f2fa9262ee15d35a503579e28ab9daf0c3a154363a05ccf574acd'
### cipherinfo: '834a3136313637373137373850cc4ca2ff770a13f937c8244fb70c5d85582fabda93b850878f6c32c01482ea2e0efa7ae329a18f2fa9262ee15d35a503579e28ab9daf0c3a154363a05ccf574acd'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '6eb7efb9c1a9c7a3194a20c3'
### iv_xor: '6eb7efb9c1a9c7a3194a20c3'
### authtag: 'cc4ca2ff770a13f937c8244fb70c5d85'
### authtag: 'cc4ca2ff770a13f937c8244fb70c5d85'
### ciphertext: 'abda93b850878f6c32c01482ea2e0efa7ae329a18f2fa9262ee15d35a503579e28ab9daf0c3a154363a05ccf574acd'
### ciphertext: 'abda93b850878f6c32c01482ea2e0efa7ae329a18f2fa9262ee15d35a503579e28ab9daf0c3a154363a05ccf574acd'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'NN',
###                               'test_psk',
###                               0

### -----------end test --------: 'NN',
###                               'test_psk',
###                               0

### -----------start test --------: 'NN',
###                                 'test_psk',
###                                 1

### -----------start test --------: 'NN',
###                                 'test_psk',
###                                 1

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NN",
  initiator => 1,
  message_pattens => [["e", "psk"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","47090b38845a0d67cbb1b640692d4c76dac6740b73514aea75b9f23d74422b45"),
    h  => pack("H*","a2d5b771d00c5e5cc1f14ef2c562ac705eb314c235eb67e7360accf9f770cebd"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NN",
  initiator => 1,
  message_pattens => [["e", "psk"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","47090b38845a0d67cbb1b640692d4c76dac6740b73514aea75b9f23d74422b45"),
    h  => pack("H*","a2d5b771d00c5e5cc1f14ef2c562ac705eb314c235eb67e7360accf9f770cebd"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '036fdede46f4cc15e1a095f7f05def3e1efed32cc4f9615267f5570ab089db68f8'

### public compressed: '036fdede46f4cc15e1a095f7f05def3e1efed32cc4f9615267f5570ab089db68f8'

### write message pattern: 'psk'

### write message pattern: 'psk'

### noise encrypt

### noise encrypt
### key: '9a64010d2a9ad816d5e0317b1a55e6ca8c75e5b0397712a3c6fb92b5dab846f8'
### key: '9a64010d2a9ad816d5e0317b1a55e6ca8c75e5b0397712a3c6fb92b5dab846f8'
### iv: '218977dd27de16269773885b'
### iv: '218977dd27de16269773885b'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '10bf46eb10e92711a04b885b'
### iv_xor: '10bf46eb10e92711a04b885b'
### aad: '32525e97fd98a4aea7353d879b94c185e359872309d19473ec7608b1893c2675'
### aad: '32525e97fd98a4aea7353d879b94c185e359872309d19473ec7608b1893c2675'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '25de322b02a9de17'
### ciphertext: '25de322b02a9de17'
### authtag: '3fbc1dd04642976ad468e080f9442296'
### authtag: '3fbc1dd04642976ad468e080f9442296'
### cipherinfo: '834a31363136373731373738503fbc1dd04642976ad468e080f94422964825de322b02a9de17'
### cipherinfo: '834a31363136373731373738503fbc1dd04642976ad468e080f94422964825de322b02a9de17'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA2/e3kb0zBXhoJX38F3vPh7+0yzE+WFSZ/VXCrCJ22j4WCaDSjE2MTY3NzE3NzhQP7wd0EZCl2rUaOCA+UQilkgl3jIrAqneFw=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA2/e3kb0zBXhoJX38F3vPh7+0yzE+WFSZ/VXCrCJ22j4WCaDSjE2MTY3NzE3NzhQP7wd0EZCl2rUaOCA+UQilkgl3jIrAqneFw=="),
  );
}
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","036fdede46f4cc15e1a095f7f05def3e1efed32cc4f9615267f5570ab089db68f8"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 1,
    message_pattens => [["e", "psk"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","162b8c4f9498e99a50bf4f046480c14c306d9b07cbc4319f5015142f88f2986e"),
      h => pack("H*","5d20ea24b052596146a94faa9936890b879c399b1653204a5eef9c64284a009e"),
      hasK => 1,
      k => pack("H*","1ddb83d9692579e3d4bd90f3cba7a505a8c35c87a5b6b54026a0afac651fa271"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","036fdede46f4cc15e1a095f7f05def3e1efed32cc4f9615267f5570ab089db68f8"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 1,
    message_pattens => [["e", "psk"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","162b8c4f9498e99a50bf4f046480c14c306d9b07cbc4319f5015142f88f2986e"),
      h => pack("H*","5d20ea24b052596146a94faa9936890b879c399b1653204a5eef9c64284a009e"),
      hasK => 1,
      k => pack("H*","1ddb83d9692579e3d4bd90f3cba7a505a8c35c87a5b6b54026a0afac651fa271"),
    },
    who => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NN",
  initiator => 0,
  message_pattens => [["e", "psk"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","47090b38845a0d67cbb1b640692d4c76dac6740b73514aea75b9f23d74422b45"),
    h  => pack("H*","a2d5b771d00c5e5cc1f14ef2c562ac705eb314c235eb67e7360accf9f770cebd"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NN",
  initiator => 0,
  message_pattens => [["e", "psk"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","47090b38845a0d67cbb1b640692d4c76dac6740b73514aea75b9f23d74422b45"),
    h  => pack("H*","a2d5b771d00c5e5cc1f14ef2c562ac705eb314c235eb67e7360accf9f770cebd"),
  },
  who => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'psk'

### read message pattern: 'psk'

### noise decrypt

### noise decrypt
### key: '9a64010d2a9ad816d5e0317b1a55e6ca8c75e5b0397712a3c6fb92b5dab846f8'
### key: '9a64010d2a9ad816d5e0317b1a55e6ca8c75e5b0397712a3c6fb92b5dab846f8'
### iv: '218977dd27de16269773885b'
### iv: '218977dd27de16269773885b'
### aad: '32525e97fd98a4aea7353d879b94c185e359872309d19473ec7608b1893c2675'
### aad: '32525e97fd98a4aea7353d879b94c185e359872309d19473ec7608b1893c2675'
### cipherinfo: '834a31363136373731373738503fbc1dd04642976ad468e080f94422964825de322b02a9de17'
### cipherinfo: '834a31363136373731373738503fbc1dd04642976ad468e080f94422964825de322b02a9de17'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '10bf46eb10e92711a04b885b'
### iv_xor: '10bf46eb10e92711a04b885b'
### authtag: '3fbc1dd04642976ad468e080f9442296'
### authtag: '3fbc1dd04642976ad468e080f9442296'
### ciphertext: '25de322b02a9de17'
### ciphertext: '25de322b02a9de17'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "NN",
    initiator => 0,
    message_pattens => [["e", "psk"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","036fdede46f4cc15e1a095f7f05def3e1efed32cc4f9615267f5570ab089db68f8"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","162b8c4f9498e99a50bf4f046480c14c306d9b07cbc4319f5015142f88f2986e"),
      h => pack("H*","5d20ea24b052596146a94faa9936890b879c399b1653204a5eef9c64284a009e"),
      hasK => 1,
      k => pack("H*","1ddb83d9692579e3d4bd90f3cba7a505a8c35c87a5b6b54026a0afac651fa271"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "NN",
    initiator => 0,
    message_pattens => [["e", "psk"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","036fdede46f4cc15e1a095f7f05def3e1efed32cc4f9615267f5570ab089db68f8"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","162b8c4f9498e99a50bf4f046480c14c306d9b07cbc4319f5015142f88f2986e"),
      h => pack("H*","5d20ea24b052596146a94faa9936890b879c399b1653204a5eef9c64284a009e"),
      hasK => 1,
      k => pack("H*","1ddb83d9692579e3d4bd90f3cba7a505a8c35c87a5b6b54026a0afac651fa271"),
    },
    who => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '037ba5e0089df065c0be4e474315a80c5ed65bdf8c5404cde0653ff6101ee3f7ff'

### public compressed: '037ba5e0089df065c0be4e474315a80c5ed65bdf8c5404cde0653ff6101ee3f7ff'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIJ7exspBAnW6UH3KHDl55OEaTah7HBfZRLRcDQMUYeDVoAoGCCqGSM49
',
###             'AwEHoUQDQgAEe6XgCJ3wZcC+TkdDFagMXtZb34xUBM3gZT/2EB7j9//j8sAO1mWr
',
###             '/YEKuy1W/uqb2vt1VXkT7Phl5+kInZrcsQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIJ7exspBAnW6UH3KHDl55OEaTah7HBfZRLRcDQMUYeDVoAoGCCqGSM49
',
###             'AwEHoUQDQgAEe6XgCJ3wZcC+TkdDFagMXtZb34xUBM3gZT/2EB7j9//j8sAO1mWr
',
###             '/YEKuy1W/uqb2vt1VXkT7Phl5+kInZrcsQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEb97eRvTMFeGglffwXe8+Hv7TLMT5
',
###           'YVJn9VcKsInbaPipNcRQn/YUaybe0nK1fZwe5smHhX1SvcZOM39Fghr4Ow==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEb97eRvTMFeGglffwXe8+Hv7TLMT5
',
###           'YVJn9VcKsInbaPipNcRQn/YUaybe0nK1fZwe5smHhX1SvcZOM39Fghr4Ow==
',
###           '-----END PUBLIC KEY-----
'
### z: '9f9072871309da071d8c0b1e8dc556931d271b22360d159d3ff77a59790fe3d7'
### z: '9f9072871309da071d8c0b1e8dc556931d271b22360d159d3ff77a59790fe3d7'

### noise encrypt

### noise encrypt
### key: 'a82e177f9a0bfc87d44913e5a8f1574bb32f7b2ecfa5eabf28b62a303bde9b8c'
### key: 'a82e177f9a0bfc87d44913e5a8f1574bb32f7b2ecfa5eabf28b62a303bde9b8c'
### iv: 'b1f1234be1e4e9e7180756c3'
### iv: 'b1f1234be1e4e9e7180756c3'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '80c7127dd6d3d8d02f3f56c3'
### iv_xor: '80c7127dd6d3d8d02f3f56c3'
### aad: '24626236a42f049c2f193fe0adb428a323cf09c0da5b9a014b9cf441b482a49b'
### aad: '24626236a42f049c2f193fe0adb428a323cf09c0da5b9a014b9cf441b482a49b'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '4df671db2938bd53'
### ciphertext: '4df671db2938bd53'
### authtag: '87925509c925b819e26bcefba5c3bc74'
### authtag: '87925509c925b819e26bcefba5c3bc74'
### cipherinfo: '834a313631363737313737385087925509c925b819e26bcefba5c3bc74484df671db2938bd53'
### cipherinfo: '834a313631363737313737385087925509c925b819e26bcefba5c3bc74484df671db2938bd53'

### b_msg: '825821037ba5e0089df065c0be4e474315a80c5ed65bdf8c5404cde0653ff6101ee3f7ff5826834a313631363737313737385087925509c925b819e26bcefba5c3bc74484df671db2938bd53'

### b_msg: '825821037ba5e0089df065c0be4e474315a80c5ed65bdf8c5404cde0653ff6101ee3f7ff5826834a313631363737313737385087925509c925b819e26bcefba5c3bc74484df671db2938bd53'
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","037ba5e0089df065c0be4e474315a80c5ed65bdf8c5404cde0653ff6101ee3f7ff"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 0,
    message_pattens => [["e", "psk"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","036fdede46f4cc15e1a095f7f05def3e1efed32cc4f9615267f5570ab089db68f8"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","32cd1cf1339ea0ea21e7691f36b782a6a9f6fc17c15490d76361e4e4ce6e8ff0"),
      h => pack("H*","e362a1d1d4be120c54cbefed2bd0045d09052f2a289299945779df4f1def3952"),
      hasK => 1,
      k => pack("H*","192850237410183f33bd482ec13bb7f0dc9e38a78a21cf4fb680816392043947"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","680d4093cbe0fbb8be349ca52f127f53bf0a2dcaf5d7e9b98417aab67f00cd41"),
  },
  {
    hasK => 1,
    k => pack("H*","ad098f135cef641309b4412dda1d8b616f68b3f6bfa4d568c299f34f0b79103e"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","037ba5e0089df065c0be4e474315a80c5ed65bdf8c5404cde0653ff6101ee3f7ff"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 0,
    message_pattens => [["e", "psk"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","036fdede46f4cc15e1a095f7f05def3e1efed32cc4f9615267f5570ab089db68f8"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","32cd1cf1339ea0ea21e7691f36b782a6a9f6fc17c15490d76361e4e4ce6e8ff0"),
      h => pack("H*","e362a1d1d4be120c54cbefed2bd0045d09052f2a289299945779df4f1def3952"),
      hasK => 1,
      k => pack("H*","192850237410183f33bd482ec13bb7f0dc9e38a78a21cf4fb680816392043947"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","680d4093cbe0fbb8be349ca52f127f53bf0a2dcaf5d7e9b98417aab67f00cd41"),
  },
  {
    hasK => 1,
    k => pack("H*","ad098f135cef641309b4412dda1d8b616f68b3f6bfa4d568c299f34f0b79103e"),
  },
)

### a read_message from b

### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOtWlvxvYydFm4X7FLboJ9tQJJ+VnvXHSspjyupHabk4oAoGCCqGSM49
',
###             'AwEHoUQDQgAEb97eRvTMFeGglffwXe8+Hv7TLMT5YVJn9VcKsInbaPipNcRQn/YU
',
###             'aybe0nK1fZwe5smHhX1SvcZOM39Fghr4Ow==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOtWlvxvYydFm4X7FLboJ9tQJJ+VnvXHSspjyupHabk4oAoGCCqGSM49
',
###             'AwEHoUQDQgAEb97eRvTMFeGglffwXe8+Hv7TLMT5YVJn9VcKsInbaPipNcRQn/YU
',
###             'aybe0nK1fZwe5smHhX1SvcZOM39Fghr4Ow==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEe6XgCJ3wZcC+TkdDFagMXtZb34xU
',
###           'BM3gZT/2EB7j9//j8sAO1mWr/YEKuy1W/uqb2vt1VXkT7Phl5+kInZrcsQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEe6XgCJ3wZcC+TkdDFagMXtZb34xU
',
###           'BM3gZT/2EB7j9//j8sAO1mWr/YEKuy1W/uqb2vt1VXkT7Phl5+kInZrcsQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '9f9072871309da071d8c0b1e8dc556931d271b22360d159d3ff77a59790fe3d7'
### z: '9f9072871309da071d8c0b1e8dc556931d271b22360d159d3ff77a59790fe3d7'

### noise decrypt

### noise decrypt
### key: 'a82e177f9a0bfc87d44913e5a8f1574bb32f7b2ecfa5eabf28b62a303bde9b8c'
### key: 'a82e177f9a0bfc87d44913e5a8f1574bb32f7b2ecfa5eabf28b62a303bde9b8c'
### iv: 'b1f1234be1e4e9e7180756c3'
### iv: 'b1f1234be1e4e9e7180756c3'
### aad: '24626236a42f049c2f193fe0adb428a323cf09c0da5b9a014b9cf441b482a49b'
### aad: '24626236a42f049c2f193fe0adb428a323cf09c0da5b9a014b9cf441b482a49b'
### cipherinfo: '834a313631363737313737385087925509c925b819e26bcefba5c3bc74484df671db2938bd53'
### cipherinfo: '834a313631363737313737385087925509c925b819e26bcefba5c3bc74484df671db2938bd53'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '80c7127dd6d3d8d02f3f56c3'
### iv_xor: '80c7127dd6d3d8d02f3f56c3'
### authtag: '87925509c925b819e26bcefba5c3bc74'
### authtag: '87925509c925b819e26bcefba5c3bc74'
### ciphertext: '4df671db2938bd53'
### ciphertext: '4df671db2938bd53'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","036fdede46f4cc15e1a095f7f05def3e1efed32cc4f9615267f5570ab089db68f8"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 1,
    message_pattens => [["e", "psk"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","037ba5e0089df065c0be4e474315a80c5ed65bdf8c5404cde0653ff6101ee3f7ff"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","32cd1cf1339ea0ea21e7691f36b782a6a9f6fc17c15490d76361e4e4ce6e8ff0"),
      h => pack("H*","e362a1d1d4be120c54cbefed2bd0045d09052f2a289299945779df4f1def3952"),
      hasK => 1,
      k => pack("H*","192850237410183f33bd482ec13bb7f0dc9e38a78a21cf4fb680816392043947"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","680d4093cbe0fbb8be349ca52f127f53bf0a2dcaf5d7e9b98417aab67f00cd41"),
  },
  {
    hasK => 1,
    k => pack("H*","ad098f135cef641309b4412dda1d8b616f68b3f6bfa4d568c299f34f0b79103e"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","036fdede46f4cc15e1a095f7f05def3e1efed32cc4f9615267f5570ab089db68f8"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    initiator => 1,
    message_pattens => [["e", "psk"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","037ba5e0089df065c0be4e474315a80c5ed65bdf8c5404cde0653ff6101ee3f7ff"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","32cd1cf1339ea0ea21e7691f36b782a6a9f6fc17c15490d76361e4e4ce6e8ff0"),
      h => pack("H*","e362a1d1d4be120c54cbefed2bd0045d09052f2a289299945779df4f1def3952"),
      hasK => 1,
      k => pack("H*","192850237410183f33bd482ec13bb7f0dc9e38a78a21cf4fb680816392043947"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","680d4093cbe0fbb8be349ca52f127f53bf0a2dcaf5d7e9b98417aab67f00cd41"),
  },
  {
    hasK => 1,
    k => pack("H*","ad098f135cef641309b4412dda1d8b616f68b3f6bfa4d568c299f34f0b79103e"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '0f5fdd36be5298a6126e48dc4e1fa5f5d69339d981a309345dd2cd46ca9e9b18'
### key: '0f5fdd36be5298a6126e48dc4e1fa5f5d69339d981a309345dd2cd46ca9e9b18'
### iv: '4e47176c02074f40de42c028'
### iv: '4e47176c02074f40de42c028'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '7f71265a35307e77e97ac028'
### iv_xor: '7f71265a35307e77e97ac028'
### aad: 'e362a1d1d4be120c54cbefed2bd0045d09052f2a289299945779df4f1def3952'
### aad: 'e362a1d1d4be120c54cbefed2bd0045d09052f2a289299945779df4f1def3952'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '55e9217845709869c27ec8cf6d335f878a413f5dcab34897af38341bf1dedbb55e716f9bea9f8db29f630645709409b827707e'
### ciphertext: '55e9217845709869c27ec8cf6d335f878a413f5dcab34897af38341bf1dedbb55e716f9bea9f8db29f630645709409b827707e'
### authtag: '5d1fb886a249c4ccdab65569cc498ace'
### authtag: '5d1fb886a249c4ccdab65569cc498ace'
### cipherinfo: '834a31363136373731373738505d1fb886a249c4ccdab65569cc498ace583355e9217845709869c27ec8cf6d335f878a413f5dcab34897af38341bf1dedbb55e716f9bea9f8db29f630645709409b827707e'
### cipherinfo: '834a31363136373731373738505d1fb886a249c4ccdab65569cc498ace583355e9217845709869c27ec8cf6d335f878a413f5dcab34897af38341bf1dedbb55e716f9bea9f8db29f630645709409b827707e'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '0f5fdd36be5298a6126e48dc4e1fa5f5d69339d981a309345dd2cd46ca9e9b18'
### key: '0f5fdd36be5298a6126e48dc4e1fa5f5d69339d981a309345dd2cd46ca9e9b18'
### iv: '4e47176c02074f40de42c028'
### iv: '4e47176c02074f40de42c028'
### aad: 'e362a1d1d4be120c54cbefed2bd0045d09052f2a289299945779df4f1def3952'
### aad: 'e362a1d1d4be120c54cbefed2bd0045d09052f2a289299945779df4f1def3952'
### cipherinfo: '834a31363136373731373738505d1fb886a249c4ccdab65569cc498ace583355e9217845709869c27ec8cf6d335f878a413f5dcab34897af38341bf1dedbb55e716f9bea9f8db29f630645709409b827707e'
### cipherinfo: '834a31363136373731373738505d1fb886a249c4ccdab65569cc498ace583355e9217845709869c27ec8cf6d335f878a413f5dcab34897af38341bf1dedbb55e716f9bea9f8db29f630645709409b827707e'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '7f71265a35307e77e97ac028'
### iv_xor: '7f71265a35307e77e97ac028'
### authtag: '5d1fb886a249c4ccdab65569cc498ace'
### authtag: '5d1fb886a249c4ccdab65569cc498ace'
### ciphertext: '55e9217845709869c27ec8cf6d335f878a413f5dcab34897af38341bf1dedbb55e716f9bea9f8db29f630645709409b827707e'
### ciphertext: '55e9217845709869c27ec8cf6d335f878a413f5dcab34897af38341bf1dedbb55e716f9bea9f8db29f630645709409b827707e'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a


### noise encrypt
### noise encrypt
### key: '94dfc46b175c1abff9c7d8c29948b32b32ebd8b2eda3653185abd6479a7028a9'
### key: '94dfc46b175c1abff9c7d8c29948b32b32ebd8b2eda3653185abd6479a7028a9'
### iv: '88395f42ffbfaa0ff4611c2d'
### iv: '88395f42ffbfaa0ff4611c2d'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'b90f6e74c8889b38c3591c2d'
### iv_xor: 'b90f6e74c8889b38c3591c2d'
### aad: 'e362a1d1d4be120c54cbefed2bd0045d09052f2a289299945779df4f1def3952'
### aad: 'e362a1d1d4be120c54cbefed2bd0045d09052f2a289299945779df4f1def3952'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '8457e95411742b2a389270dcdc680e97abf5c8d1bf42fa69abec897ae90cf8c013c110fb65566aad588e2841cef41d'
### ciphertext: '8457e95411742b2a389270dcdc680e97abf5c8d1bf42fa69abec897ae90cf8c013c110fb65566aad588e2841cef41d'
### authtag: 'b382d5fbabb278c597081e399b7605c8'
### authtag: 'b382d5fbabb278c597081e399b7605c8'
### cipherinfo: '834a3136313637373137373850b382d5fbabb278c597081e399b7605c8582f8457e95411742b2a389270dcdc680e97abf5c8d1bf42fa69abec897ae90cf8c013c110fb65566aad588e2841cef41d'
### cipherinfo: '834a3136313637373137373850b382d5fbabb278c597081e399b7605c8582f8457e95411742b2a389270dcdc680e97abf5c8d1bf42fa69abec897ae90cf8c013c110fb65566aad588e2841cef41d'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '94dfc46b175c1abff9c7d8c29948b32b32ebd8b2eda3653185abd6479a7028a9'
### key: '94dfc46b175c1abff9c7d8c29948b32b32ebd8b2eda3653185abd6479a7028a9'
### iv: '88395f42ffbfaa0ff4611c2d'
### iv: '88395f42ffbfaa0ff4611c2d'
### aad: 'e362a1d1d4be120c54cbefed2bd0045d09052f2a289299945779df4f1def3952'
### aad: 'e362a1d1d4be120c54cbefed2bd0045d09052f2a289299945779df4f1def3952'
### cipherinfo: '834a3136313637373137373850b382d5fbabb278c597081e399b7605c8582f8457e95411742b2a389270dcdc680e97abf5c8d1bf42fa69abec897ae90cf8c013c110fb65566aad588e2841cef41d'
### cipherinfo: '834a3136313637373137373850b382d5fbabb278c597081e399b7605c8582f8457e95411742b2a389270dcdc680e97abf5c8d1bf42fa69abec897ae90cf8c013c110fb65566aad588e2841cef41d'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'b90f6e74c8889b38c3591c2d'
### iv_xor: 'b90f6e74c8889b38c3591c2d'
### authtag: 'b382d5fbabb278c597081e399b7605c8'
### authtag: 'b382d5fbabb278c597081e399b7605c8'
### ciphertext: '8457e95411742b2a389270dcdc680e97abf5c8d1bf42fa69abec897ae90cf8c013c110fb65566aad588e2841cef41d'
### ciphertext: '8457e95411742b2a389270dcdc680e97abf5c8d1bf42fa69abec897ae90cf8c013c110fb65566aad588e2841cef41d'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'NN',
###                               'test_psk',
###                               1

### -----------end test --------: 'NN',
###                               'test_psk',
###                               1

### -----------start test --------: 'NK',
###                                 undef,
###                                 undef

### -----------start test --------: 'NK',
###                                 undef,
###                                 undef


### a write message to b
### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NK",
  initiator => 1,
  message_pattens => [["e", "es"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => "Noise_NK_secp256r1_AESGCM_SHA256",
    h  => pack("H*","2ae14458ce54aa7003e70975f58e8a41e2e7ce1fb61df64492c4a0d77ce4da98"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NK",
  initiator => 1,
  message_pattens => [["e", "es"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => "Noise_NK_secp256r1_AESGCM_SHA256",
    h  => pack("H*","2ae14458ce54aa7003e70975f58e8a41e2e7ce1fb61df64492c4a0d77ce4da98"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '03c0216213c6af39d6e55100c0f0b259c7f7bc5611759546e05fdfd92124eebf0c'

### public compressed: '03c0216213c6af39d6e55100c0f0b259c7f7bc5611759546e05fdfd92124eebf0c'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMjabyqBJgmXe49NCfN7DqAsj6RwzTS8NRQA0Z/1JZ9UoAoGCCqGSM49
',
###             'AwEHoUQDQgAEwCFiE8avOdblUQDA8LJZx/e8VhF1lUbgX9/ZISTuvwx2xjI4pqdV
',
###             'v1Go6a0GzOAOlEreiJrdCgDeiKjCz0j7kQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMjabyqBJgmXe49NCfN7DqAsj6RwzTS8NRQA0Z/1JZ9UoAoGCCqGSM49
',
###             'AwEHoUQDQgAEwCFiE8avOdblUQDA8LJZx/e8VhF1lUbgX9/ZISTuvwx2xjI4pqdV
',
###             'v1Go6a0GzOAOlEreiJrdCgDeiKjCz0j7kQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'a4385606b3791b251dc490583a80d580c443c2c7cf8d1f004bb07e5f9f49265c'
### z: 'a4385606b3791b251dc490583a80d580c443c2c7cf8d1f004bb07e5f9f49265c'


### noise encrypt
### noise encrypt
### key: '9f35c654098754154fcc4abfec08fefe0648b5da3337f58b25bc8d57c1a9a79b'
### key: '9f35c654098754154fcc4abfec08fefe0648b5da3337f58b25bc8d57c1a9a79b'
### iv: '1d63147631588d9fbb12b1de'
### iv: '1d63147631588d9fbb12b1de'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '2c552540066fbca88c2ab1de'
### iv_xor: '2c552540066fbca88c2ab1de'
### aad: '116b24e438ddc4aafc4cd5c145761be82074f948c9d45c9777c81b039336afb2'
### aad: '116b24e438ddc4aafc4cd5c145761be82074f948c9d45c9777c81b039336afb2'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: 'fc1132e83d7ae56a'
### ciphertext: 'fc1132e83d7ae56a'
### authtag: 'c21babf612cbc29e1b2efb82ed09d139'
### authtag: 'c21babf612cbc29e1b2efb82ed09d139'
### cipherinfo: '834a3136313637373137373850c21babf612cbc29e1b2efb82ed09d13948fc1132e83d7ae56a'
### cipherinfo: '834a3136313637373137373850c21babf612cbc29e1b2efb82ed09d13948fc1132e83d7ae56a'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA8AhYhPGrznW5VEAwPCyWcf3vFYRdZVG4F/f2SEk7r8MWCaDSjE2MTY3NzE3NzhQwhur9hLLwp4bLvuC7QnROUj8ETLoPXrlag=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA8AhYhPGrznW5VEAwPCyWcf3vFYRdZVG4F/f2SEk7r8MWCaDSjE2MTY3NzE3NzhQwhur9hLLwp4bLvuC7QnROUj8ETLoPXrlag=="),
  );
}
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03c0216213c6af39d6e55100c0f0b259c7f7bc5611759546e05fdfd92124eebf0c"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 1,
    message_pattens => [["e", "es"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","7b67ee877a3dcbe215b0233cfa92609b87c985eef612156235d4325ce993a86c"),
      h => pack("H*","067b73947cb55e2d092b3a9df5bd60d7e8827539738f641d62615bd2380d1ace"),
      hasK => 1,
      k => pack("H*","d0c88dd89b03a3c40a39669bb2653bd1ba5694d4a1d2dbf5013f361e9c506012"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03c0216213c6af39d6e55100c0f0b259c7f7bc5611759546e05fdfd92124eebf0c"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 1,
    message_pattens => [["e", "es"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","7b67ee877a3dcbe215b0233cfa92609b87c985eef612156235d4325ce993a86c"),
      h => pack("H*","067b73947cb55e2d092b3a9df5bd60d7e8827539738f641d62615bd2380d1ace"),
      hasK => 1,
      k => pack("H*","d0c88dd89b03a3c40a39669bb2653bd1ba5694d4a1d2dbf5013f361e9c506012"),
    },
    who => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NK",
  initiator => 0,
  message_pattens => [["e", "es"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => "Noise_NK_secp256r1_AESGCM_SHA256",
    h  => pack("H*","2ae14458ce54aa7003e70975f58e8a41e2e7ce1fb61df64492c4a0d77ce4da98"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NK",
  initiator => 0,
  message_pattens => [["e", "es"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => "Noise_NK_secp256r1_AESGCM_SHA256",
    h  => pack("H*","2ae14458ce54aa7003e70975f58e8a41e2e7ce1fb61df64492c4a0d77ce4da98"),
  },
  who => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEwCFiE8avOdblUQDA8LJZx/e8VhF1
',
###           'lUbgX9/ZISTuvwx2xjI4pqdVv1Go6a0GzOAOlEreiJrdCgDeiKjCz0j7kQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEwCFiE8avOdblUQDA8LJZx/e8VhF1
',
###           'lUbgX9/ZISTuvwx2xjI4pqdVv1Go6a0GzOAOlEreiJrdCgDeiKjCz0j7kQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'a4385606b3791b251dc490583a80d580c443c2c7cf8d1f004bb07e5f9f49265c'
### z: 'a4385606b3791b251dc490583a80d580c443c2c7cf8d1f004bb07e5f9f49265c'

### noise decrypt

### noise decrypt
### key: '9f35c654098754154fcc4abfec08fefe0648b5da3337f58b25bc8d57c1a9a79b'
### key: '9f35c654098754154fcc4abfec08fefe0648b5da3337f58b25bc8d57c1a9a79b'
### iv: '1d63147631588d9fbb12b1de'
### iv: '1d63147631588d9fbb12b1de'
### aad: '116b24e438ddc4aafc4cd5c145761be82074f948c9d45c9777c81b039336afb2'
### aad: '116b24e438ddc4aafc4cd5c145761be82074f948c9d45c9777c81b039336afb2'
### cipherinfo: '834a3136313637373137373850c21babf612cbc29e1b2efb82ed09d13948fc1132e83d7ae56a'
### cipherinfo: '834a3136313637373137373850c21babf612cbc29e1b2efb82ed09d13948fc1132e83d7ae56a'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '2c552540066fbca88c2ab1de'
### iv_xor: '2c552540066fbca88c2ab1de'
### authtag: 'c21babf612cbc29e1b2efb82ed09d139'
### authtag: 'c21babf612cbc29e1b2efb82ed09d139'
### ciphertext: 'fc1132e83d7ae56a'
### ciphertext: 'fc1132e83d7ae56a'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "NK",
    initiator => 0,
    message_pattens => [["e", "es"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","03c0216213c6af39d6e55100c0f0b259c7f7bc5611759546e05fdfd92124eebf0c"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","7b67ee877a3dcbe215b0233cfa92609b87c985eef612156235d4325ce993a86c"),
      h => pack("H*","067b73947cb55e2d092b3a9df5bd60d7e8827539738f641d62615bd2380d1ace"),
      hasK => 1,
      k => pack("H*","d0c88dd89b03a3c40a39669bb2653bd1ba5694d4a1d2dbf5013f361e9c506012"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "NK",
    initiator => 0,
    message_pattens => [["e", "es"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","03c0216213c6af39d6e55100c0f0b259c7f7bc5611759546e05fdfd92124eebf0c"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","7b67ee877a3dcbe215b0233cfa92609b87c985eef612156235d4325ce993a86c"),
      h => pack("H*","067b73947cb55e2d092b3a9df5bd60d7e8827539738f641d62615bd2380d1ace"),
      hasK => 1,
      k => pack("H*","d0c88dd89b03a3c40a39669bb2653bd1ba5694d4a1d2dbf5013f361e9c506012"),
    },
    who => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '02b26e8c0c9ee6bd97aea9af7539c5de8f8a37638af62ee456f99119856284e734'

### public compressed: '02b26e8c0c9ee6bd97aea9af7539c5de8f8a37638af62ee456f99119856284e734'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIFitATnlC38rlSYKu2O9QlApxFlDaoyIQHZ+JRgEaUYgoAoGCCqGSM49
',
###             'AwEHoUQDQgAEsm6MDJ7mvZeuqa91OcXej4o3Y4r2LuRW+ZEZhWKE5zTo7VtC+UAN
',
###             'vOCtxMUfBCZui8GFN1bXMgCJoWDQ2RQidg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIFitATnlC38rlSYKu2O9QlApxFlDaoyIQHZ+JRgEaUYgoAoGCCqGSM49
',
###             'AwEHoUQDQgAEsm6MDJ7mvZeuqa91OcXej4o3Y4r2LuRW+ZEZhWKE5zTo7VtC+UAN
',
###             'vOCtxMUfBCZui8GFN1bXMgCJoWDQ2RQidg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEwCFiE8avOdblUQDA8LJZx/e8VhF1
',
###           'lUbgX9/ZISTuvwx2xjI4pqdVv1Go6a0GzOAOlEreiJrdCgDeiKjCz0j7kQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEwCFiE8avOdblUQDA8LJZx/e8VhF1
',
###           'lUbgX9/ZISTuvwx2xjI4pqdVv1Go6a0GzOAOlEreiJrdCgDeiKjCz0j7kQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'ae7a0a76a220b6937de5ddedf3a60f71586bc0284e4afae3b5946eb576fae618'
### z: 'ae7a0a76a220b6937de5ddedf3a60f71586bc0284e4afae3b5946eb576fae618'

### noise encrypt

### noise encrypt
### key: '01417dc0a6095f462dc6224b94b9025bf1fa09500c1e4ec10601c6c71728f6cb'
### key: '01417dc0a6095f462dc6224b94b9025bf1fa09500c1e4ec10601c6c71728f6cb'
### iv: 'acbf18b4a0bdeb457644b5f6'
### iv: 'acbf18b4a0bdeb457644b5f6'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '9d892982978ada72417cb5f6'
### iv_xor: '9d892982978ada72417cb5f6'
### aad: '66f50677c8c7ebafb8b6ec794d8da295512b11262924e4804b97ee41160390bc'
### aad: '66f50677c8c7ebafb8b6ec794d8da295512b11262924e4804b97ee41160390bc'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '625134fb64307a61'
### ciphertext: '625134fb64307a61'
### authtag: '0cf640ddbcbe9373bda1e29caa6aa6cd'
### authtag: '0cf640ddbcbe9373bda1e29caa6aa6cd'
### cipherinfo: '834a31363136373731373738500cf640ddbcbe9373bda1e29caa6aa6cd48625134fb64307a61'
### cipherinfo: '834a31363136373731373738500cf640ddbcbe9373bda1e29caa6aa6cd48625134fb64307a61'

### b_msg: '82582102b26e8c0c9ee6bd97aea9af7539c5de8f8a37638af62ee456f99119856284e7345826834a31363136373731373738500cf640ddbcbe9373bda1e29caa6aa6cd48625134fb64307a61'

### b_msg: '82582102b26e8c0c9ee6bd97aea9af7539c5de8f8a37638af62ee456f99119856284e7345826834a31363136373731373738500cf640ddbcbe9373bda1e29caa6aa6cd48625134fb64307a61'
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02b26e8c0c9ee6bd97aea9af7539c5de8f8a37638af62ee456f99119856284e734"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 0,
    message_pattens => [["e", "es"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","03c0216213c6af39d6e55100c0f0b259c7f7bc5611759546e05fdfd92124eebf0c"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","d17b38b7e2e979ab2ccf305df5061c1850ebe0bcc43e3273d03e066d5cc68e88"),
      h => pack("H*","c983a88e15c0dd0dc2297931051d9bcf9a4f6e7e2243a91d31f8a54007dc6a05"),
      hasK => 1,
      k => pack("H*","0c04454171c5876e3ec902236946a3b2e85d4e13f509597d835cf7e204a7788a"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","b423133c3d3d7042410fb15a5ed6b4951fd91edef393f4813b73db19920641a0"),
  },
  {
    hasK => 1,
    k => pack("H*","edd8ca8bbb608e8b92ce43003ca07827c9c39d0cf3eeded99f6b44e615eac877"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02b26e8c0c9ee6bd97aea9af7539c5de8f8a37638af62ee456f99119856284e734"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 0,
    message_pattens => [["e", "es"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","03c0216213c6af39d6e55100c0f0b259c7f7bc5611759546e05fdfd92124eebf0c"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","d17b38b7e2e979ab2ccf305df5061c1850ebe0bcc43e3273d03e066d5cc68e88"),
      h => pack("H*","c983a88e15c0dd0dc2297931051d9bcf9a4f6e7e2243a91d31f8a54007dc6a05"),
      hasK => 1,
      k => pack("H*","0c04454171c5876e3ec902236946a3b2e85d4e13f509597d835cf7e204a7788a"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","b423133c3d3d7042410fb15a5ed6b4951fd91edef393f4813b73db19920641a0"),
  },
  {
    hasK => 1,
    k => pack("H*","edd8ca8bbb608e8b92ce43003ca07827c9c39d0cf3eeded99f6b44e615eac877"),
  },
)

### a read_message from b

### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMjabyqBJgmXe49NCfN7DqAsj6RwzTS8NRQA0Z/1JZ9UoAoGCCqGSM49
',
###             'AwEHoUQDQgAEwCFiE8avOdblUQDA8LJZx/e8VhF1lUbgX9/ZISTuvwx2xjI4pqdV
',
###             'v1Go6a0GzOAOlEreiJrdCgDeiKjCz0j7kQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMjabyqBJgmXe49NCfN7DqAsj6RwzTS8NRQA0Z/1JZ9UoAoGCCqGSM49
',
###             'AwEHoUQDQgAEwCFiE8avOdblUQDA8LJZx/e8VhF1lUbgX9/ZISTuvwx2xjI4pqdV
',
###             'v1Go6a0GzOAOlEreiJrdCgDeiKjCz0j7kQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEsm6MDJ7mvZeuqa91OcXej4o3Y4r2
',
###           'LuRW+ZEZhWKE5zTo7VtC+UANvOCtxMUfBCZui8GFN1bXMgCJoWDQ2RQidg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEsm6MDJ7mvZeuqa91OcXej4o3Y4r2
',
###           'LuRW+ZEZhWKE5zTo7VtC+UANvOCtxMUfBCZui8GFN1bXMgCJoWDQ2RQidg==
',
###           '-----END PUBLIC KEY-----
'
### z: 'ae7a0a76a220b6937de5ddedf3a60f71586bc0284e4afae3b5946eb576fae618'
### z: 'ae7a0a76a220b6937de5ddedf3a60f71586bc0284e4afae3b5946eb576fae618'

### noise decrypt

### noise decrypt
### key: '01417dc0a6095f462dc6224b94b9025bf1fa09500c1e4ec10601c6c71728f6cb'
### key: '01417dc0a6095f462dc6224b94b9025bf1fa09500c1e4ec10601c6c71728f6cb'
### iv: 'acbf18b4a0bdeb457644b5f6'
### iv: 'acbf18b4a0bdeb457644b5f6'
### aad: '66f50677c8c7ebafb8b6ec794d8da295512b11262924e4804b97ee41160390bc'
### aad: '66f50677c8c7ebafb8b6ec794d8da295512b11262924e4804b97ee41160390bc'
### cipherinfo: '834a31363136373731373738500cf640ddbcbe9373bda1e29caa6aa6cd48625134fb64307a61'
### cipherinfo: '834a31363136373731373738500cf640ddbcbe9373bda1e29caa6aa6cd48625134fb64307a61'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '9d892982978ada72417cb5f6'
### iv_xor: '9d892982978ada72417cb5f6'
### authtag: '0cf640ddbcbe9373bda1e29caa6aa6cd'
### authtag: '0cf640ddbcbe9373bda1e29caa6aa6cd'
### ciphertext: '625134fb64307a61'
### ciphertext: '625134fb64307a61'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03c0216213c6af39d6e55100c0f0b259c7f7bc5611759546e05fdfd92124eebf0c"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 1,
    message_pattens => [["e", "es"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","02b26e8c0c9ee6bd97aea9af7539c5de8f8a37638af62ee456f99119856284e734"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","d17b38b7e2e979ab2ccf305df5061c1850ebe0bcc43e3273d03e066d5cc68e88"),
      h => pack("H*","c983a88e15c0dd0dc2297931051d9bcf9a4f6e7e2243a91d31f8a54007dc6a05"),
      hasK => 1,
      k => pack("H*","0c04454171c5876e3ec902236946a3b2e85d4e13f509597d835cf7e204a7788a"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","b423133c3d3d7042410fb15a5ed6b4951fd91edef393f4813b73db19920641a0"),
  },
  {
    hasK => 1,
    k => pack("H*","edd8ca8bbb608e8b92ce43003ca07827c9c39d0cf3eeded99f6b44e615eac877"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03c0216213c6af39d6e55100c0f0b259c7f7bc5611759546e05fdfd92124eebf0c"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 1,
    message_pattens => [["e", "es"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","02b26e8c0c9ee6bd97aea9af7539c5de8f8a37638af62ee456f99119856284e734"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","d17b38b7e2e979ab2ccf305df5061c1850ebe0bcc43e3273d03e066d5cc68e88"),
      h => pack("H*","c983a88e15c0dd0dc2297931051d9bcf9a4f6e7e2243a91d31f8a54007dc6a05"),
      hasK => 1,
      k => pack("H*","0c04454171c5876e3ec902236946a3b2e85d4e13f509597d835cf7e204a7788a"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","b423133c3d3d7042410fb15a5ed6b4951fd91edef393f4813b73db19920641a0"),
  },
  {
    hasK => 1,
    k => pack("H*","edd8ca8bbb608e8b92ce43003ca07827c9c39d0cf3eeded99f6b44e615eac877"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '691ef3886b9619673b0b424fecd50044c5da7f81188908969dda42d4b96df685'
### key: '691ef3886b9619673b0b424fecd50044c5da7f81188908969dda42d4b96df685'
### iv: 'fa1913e3933ef2ad745654bc'
### iv: 'fa1913e3933ef2ad745654bc'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'cb2f22d5a409c39a436e54bc'
### iv_xor: 'cb2f22d5a409c39a436e54bc'
### aad: 'c983a88e15c0dd0dc2297931051d9bcf9a4f6e7e2243a91d31f8a54007dc6a05'
### aad: 'c983a88e15c0dd0dc2297931051d9bcf9a4f6e7e2243a91d31f8a54007dc6a05'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'b44069dac5cb0e4c0ee952d2484b24c0df1c1d05409035a1481734a21cf4708836aab80045dad5ddab1ff826c938b496a4fa31'
### ciphertext: 'b44069dac5cb0e4c0ee952d2484b24c0df1c1d05409035a1481734a21cf4708836aab80045dad5ddab1ff826c938b496a4fa31'
### authtag: '329d9d682f8c0591b45d55ca47276d90'
### authtag: '329d9d682f8c0591b45d55ca47276d90'
### cipherinfo: '834a3136313637373137373850329d9d682f8c0591b45d55ca47276d905833b44069dac5cb0e4c0ee952d2484b24c0df1c1d05409035a1481734a21cf4708836aab80045dad5ddab1ff826c938b496a4fa31'
### cipherinfo: '834a3136313637373137373850329d9d682f8c0591b45d55ca47276d905833b44069dac5cb0e4c0ee952d2484b24c0df1c1d05409035a1481734a21cf4708836aab80045dad5ddab1ff826c938b496a4fa31'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '691ef3886b9619673b0b424fecd50044c5da7f81188908969dda42d4b96df685'
### key: '691ef3886b9619673b0b424fecd50044c5da7f81188908969dda42d4b96df685'
### iv: 'fa1913e3933ef2ad745654bc'
### iv: 'fa1913e3933ef2ad745654bc'
### aad: 'c983a88e15c0dd0dc2297931051d9bcf9a4f6e7e2243a91d31f8a54007dc6a05'
### aad: 'c983a88e15c0dd0dc2297931051d9bcf9a4f6e7e2243a91d31f8a54007dc6a05'
### cipherinfo: '834a3136313637373137373850329d9d682f8c0591b45d55ca47276d905833b44069dac5cb0e4c0ee952d2484b24c0df1c1d05409035a1481734a21cf4708836aab80045dad5ddab1ff826c938b496a4fa31'
### cipherinfo: '834a3136313637373137373850329d9d682f8c0591b45d55ca47276d905833b44069dac5cb0e4c0ee952d2484b24c0df1c1d05409035a1481734a21cf4708836aab80045dad5ddab1ff826c938b496a4fa31'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'cb2f22d5a409c39a436e54bc'
### iv_xor: 'cb2f22d5a409c39a436e54bc'
### authtag: '329d9d682f8c0591b45d55ca47276d90'
### authtag: '329d9d682f8c0591b45d55ca47276d90'
### ciphertext: 'b44069dac5cb0e4c0ee952d2484b24c0df1c1d05409035a1481734a21cf4708836aab80045dad5ddab1ff826c938b496a4fa31'
### ciphertext: 'b44069dac5cb0e4c0ee952d2484b24c0df1c1d05409035a1481734a21cf4708836aab80045dad5ddab1ff826c938b496a4fa31'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: 'd6cde7d96b5b93e8404733e6da3b49a3acd2e40f8f15a50625baecb4635d462c'
### key: 'd6cde7d96b5b93e8404733e6da3b49a3acd2e40f8f15a50625baecb4635d462c'
### iv: '2e8f1232f8d5124c31a9ed53'
### iv: '2e8f1232f8d5124c31a9ed53'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '1fb92304cfe2237b0691ed53'
### iv_xor: '1fb92304cfe2237b0691ed53'
### aad: 'c983a88e15c0dd0dc2297931051d9bcf9a4f6e7e2243a91d31f8a54007dc6a05'
### aad: 'c983a88e15c0dd0dc2297931051d9bcf9a4f6e7e2243a91d31f8a54007dc6a05'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'b2ad6014142fb5c1b04c8e9971359187fa3cfad08b02953ada2ecfba4a9bb1c1b0e3dd5b8f6041e08bba66a49483d9'
### ciphertext: 'b2ad6014142fb5c1b04c8e9971359187fa3cfad08b02953ada2ecfba4a9bb1c1b0e3dd5b8f6041e08bba66a49483d9'
### authtag: '100e20a02b1e737c6d577a6c4e1ed845'
### authtag: '100e20a02b1e737c6d577a6c4e1ed845'
### cipherinfo: '834a3136313637373137373850100e20a02b1e737c6d577a6c4e1ed845582fb2ad6014142fb5c1b04c8e9971359187fa3cfad08b02953ada2ecfba4a9bb1c1b0e3dd5b8f6041e08bba66a49483d9'
### cipherinfo: '834a3136313637373137373850100e20a02b1e737c6d577a6c4e1ed845582fb2ad6014142fb5c1b04c8e9971359187fa3cfad08b02953ada2ecfba4a9bb1c1b0e3dd5b8f6041e08bba66a49483d9'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: 'd6cde7d96b5b93e8404733e6da3b49a3acd2e40f8f15a50625baecb4635d462c'
### key: 'd6cde7d96b5b93e8404733e6da3b49a3acd2e40f8f15a50625baecb4635d462c'
### iv: '2e8f1232f8d5124c31a9ed53'
### iv: '2e8f1232f8d5124c31a9ed53'
### aad: 'c983a88e15c0dd0dc2297931051d9bcf9a4f6e7e2243a91d31f8a54007dc6a05'
### aad: 'c983a88e15c0dd0dc2297931051d9bcf9a4f6e7e2243a91d31f8a54007dc6a05'
### cipherinfo: '834a3136313637373137373850100e20a02b1e737c6d577a6c4e1ed845582fb2ad6014142fb5c1b04c8e9971359187fa3cfad08b02953ada2ecfba4a9bb1c1b0e3dd5b8f6041e08bba66a49483d9'
### cipherinfo: '834a3136313637373137373850100e20a02b1e737c6d577a6c4e1ed845582fb2ad6014142fb5c1b04c8e9971359187fa3cfad08b02953ada2ecfba4a9bb1c1b0e3dd5b8f6041e08bba66a49483d9'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '1fb92304cfe2237b0691ed53'
### iv_xor: '1fb92304cfe2237b0691ed53'
### authtag: '100e20a02b1e737c6d577a6c4e1ed845'
### authtag: '100e20a02b1e737c6d577a6c4e1ed845'
### ciphertext: 'b2ad6014142fb5c1b04c8e9971359187fa3cfad08b02953ada2ecfba4a9bb1c1b0e3dd5b8f6041e08bba66a49483d9'
### ciphertext: 'b2ad6014142fb5c1b04c8e9971359187fa3cfad08b02953ada2ecfba4a9bb1c1b0e3dd5b8f6041e08bba66a49483d9'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'NK',
###                               undef,
###                               undef
### -----------end test --------: 'NK',
###                               undef,
###                               undef


### -----------start test --------: 'NK',
###                                 'test_psk',
###                                 0
### -----------start test --------: 'NK',
###                                 'test_psk',
###                                 0

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NK",
  initiator => 1,
  message_pattens => [["psk", "e", "es"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","c0592f5d4a982efb3e1cd18665b2400c94f8d56e693c7d21580bd369a43dabfb"),
    h  => pack("H*","7ad22aead2a63388e37d15002c5d417e6702d15142a6d2d659a65c26b7e47120"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NK",
  initiator => 1,
  message_pattens => [["psk", "e", "es"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","c0592f5d4a982efb3e1cd18665b2400c94f8d56e693c7d21580bd369a43dabfb"),
    h  => pack("H*","7ad22aead2a63388e37d15002c5d417e6702d15142a6d2d659a65c26b7e47120"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'psk'

### write message pattern: 'psk'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '02445362ddf223f494d23695a74f7e9353fc697e4e4d2376c13a35ee304cc03339'

### public compressed: '02445362ddf223f494d23695a74f7e9353fc697e4e4d2376c13a35ee304cc03339'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMcXSsJgLn+Z24Ka6NNu9FP+MFQAZuIpOfyNnz3Y1td9oAoGCCqGSM49
',
###             'AwEHoUQDQgAERFNi3fIj9JTSNpWnT36TU/xpfk5NI3bBOjXuMEzAMzl2frbYU09G
',
###             'PCxdi13aD0Y+m6mJ7cpza06Nlvl/8LDGtg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMcXSsJgLn+Z24Ka6NNu9FP+MFQAZuIpOfyNnz3Y1td9oAoGCCqGSM49
',
###             'AwEHoUQDQgAERFNi3fIj9JTSNpWnT36TU/xpfk5NI3bBOjXuMEzAMzl2frbYU09G
',
###             'PCxdi13aD0Y+m6mJ7cpza06Nlvl/8LDGtg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '1ef03721278e6052907c76848337187e6170626bf6c1504375f67615a3c48c11'
### z: '1ef03721278e6052907c76848337187e6170626bf6c1504375f67615a3c48c11'

### noise encrypt

### noise encrypt
### key: 'dfb757e842b8fddf45c496b3a9fb3cec1657a3fe1bfa4adc9fe64e3545c0e40d'
### key: 'dfb757e842b8fddf45c496b3a9fb3cec1657a3fe1bfa4adc9fe64e3545c0e40d'
### iv: 'fa7e4656773bfd80ae50852e'
### iv: 'fa7e4656773bfd80ae50852e'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'cb487760400cccb79968852e'
### iv_xor: 'cb487760400cccb79968852e'
### aad: '6a5829ca173ce7329a34bf39682d61d4e6fa6ea42c3486a68474d95aafe8a630'
### aad: '6a5829ca173ce7329a34bf39682d61d4e6fa6ea42c3486a68474d95aafe8a630'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: 'b358631472942225'
### ciphertext: 'b358631472942225'
### authtag: '65add95f85c0d09101ad97b321ec86c3'
### authtag: '65add95f85c0d09101ad97b321ec86c3'
### cipherinfo: '834a313631363737313737385065add95f85c0d09101ad97b321ec86c348b358631472942225'
### cipherinfo: '834a313631363737313737385065add95f85c0d09101ad97b321ec86c348b358631472942225'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAkRTYt3yI/SU0jaVp09+k1P8aX5OTSN2wTo17jBMwDM5WCaDSjE2MTY3NzE3NzhQZa3ZX4XA0JEBrZezIeyGw0izWGMUcpQiJQ=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAkRTYt3yI/SU0jaVp09+k1P8aX5OTSN2wTo17jBMwDM5WCaDSjE2MTY3NzE3NzhQZa3ZX4XA0JEBrZezIeyGw0izWGMUcpQiJQ=="),
  );
}
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02445362ddf223f494d23695a74f7e9353fc697e4e4d2376c13a35ee304cc03339"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 1,
    message_pattens => [["psk", "e", "es"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","226ebd66095fe760370569a1cdb6d88d4989e208d69d04e2deab8662754597bd"),
      h => pack("H*","8a869eb2e8e5bca93fa10d148763f8b16d18d89944657765a2c33d62c0d21e6d"),
      hasK => 1,
      k => pack("H*","f6dc2e9bf66af8d1fec92db121937450053356fea9c2bd2ff8d8a7caf2751398"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02445362ddf223f494d23695a74f7e9353fc697e4e4d2376c13a35ee304cc03339"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 1,
    message_pattens => [["psk", "e", "es"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","226ebd66095fe760370569a1cdb6d88d4989e208d69d04e2deab8662754597bd"),
      h => pack("H*","8a869eb2e8e5bca93fa10d148763f8b16d18d89944657765a2c33d62c0d21e6d"),
      hasK => 1,
      k => pack("H*","f6dc2e9bf66af8d1fec92db121937450053356fea9c2bd2ff8d8a7caf2751398"),
    },
    who => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NK",
  initiator => 0,
  message_pattens => [["psk", "e", "es"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","c0592f5d4a982efb3e1cd18665b2400c94f8d56e693c7d21580bd369a43dabfb"),
    h  => pack("H*","7ad22aead2a63388e37d15002c5d417e6702d15142a6d2d659a65c26b7e47120"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NK",
  initiator => 0,
  message_pattens => [["psk", "e", "es"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","c0592f5d4a982efb3e1cd18665b2400c94f8d56e693c7d21580bd369a43dabfb"),
    h  => pack("H*","7ad22aead2a63388e37d15002c5d417e6702d15142a6d2d659a65c26b7e47120"),
  },
  who => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'psk'

### read message pattern: 'psk'

### read message pattern: 'e'

### read message pattern: 'e'


### read message pattern: 'es'
### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAERFNi3fIj9JTSNpWnT36TU/xpfk5N
',
###           'I3bBOjXuMEzAMzl2frbYU09GPCxdi13aD0Y+m6mJ7cpza06Nlvl/8LDGtg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAERFNi3fIj9JTSNpWnT36TU/xpfk5N
',
###           'I3bBOjXuMEzAMzl2frbYU09GPCxdi13aD0Y+m6mJ7cpza06Nlvl/8LDGtg==
',
###           '-----END PUBLIC KEY-----
'
### z: '1ef03721278e6052907c76848337187e6170626bf6c1504375f67615a3c48c11'
### z: '1ef03721278e6052907c76848337187e6170626bf6c1504375f67615a3c48c11'

### noise decrypt

### noise decrypt
### key: 'dfb757e842b8fddf45c496b3a9fb3cec1657a3fe1bfa4adc9fe64e3545c0e40d'
### key: 'dfb757e842b8fddf45c496b3a9fb3cec1657a3fe1bfa4adc9fe64e3545c0e40d'
### iv: 'fa7e4656773bfd80ae50852e'
### iv: 'fa7e4656773bfd80ae50852e'
### aad: '6a5829ca173ce7329a34bf39682d61d4e6fa6ea42c3486a68474d95aafe8a630'
### aad: '6a5829ca173ce7329a34bf39682d61d4e6fa6ea42c3486a68474d95aafe8a630'
### cipherinfo: '834a313631363737313737385065add95f85c0d09101ad97b321ec86c348b358631472942225'
### cipherinfo: '834a313631363737313737385065add95f85c0d09101ad97b321ec86c348b358631472942225'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'cb487760400cccb79968852e'
### iv_xor: 'cb487760400cccb79968852e'
### authtag: '65add95f85c0d09101ad97b321ec86c3'
### authtag: '65add95f85c0d09101ad97b321ec86c3'
### ciphertext: 'b358631472942225'
### ciphertext: 'b358631472942225'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "NK",
    initiator => 0,
    message_pattens => [["psk", "e", "es"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","02445362ddf223f494d23695a74f7e9353fc697e4e4d2376c13a35ee304cc03339"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","226ebd66095fe760370569a1cdb6d88d4989e208d69d04e2deab8662754597bd"),
      h => pack("H*","8a869eb2e8e5bca93fa10d148763f8b16d18d89944657765a2c33d62c0d21e6d"),
      hasK => 1,
      k => pack("H*","f6dc2e9bf66af8d1fec92db121937450053356fea9c2bd2ff8d8a7caf2751398"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "NK",
    initiator => 0,
    message_pattens => [["psk", "e", "es"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","02445362ddf223f494d23695a74f7e9353fc697e4e4d2376c13a35ee304cc03339"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","226ebd66095fe760370569a1cdb6d88d4989e208d69d04e2deab8662754597bd"),
      h => pack("H*","8a869eb2e8e5bca93fa10d148763f8b16d18d89944657765a2c33d62c0d21e6d"),
      hasK => 1,
      k => pack("H*","f6dc2e9bf66af8d1fec92db121937450053356fea9c2bd2ff8d8a7caf2751398"),
    },
    who => "b",
  },
)


### b write_message to a
### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'


### public compressed: '036a3b629718b2d28f22be34819c19237b2c162063b2a1f6e7ed96d172caae9542'
### public compressed: '036a3b629718b2d28f22be34819c19237b2c162063b2a1f6e7ed96d172caae9542'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMsrYEvmrrZk9Di1hnptBOQceFcuprJ9CNWef0BZJxYBoAoGCCqGSM49
',
###             'AwEHoUQDQgAEajtilxiy0o8ivjSBnBkjeywWIGOyofbn7ZbRcsqulUL+K5+3WuRb
',
###             'MplK5mCAOxC9mtcVaGLYDovcSjHphgY7sQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMsrYEvmrrZk9Di1hnptBOQceFcuprJ9CNWef0BZJxYBoAoGCCqGSM49
',
###             'AwEHoUQDQgAEajtilxiy0o8ivjSBnBkjeywWIGOyofbn7ZbRcsqulUL+K5+3WuRb
',
###             'MplK5mCAOxC9mtcVaGLYDovcSjHphgY7sQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAERFNi3fIj9JTSNpWnT36TU/xpfk5N
',
###           'I3bBOjXuMEzAMzl2frbYU09GPCxdi13aD0Y+m6mJ7cpza06Nlvl/8LDGtg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAERFNi3fIj9JTSNpWnT36TU/xpfk5N
',
###           'I3bBOjXuMEzAMzl2frbYU09GPCxdi13aD0Y+m6mJ7cpza06Nlvl/8LDGtg==
',
###           '-----END PUBLIC KEY-----
'
### z: 'c7e8b455082badb068f9ed0ef022825e885c92003ceb67c490d7c326e4cbd58b'
### z: 'c7e8b455082badb068f9ed0ef022825e885c92003ceb67c490d7c326e4cbd58b'

### noise encrypt

### noise encrypt
### key: 'bb03dcb516aa5d5d2931714d42c750313d24d992785f78122f103f5cfb00a154'
### key: 'bb03dcb516aa5d5d2931714d42c750313d24d992785f78122f103f5cfb00a154'
### iv: '7f531f8c48d7ba82258926e5'
### iv: '7f531f8c48d7ba82258926e5'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '4e652eba7fe08bb512b126e5'
### iv_xor: '4e652eba7fe08bb512b126e5'
### aad: 'd6705f35e44f78fe7fdbf340d6d2c15ef44ec1fc06539f335136bd4ba8bc1ce3'
### aad: 'd6705f35e44f78fe7fdbf340d6d2c15ef44ec1fc06539f335136bd4ba8bc1ce3'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '2d0a06c1f1e27377'
### ciphertext: '2d0a06c1f1e27377'
### authtag: '6b024ca14101b26282c524cf59d215e2'
### authtag: '6b024ca14101b26282c524cf59d215e2'
### cipherinfo: '834a31363136373731373738506b024ca14101b26282c524cf59d215e2482d0a06c1f1e27377'
### cipherinfo: '834a31363136373731373738506b024ca14101b26282c524cf59d215e2482d0a06c1f1e27377'


### b_msg: '825821036a3b629718b2d28f22be34819c19237b2c162063b2a1f6e7ed96d172caae95425826834a31363136373731373738506b024ca14101b26282c524cf59d215e2482d0a06c1f1e27377'
### b_msg: '825821036a3b629718b2d28f22be34819c19237b2c162063b2a1f6e7ed96d172caae95425826834a31363136373731373738506b024ca14101b26282c524cf59d215e2482d0a06c1f1e27377'
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","036a3b629718b2d28f22be34819c19237b2c162063b2a1f6e7ed96d172caae9542"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 0,
    message_pattens => [["psk", "e", "es"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","02445362ddf223f494d23695a74f7e9353fc697e4e4d2376c13a35ee304cc03339"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","b3d07564f7112c3f97f153e586bebc5b8f1faf3475624d9f594501076830b3e4"),
      h => pack("H*","0feb7308b4ce3944cf1d48f788de467a198eecfda491d7f511ff94a0dcc1598b"),
      hasK => 1,
      k => pack("H*","21ac4e32e0d1f227f7434331d226722c60e55a95a4a202aa971e374ca477022d"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","9694be92c767d526c806c669e8859368945a01d2e478051e26bcb1ac869c1ec3"),
  },
  {
    hasK => 1,
    k => pack("H*","1f879903a0c8ceba440d061ac310a22c7edf79e1c7bdf5af221dd9dbf638adef"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","036a3b629718b2d28f22be34819c19237b2c162063b2a1f6e7ed96d172caae9542"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 0,
    message_pattens => [["psk", "e", "es"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","02445362ddf223f494d23695a74f7e9353fc697e4e4d2376c13a35ee304cc03339"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","b3d07564f7112c3f97f153e586bebc5b8f1faf3475624d9f594501076830b3e4"),
      h => pack("H*","0feb7308b4ce3944cf1d48f788de467a198eecfda491d7f511ff94a0dcc1598b"),
      hasK => 1,
      k => pack("H*","21ac4e32e0d1f227f7434331d226722c60e55a95a4a202aa971e374ca477022d"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","9694be92c767d526c806c669e8859368945a01d2e478051e26bcb1ac869c1ec3"),
  },
  {
    hasK => 1,
    k => pack("H*","1f879903a0c8ceba440d061ac310a22c7edf79e1c7bdf5af221dd9dbf638adef"),
  },
)

### a read_message from b

### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMcXSsJgLn+Z24Ka6NNu9FP+MFQAZuIpOfyNnz3Y1td9oAoGCCqGSM49
',
###             'AwEHoUQDQgAERFNi3fIj9JTSNpWnT36TU/xpfk5NI3bBOjXuMEzAMzl2frbYU09G
',
###             'PCxdi13aD0Y+m6mJ7cpza06Nlvl/8LDGtg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMcXSsJgLn+Z24Ka6NNu9FP+MFQAZuIpOfyNnz3Y1td9oAoGCCqGSM49
',
###             'AwEHoUQDQgAERFNi3fIj9JTSNpWnT36TU/xpfk5NI3bBOjXuMEzAMzl2frbYU09G
',
###             'PCxdi13aD0Y+m6mJ7cpza06Nlvl/8LDGtg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEajtilxiy0o8ivjSBnBkjeywWIGOy
',
###           'ofbn7ZbRcsqulUL+K5+3WuRbMplK5mCAOxC9mtcVaGLYDovcSjHphgY7sQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEajtilxiy0o8ivjSBnBkjeywWIGOy
',
###           'ofbn7ZbRcsqulUL+K5+3WuRbMplK5mCAOxC9mtcVaGLYDovcSjHphgY7sQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'c7e8b455082badb068f9ed0ef022825e885c92003ceb67c490d7c326e4cbd58b'
### z: 'c7e8b455082badb068f9ed0ef022825e885c92003ceb67c490d7c326e4cbd58b'

### noise decrypt

### noise decrypt
### key: 'bb03dcb516aa5d5d2931714d42c750313d24d992785f78122f103f5cfb00a154'
### key: 'bb03dcb516aa5d5d2931714d42c750313d24d992785f78122f103f5cfb00a154'
### iv: '7f531f8c48d7ba82258926e5'
### iv: '7f531f8c48d7ba82258926e5'
### aad: 'd6705f35e44f78fe7fdbf340d6d2c15ef44ec1fc06539f335136bd4ba8bc1ce3'
### aad: 'd6705f35e44f78fe7fdbf340d6d2c15ef44ec1fc06539f335136bd4ba8bc1ce3'
### cipherinfo: '834a31363136373731373738506b024ca14101b26282c524cf59d215e2482d0a06c1f1e27377'
### cipherinfo: '834a31363136373731373738506b024ca14101b26282c524cf59d215e2482d0a06c1f1e27377'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '4e652eba7fe08bb512b126e5'
### iv_xor: '4e652eba7fe08bb512b126e5'
### authtag: '6b024ca14101b26282c524cf59d215e2'
### authtag: '6b024ca14101b26282c524cf59d215e2'
### ciphertext: '2d0a06c1f1e27377'
### ciphertext: '2d0a06c1f1e27377'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02445362ddf223f494d23695a74f7e9353fc697e4e4d2376c13a35ee304cc03339"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 1,
    message_pattens => [["psk", "e", "es"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","036a3b629718b2d28f22be34819c19237b2c162063b2a1f6e7ed96d172caae9542"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","b3d07564f7112c3f97f153e586bebc5b8f1faf3475624d9f594501076830b3e4"),
      h => pack("H*","0feb7308b4ce3944cf1d48f788de467a198eecfda491d7f511ff94a0dcc1598b"),
      hasK => 1,
      k => pack("H*","21ac4e32e0d1f227f7434331d226722c60e55a95a4a202aa971e374ca477022d"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","9694be92c767d526c806c669e8859368945a01d2e478051e26bcb1ac869c1ec3"),
  },
  {
    hasK => 1,
    k => pack("H*","1f879903a0c8ceba440d061ac310a22c7edf79e1c7bdf5af221dd9dbf638adef"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02445362ddf223f494d23695a74f7e9353fc697e4e4d2376c13a35ee304cc03339"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 1,
    message_pattens => [["psk", "e", "es"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","036a3b629718b2d28f22be34819c19237b2c162063b2a1f6e7ed96d172caae9542"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","b3d07564f7112c3f97f153e586bebc5b8f1faf3475624d9f594501076830b3e4"),
      h => pack("H*","0feb7308b4ce3944cf1d48f788de467a198eecfda491d7f511ff94a0dcc1598b"),
      hasK => 1,
      k => pack("H*","21ac4e32e0d1f227f7434331d226722c60e55a95a4a202aa971e374ca477022d"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","9694be92c767d526c806c669e8859368945a01d2e478051e26bcb1ac869c1ec3"),
  },
  {
    hasK => 1,
    k => pack("H*","1f879903a0c8ceba440d061ac310a22c7edf79e1c7bdf5af221dd9dbf638adef"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '5cb9aa03aa2f9a65a2bfce2098e77358f8661bd5ca7f53128cbfd9a7eef4452d'
### key: '5cb9aa03aa2f9a65a2bfce2098e77358f8661bd5ca7f53128cbfd9a7eef4452d'
### iv: '223c826110f853470c20dcbc'
### iv: '223c826110f853470c20dcbc'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '130ab35727cf62703b18dcbc'
### iv_xor: '130ab35727cf62703b18dcbc'
### aad: '0feb7308b4ce3944cf1d48f788de467a198eecfda491d7f511ff94a0dcc1598b'
### aad: '0feb7308b4ce3944cf1d48f788de467a198eecfda491d7f511ff94a0dcc1598b'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '852188b2e7de2e06a9926a7d02a3568ed693c962acce381d707af95389b1e65ba49b566bcb5fdcaa9641ead696c80371ceede4'
### ciphertext: '852188b2e7de2e06a9926a7d02a3568ed693c962acce381d707af95389b1e65ba49b566bcb5fdcaa9641ead696c80371ceede4'
### authtag: '86aed3e9962789d6c10903fd63036cf4'
### authtag: '86aed3e9962789d6c10903fd63036cf4'
### cipherinfo: '834a313631363737313737385086aed3e9962789d6c10903fd63036cf45833852188b2e7de2e06a9926a7d02a3568ed693c962acce381d707af95389b1e65ba49b566bcb5fdcaa9641ead696c80371ceede4'
### cipherinfo: '834a313631363737313737385086aed3e9962789d6c10903fd63036cf45833852188b2e7de2e06a9926a7d02a3568ed693c962acce381d707af95389b1e65ba49b566bcb5fdcaa9641ead696c80371ceede4'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '5cb9aa03aa2f9a65a2bfce2098e77358f8661bd5ca7f53128cbfd9a7eef4452d'
### key: '5cb9aa03aa2f9a65a2bfce2098e77358f8661bd5ca7f53128cbfd9a7eef4452d'
### iv: '223c826110f853470c20dcbc'
### iv: '223c826110f853470c20dcbc'
### aad: '0feb7308b4ce3944cf1d48f788de467a198eecfda491d7f511ff94a0dcc1598b'
### aad: '0feb7308b4ce3944cf1d48f788de467a198eecfda491d7f511ff94a0dcc1598b'
### cipherinfo: '834a313631363737313737385086aed3e9962789d6c10903fd63036cf45833852188b2e7de2e06a9926a7d02a3568ed693c962acce381d707af95389b1e65ba49b566bcb5fdcaa9641ead696c80371ceede4'
### cipherinfo: '834a313631363737313737385086aed3e9962789d6c10903fd63036cf45833852188b2e7de2e06a9926a7d02a3568ed693c962acce381d707af95389b1e65ba49b566bcb5fdcaa9641ead696c80371ceede4'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '130ab35727cf62703b18dcbc'
### iv_xor: '130ab35727cf62703b18dcbc'
### authtag: '86aed3e9962789d6c10903fd63036cf4'
### authtag: '86aed3e9962789d6c10903fd63036cf4'
### ciphertext: '852188b2e7de2e06a9926a7d02a3568ed693c962acce381d707af95389b1e65ba49b566bcb5fdcaa9641ead696c80371ceede4'
### ciphertext: '852188b2e7de2e06a9926a7d02a3568ed693c962acce381d707af95389b1e65ba49b566bcb5fdcaa9641ead696c80371ceede4'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '1fb9ccf16af647d7dbac6e383aea6b87b43837749bfd88ecec15433d3c95b8ed'
### key: '1fb9ccf16af647d7dbac6e383aea6b87b43837749bfd88ecec15433d3c95b8ed'
### iv: '9554349c509fa29c1e5f92c8'
### iv: '9554349c509fa29c1e5f92c8'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'a46205aa67a893ab296792c8'
### iv_xor: 'a46205aa67a893ab296792c8'
### aad: '0feb7308b4ce3944cf1d48f788de467a198eecfda491d7f511ff94a0dcc1598b'
### aad: '0feb7308b4ce3944cf1d48f788de467a198eecfda491d7f511ff94a0dcc1598b'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'df3280cbf65c331922681428096aa513887cf364dd620c1a17cc63fd0732ba3cd23739764400d7f59b55bcc35343db'
### ciphertext: 'df3280cbf65c331922681428096aa513887cf364dd620c1a17cc63fd0732ba3cd23739764400d7f59b55bcc35343db'
### authtag: 'ecbcba95020446a2f6d0c7127867b403'
### authtag: 'ecbcba95020446a2f6d0c7127867b403'
### cipherinfo: '834a3136313637373137373850ecbcba95020446a2f6d0c7127867b403582fdf3280cbf65c331922681428096aa513887cf364dd620c1a17cc63fd0732ba3cd23739764400d7f59b55bcc35343db'
### cipherinfo: '834a3136313637373137373850ecbcba95020446a2f6d0c7127867b403582fdf3280cbf65c331922681428096aa513887cf364dd620c1a17cc63fd0732ba3cd23739764400d7f59b55bcc35343db'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '1fb9ccf16af647d7dbac6e383aea6b87b43837749bfd88ecec15433d3c95b8ed'
### key: '1fb9ccf16af647d7dbac6e383aea6b87b43837749bfd88ecec15433d3c95b8ed'
### iv: '9554349c509fa29c1e5f92c8'
### iv: '9554349c509fa29c1e5f92c8'
### aad: '0feb7308b4ce3944cf1d48f788de467a198eecfda491d7f511ff94a0dcc1598b'
### aad: '0feb7308b4ce3944cf1d48f788de467a198eecfda491d7f511ff94a0dcc1598b'
### cipherinfo: '834a3136313637373137373850ecbcba95020446a2f6d0c7127867b403582fdf3280cbf65c331922681428096aa513887cf364dd620c1a17cc63fd0732ba3cd23739764400d7f59b55bcc35343db'
### cipherinfo: '834a3136313637373137373850ecbcba95020446a2f6d0c7127867b403582fdf3280cbf65c331922681428096aa513887cf364dd620c1a17cc63fd0732ba3cd23739764400d7f59b55bcc35343db'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'a46205aa67a893ab296792c8'
### iv_xor: 'a46205aa67a893ab296792c8'
### authtag: 'ecbcba95020446a2f6d0c7127867b403'
### authtag: 'ecbcba95020446a2f6d0c7127867b403'
### ciphertext: 'df3280cbf65c331922681428096aa513887cf364dd620c1a17cc63fd0732ba3cd23739764400d7f59b55bcc35343db'
### ciphertext: 'df3280cbf65c331922681428096aa513887cf364dd620c1a17cc63fd0732ba3cd23739764400d7f59b55bcc35343db'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'NK',
###                               'test_psk',
###                               0

### -----------end test --------: 'NK',
###                               'test_psk',
###                               0

### -----------start test --------: 'NK',
###                                 'test_psk',
###                                 1

### -----------start test --------: 'NK',
###                                 'test_psk',
###                                 1

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NK",
  initiator => 1,
  message_pattens => [["e", "es", "psk"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","b1f467d9560de53bb28a37f814f316823a4bdbe1fc7a6a0f9c4ca6885140f19f"),
    h  => pack("H*","8504be8924028a71ef8f5f8a5f0b4a942a2893d05d47b18f88bb35854f7a43cf"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NK",
  initiator => 1,
  message_pattens => [["e", "es", "psk"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","b1f467d9560de53bb28a37f814f316823a4bdbe1fc7a6a0f9c4ca6885140f19f"),
    h  => pack("H*","8504be8924028a71ef8f5f8a5f0b4a942a2893d05d47b18f88bb35854f7a43cf"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '03cb3de9ad8309621bba42d4c206ba52f417a2d2695934766531fd4df556fc6f7e'

### public compressed: '03cb3de9ad8309621bba42d4c206ba52f417a2d2695934766531fd4df556fc6f7e'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDkJg0AGO+fZla0CgCIvvAHrr/66QdpJSRbYyjhM5BfxoAoGCCqGSM49
',
###             'AwEHoUQDQgAEyz3prYMJYhu6QtTCBrpS9Bei0mlZNHZlMf1N9Vb8b35jrRbI/kPl
',
###             'f3TKi6GsKmcHKpaouTulCX1fpSPMcaH5tQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDkJg0AGO+fZla0CgCIvvAHrr/66QdpJSRbYyjhM5BfxoAoGCCqGSM49
',
###             'AwEHoUQDQgAEyz3prYMJYhu6QtTCBrpS9Bei0mlZNHZlMf1N9Vb8b35jrRbI/kPl
',
###             'f3TKi6GsKmcHKpaouTulCX1fpSPMcaH5tQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '94df4f55f0d960469346d9b8012d96953ce3e315bfd6f1b889220c4e40458be4'
### z: '94df4f55f0d960469346d9b8012d96953ce3e315bfd6f1b889220c4e40458be4'

### write message pattern: 'psk'

### write message pattern: 'psk'

### noise encrypt

### noise encrypt
### key: '141ce94c550c90f29cb31703e75f5d1b73791af44c3d09658f666947ba684754'
### key: '141ce94c550c90f29cb31703e75f5d1b73791af44c3d09658f666947ba684754'
### iv: '75e72a41ade531c32e66fd38'
### iv: '75e72a41ade531c32e66fd38'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '44d11b779ad200f4195efd38'
### iv_xor: '44d11b779ad200f4195efd38'
### aad: '0904a36bee70ef4d8c3387b684113bd7b1132f6a7a1096cc0f0c7e80d0cb3ec9'
### aad: '0904a36bee70ef4d8c3387b684113bd7b1132f6a7a1096cc0f0c7e80d0cb3ec9'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '0e3a9a01090c1c08'
### ciphertext: '0e3a9a01090c1c08'
### authtag: '96d47b213dd711f57fd99b47df6f1f78'
### authtag: '96d47b213dd711f57fd99b47df6f1f78'
### cipherinfo: '834a313631363737313737385096d47b213dd711f57fd99b47df6f1f78480e3a9a01090c1c08'
### cipherinfo: '834a313631363737313737385096d47b213dd711f57fd99b47df6f1f78480e3a9a01090c1c08'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA8s96a2DCWIbukLUwga6UvQXotJpWTR2ZTH9TfVW/G9+WCaDSjE2MTY3NzE3NzhQltR7IT3XEfV/2ZtH328feEgOOpoBCQwcCA=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA8s96a2DCWIbukLUwga6UvQXotJpWTR2ZTH9TfVW/G9+WCaDSjE2MTY3NzE3NzhQltR7IT3XEfV/2ZtH328feEgOOpoBCQwcCA=="),
  );
}
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03cb3de9ad8309621bba42d4c206ba52f417a2d2695934766531fd4df556fc6f7e"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 1,
    message_pattens => [["e", "es", "psk"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","43de044eaa0fd07e571e3ee0618fa20e211ed10b95667066327cc865b1902711"),
      h => pack("H*","039d4b17361a607cb53305f405a49f2b020acbce0569422739ab8f716ac94750"),
      hasK => 1,
      k => pack("H*","23e880029a2af81ee72d59ab73c710b2d3a48bf4926c79fcb81ee5aeba0b60d0"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03cb3de9ad8309621bba42d4c206ba52f417a2d2695934766531fd4df556fc6f7e"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 1,
    message_pattens => [["e", "es", "psk"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","43de044eaa0fd07e571e3ee0618fa20e211ed10b95667066327cc865b1902711"),
      h => pack("H*","039d4b17361a607cb53305f405a49f2b020acbce0569422739ab8f716ac94750"),
      hasK => 1,
      k => pack("H*","23e880029a2af81ee72d59ab73c710b2d3a48bf4926c79fcb81ee5aeba0b60d0"),
    },
    who => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NK",
  initiator => 0,
  message_pattens => [["e", "es", "psk"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","b1f467d9560de53bb28a37f814f316823a4bdbe1fc7a6a0f9c4ca6885140f19f"),
    h  => pack("H*","8504be8924028a71ef8f5f8a5f0b4a942a2893d05d47b18f88bb35854f7a43cf"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "NK",
  initiator => 0,
  message_pattens => [["e", "es", "psk"], ["e", "ee"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","b1f467d9560de53bb28a37f814f316823a4bdbe1fc7a6a0f9c4ca6885140f19f"),
    h  => pack("H*","8504be8924028a71ef8f5f8a5f0b4a942a2893d05d47b18f88bb35854f7a43cf"),
  },
  who => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'


### read message pattern: 'es'
### read message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEyz3prYMJYhu6QtTCBrpS9Bei0mlZ
',
###           'NHZlMf1N9Vb8b35jrRbI/kPlf3TKi6GsKmcHKpaouTulCX1fpSPMcaH5tQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEyz3prYMJYhu6QtTCBrpS9Bei0mlZ
',
###           'NHZlMf1N9Vb8b35jrRbI/kPlf3TKi6GsKmcHKpaouTulCX1fpSPMcaH5tQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '94df4f55f0d960469346d9b8012d96953ce3e315bfd6f1b889220c4e40458be4'
### z: '94df4f55f0d960469346d9b8012d96953ce3e315bfd6f1b889220c4e40458be4'

### read message pattern: 'psk'

### read message pattern: 'psk'

### noise decrypt

### noise decrypt
### key: '141ce94c550c90f29cb31703e75f5d1b73791af44c3d09658f666947ba684754'
### key: '141ce94c550c90f29cb31703e75f5d1b73791af44c3d09658f666947ba684754'
### iv: '75e72a41ade531c32e66fd38'
### iv: '75e72a41ade531c32e66fd38'
### aad: '0904a36bee70ef4d8c3387b684113bd7b1132f6a7a1096cc0f0c7e80d0cb3ec9'
### aad: '0904a36bee70ef4d8c3387b684113bd7b1132f6a7a1096cc0f0c7e80d0cb3ec9'
### cipherinfo: '834a313631363737313737385096d47b213dd711f57fd99b47df6f1f78480e3a9a01090c1c08'
### cipherinfo: '834a313631363737313737385096d47b213dd711f57fd99b47df6f1f78480e3a9a01090c1c08'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '44d11b779ad200f4195efd38'
### iv_xor: '44d11b779ad200f4195efd38'
### authtag: '96d47b213dd711f57fd99b47df6f1f78'
### authtag: '96d47b213dd711f57fd99b47df6f1f78'
### ciphertext: '0e3a9a01090c1c08'
### ciphertext: '0e3a9a01090c1c08'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "NK",
    initiator => 0,
    message_pattens => [["e", "es", "psk"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","03cb3de9ad8309621bba42d4c206ba52f417a2d2695934766531fd4df556fc6f7e"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","43de044eaa0fd07e571e3ee0618fa20e211ed10b95667066327cc865b1902711"),
      h => pack("H*","039d4b17361a607cb53305f405a49f2b020acbce0569422739ab8f716ac94750"),
      hasK => 1,
      k => pack("H*","23e880029a2af81ee72d59ab73c710b2d3a48bf4926c79fcb81ee5aeba0b60d0"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "NK",
    initiator => 0,
    message_pattens => [["e", "es", "psk"], ["e", "ee"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","03cb3de9ad8309621bba42d4c206ba52f417a2d2695934766531fd4df556fc6f7e"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","43de044eaa0fd07e571e3ee0618fa20e211ed10b95667066327cc865b1902711"),
      h => pack("H*","039d4b17361a607cb53305f405a49f2b020acbce0569422739ab8f716ac94750"),
      hasK => 1,
      k => pack("H*","23e880029a2af81ee72d59ab73c710b2d3a48bf4926c79fcb81ee5aeba0b60d0"),
    },
    who => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '03e74d41f6540bb0cf7cbc14dbdab778af4209b627eb70b074aaa514dbd32ba160'

### public compressed: '03e74d41f6540bb0cf7cbc14dbdab778af4209b627eb70b074aaa514dbd32ba160'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPH8ibIIdTvNw/1ab2wp13b0zfa/53k4y2SAFLC7BlI+oAoGCCqGSM49
',
###             'AwEHoUQDQgAE501B9lQLsM98vBTb2rd4r0IJtifrcLB0qqUU29MroWBCS56ho+Kr
',
###             'jR/W7Tz4JCkA4rRNo+YMz1QaP5rUCsK1cQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPH8ibIIdTvNw/1ab2wp13b0zfa/53k4y2SAFLC7BlI+oAoGCCqGSM49
',
###             'AwEHoUQDQgAE501B9lQLsM98vBTb2rd4r0IJtifrcLB0qqUU29MroWBCS56ho+Kr
',
###             'jR/W7Tz4JCkA4rRNo+YMz1QaP5rUCsK1cQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEyz3prYMJYhu6QtTCBrpS9Bei0mlZ
',
###           'NHZlMf1N9Vb8b35jrRbI/kPlf3TKi6GsKmcHKpaouTulCX1fpSPMcaH5tQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEyz3prYMJYhu6QtTCBrpS9Bei0mlZ
',
###           'NHZlMf1N9Vb8b35jrRbI/kPlf3TKi6GsKmcHKpaouTulCX1fpSPMcaH5tQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '44672b849731ad3de7689baead7af1946fa26ba353ab190fefb2e181596d63ab'
### z: '44672b849731ad3de7689baead7af1946fa26ba353ab190fefb2e181596d63ab'

### noise encrypt

### noise encrypt
### key: 'ae77143d5ca27a010c2ac555be6b9bda80891aaf9bd9de4aeb3a138e3baddc0b'
### key: 'ae77143d5ca27a010c2ac555be6b9bda80891aaf9bd9de4aeb3a138e3baddc0b'
### iv: 'd55e4b098e5404c19f32e6e9'
### iv: 'd55e4b098e5404c19f32e6e9'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'e4687a3fb96335f6a80ae6e9'
### iv_xor: 'e4687a3fb96335f6a80ae6e9'
### aad: 'bd5996cd60a27f281be7605c11d1c39c79020d9b646cf42a89a3a4a759a87852'
### aad: 'bd5996cd60a27f281be7605c11d1c39c79020d9b646cf42a89a3a4a759a87852'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: 'dd80b4d9c109fb45'
### ciphertext: 'dd80b4d9c109fb45'
### authtag: '91b13ff4f76f0f2f38cc6f50518d310d'
### authtag: '91b13ff4f76f0f2f38cc6f50518d310d'
### cipherinfo: '834a313631363737313737385091b13ff4f76f0f2f38cc6f50518d310d48dd80b4d9c109fb45'
### cipherinfo: '834a313631363737313737385091b13ff4f76f0f2f38cc6f50518d310d48dd80b4d9c109fb45'


### b_msg: '82582103e74d41f6540bb0cf7cbc14dbdab778af4209b627eb70b074aaa514dbd32ba1605826834a313631363737313737385091b13ff4f76f0f2f38cc6f50518d310d48dd80b4d9c109fb45'
### b_msg: '82582103e74d41f6540bb0cf7cbc14dbdab778af4209b627eb70b074aaa514dbd32ba1605826834a313631363737313737385091b13ff4f76f0f2f38cc6f50518d310d48dd80b4d9c109fb45'
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03e74d41f6540bb0cf7cbc14dbdab778af4209b627eb70b074aaa514dbd32ba160"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 0,
    message_pattens => [["e", "es", "psk"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","03cb3de9ad8309621bba42d4c206ba52f417a2d2695934766531fd4df556fc6f7e"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","3e506aaad9a39655e96ae011d9a0c07dcb1f4011a0316e7a63180e404ecf7f67"),
      h => pack("H*","6cfab522ff5a5740b5aa7e7e186d80a5cafe9e225ccc966e6cc6fdd795d965fa"),
      hasK => 1,
      k => pack("H*","bf174aba8b73c6f4f5e449203776b86a560c4828b7bca77c012feb4743d406ae"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","4255788744fadc5f324145a4908bb12be23d31b80d2ce39a4b24fe01e4b00d15"),
  },
  {
    hasK => 1,
    k => pack("H*","d16f80482f54f0bfb5b9d61d6292756f8d97bf49f3d80a601f07e8d92f62039a"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03e74d41f6540bb0cf7cbc14dbdab778af4209b627eb70b074aaa514dbd32ba160"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 0,
    message_pattens => [["e", "es", "psk"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","03cb3de9ad8309621bba42d4c206ba52f417a2d2695934766531fd4df556fc6f7e"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","3e506aaad9a39655e96ae011d9a0c07dcb1f4011a0316e7a63180e404ecf7f67"),
      h => pack("H*","6cfab522ff5a5740b5aa7e7e186d80a5cafe9e225ccc966e6cc6fdd795d965fa"),
      hasK => 1,
      k => pack("H*","bf174aba8b73c6f4f5e449203776b86a560c4828b7bca77c012feb4743d406ae"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","4255788744fadc5f324145a4908bb12be23d31b80d2ce39a4b24fe01e4b00d15"),
  },
  {
    hasK => 1,
    k => pack("H*","d16f80482f54f0bfb5b9d61d6292756f8d97bf49f3d80a601f07e8d92f62039a"),
  },
)


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDkJg0AGO+fZla0CgCIvvAHrr/66QdpJSRbYyjhM5BfxoAoGCCqGSM49
',
###             'AwEHoUQDQgAEyz3prYMJYhu6QtTCBrpS9Bei0mlZNHZlMf1N9Vb8b35jrRbI/kPl
',
###             'f3TKi6GsKmcHKpaouTulCX1fpSPMcaH5tQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDkJg0AGO+fZla0CgCIvvAHrr/66QdpJSRbYyjhM5BfxoAoGCCqGSM49
',
###             'AwEHoUQDQgAEyz3prYMJYhu6QtTCBrpS9Bei0mlZNHZlMf1N9Vb8b35jrRbI/kPl
',
###             'f3TKi6GsKmcHKpaouTulCX1fpSPMcaH5tQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE501B9lQLsM98vBTb2rd4r0IJtifr
',
###           'cLB0qqUU29MroWBCS56ho+KrjR/W7Tz4JCkA4rRNo+YMz1QaP5rUCsK1cQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE501B9lQLsM98vBTb2rd4r0IJtifr
',
###           'cLB0qqUU29MroWBCS56ho+KrjR/W7Tz4JCkA4rRNo+YMz1QaP5rUCsK1cQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '44672b849731ad3de7689baead7af1946fa26ba353ab190fefb2e181596d63ab'
### z: '44672b849731ad3de7689baead7af1946fa26ba353ab190fefb2e181596d63ab'

### noise decrypt

### noise decrypt
### key: 'ae77143d5ca27a010c2ac555be6b9bda80891aaf9bd9de4aeb3a138e3baddc0b'
### key: 'ae77143d5ca27a010c2ac555be6b9bda80891aaf9bd9de4aeb3a138e3baddc0b'
### iv: 'd55e4b098e5404c19f32e6e9'
### iv: 'd55e4b098e5404c19f32e6e9'
### aad: 'bd5996cd60a27f281be7605c11d1c39c79020d9b646cf42a89a3a4a759a87852'
### aad: 'bd5996cd60a27f281be7605c11d1c39c79020d9b646cf42a89a3a4a759a87852'
### cipherinfo: '834a313631363737313737385091b13ff4f76f0f2f38cc6f50518d310d48dd80b4d9c109fb45'
### cipherinfo: '834a313631363737313737385091b13ff4f76f0f2f38cc6f50518d310d48dd80b4d9c109fb45'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'e4687a3fb96335f6a80ae6e9'
### iv_xor: 'e4687a3fb96335f6a80ae6e9'
### authtag: '91b13ff4f76f0f2f38cc6f50518d310d'
### authtag: '91b13ff4f76f0f2f38cc6f50518d310d'
### ciphertext: 'dd80b4d9c109fb45'
### ciphertext: 'dd80b4d9c109fb45'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03cb3de9ad8309621bba42d4c206ba52f417a2d2695934766531fd4df556fc6f7e"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 1,
    message_pattens => [["e", "es", "psk"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","03e74d41f6540bb0cf7cbc14dbdab778af4209b627eb70b074aaa514dbd32ba160"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","3e506aaad9a39655e96ae011d9a0c07dcb1f4011a0316e7a63180e404ecf7f67"),
      h => pack("H*","6cfab522ff5a5740b5aa7e7e186d80a5cafe9e225ccc966e6cc6fdd795d965fa"),
      hasK => 1,
      k => pack("H*","bf174aba8b73c6f4f5e449203776b86a560c4828b7bca77c012feb4743d406ae"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","4255788744fadc5f324145a4908bb12be23d31b80d2ce39a4b24fe01e4b00d15"),
  },
  {
    hasK => 1,
    k => pack("H*","d16f80482f54f0bfb5b9d61d6292756f8d97bf49f3d80a601f07e8d92f62039a"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03cb3de9ad8309621bba42d4c206ba52f417a2d2695934766531fd4df556fc6f7e"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    initiator => 1,
    message_pattens => [["e", "es", "psk"], ["e", "ee"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","03e74d41f6540bb0cf7cbc14dbdab778af4209b627eb70b074aaa514dbd32ba160"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","3e506aaad9a39655e96ae011d9a0c07dcb1f4011a0316e7a63180e404ecf7f67"),
      h => pack("H*","6cfab522ff5a5740b5aa7e7e186d80a5cafe9e225ccc966e6cc6fdd795d965fa"),
      hasK => 1,
      k => pack("H*","bf174aba8b73c6f4f5e449203776b86a560c4828b7bca77c012feb4743d406ae"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","4255788744fadc5f324145a4908bb12be23d31b80d2ce39a4b24fe01e4b00d15"),
  },
  {
    hasK => 1,
    k => pack("H*","d16f80482f54f0bfb5b9d61d6292756f8d97bf49f3d80a601f07e8d92f62039a"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: 'c7a3eee5189ad9c4dffc3ea6a2ae784d12c8ce127185d76c886bc99b205a7512'
### key: 'c7a3eee5189ad9c4dffc3ea6a2ae784d12c8ce127185d76c886bc99b205a7512'
### iv: '5eb01df24bce41acac719df4'
### iv: '5eb01df24bce41acac719df4'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '6f862cc47cf9709b9b499df4'
### iv_xor: '6f862cc47cf9709b9b499df4'
### aad: '6cfab522ff5a5740b5aa7e7e186d80a5cafe9e225ccc966e6cc6fdd795d965fa'
### aad: '6cfab522ff5a5740b5aa7e7e186d80a5cafe9e225ccc966e6cc6fdd795d965fa'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'e54881f84704a6344e21e6e5130abb39bb301c0eba16688fec7053cb94f9ade21736c884dc4dcbe6900ba61bcfd88d374b890a'
### ciphertext: 'e54881f84704a6344e21e6e5130abb39bb301c0eba16688fec7053cb94f9ade21736c884dc4dcbe6900ba61bcfd88d374b890a'
### authtag: 'b017a95715252658197d0c9a8c876359'
### authtag: 'b017a95715252658197d0c9a8c876359'
### cipherinfo: '834a3136313637373137373850b017a95715252658197d0c9a8c8763595833e54881f84704a6344e21e6e5130abb39bb301c0eba16688fec7053cb94f9ade21736c884dc4dcbe6900ba61bcfd88d374b890a'
### cipherinfo: '834a3136313637373137373850b017a95715252658197d0c9a8c8763595833e54881f84704a6344e21e6e5130abb39bb301c0eba16688fec7053cb94f9ade21736c884dc4dcbe6900ba61bcfd88d374b890a'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: 'c7a3eee5189ad9c4dffc3ea6a2ae784d12c8ce127185d76c886bc99b205a7512'
### key: 'c7a3eee5189ad9c4dffc3ea6a2ae784d12c8ce127185d76c886bc99b205a7512'
### iv: '5eb01df24bce41acac719df4'
### iv: '5eb01df24bce41acac719df4'
### aad: '6cfab522ff5a5740b5aa7e7e186d80a5cafe9e225ccc966e6cc6fdd795d965fa'
### aad: '6cfab522ff5a5740b5aa7e7e186d80a5cafe9e225ccc966e6cc6fdd795d965fa'
### cipherinfo: '834a3136313637373137373850b017a95715252658197d0c9a8c8763595833e54881f84704a6344e21e6e5130abb39bb301c0eba16688fec7053cb94f9ade21736c884dc4dcbe6900ba61bcfd88d374b890a'
### cipherinfo: '834a3136313637373137373850b017a95715252658197d0c9a8c8763595833e54881f84704a6344e21e6e5130abb39bb301c0eba16688fec7053cb94f9ade21736c884dc4dcbe6900ba61bcfd88d374b890a'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '6f862cc47cf9709b9b499df4'
### iv_xor: '6f862cc47cf9709b9b499df4'
### authtag: 'b017a95715252658197d0c9a8c876359'
### authtag: 'b017a95715252658197d0c9a8c876359'
### ciphertext: 'e54881f84704a6344e21e6e5130abb39bb301c0eba16688fec7053cb94f9ade21736c884dc4dcbe6900ba61bcfd88d374b890a'
### ciphertext: 'e54881f84704a6344e21e6e5130abb39bb301c0eba16688fec7053cb94f9ade21736c884dc4dcbe6900ba61bcfd88d374b890a'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '2003fb54efdc86f04946199c7c53d265067e3f3071b3fe72812da9861c88f576'
### key: '2003fb54efdc86f04946199c7c53d265067e3f3071b3fe72812da9861c88f576'
### iv: 'b3d77c3f4cb48e6806e7be5b'
### iv: 'b3d77c3f4cb48e6806e7be5b'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '82e14d097b83bf5f31dfbe5b'
### iv_xor: '82e14d097b83bf5f31dfbe5b'
### aad: '6cfab522ff5a5740b5aa7e7e186d80a5cafe9e225ccc966e6cc6fdd795d965fa'
### aad: '6cfab522ff5a5740b5aa7e7e186d80a5cafe9e225ccc966e6cc6fdd795d965fa'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'c494a6706c49f9bd0e398da4eab1c4172a7ec3849664579fd76b1017c48eb2a5d614195bdfa3a3e1e9004839deb8c9'
### ciphertext: 'c494a6706c49f9bd0e398da4eab1c4172a7ec3849664579fd76b1017c48eb2a5d614195bdfa3a3e1e9004839deb8c9'
### authtag: '4b5fe653f5ebf9cc455e27b49fa04748'
### authtag: '4b5fe653f5ebf9cc455e27b49fa04748'
### cipherinfo: '834a31363136373731373738504b5fe653f5ebf9cc455e27b49fa04748582fc494a6706c49f9bd0e398da4eab1c4172a7ec3849664579fd76b1017c48eb2a5d614195bdfa3a3e1e9004839deb8c9'
### cipherinfo: '834a31363136373731373738504b5fe653f5ebf9cc455e27b49fa04748582fc494a6706c49f9bd0e398da4eab1c4172a7ec3849664579fd76b1017c48eb2a5d614195bdfa3a3e1e9004839deb8c9'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '2003fb54efdc86f04946199c7c53d265067e3f3071b3fe72812da9861c88f576'
### key: '2003fb54efdc86f04946199c7c53d265067e3f3071b3fe72812da9861c88f576'
### iv: 'b3d77c3f4cb48e6806e7be5b'
### iv: 'b3d77c3f4cb48e6806e7be5b'
### aad: '6cfab522ff5a5740b5aa7e7e186d80a5cafe9e225ccc966e6cc6fdd795d965fa'
### aad: '6cfab522ff5a5740b5aa7e7e186d80a5cafe9e225ccc966e6cc6fdd795d965fa'
### cipherinfo: '834a31363136373731373738504b5fe653f5ebf9cc455e27b49fa04748582fc494a6706c49f9bd0e398da4eab1c4172a7ec3849664579fd76b1017c48eb2a5d614195bdfa3a3e1e9004839deb8c9'
### cipherinfo: '834a31363136373731373738504b5fe653f5ebf9cc455e27b49fa04748582fc494a6706c49f9bd0e398da4eab1c4172a7ec3849664579fd76b1017c48eb2a5d614195bdfa3a3e1e9004839deb8c9'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '82e14d097b83bf5f31dfbe5b'
### iv_xor: '82e14d097b83bf5f31dfbe5b'
### authtag: '4b5fe653f5ebf9cc455e27b49fa04748'
### authtag: '4b5fe653f5ebf9cc455e27b49fa04748'
### ciphertext: 'c494a6706c49f9bd0e398da4eab1c4172a7ec3849664579fd76b1017c48eb2a5d614195bdfa3a3e1e9004839deb8c9'
### ciphertext: 'c494a6706c49f9bd0e398da4eab1c4172a7ec3849664579fd76b1017c48eb2a5d614195bdfa3a3e1e9004839deb8c9'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'NK',
###                               'test_psk',
###                               1

### -----------end test --------: 'NK',
###                               'test_psk',
###                               1

### -----------start test --------: 'KK',
###                                 undef,
###                                 undef

### -----------start test --------: 'KK',
###                                 undef,
###                                 undef

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "KK",
  initiator => 1,
  message_pattens => [["e", "es", "ss"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => "Noise_KK_secp256r1_AESGCM_SHA256",
    h  => pack("H*","a0dde3d544fe77548e0931d67a5db8c142ed54fabf5b1f02a4cb7ceaa1d114cc"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "KK",
  initiator => 1,
  message_pattens => [["e", "es", "ss"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => "Noise_KK_secp256r1_AESGCM_SHA256",
    h  => pack("H*","a0dde3d544fe77548e0931d67a5db8c142ed54fabf5b1f02a4cb7ceaa1d114cc"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '027f8465d28e2fec18c416312181f59870558398858cc93bb2dc05626663450519'

### public compressed: '027f8465d28e2fec18c416312181f59870558398858cc93bb2dc05626663450519'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBpsV5JGEvEwrJ2/xlnChvh/TO/Q60o83RdYBJHNjKjQoAoGCCqGSM49
',
###             'AwEHoUQDQgAEf4Rl0o4v7BjEFjEhgfWYcFWDmIWMyTuy3AViZmNFBRlsaFwuILH7
',
###             'eS1jI+RjnnLttlmCke++s+6UrlyZ8ABV2g==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBpsV5JGEvEwrJ2/xlnChvh/TO/Q60o83RdYBJHNjKjQoAoGCCqGSM49
',
###             'AwEHoUQDQgAEf4Rl0o4v7BjEFjEhgfWYcFWDmIWMyTuy3AViZmNFBRlsaFwuILH7
',
###             'eS1jI+RjnnLttlmCke++s+6UrlyZ8ABV2g==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '41057605277f588ba656d8c6f6828aca6754caaeb67f004fa548c1b4ab3766bc'
### z: '41057605277f588ba656d8c6f6828aca6754caaeb67f004fa548c1b4ab3766bc'

### write message pattern: 'ss'

### write message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### noise encrypt

### noise encrypt
### key: '1364458a94c4a957a7d0810e4cc483fcb1303df9b1688ca650ef2505c1733df6'
### key: '1364458a94c4a957a7d0810e4cc483fcb1303df9b1688ca650ef2505c1733df6'
### iv: 'a27d6910ee4bad754bb9d608'
### iv: 'a27d6910ee4bad754bb9d608'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '934b5826d97c9c427c81d608'
### iv_xor: '934b5826d97c9c427c81d608'
### aad: '219f7ea2786be15560ab62b74d420725b7dcaf5f02d545647578a0c1869cd609'
### aad: '219f7ea2786be15560ab62b74d420725b7dcaf5f02d545647578a0c1869cd609'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '5df1214193973262'
### ciphertext: '5df1214193973262'
### authtag: '418a1dec934df9de8140a0b4c7b431e3'
### authtag: '418a1dec934df9de8140a0b4c7b431e3'
### cipherinfo: '834a3136313637373137373850418a1dec934df9de8140a0b4c7b431e3485df1214193973262'
### cipherinfo: '834a3136313637373137373850418a1dec934df9de8140a0b4c7b431e3485df1214193973262'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAn+EZdKOL+wYxBYxIYH1mHBVg5iFjMk7stwFYmZjRQUZWCaDSjE2MTY3NzE3NzhQQYod7JNN+d6BQKC0x7Qx40hd8SFBk5cyYg=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAn+EZdKOL+wYxBYxIYH1mHBVg5iFjMk7stwFYmZjRQUZWCaDSjE2MTY3NzE3NzhQQYod7JNN+d6BQKC0x7Qx40hd8SFBk5cyYg=="),
  );
}
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","027f8465d28e2fec18c416312181f59870558398858cc93bb2dc05626663450519"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 1,
    message_pattens => [["e", "es", "ss"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","9c01b88e83fd09f52dd378fb6527cf7fad0416bb43d4306123f2cd0bf1a3c4bb"),
      h => pack("H*","b9e10d79d7e5878085e0bff85fc1ba0d0a187ab2275a44fbebf2d4cdcaf0430c"),
      hasK => 1,
      k => pack("H*","d98e1ac9d90c017e8f49728b235774776be3f80d3addb7fa55672fd51aaa148b"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","027f8465d28e2fec18c416312181f59870558398858cc93bb2dc05626663450519"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 1,
    message_pattens => [["e", "es", "ss"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","9c01b88e83fd09f52dd378fb6527cf7fad0416bb43d4306123f2cd0bf1a3c4bb"),
      h => pack("H*","b9e10d79d7e5878085e0bff85fc1ba0d0a187ab2275a44fbebf2d4cdcaf0430c"),
      hasK => 1,
      k => pack("H*","d98e1ac9d90c017e8f49728b235774776be3f80d3addb7fa55672fd51aaa148b"),
    },
    who => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "KK",
  initiator => 0,
  message_pattens => [["e", "es", "ss"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => "Noise_KK_secp256r1_AESGCM_SHA256",
    h  => pack("H*","a0dde3d544fe77548e0931d67a5db8c142ed54fabf5b1f02a4cb7ceaa1d114cc"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "KK",
  initiator => 0,
  message_pattens => [["e", "es", "ss"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => "Noise_KK_secp256r1_AESGCM_SHA256",
    h  => pack("H*","a0dde3d544fe77548e0931d67a5db8c142ed54fabf5b1f02a4cb7ceaa1d114cc"),
  },
  who => "b",
}


### b recv msg from a
### b recv msg from a


### read message pattern: 'e'
### read message pattern: 'e'


### read message pattern: 'es'
### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEf4Rl0o4v7BjEFjEhgfWYcFWDmIWM
',
###           'yTuy3AViZmNFBRlsaFwuILH7eS1jI+RjnnLttlmCke++s+6UrlyZ8ABV2g==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEf4Rl0o4v7BjEFjEhgfWYcFWDmIWM
',
###           'yTuy3AViZmNFBRlsaFwuILH7eS1jI+RjnnLttlmCke++s+6UrlyZ8ABV2g==
',
###           '-----END PUBLIC KEY-----
'
### z: '41057605277f588ba656d8c6f6828aca6754caaeb67f004fa548c1b4ab3766bc'
### z: '41057605277f588ba656d8c6f6828aca6754caaeb67f004fa548c1b4ab3766bc'

### read message pattern: 'ss'

### read message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### noise decrypt

### noise decrypt
### key: '1364458a94c4a957a7d0810e4cc483fcb1303df9b1688ca650ef2505c1733df6'
### key: '1364458a94c4a957a7d0810e4cc483fcb1303df9b1688ca650ef2505c1733df6'
### iv: 'a27d6910ee4bad754bb9d608'
### iv: 'a27d6910ee4bad754bb9d608'
### aad: '219f7ea2786be15560ab62b74d420725b7dcaf5f02d545647578a0c1869cd609'
### aad: '219f7ea2786be15560ab62b74d420725b7dcaf5f02d545647578a0c1869cd609'
### cipherinfo: '834a3136313637373137373850418a1dec934df9de8140a0b4c7b431e3485df1214193973262'
### cipherinfo: '834a3136313637373137373850418a1dec934df9de8140a0b4c7b431e3485df1214193973262'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '934b5826d97c9c427c81d608'
### iv_xor: '934b5826d97c9c427c81d608'
### authtag: '418a1dec934df9de8140a0b4c7b431e3'
### authtag: '418a1dec934df9de8140a0b4c7b431e3'
### ciphertext: '5df1214193973262'
### ciphertext: '5df1214193973262'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "KK",
    initiator => 0,
    message_pattens => [["e", "es", "ss"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","027f8465d28e2fec18c416312181f59870558398858cc93bb2dc05626663450519"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","9c01b88e83fd09f52dd378fb6527cf7fad0416bb43d4306123f2cd0bf1a3c4bb"),
      h => pack("H*","b9e10d79d7e5878085e0bff85fc1ba0d0a187ab2275a44fbebf2d4cdcaf0430c"),
      hasK => 1,
      k => pack("H*","d98e1ac9d90c017e8f49728b235774776be3f80d3addb7fa55672fd51aaa148b"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "KK",
    initiator => 0,
    message_pattens => [["e", "es", "ss"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","027f8465d28e2fec18c416312181f59870558398858cc93bb2dc05626663450519"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","9c01b88e83fd09f52dd378fb6527cf7fad0416bb43d4306123f2cd0bf1a3c4bb"),
      h => pack("H*","b9e10d79d7e5878085e0bff85fc1ba0d0a187ab2275a44fbebf2d4cdcaf0430c"),
      hasK => 1,
      k => pack("H*","d98e1ac9d90c017e8f49728b235774776be3f80d3addb7fa55672fd51aaa148b"),
    },
    who => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '025da4c0128200862f8c89cfc164ddb4bdb29d71a866555015e6cbdcc719a037e8'

### public compressed: '025da4c0128200862f8c89cfc164ddb4bdb29d71a866555015e6cbdcc719a037e8'

### write message pattern: 'ee'

### write message pattern: 'ee'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINLMo8Pza3sW5cLlBILexh9PcWDyDRZWfT9YYbheUXu1oAoGCCqGSM49
',
###             'AwEHoUQDQgAEXaTAEoIAhi+Mic/BZN20vbKdcahmVVAV5svcxxmgN+hu6yQOh6Oi
',
###             'qERv0ayOoKLH2UIX+QOjDzfpRAj0oBu7Ag==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINLMo8Pza3sW5cLlBILexh9PcWDyDRZWfT9YYbheUXu1oAoGCCqGSM49
',
###             'AwEHoUQDQgAEXaTAEoIAhi+Mic/BZN20vbKdcahmVVAV5svcxxmgN+hu6yQOh6Oi
',
###             'qERv0ayOoKLH2UIX+QOjDzfpRAj0oBu7Ag==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEf4Rl0o4v7BjEFjEhgfWYcFWDmIWM
',
###           'yTuy3AViZmNFBRlsaFwuILH7eS1jI+RjnnLttlmCke++s+6UrlyZ8ABV2g==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEf4Rl0o4v7BjEFjEhgfWYcFWDmIWM
',
###           'yTuy3AViZmNFBRlsaFwuILH7eS1jI+RjnnLttlmCke++s+6UrlyZ8ABV2g==
',
###           '-----END PUBLIC KEY-----
'
### z: '9a2e5982b7a63a94f3e503912b26120227fb1af83ce613f8b6b6aa7d9a6b7ae4'
### z: '9a2e5982b7a63a94f3e503912b26120227fb1af83ce613f8b6b6aa7d9a6b7ae4'

### write message pattern: 'se'

### write message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINLMo8Pza3sW5cLlBILexh9PcWDyDRZWfT9YYbheUXu1oAoGCCqGSM49
',
###             'AwEHoUQDQgAEXaTAEoIAhi+Mic/BZN20vbKdcahmVVAV5svcxxmgN+hu6yQOh6Oi
',
###             'qERv0ayOoKLH2UIX+QOjDzfpRAj0oBu7Ag==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINLMo8Pza3sW5cLlBILexh9PcWDyDRZWfT9YYbheUXu1oAoGCCqGSM49
',
###             'AwEHoUQDQgAEXaTAEoIAhi+Mic/BZN20vbKdcahmVVAV5svcxxmgN+hu6yQOh6Oi
',
###             'qERv0ayOoKLH2UIX+QOjDzfpRAj0oBu7Ag==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20cfb343c5ab2c393505f835b0ec8b8c0c65457602928617deefd403e77e81ec'
### z: '20cfb343c5ab2c393505f835b0ec8b8c0c65457602928617deefd403e77e81ec'

### noise encrypt

### noise encrypt
### key: '5f6020857cbde604209117040eb6ae79ec7479ebb112a56f069652ba7211e9bf'
### key: '5f6020857cbde604209117040eb6ae79ec7479ebb112a56f069652ba7211e9bf'
### iv: 'c380d0b43f1f88b34dfe39e5'
### iv: 'c380d0b43f1f88b34dfe39e5'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'f2b6e1820828b9847ac639e5'
### iv_xor: 'f2b6e1820828b9847ac639e5'
### aad: '45fbf781edf4ac15fb0baf72e10224507edd281a1c57cd5b374efd47cbe78f06'
### aad: '45fbf781edf4ac15fb0baf72e10224507edd281a1c57cd5b374efd47cbe78f06'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '1dae24b46dd759bd'
### ciphertext: '1dae24b46dd759bd'
### authtag: '41d47e1445167f38ed3be71d3893fd07'
### authtag: '41d47e1445167f38ed3be71d3893fd07'
### cipherinfo: '834a313631363737313737385041d47e1445167f38ed3be71d3893fd07481dae24b46dd759bd'
### cipherinfo: '834a313631363737313737385041d47e1445167f38ed3be71d3893fd07481dae24b46dd759bd'


### b_msg: '825821025da4c0128200862f8c89cfc164ddb4bdb29d71a866555015e6cbdcc719a037e85826834a313631363737313737385041d47e1445167f38ed3be71d3893fd07481dae24b46dd759bd'
### b_msg: '825821025da4c0128200862f8c89cfc164ddb4bdb29d71a866555015e6cbdcc719a037e85826834a313631363737313737385041d47e1445167f38ed3be71d3893fd07481dae24b46dd759bd'
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","025da4c0128200862f8c89cfc164ddb4bdb29d71a866555015e6cbdcc719a037e8"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 0,
    message_pattens => [["e", "es", "ss"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","027f8465d28e2fec18c416312181f59870558398858cc93bb2dc05626663450519"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","e30f0c3c55f820a52bd8e89c6a569102bc9542eb2904251c23e25e3c0057d008"),
      h => pack("H*","2a84956caf7f23a18ec9f5d8bfee38d8399a196bed34481aecec6e96d6f80ee2"),
      hasK => 1,
      k => pack("H*","478a58627bf3799e73a5426475f74293a28e923497ffea7fa7f3347f1a78f14d"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","642339bb2420ce013150bdfc2fde1bfa2e26eac3ee804895ed346e5d81bdd631"),
  },
  {
    hasK => 1,
    k => pack("H*","f50f339ed0c32de94281a8f8a12450712b7de0107f8ec37dce6579f7870eaca6"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","025da4c0128200862f8c89cfc164ddb4bdb29d71a866555015e6cbdcc719a037e8"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 0,
    message_pattens => [["e", "es", "ss"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","027f8465d28e2fec18c416312181f59870558398858cc93bb2dc05626663450519"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","e30f0c3c55f820a52bd8e89c6a569102bc9542eb2904251c23e25e3c0057d008"),
      h => pack("H*","2a84956caf7f23a18ec9f5d8bfee38d8399a196bed34481aecec6e96d6f80ee2"),
      hasK => 1,
      k => pack("H*","478a58627bf3799e73a5426475f74293a28e923497ffea7fa7f3347f1a78f14d"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","642339bb2420ce013150bdfc2fde1bfa2e26eac3ee804895ed346e5d81bdd631"),
  },
  {
    hasK => 1,
    k => pack("H*","f50f339ed0c32de94281a8f8a12450712b7de0107f8ec37dce6579f7870eaca6"),
  },
)

### a read_message from b

### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBpsV5JGEvEwrJ2/xlnChvh/TO/Q60o83RdYBJHNjKjQoAoGCCqGSM49
',
###             'AwEHoUQDQgAEf4Rl0o4v7BjEFjEhgfWYcFWDmIWMyTuy3AViZmNFBRlsaFwuILH7
',
###             'eS1jI+RjnnLttlmCke++s+6UrlyZ8ABV2g==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBpsV5JGEvEwrJ2/xlnChvh/TO/Q60o83RdYBJHNjKjQoAoGCCqGSM49
',
###             'AwEHoUQDQgAEf4Rl0o4v7BjEFjEhgfWYcFWDmIWMyTuy3AViZmNFBRlsaFwuILH7
',
###             'eS1jI+RjnnLttlmCke++s+6UrlyZ8ABV2g==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEXaTAEoIAhi+Mic/BZN20vbKdcahm
',
###           'VVAV5svcxxmgN+hu6yQOh6OiqERv0ayOoKLH2UIX+QOjDzfpRAj0oBu7Ag==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEXaTAEoIAhi+Mic/BZN20vbKdcahm
',
###           'VVAV5svcxxmgN+hu6yQOh6OiqERv0ayOoKLH2UIX+QOjDzfpRAj0oBu7Ag==
',
###           '-----END PUBLIC KEY-----
'
### z: '9a2e5982b7a63a94f3e503912b26120227fb1af83ce613f8b6b6aa7d9a6b7ae4'
### z: '9a2e5982b7a63a94f3e503912b26120227fb1af83ce613f8b6b6aa7d9a6b7ae4'

### read message pattern: 'se'

### read message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEXaTAEoIAhi+Mic/BZN20vbKdcahm
',
###           'VVAV5svcxxmgN+hu6yQOh6OiqERv0ayOoKLH2UIX+QOjDzfpRAj0oBu7Ag==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEXaTAEoIAhi+Mic/BZN20vbKdcahm
',
###           'VVAV5svcxxmgN+hu6yQOh6OiqERv0ayOoKLH2UIX+QOjDzfpRAj0oBu7Ag==
',
###           '-----END PUBLIC KEY-----
'
### z: '20cfb343c5ab2c393505f835b0ec8b8c0c65457602928617deefd403e77e81ec'
### z: '20cfb343c5ab2c393505f835b0ec8b8c0c65457602928617deefd403e77e81ec'

### noise decrypt

### noise decrypt
### key: '5f6020857cbde604209117040eb6ae79ec7479ebb112a56f069652ba7211e9bf'
### key: '5f6020857cbde604209117040eb6ae79ec7479ebb112a56f069652ba7211e9bf'
### iv: 'c380d0b43f1f88b34dfe39e5'
### iv: 'c380d0b43f1f88b34dfe39e5'
### aad: '45fbf781edf4ac15fb0baf72e10224507edd281a1c57cd5b374efd47cbe78f06'
### aad: '45fbf781edf4ac15fb0baf72e10224507edd281a1c57cd5b374efd47cbe78f06'
### cipherinfo: '834a313631363737313737385041d47e1445167f38ed3be71d3893fd07481dae24b46dd759bd'
### cipherinfo: '834a313631363737313737385041d47e1445167f38ed3be71d3893fd07481dae24b46dd759bd'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'f2b6e1820828b9847ac639e5'
### iv_xor: 'f2b6e1820828b9847ac639e5'
### authtag: '41d47e1445167f38ed3be71d3893fd07'
### authtag: '41d47e1445167f38ed3be71d3893fd07'
### ciphertext: '1dae24b46dd759bd'
### ciphertext: '1dae24b46dd759bd'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","027f8465d28e2fec18c416312181f59870558398858cc93bb2dc05626663450519"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 1,
    message_pattens => [["e", "es", "ss"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","025da4c0128200862f8c89cfc164ddb4bdb29d71a866555015e6cbdcc719a037e8"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","e30f0c3c55f820a52bd8e89c6a569102bc9542eb2904251c23e25e3c0057d008"),
      h => pack("H*","2a84956caf7f23a18ec9f5d8bfee38d8399a196bed34481aecec6e96d6f80ee2"),
      hasK => 1,
      k => pack("H*","478a58627bf3799e73a5426475f74293a28e923497ffea7fa7f3347f1a78f14d"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","642339bb2420ce013150bdfc2fde1bfa2e26eac3ee804895ed346e5d81bdd631"),
  },
  {
    hasK => 1,
    k => pack("H*","f50f339ed0c32de94281a8f8a12450712b7de0107f8ec37dce6579f7870eaca6"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","027f8465d28e2fec18c416312181f59870558398858cc93bb2dc05626663450519"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 1,
    message_pattens => [["e", "es", "ss"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","025da4c0128200862f8c89cfc164ddb4bdb29d71a866555015e6cbdcc719a037e8"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","e30f0c3c55f820a52bd8e89c6a569102bc9542eb2904251c23e25e3c0057d008"),
      h => pack("H*","2a84956caf7f23a18ec9f5d8bfee38d8399a196bed34481aecec6e96d6f80ee2"),
      hasK => 1,
      k => pack("H*","478a58627bf3799e73a5426475f74293a28e923497ffea7fa7f3347f1a78f14d"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","642339bb2420ce013150bdfc2fde1bfa2e26eac3ee804895ed346e5d81bdd631"),
  },
  {
    hasK => 1,
    k => pack("H*","f50f339ed0c32de94281a8f8a12450712b7de0107f8ec37dce6579f7870eaca6"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '97ab8522908071c3eeb71ced9991a7ffb770bba3b61ef1f75df18432605ab56a'
### key: '97ab8522908071c3eeb71ced9991a7ffb770bba3b61ef1f75df18432605ab56a'
### iv: '2782073c3390faef0e6f0e89'
### iv: '2782073c3390faef0e6f0e89'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '16b4360a04a7cbd839570e89'
### iv_xor: '16b4360a04a7cbd839570e89'
### aad: '2a84956caf7f23a18ec9f5d8bfee38d8399a196bed34481aecec6e96d6f80ee2'
### aad: '2a84956caf7f23a18ec9f5d8bfee38d8399a196bed34481aecec6e96d6f80ee2'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'c0b07ed97de1cdce1a3183a5e11fa36c03d9cdaec6b12555edad6afc75beb0de77dbd2ccd531d336dbe06b37b610498fcef969'
### ciphertext: 'c0b07ed97de1cdce1a3183a5e11fa36c03d9cdaec6b12555edad6afc75beb0de77dbd2ccd531d336dbe06b37b610498fcef969'
### authtag: '14ca65dc72212d344a44b7ac5cdf1969'
### authtag: '14ca65dc72212d344a44b7ac5cdf1969'
### cipherinfo: '834a313631363737313737385014ca65dc72212d344a44b7ac5cdf19695833c0b07ed97de1cdce1a3183a5e11fa36c03d9cdaec6b12555edad6afc75beb0de77dbd2ccd531d336dbe06b37b610498fcef969'
### cipherinfo: '834a313631363737313737385014ca65dc72212d344a44b7ac5cdf19695833c0b07ed97de1cdce1a3183a5e11fa36c03d9cdaec6b12555edad6afc75beb0de77dbd2ccd531d336dbe06b37b610498fcef969'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '97ab8522908071c3eeb71ced9991a7ffb770bba3b61ef1f75df18432605ab56a'
### key: '97ab8522908071c3eeb71ced9991a7ffb770bba3b61ef1f75df18432605ab56a'
### iv: '2782073c3390faef0e6f0e89'
### iv: '2782073c3390faef0e6f0e89'
### aad: '2a84956caf7f23a18ec9f5d8bfee38d8399a196bed34481aecec6e96d6f80ee2'
### aad: '2a84956caf7f23a18ec9f5d8bfee38d8399a196bed34481aecec6e96d6f80ee2'
### cipherinfo: '834a313631363737313737385014ca65dc72212d344a44b7ac5cdf19695833c0b07ed97de1cdce1a3183a5e11fa36c03d9cdaec6b12555edad6afc75beb0de77dbd2ccd531d336dbe06b37b610498fcef969'
### cipherinfo: '834a313631363737313737385014ca65dc72212d344a44b7ac5cdf19695833c0b07ed97de1cdce1a3183a5e11fa36c03d9cdaec6b12555edad6afc75beb0de77dbd2ccd531d336dbe06b37b610498fcef969'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '16b4360a04a7cbd839570e89'
### iv_xor: '16b4360a04a7cbd839570e89'
### authtag: '14ca65dc72212d344a44b7ac5cdf1969'
### authtag: '14ca65dc72212d344a44b7ac5cdf1969'
### ciphertext: 'c0b07ed97de1cdce1a3183a5e11fa36c03d9cdaec6b12555edad6afc75beb0de77dbd2ccd531d336dbe06b37b610498fcef969'
### ciphertext: 'c0b07ed97de1cdce1a3183a5e11fa36c03d9cdaec6b12555edad6afc75beb0de77dbd2ccd531d336dbe06b37b610498fcef969'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: 'b567bc9f6d49b03e20b22371ae82ec2810da9579168f5ec7a75ae43008ee33ea'
### key: 'b567bc9f6d49b03e20b22371ae82ec2810da9579168f5ec7a75ae43008ee33ea'
### iv: '8ab8bed0781b71c863648aa2'
### iv: '8ab8bed0781b71c863648aa2'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'bb8e8fe64f2c40ff545c8aa2'
### iv_xor: 'bb8e8fe64f2c40ff545c8aa2'
### aad: '2a84956caf7f23a18ec9f5d8bfee38d8399a196bed34481aecec6e96d6f80ee2'
### aad: '2a84956caf7f23a18ec9f5d8bfee38d8399a196bed34481aecec6e96d6f80ee2'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'db34c61361a40936960197b92514c0fd8055f0cc57d34e17d6fb62ea24fabb924064ddea7fb20124375694bca0946c'
### ciphertext: 'db34c61361a40936960197b92514c0fd8055f0cc57d34e17d6fb62ea24fabb924064ddea7fb20124375694bca0946c'
### authtag: '081376d108c533db3ae085bf63b45212'
### authtag: '081376d108c533db3ae085bf63b45212'
### cipherinfo: '834a3136313637373137373850081376d108c533db3ae085bf63b45212582fdb34c61361a40936960197b92514c0fd8055f0cc57d34e17d6fb62ea24fabb924064ddea7fb20124375694bca0946c'
### cipherinfo: '834a3136313637373137373850081376d108c533db3ae085bf63b45212582fdb34c61361a40936960197b92514c0fd8055f0cc57d34e17d6fb62ea24fabb924064ddea7fb20124375694bca0946c'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: 'b567bc9f6d49b03e20b22371ae82ec2810da9579168f5ec7a75ae43008ee33ea'
### key: 'b567bc9f6d49b03e20b22371ae82ec2810da9579168f5ec7a75ae43008ee33ea'
### iv: '8ab8bed0781b71c863648aa2'
### iv: '8ab8bed0781b71c863648aa2'
### aad: '2a84956caf7f23a18ec9f5d8bfee38d8399a196bed34481aecec6e96d6f80ee2'
### aad: '2a84956caf7f23a18ec9f5d8bfee38d8399a196bed34481aecec6e96d6f80ee2'
### cipherinfo: '834a3136313637373137373850081376d108c533db3ae085bf63b45212582fdb34c61361a40936960197b92514c0fd8055f0cc57d34e17d6fb62ea24fabb924064ddea7fb20124375694bca0946c'
### cipherinfo: '834a3136313637373137373850081376d108c533db3ae085bf63b45212582fdb34c61361a40936960197b92514c0fd8055f0cc57d34e17d6fb62ea24fabb924064ddea7fb20124375694bca0946c'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'bb8e8fe64f2c40ff545c8aa2'
### iv_xor: 'bb8e8fe64f2c40ff545c8aa2'
### authtag: '081376d108c533db3ae085bf63b45212'
### authtag: '081376d108c533db3ae085bf63b45212'
### ciphertext: 'db34c61361a40936960197b92514c0fd8055f0cc57d34e17d6fb62ea24fabb924064ddea7fb20124375694bca0946c'
### ciphertext: 'db34c61361a40936960197b92514c0fd8055f0cc57d34e17d6fb62ea24fabb924064ddea7fb20124375694bca0946c'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'KK',
###                               undef,
###                               undef

### -----------end test --------: 'KK',
###                               undef,
###                               undef

### -----------start test --------: 'KK',
###                                 'test_psk',
###                                 0

### -----------start test --------: 'KK',
###                                 'test_psk',
###                                 0

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "KK",
  initiator => 1,
  message_pattens => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","5c3d78538a39678206fbb5f55bb695ea6cf89db633e3157b5b50105b99a0371b"),
    h  => pack("H*","e2e31029fa82bd995a9e4948a1232f818484de714092e6a463b099476b4737b1"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "KK",
  initiator => 1,
  message_pattens => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","5c3d78538a39678206fbb5f55bb695ea6cf89db633e3157b5b50105b99a0371b"),
    h  => pack("H*","e2e31029fa82bd995a9e4948a1232f818484de714092e6a463b099476b4737b1"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'psk'

### write message pattern: 'psk'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '03dcc0b4125fc47a83371973dcc96a5a08dab7948298cb5f8396fa342b2396bfb3'

### public compressed: '03dcc0b4125fc47a83371973dcc96a5a08dab7948298cb5f8396fa342b2396bfb3'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIKLn5L2sLO3vF+3M6r3oN72dTe7JakOliv/jBIa8I7yfoAoGCCqGSM49
',
###             'AwEHoUQDQgAE3MC0El/EeoM3GXPcyWpaCNq3lIKYy1+Dlvo0KyOWv7PSQ4WkK1Tp
',
###             'hTLrWziTaDIdiOaAeR0co2BH5FVUz65vLw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIKLn5L2sLO3vF+3M6r3oN72dTe7JakOliv/jBIa8I7yfoAoGCCqGSM49
',
###             'AwEHoUQDQgAE3MC0El/EeoM3GXPcyWpaCNq3lIKYy1+Dlvo0KyOWv7PSQ4WkK1Tp
',
###             'hTLrWziTaDIdiOaAeR0co2BH5FVUz65vLw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'c331ba972c9955cc67876d3b872f7ace0506b9c6532f063e1c948a989e46b1d9'
### z: 'c331ba972c9955cc67876d3b872f7ace0506b9c6532f063e1c948a989e46b1d9'

### write message pattern: 'ss'

### write message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### noise encrypt

### noise encrypt
### key: 'cf0f48f69fee67d5810b9b37f8df70faa22d486595114345aaa4c7327b400be9'
### key: 'cf0f48f69fee67d5810b9b37f8df70faa22d486595114345aaa4c7327b400be9'
### iv: 'dc7e4d5a5840e690dfa03cbd'
### iv: 'dc7e4d5a5840e690dfa03cbd'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'ed487c6c6f77d7a7e8983cbd'
### iv_xor: 'ed487c6c6f77d7a7e8983cbd'
### aad: '1643801ef2d8cc88031a7eaf5e751fe7f2e189cdd6512bed8c2a43229739f358'
### aad: '1643801ef2d8cc88031a7eaf5e751fe7f2e189cdd6512bed8c2a43229739f358'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '63a3616e53e95d3a'
### ciphertext: '63a3616e53e95d3a'
### authtag: '9892b89f326ecd4ffee7b1a15efc877b'
### authtag: '9892b89f326ecd4ffee7b1a15efc877b'
### cipherinfo: '834a31363136373731373738509892b89f326ecd4ffee7b1a15efc877b4863a3616e53e95d3a'
### cipherinfo: '834a31363136373731373738509892b89f326ecd4ffee7b1a15efc877b4863a3616e53e95d3a'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA9zAtBJfxHqDNxlz3MlqWgjat5SCmMtfg5b6NCsjlr+zWCaDSjE2MTY3NzE3NzhQmJK4nzJuzU/+57GhXvyHe0hjo2FuU+ldOg=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA9zAtBJfxHqDNxlz3MlqWgjat5SCmMtfg5b6NCsjlr+zWCaDSjE2MTY3NzE3NzhQmJK4nzJuzU/+57GhXvyHe0hjo2FuU+ldOg=="),
  );
}
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03dcc0b4125fc47a83371973dcc96a5a08dab7948298cb5f8396fa342b2396bfb3"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 1,
    message_pattens => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","cf37408aa5ad9b76eff8f193357e95c53ac79387dab6c09422fcbb60a7355b87"),
      h => pack("H*","5f8754f1455d7f7b98330926c1e9d7c5b3131cbb6443f8cacf62af9f4f75c108"),
      hasK => 1,
      k => pack("H*","a030190bd914d7f8094551d8c810296f5d419b3cd42f7a1c0959f4b90119b1aa"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03dcc0b4125fc47a83371973dcc96a5a08dab7948298cb5f8396fa342b2396bfb3"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 1,
    message_pattens => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","cf37408aa5ad9b76eff8f193357e95c53ac79387dab6c09422fcbb60a7355b87"),
      h => pack("H*","5f8754f1455d7f7b98330926c1e9d7c5b3131cbb6443f8cacf62af9f4f75c108"),
      hasK => 1,
      k => pack("H*","a030190bd914d7f8094551d8c810296f5d419b3cd42f7a1c0959f4b90119b1aa"),
    },
    who => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "KK",
  initiator => 0,
  message_pattens => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","5c3d78538a39678206fbb5f55bb695ea6cf89db633e3157b5b50105b99a0371b"),
    h  => pack("H*","e2e31029fa82bd995a9e4948a1232f818484de714092e6a463b099476b4737b1"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "KK",
  initiator => 0,
  message_pattens => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","5c3d78538a39678206fbb5f55bb695ea6cf89db633e3157b5b50105b99a0371b"),
    h  => pack("H*","e2e31029fa82bd995a9e4948a1232f818484de714092e6a463b099476b4737b1"),
  },
  who => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'psk'

### read message pattern: 'psk'

### read message pattern: 'e'

### read message pattern: 'e'


### read message pattern: 'es'
### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE3MC0El/EeoM3GXPcyWpaCNq3lIKY
',
###           'y1+Dlvo0KyOWv7PSQ4WkK1TphTLrWziTaDIdiOaAeR0co2BH5FVUz65vLw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE3MC0El/EeoM3GXPcyWpaCNq3lIKY
',
###           'y1+Dlvo0KyOWv7PSQ4WkK1TphTLrWziTaDIdiOaAeR0co2BH5FVUz65vLw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'c331ba972c9955cc67876d3b872f7ace0506b9c6532f063e1c948a989e46b1d9'
### z: 'c331ba972c9955cc67876d3b872f7ace0506b9c6532f063e1c948a989e46b1d9'

### read message pattern: 'ss'

### read message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### noise decrypt

### noise decrypt
### key: 'cf0f48f69fee67d5810b9b37f8df70faa22d486595114345aaa4c7327b400be9'
### key: 'cf0f48f69fee67d5810b9b37f8df70faa22d486595114345aaa4c7327b400be9'
### iv: 'dc7e4d5a5840e690dfa03cbd'
### iv: 'dc7e4d5a5840e690dfa03cbd'
### aad: '1643801ef2d8cc88031a7eaf5e751fe7f2e189cdd6512bed8c2a43229739f358'
### aad: '1643801ef2d8cc88031a7eaf5e751fe7f2e189cdd6512bed8c2a43229739f358'
### cipherinfo: '834a31363136373731373738509892b89f326ecd4ffee7b1a15efc877b4863a3616e53e95d3a'
### cipherinfo: '834a31363136373731373738509892b89f326ecd4ffee7b1a15efc877b4863a3616e53e95d3a'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'ed487c6c6f77d7a7e8983cbd'
### iv_xor: 'ed487c6c6f77d7a7e8983cbd'
### authtag: '9892b89f326ecd4ffee7b1a15efc877b'
### authtag: '9892b89f326ecd4ffee7b1a15efc877b'
### ciphertext: '63a3616e53e95d3a'
### ciphertext: '63a3616e53e95d3a'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "KK",
    initiator => 0,
    message_pattens => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","03dcc0b4125fc47a83371973dcc96a5a08dab7948298cb5f8396fa342b2396bfb3"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","cf37408aa5ad9b76eff8f193357e95c53ac79387dab6c09422fcbb60a7355b87"),
      h => pack("H*","5f8754f1455d7f7b98330926c1e9d7c5b3131cbb6443f8cacf62af9f4f75c108"),
      hasK => 1,
      k => pack("H*","a030190bd914d7f8094551d8c810296f5d419b3cd42f7a1c0959f4b90119b1aa"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "KK",
    initiator => 0,
    message_pattens => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","03dcc0b4125fc47a83371973dcc96a5a08dab7948298cb5f8396fa342b2396bfb3"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","cf37408aa5ad9b76eff8f193357e95c53ac79387dab6c09422fcbb60a7355b87"),
      h => pack("H*","5f8754f1455d7f7b98330926c1e9d7c5b3131cbb6443f8cacf62af9f4f75c108"),
      hasK => 1,
      k => pack("H*","a030190bd914d7f8094551d8c810296f5d419b3cd42f7a1c0959f4b90119b1aa"),
    },
    who => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '0366d03471d94915201db97785e96b96e4891e33e316dee956c58dad866af7fbf2'

### public compressed: '0366d03471d94915201db97785e96b96e4891e33e316dee956c58dad866af7fbf2'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINhPVGpV0nsXRRe+8ePuFSrR60xkANaP7qJ03Q1xgTU3oAoGCCqGSM49
',
###             'AwEHoUQDQgAEZtA0cdlJFSAduXeF6WuW5IkeM+MW3ulWxY2thmr3+/I3WjVGb5Og
',
###             'gys28hl6O+jYGbQ4I3ZCwuJmDGTZJxMjEw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINhPVGpV0nsXRRe+8ePuFSrR60xkANaP7qJ03Q1xgTU3oAoGCCqGSM49
',
###             'AwEHoUQDQgAEZtA0cdlJFSAduXeF6WuW5IkeM+MW3ulWxY2thmr3+/I3WjVGb5Og
',
###             'gys28hl6O+jYGbQ4I3ZCwuJmDGTZJxMjEw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE3MC0El/EeoM3GXPcyWpaCNq3lIKY
',
###           'y1+Dlvo0KyOWv7PSQ4WkK1TphTLrWziTaDIdiOaAeR0co2BH5FVUz65vLw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE3MC0El/EeoM3GXPcyWpaCNq3lIKY
',
###           'y1+Dlvo0KyOWv7PSQ4WkK1TphTLrWziTaDIdiOaAeR0co2BH5FVUz65vLw==
',
###           '-----END PUBLIC KEY-----
'
### z: '5eb2fdb09550dcbf330b9896057d1a67599a05d911908360a0b8babf1ef37384'
### z: '5eb2fdb09550dcbf330b9896057d1a67599a05d911908360a0b8babf1ef37384'

### write message pattern: 'se'

### write message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINhPVGpV0nsXRRe+8ePuFSrR60xkANaP7qJ03Q1xgTU3oAoGCCqGSM49
',
###             'AwEHoUQDQgAEZtA0cdlJFSAduXeF6WuW5IkeM+MW3ulWxY2thmr3+/I3WjVGb5Og
',
###             'gys28hl6O+jYGbQ4I3ZCwuJmDGTZJxMjEw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINhPVGpV0nsXRRe+8ePuFSrR60xkANaP7qJ03Q1xgTU3oAoGCCqGSM49
',
###             'AwEHoUQDQgAEZtA0cdlJFSAduXeF6WuW5IkeM+MW3ulWxY2thmr3+/I3WjVGb5Og
',
###             'gys28hl6O+jYGbQ4I3ZCwuJmDGTZJxMjEw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '0707033f4df5869dcb995be82ef86741b3166e3184b6ccf8f75a8dc77a5dfe18'
### z: '0707033f4df5869dcb995be82ef86741b3166e3184b6ccf8f75a8dc77a5dfe18'

### noise encrypt

### noise encrypt
### key: '160f38ef8c09e708a4ed63701725111f38d7142e9a1928cafb3dea0d4b77cc42'
### key: '160f38ef8c09e708a4ed63701725111f38d7142e9a1928cafb3dea0d4b77cc42'
### iv: 'b41659958811955ddc34ccce'
### iv: 'b41659958811955ddc34ccce'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '852068a3bf26a46aeb0cccce'
### iv_xor: '852068a3bf26a46aeb0cccce'
### aad: '99692d2d274a1ebca81d157fa68c3db0c1b3dd7414c860256fb1151d04fe14c1'
### aad: '99692d2d274a1ebca81d157fa68c3db0c1b3dd7414c860256fb1151d04fe14c1'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '8dd0812f41196891'
### ciphertext: '8dd0812f41196891'
### authtag: '0c7fc934258b9ba2e0fab9a32b567c84'
### authtag: '0c7fc934258b9ba2e0fab9a32b567c84'
### cipherinfo: '834a31363136373731373738500c7fc934258b9ba2e0fab9a32b567c84488dd0812f41196891'
### cipherinfo: '834a31363136373731373738500c7fc934258b9ba2e0fab9a32b567c84488dd0812f41196891'

### b_msg: '8258210366d03471d94915201db97785e96b96e4891e33e316dee956c58dad866af7fbf25826834a31363136373731373738500c7fc934258b9ba2e0fab9a32b567c84488dd0812f41196891'

### b_msg: '8258210366d03471d94915201db97785e96b96e4891e33e316dee956c58dad866af7fbf25826834a31363136373731373738500c7fc934258b9ba2e0fab9a32b567c84488dd0812f41196891'
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0366d03471d94915201db97785e96b96e4891e33e316dee956c58dad866af7fbf2"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 0,
    message_pattens => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","03dcc0b4125fc47a83371973dcc96a5a08dab7948298cb5f8396fa342b2396bfb3"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","79848f19458b8c2479912a69047a6773f5785d970f2f771a3568c057dbb26ae8"),
      h => pack("H*","e102e5141bd971769bbc19f2594820360ad41a88691f291dd6d3320f6c032930"),
      hasK => 1,
      k => pack("H*","4f6c380d252e99821975a295c2d540f5b88dfc3f712e71046aa4af474d2351e4"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","0cdc62780604a39753b30d0e4f0b93648d090d5c10be84b1f5557434b115ec29"),
  },
  {
    hasK => 1,
    k => pack("H*","64fbaa00976f36be85e3b21e4d3c7f98ac9c790876a981679c3c7c6b600e0664"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0366d03471d94915201db97785e96b96e4891e33e316dee956c58dad866af7fbf2"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 0,
    message_pattens => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","03dcc0b4125fc47a83371973dcc96a5a08dab7948298cb5f8396fa342b2396bfb3"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","79848f19458b8c2479912a69047a6773f5785d970f2f771a3568c057dbb26ae8"),
      h => pack("H*","e102e5141bd971769bbc19f2594820360ad41a88691f291dd6d3320f6c032930"),
      hasK => 1,
      k => pack("H*","4f6c380d252e99821975a295c2d540f5b88dfc3f712e71046aa4af474d2351e4"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","0cdc62780604a39753b30d0e4f0b93648d090d5c10be84b1f5557434b115ec29"),
  },
  {
    hasK => 1,
    k => pack("H*","64fbaa00976f36be85e3b21e4d3c7f98ac9c790876a981679c3c7c6b600e0664"),
  },
)

### a read_message from b

### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIKLn5L2sLO3vF+3M6r3oN72dTe7JakOliv/jBIa8I7yfoAoGCCqGSM49
',
###             'AwEHoUQDQgAE3MC0El/EeoM3GXPcyWpaCNq3lIKYy1+Dlvo0KyOWv7PSQ4WkK1Tp
',
###             'hTLrWziTaDIdiOaAeR0co2BH5FVUz65vLw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIKLn5L2sLO3vF+3M6r3oN72dTe7JakOliv/jBIa8I7yfoAoGCCqGSM49
',
###             'AwEHoUQDQgAE3MC0El/EeoM3GXPcyWpaCNq3lIKYy1+Dlvo0KyOWv7PSQ4WkK1Tp
',
###             'hTLrWziTaDIdiOaAeR0co2BH5FVUz65vLw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEZtA0cdlJFSAduXeF6WuW5IkeM+MW
',
###           '3ulWxY2thmr3+/I3WjVGb5Oggys28hl6O+jYGbQ4I3ZCwuJmDGTZJxMjEw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEZtA0cdlJFSAduXeF6WuW5IkeM+MW
',
###           '3ulWxY2thmr3+/I3WjVGb5Oggys28hl6O+jYGbQ4I3ZCwuJmDGTZJxMjEw==
',
###           '-----END PUBLIC KEY-----
'
### z: '5eb2fdb09550dcbf330b9896057d1a67599a05d911908360a0b8babf1ef37384'
### z: '5eb2fdb09550dcbf330b9896057d1a67599a05d911908360a0b8babf1ef37384'

### read message pattern: 'se'

### read message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEZtA0cdlJFSAduXeF6WuW5IkeM+MW
',
###           '3ulWxY2thmr3+/I3WjVGb5Oggys28hl6O+jYGbQ4I3ZCwuJmDGTZJxMjEw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEZtA0cdlJFSAduXeF6WuW5IkeM+MW
',
###           '3ulWxY2thmr3+/I3WjVGb5Oggys28hl6O+jYGbQ4I3ZCwuJmDGTZJxMjEw==
',
###           '-----END PUBLIC KEY-----
'
### z: '0707033f4df5869dcb995be82ef86741b3166e3184b6ccf8f75a8dc77a5dfe18'
### z: '0707033f4df5869dcb995be82ef86741b3166e3184b6ccf8f75a8dc77a5dfe18'

### noise decrypt

### noise decrypt
### key: '160f38ef8c09e708a4ed63701725111f38d7142e9a1928cafb3dea0d4b77cc42'
### key: '160f38ef8c09e708a4ed63701725111f38d7142e9a1928cafb3dea0d4b77cc42'
### iv: 'b41659958811955ddc34ccce'
### iv: 'b41659958811955ddc34ccce'
### aad: '99692d2d274a1ebca81d157fa68c3db0c1b3dd7414c860256fb1151d04fe14c1'
### aad: '99692d2d274a1ebca81d157fa68c3db0c1b3dd7414c860256fb1151d04fe14c1'
### cipherinfo: '834a31363136373731373738500c7fc934258b9ba2e0fab9a32b567c84488dd0812f41196891'
### cipherinfo: '834a31363136373731373738500c7fc934258b9ba2e0fab9a32b567c84488dd0812f41196891'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '852068a3bf26a46aeb0cccce'
### iv_xor: '852068a3bf26a46aeb0cccce'
### authtag: '0c7fc934258b9ba2e0fab9a32b567c84'
### authtag: '0c7fc934258b9ba2e0fab9a32b567c84'
### ciphertext: '8dd0812f41196891'
### ciphertext: '8dd0812f41196891'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03dcc0b4125fc47a83371973dcc96a5a08dab7948298cb5f8396fa342b2396bfb3"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 1,
    message_pattens => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","0366d03471d94915201db97785e96b96e4891e33e316dee956c58dad866af7fbf2"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","79848f19458b8c2479912a69047a6773f5785d970f2f771a3568c057dbb26ae8"),
      h => pack("H*","e102e5141bd971769bbc19f2594820360ad41a88691f291dd6d3320f6c032930"),
      hasK => 1,
      k => pack("H*","4f6c380d252e99821975a295c2d540f5b88dfc3f712e71046aa4af474d2351e4"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","0cdc62780604a39753b30d0e4f0b93648d090d5c10be84b1f5557434b115ec29"),
  },
  {
    hasK => 1,
    k => pack("H*","64fbaa00976f36be85e3b21e4d3c7f98ac9c790876a981679c3c7c6b600e0664"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03dcc0b4125fc47a83371973dcc96a5a08dab7948298cb5f8396fa342b2396bfb3"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 1,
    message_pattens => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","0366d03471d94915201db97785e96b96e4891e33e316dee956c58dad866af7fbf2"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","79848f19458b8c2479912a69047a6773f5785d970f2f771a3568c057dbb26ae8"),
      h => pack("H*","e102e5141bd971769bbc19f2594820360ad41a88691f291dd6d3320f6c032930"),
      hasK => 1,
      k => pack("H*","4f6c380d252e99821975a295c2d540f5b88dfc3f712e71046aa4af474d2351e4"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","0cdc62780604a39753b30d0e4f0b93648d090d5c10be84b1f5557434b115ec29"),
  },
  {
    hasK => 1,
    k => pack("H*","64fbaa00976f36be85e3b21e4d3c7f98ac9c790876a981679c3c7c6b600e0664"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '97ad62c18a0d392bbb26f6a9aa68c9c22650d5b9643e6232105155c7b968a642'
### key: '97ad62c18a0d392bbb26f6a9aa68c9c22650d5b9643e6232105155c7b968a642'
### iv: '46b796fa78891c23b85a84af'
### iv: '46b796fa78891c23b85a84af'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '7781a7cc4fbe2d148f6284af'
### iv_xor: '7781a7cc4fbe2d148f6284af'
### aad: 'e102e5141bd971769bbc19f2594820360ad41a88691f291dd6d3320f6c032930'
### aad: 'e102e5141bd971769bbc19f2594820360ad41a88691f291dd6d3320f6c032930'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '6bc0cedf4625a6f8ad7b61fba727cab590fe72b332202f011f65035460a96744cf8d36430caf6c87544ddc958bc51ed4f27918'
### ciphertext: '6bc0cedf4625a6f8ad7b61fba727cab590fe72b332202f011f65035460a96744cf8d36430caf6c87544ddc958bc51ed4f27918'
### authtag: 'dfdfe917140bdacbe57b770394451ae7'
### authtag: 'dfdfe917140bdacbe57b770394451ae7'
### cipherinfo: '834a3136313637373137373850dfdfe917140bdacbe57b770394451ae758336bc0cedf4625a6f8ad7b61fba727cab590fe72b332202f011f65035460a96744cf8d36430caf6c87544ddc958bc51ed4f27918'
### cipherinfo: '834a3136313637373137373850dfdfe917140bdacbe57b770394451ae758336bc0cedf4625a6f8ad7b61fba727cab590fe72b332202f011f65035460a96744cf8d36430caf6c87544ddc958bc51ed4f27918'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '97ad62c18a0d392bbb26f6a9aa68c9c22650d5b9643e6232105155c7b968a642'
### key: '97ad62c18a0d392bbb26f6a9aa68c9c22650d5b9643e6232105155c7b968a642'
### iv: '46b796fa78891c23b85a84af'
### iv: '46b796fa78891c23b85a84af'
### aad: 'e102e5141bd971769bbc19f2594820360ad41a88691f291dd6d3320f6c032930'
### aad: 'e102e5141bd971769bbc19f2594820360ad41a88691f291dd6d3320f6c032930'
### cipherinfo: '834a3136313637373137373850dfdfe917140bdacbe57b770394451ae758336bc0cedf4625a6f8ad7b61fba727cab590fe72b332202f011f65035460a96744cf8d36430caf6c87544ddc958bc51ed4f27918'
### cipherinfo: '834a3136313637373137373850dfdfe917140bdacbe57b770394451ae758336bc0cedf4625a6f8ad7b61fba727cab590fe72b332202f011f65035460a96744cf8d36430caf6c87544ddc958bc51ed4f27918'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '7781a7cc4fbe2d148f6284af'
### iv_xor: '7781a7cc4fbe2d148f6284af'
### authtag: 'dfdfe917140bdacbe57b770394451ae7'
### authtag: 'dfdfe917140bdacbe57b770394451ae7'
### ciphertext: '6bc0cedf4625a6f8ad7b61fba727cab590fe72b332202f011f65035460a96744cf8d36430caf6c87544ddc958bc51ed4f27918'
### ciphertext: '6bc0cedf4625a6f8ad7b61fba727cab590fe72b332202f011f65035460a96744cf8d36430caf6c87544ddc958bc51ed4f27918'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '5e7f0b85cf8dc50571f360c2c841e81f10ae3e877e7f640e315df0e7ce4960dc'
### key: '5e7f0b85cf8dc50571f360c2c841e81f10ae3e877e7f640e315df0e7ce4960dc'
### iv: '45f15f1e8539a0042e032e64'
### iv: '45f15f1e8539a0042e032e64'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '74c76e28b20e9133193b2e64'
### iv_xor: '74c76e28b20e9133193b2e64'
### aad: 'e102e5141bd971769bbc19f2594820360ad41a88691f291dd6d3320f6c032930'
### aad: 'e102e5141bd971769bbc19f2594820360ad41a88691f291dd6d3320f6c032930'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '25f14fe7f21bc4d332a97d073003d94895a3bd6fb00b5bcf67565c4248e10ec27ce035afb69877e0b9ad3578645c07'
### ciphertext: '25f14fe7f21bc4d332a97d073003d94895a3bd6fb00b5bcf67565c4248e10ec27ce035afb69877e0b9ad3578645c07'
### authtag: 'be1b050337460d8f9064d74eabc557c7'
### authtag: 'be1b050337460d8f9064d74eabc557c7'
### cipherinfo: '834a3136313637373137373850be1b050337460d8f9064d74eabc557c7582f25f14fe7f21bc4d332a97d073003d94895a3bd6fb00b5bcf67565c4248e10ec27ce035afb69877e0b9ad3578645c07'
### cipherinfo: '834a3136313637373137373850be1b050337460d8f9064d74eabc557c7582f25f14fe7f21bc4d332a97d073003d94895a3bd6fb00b5bcf67565c4248e10ec27ce035afb69877e0b9ad3578645c07'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '5e7f0b85cf8dc50571f360c2c841e81f10ae3e877e7f640e315df0e7ce4960dc'
### key: '5e7f0b85cf8dc50571f360c2c841e81f10ae3e877e7f640e315df0e7ce4960dc'
### iv: '45f15f1e8539a0042e032e64'
### iv: '45f15f1e8539a0042e032e64'
### aad: 'e102e5141bd971769bbc19f2594820360ad41a88691f291dd6d3320f6c032930'
### aad: 'e102e5141bd971769bbc19f2594820360ad41a88691f291dd6d3320f6c032930'
### cipherinfo: '834a3136313637373137373850be1b050337460d8f9064d74eabc557c7582f25f14fe7f21bc4d332a97d073003d94895a3bd6fb00b5bcf67565c4248e10ec27ce035afb69877e0b9ad3578645c07'
### cipherinfo: '834a3136313637373137373850be1b050337460d8f9064d74eabc557c7582f25f14fe7f21bc4d332a97d073003d94895a3bd6fb00b5bcf67565c4248e10ec27ce035afb69877e0b9ad3578645c07'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '74c76e28b20e9133193b2e64'
### iv_xor: '74c76e28b20e9133193b2e64'
### authtag: 'be1b050337460d8f9064d74eabc557c7'
### authtag: 'be1b050337460d8f9064d74eabc557c7'
### ciphertext: '25f14fe7f21bc4d332a97d073003d94895a3bd6fb00b5bcf67565c4248e10ec27ce035afb69877e0b9ad3578645c07'
### ciphertext: '25f14fe7f21bc4d332a97d073003d94895a3bd6fb00b5bcf67565c4248e10ec27ce035afb69877e0b9ad3578645c07'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'KK',
###                               'test_psk',
###                               0

### -----------end test --------: 'KK',
###                               'test_psk',
###                               0

### -----------start test --------: 'KK',
###                                 'test_psk',
###                                 1

### -----------start test --------: 'KK',
###                                 'test_psk',
###                                 1

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "KK",
  initiator => 1,
  message_pattens => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","775e5a71d142a55fd073e16ac4b66bdb0d5ebeccc6ca2c46b292522866ff1744"),
    h  => pack("H*","41a14466d3a4f5f098063039dc37102551d6c53e481025d75e0f99e62af4a1e3"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "KK",
  initiator => 1,
  message_pattens => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","775e5a71d142a55fd073e16ac4b66bdb0d5ebeccc6ca2c46b292522866ff1744"),
    h  => pack("H*","41a14466d3a4f5f098063039dc37102551d6c53e481025d75e0f99e62af4a1e3"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '02cc87e3b4223748770dc418862d4d54ae5554342f625f859165e89b42d2280cb9'

### public compressed: '02cc87e3b4223748770dc418862d4d54ae5554342f625f859165e89b42d2280cb9'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINBz39IV3Zj2ntsZb/Y42CF8j7Jouwj+73inSJ8064NLoAoGCCqGSM49
',
###             'AwEHoUQDQgAEzIfjtCI3SHcNxBiGLU1UrlVUNC9iX4WRZeibQtIoDLly1nODzwYO
',
###             '8VZNr4pMxFrYY2cscyNCzKfzasvNIOeWDg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINBz39IV3Zj2ntsZb/Y42CF8j7Jouwj+73inSJ8064NLoAoGCCqGSM49
',
###             'AwEHoUQDQgAEzIfjtCI3SHcNxBiGLU1UrlVUNC9iX4WRZeibQtIoDLly1nODzwYO
',
###             '8VZNr4pMxFrYY2cscyNCzKfzasvNIOeWDg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '66b9b15657c1b21df2da9cff4c2b13a4a10088ed586323f16d92dd470a8c4587'
### z: '66b9b15657c1b21df2da9cff4c2b13a4a10088ed586323f16d92dd470a8c4587'

### write message pattern: 'ss'

### write message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### write message pattern: 'psk'

### write message pattern: 'psk'

### noise encrypt

### noise encrypt
### key: 'bdaff50df9fbb3bdce218b661ec16afce24dcba532669f1a56b3be4c6832680f'
### key: 'bdaff50df9fbb3bdce218b661ec16afce24dcba532669f1a56b3be4c6832680f'
### iv: '3f0fbceac901defac351a284'
### iv: '3f0fbceac901defac351a284'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '0e398ddcfe36efcdf469a284'
### iv_xor: '0e398ddcfe36efcdf469a284'
### aad: 'eb81dd1558f8a3fb5c6bb7d1ed8b394b7b6c97211441084c28b299a0fc81f02c'
### aad: 'eb81dd1558f8a3fb5c6bb7d1ed8b394b7b6c97211441084c28b299a0fc81f02c'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: 'e93b27681dddd5e9'
### ciphertext: 'e93b27681dddd5e9'
### authtag: '288f6935eb89314c1f4b148d4b01c4c0'
### authtag: '288f6935eb89314c1f4b148d4b01c4c0'
### cipherinfo: '834a3136313637373137373850288f6935eb89314c1f4b148d4b01c4c048e93b27681dddd5e9'
### cipherinfo: '834a3136313637373137373850288f6935eb89314c1f4b148d4b01c4c048e93b27681dddd5e9'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAsyH47QiN0h3DcQYhi1NVK5VVDQvYl+FkWXom0LSKAy5WCaDSjE2MTY3NzE3NzhQKI9pNeuJMUwfSxSNSwHEwEjpOydoHd3V6Q=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAsyH47QiN0h3DcQYhi1NVK5VVDQvYl+FkWXom0LSKAy5WCaDSjE2MTY3NzE3NzhQKI9pNeuJMUwfSxSNSwHEwEjpOydoHd3V6Q=="),
  );
}
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02cc87e3b4223748770dc418862d4d54ae5554342f625f859165e89b42d2280cb9"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 1,
    message_pattens => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","64a4f5dabb7a64d66c1528c1bcd3b32800b0b8f8f383b9f6ff28e604084b6387"),
      h => pack("H*","a27cf7aa7045e937842acfd7c242b851cfe1fada477ebb4d9d538b117e6ec56e"),
      hasK => 1,
      k => pack("H*","7728b068e76f2862439c56eeb0f7f8b9f0b4b0494ed951a58b5fa040718919ee"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02cc87e3b4223748770dc418862d4d54ae5554342f625f859165e89b42d2280cb9"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 1,
    message_pattens => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","64a4f5dabb7a64d66c1528c1bcd3b32800b0b8f8f383b9f6ff28e604084b6387"),
      h => pack("H*","a27cf7aa7045e937842acfd7c242b851cfe1fada477ebb4d9d538b117e6ec56e"),
      hasK => 1,
      k => pack("H*","7728b068e76f2862439c56eeb0f7f8b9f0b4b0494ed951a58b5fa040718919ee"),
    },
    who => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "KK",
  initiator => 0,
  message_pattens => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","775e5a71d142a55fd073e16ac4b66bdb0d5ebeccc6ca2c46b292522866ff1744"),
    h  => pack("H*","41a14466d3a4f5f098063039dc37102551d6c53e481025d75e0f99e62af4a1e3"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "KK",
  initiator => 0,
  message_pattens => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","775e5a71d142a55fd073e16ac4b66bdb0d5ebeccc6ca2c46b292522866ff1744"),
    h  => pack("H*","41a14466d3a4f5f098063039dc37102551d6c53e481025d75e0f99e62af4a1e3"),
  },
  who => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEzIfjtCI3SHcNxBiGLU1UrlVUNC9i
',
###           'X4WRZeibQtIoDLly1nODzwYO8VZNr4pMxFrYY2cscyNCzKfzasvNIOeWDg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEzIfjtCI3SHcNxBiGLU1UrlVUNC9i
',
###           'X4WRZeibQtIoDLly1nODzwYO8VZNr4pMxFrYY2cscyNCzKfzasvNIOeWDg==
',
###           '-----END PUBLIC KEY-----
'
### z: '66b9b15657c1b21df2da9cff4c2b13a4a10088ed586323f16d92dd470a8c4587'
### z: '66b9b15657c1b21df2da9cff4c2b13a4a10088ed586323f16d92dd470a8c4587'

### read message pattern: 'ss'

### read message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### read message pattern: 'psk'

### read message pattern: 'psk'

### noise decrypt

### noise decrypt
### key: 'bdaff50df9fbb3bdce218b661ec16afce24dcba532669f1a56b3be4c6832680f'
### key: 'bdaff50df9fbb3bdce218b661ec16afce24dcba532669f1a56b3be4c6832680f'
### iv: '3f0fbceac901defac351a284'
### iv: '3f0fbceac901defac351a284'
### aad: 'eb81dd1558f8a3fb5c6bb7d1ed8b394b7b6c97211441084c28b299a0fc81f02c'
### aad: 'eb81dd1558f8a3fb5c6bb7d1ed8b394b7b6c97211441084c28b299a0fc81f02c'
### cipherinfo: '834a3136313637373137373850288f6935eb89314c1f4b148d4b01c4c048e93b27681dddd5e9'
### cipherinfo: '834a3136313637373137373850288f6935eb89314c1f4b148d4b01c4c048e93b27681dddd5e9'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '0e398ddcfe36efcdf469a284'
### iv_xor: '0e398ddcfe36efcdf469a284'
### authtag: '288f6935eb89314c1f4b148d4b01c4c0'
### authtag: '288f6935eb89314c1f4b148d4b01c4c0'
### ciphertext: 'e93b27681dddd5e9'
### ciphertext: 'e93b27681dddd5e9'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "KK",
    initiator => 0,
    message_pattens => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","02cc87e3b4223748770dc418862d4d54ae5554342f625f859165e89b42d2280cb9"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","64a4f5dabb7a64d66c1528c1bcd3b32800b0b8f8f383b9f6ff28e604084b6387"),
      h => pack("H*","a27cf7aa7045e937842acfd7c242b851cfe1fada477ebb4d9d538b117e6ec56e"),
      hasK => 1,
      k => pack("H*","7728b068e76f2862439c56eeb0f7f8b9f0b4b0494ed951a58b5fa040718919ee"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "KK",
    initiator => 0,
    message_pattens => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","02cc87e3b4223748770dc418862d4d54ae5554342f625f859165e89b42d2280cb9"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","64a4f5dabb7a64d66c1528c1bcd3b32800b0b8f8f383b9f6ff28e604084b6387"),
      h => pack("H*","a27cf7aa7045e937842acfd7c242b851cfe1fada477ebb4d9d538b117e6ec56e"),
      hasK => 1,
      k => pack("H*","7728b068e76f2862439c56eeb0f7f8b9f0b4b0494ed951a58b5fa040718919ee"),
    },
    who => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '03852e45a6afcabe9d7f379cfa97cbb09b2473ee9b8c860b1c013c84453e00b330'

### public compressed: '03852e45a6afcabe9d7f379cfa97cbb09b2473ee9b8c860b1c013c84453e00b330'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIAe60j1vQR0lKtENrcWDJnIW/3C15vJxy+zDqTeCOaV8oAoGCCqGSM49
',
###             'AwEHoUQDQgAEhS5Fpq/Kvp1/N5z6l8uwmyRz7puMhgscATyERT4AszA+G6SwI+tq
',
###             'AqBUXgx/Evlr/bg3FAPYlRPvt9mxWSqTDw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIAe60j1vQR0lKtENrcWDJnIW/3C15vJxy+zDqTeCOaV8oAoGCCqGSM49
',
###             'AwEHoUQDQgAEhS5Fpq/Kvp1/N5z6l8uwmyRz7puMhgscATyERT4AszA+G6SwI+tq
',
###             'AqBUXgx/Evlr/bg3FAPYlRPvt9mxWSqTDw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEzIfjtCI3SHcNxBiGLU1UrlVUNC9i
',
###           'X4WRZeibQtIoDLly1nODzwYO8VZNr4pMxFrYY2cscyNCzKfzasvNIOeWDg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEzIfjtCI3SHcNxBiGLU1UrlVUNC9i
',
###           'X4WRZeibQtIoDLly1nODzwYO8VZNr4pMxFrYY2cscyNCzKfzasvNIOeWDg==
',
###           '-----END PUBLIC KEY-----
'
### z: 'cb921b993b4611d747b540bb03d4f4a9c3323a71c1c5f9db4d479fda57850070'
### z: 'cb921b993b4611d747b540bb03d4f4a9c3323a71c1c5f9db4d479fda57850070'

### write message pattern: 'se'

### write message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIAe60j1vQR0lKtENrcWDJnIW/3C15vJxy+zDqTeCOaV8oAoGCCqGSM49
',
###             'AwEHoUQDQgAEhS5Fpq/Kvp1/N5z6l8uwmyRz7puMhgscATyERT4AszA+G6SwI+tq
',
###             'AqBUXgx/Evlr/bg3FAPYlRPvt9mxWSqTDw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIAe60j1vQR0lKtENrcWDJnIW/3C15vJxy+zDqTeCOaV8oAoGCCqGSM49
',
###             'AwEHoUQDQgAEhS5Fpq/Kvp1/N5z6l8uwmyRz7puMhgscATyERT4AszA+G6SwI+tq
',
###             'AqBUXgx/Evlr/bg3FAPYlRPvt9mxWSqTDw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '8ecd720dbf331938bc6da5a3e10650e6718b88d450da5df7449284a877c7ed47'
### z: '8ecd720dbf331938bc6da5a3e10650e6718b88d450da5df7449284a877c7ed47'

### noise encrypt

### noise encrypt
### key: 'afea402b02c7a4785598faccda93b62e201d89c62d653e54b578393489892a20'
### key: 'afea402b02c7a4785598faccda93b62e201d89c62d653e54b578393489892a20'
### iv: 'fbf4d59ddc6859ba86216164'
### iv: 'fbf4d59ddc6859ba86216164'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'cac2e4abeb5f688db1196164'
### iv_xor: 'cac2e4abeb5f688db1196164'
### aad: '641b9a01b3af228b090f23b7c221ad396f85b68f52c7e4f1e8f44e0b4e7b8e9b'
### aad: '641b9a01b3af228b090f23b7c221ad396f85b68f52c7e4f1e8f44e0b4e7b8e9b'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: 'b0113c3d53b015de'
### ciphertext: 'b0113c3d53b015de'
### authtag: '62aaf4b2c2101e7058ee8b471e904fc8'
### authtag: '62aaf4b2c2101e7058ee8b471e904fc8'
### cipherinfo: '834a313631363737313737385062aaf4b2c2101e7058ee8b471e904fc848b0113c3d53b015de'
### cipherinfo: '834a313631363737313737385062aaf4b2c2101e7058ee8b471e904fc848b0113c3d53b015de'

### b_msg: '82582103852e45a6afcabe9d7f379cfa97cbb09b2473ee9b8c860b1c013c84453e00b3305826834a313631363737313737385062aaf4b2c2101e7058ee8b471e904fc848b0113c3d53b015de'

### b_msg: '82582103852e45a6afcabe9d7f379cfa97cbb09b2473ee9b8c860b1c013c84453e00b3305826834a313631363737313737385062aaf4b2c2101e7058ee8b471e904fc848b0113c3d53b015de'
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03852e45a6afcabe9d7f379cfa97cbb09b2473ee9b8c860b1c013c84453e00b330"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 0,
    message_pattens => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","02cc87e3b4223748770dc418862d4d54ae5554342f625f859165e89b42d2280cb9"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","486ebce7fce7651efd76c0df3002a4fbf98c1270b36eeac094692c6e139ecc79"),
      h => pack("H*","126c2d0454afc396167ef87312a6770da1d3c6f8b1382d478833f40868848414"),
      hasK => 1,
      k => pack("H*","2c1ff62100a17d1ef1a6760c1e8f410c5658a97fa783674bef1ab2fffa23c543"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","956ac003f071e1520d6784e345f75a0138f72efb99d98df276c8f8a88a6222b7"),
  },
  {
    hasK => 1,
    k => pack("H*","4cd900302ca3d8e7ed357c381d4087f2cd257427226a176db3ef4ae1bde164c8"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03852e45a6afcabe9d7f379cfa97cbb09b2473ee9b8c860b1c013c84453e00b330"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 0,
    message_pattens => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","02cc87e3b4223748770dc418862d4d54ae5554342f625f859165e89b42d2280cb9"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","486ebce7fce7651efd76c0df3002a4fbf98c1270b36eeac094692c6e139ecc79"),
      h => pack("H*","126c2d0454afc396167ef87312a6770da1d3c6f8b1382d478833f40868848414"),
      hasK => 1,
      k => pack("H*","2c1ff62100a17d1ef1a6760c1e8f410c5658a97fa783674bef1ab2fffa23c543"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","956ac003f071e1520d6784e345f75a0138f72efb99d98df276c8f8a88a6222b7"),
  },
  {
    hasK => 1,
    k => pack("H*","4cd900302ca3d8e7ed357c381d4087f2cd257427226a176db3ef4ae1bde164c8"),
  },
)

### a read_message from b

### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINBz39IV3Zj2ntsZb/Y42CF8j7Jouwj+73inSJ8064NLoAoGCCqGSM49
',
###             'AwEHoUQDQgAEzIfjtCI3SHcNxBiGLU1UrlVUNC9iX4WRZeibQtIoDLly1nODzwYO
',
###             '8VZNr4pMxFrYY2cscyNCzKfzasvNIOeWDg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINBz39IV3Zj2ntsZb/Y42CF8j7Jouwj+73inSJ8064NLoAoGCCqGSM49
',
###             'AwEHoUQDQgAEzIfjtCI3SHcNxBiGLU1UrlVUNC9iX4WRZeibQtIoDLly1nODzwYO
',
###             '8VZNr4pMxFrYY2cscyNCzKfzasvNIOeWDg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhS5Fpq/Kvp1/N5z6l8uwmyRz7puM
',
###           'hgscATyERT4AszA+G6SwI+tqAqBUXgx/Evlr/bg3FAPYlRPvt9mxWSqTDw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhS5Fpq/Kvp1/N5z6l8uwmyRz7puM
',
###           'hgscATyERT4AszA+G6SwI+tqAqBUXgx/Evlr/bg3FAPYlRPvt9mxWSqTDw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'cb921b993b4611d747b540bb03d4f4a9c3323a71c1c5f9db4d479fda57850070'
### z: 'cb921b993b4611d747b540bb03d4f4a9c3323a71c1c5f9db4d479fda57850070'

### read message pattern: 'se'

### read message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhS5Fpq/Kvp1/N5z6l8uwmyRz7puM
',
###           'hgscATyERT4AszA+G6SwI+tqAqBUXgx/Evlr/bg3FAPYlRPvt9mxWSqTDw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhS5Fpq/Kvp1/N5z6l8uwmyRz7puM
',
###           'hgscATyERT4AszA+G6SwI+tqAqBUXgx/Evlr/bg3FAPYlRPvt9mxWSqTDw==
',
###           '-----END PUBLIC KEY-----
'
### z: '8ecd720dbf331938bc6da5a3e10650e6718b88d450da5df7449284a877c7ed47'
### z: '8ecd720dbf331938bc6da5a3e10650e6718b88d450da5df7449284a877c7ed47'

### noise decrypt

### noise decrypt
### key: 'afea402b02c7a4785598faccda93b62e201d89c62d653e54b578393489892a20'
### key: 'afea402b02c7a4785598faccda93b62e201d89c62d653e54b578393489892a20'
### iv: 'fbf4d59ddc6859ba86216164'
### iv: 'fbf4d59ddc6859ba86216164'
### aad: '641b9a01b3af228b090f23b7c221ad396f85b68f52c7e4f1e8f44e0b4e7b8e9b'
### aad: '641b9a01b3af228b090f23b7c221ad396f85b68f52c7e4f1e8f44e0b4e7b8e9b'
### cipherinfo: '834a313631363737313737385062aaf4b2c2101e7058ee8b471e904fc848b0113c3d53b015de'
### cipherinfo: '834a313631363737313737385062aaf4b2c2101e7058ee8b471e904fc848b0113c3d53b015de'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'cac2e4abeb5f688db1196164'
### iv_xor: 'cac2e4abeb5f688db1196164'
### authtag: '62aaf4b2c2101e7058ee8b471e904fc8'
### authtag: '62aaf4b2c2101e7058ee8b471e904fc8'
### ciphertext: 'b0113c3d53b015de'
### ciphertext: 'b0113c3d53b015de'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02cc87e3b4223748770dc418862d4d54ae5554342f625f859165e89b42d2280cb9"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 1,
    message_pattens => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","03852e45a6afcabe9d7f379cfa97cbb09b2473ee9b8c860b1c013c84453e00b330"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","486ebce7fce7651efd76c0df3002a4fbf98c1270b36eeac094692c6e139ecc79"),
      h => pack("H*","126c2d0454afc396167ef87312a6770da1d3c6f8b1382d478833f40868848414"),
      hasK => 1,
      k => pack("H*","2c1ff62100a17d1ef1a6760c1e8f410c5658a97fa783674bef1ab2fffa23c543"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","956ac003f071e1520d6784e345f75a0138f72efb99d98df276c8f8a88a6222b7"),
  },
  {
    hasK => 1,
    k => pack("H*","4cd900302ca3d8e7ed357c381d4087f2cd257427226a176db3ef4ae1bde164c8"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02cc87e3b4223748770dc418862d4d54ae5554342f625f859165e89b42d2280cb9"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    initiator => 1,
    message_pattens => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","03852e45a6afcabe9d7f379cfa97cbb09b2473ee9b8c860b1c013c84453e00b330"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","486ebce7fce7651efd76c0df3002a4fbf98c1270b36eeac094692c6e139ecc79"),
      h => pack("H*","126c2d0454afc396167ef87312a6770da1d3c6f8b1382d478833f40868848414"),
      hasK => 1,
      k => pack("H*","2c1ff62100a17d1ef1a6760c1e8f410c5658a97fa783674bef1ab2fffa23c543"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","956ac003f071e1520d6784e345f75a0138f72efb99d98df276c8f8a88a6222b7"),
  },
  {
    hasK => 1,
    k => pack("H*","4cd900302ca3d8e7ed357c381d4087f2cd257427226a176db3ef4ae1bde164c8"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: 'e31094ba2ebf78f29fa996e5d32e178996548901403904c960d61f0f2b8d5057'
### key: 'e31094ba2ebf78f29fa996e5d32e178996548901403904c960d61f0f2b8d5057'
### iv: '746c4ae733133bccd2784e74'
### iv: '746c4ae733133bccd2784e74'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '455a7bd104240afbe5404e74'
### iv_xor: '455a7bd104240afbe5404e74'
### aad: '126c2d0454afc396167ef87312a6770da1d3c6f8b1382d478833f40868848414'
### aad: '126c2d0454afc396167ef87312a6770da1d3c6f8b1382d478833f40868848414'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '9e201e123ef92c771f8e3daff66a964a3ccef6810cd9e7e79e94ff46bc824c0a7733002b72268b9b5e4cb56ba4fb2de8262044'
### ciphertext: '9e201e123ef92c771f8e3daff66a964a3ccef6810cd9e7e79e94ff46bc824c0a7733002b72268b9b5e4cb56ba4fb2de8262044'
### authtag: '94f1d1452a985b9382e21c1c43304365'
### authtag: '94f1d1452a985b9382e21c1c43304365'
### cipherinfo: '834a313631363737313737385094f1d1452a985b9382e21c1c4330436558339e201e123ef92c771f8e3daff66a964a3ccef6810cd9e7e79e94ff46bc824c0a7733002b72268b9b5e4cb56ba4fb2de8262044'
### cipherinfo: '834a313631363737313737385094f1d1452a985b9382e21c1c4330436558339e201e123ef92c771f8e3daff66a964a3ccef6810cd9e7e79e94ff46bc824c0a7733002b72268b9b5e4cb56ba4fb2de8262044'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: 'e31094ba2ebf78f29fa996e5d32e178996548901403904c960d61f0f2b8d5057'
### key: 'e31094ba2ebf78f29fa996e5d32e178996548901403904c960d61f0f2b8d5057'
### iv: '746c4ae733133bccd2784e74'
### iv: '746c4ae733133bccd2784e74'
### aad: '126c2d0454afc396167ef87312a6770da1d3c6f8b1382d478833f40868848414'
### aad: '126c2d0454afc396167ef87312a6770da1d3c6f8b1382d478833f40868848414'
### cipherinfo: '834a313631363737313737385094f1d1452a985b9382e21c1c4330436558339e201e123ef92c771f8e3daff66a964a3ccef6810cd9e7e79e94ff46bc824c0a7733002b72268b9b5e4cb56ba4fb2de8262044'
### cipherinfo: '834a313631363737313737385094f1d1452a985b9382e21c1c4330436558339e201e123ef92c771f8e3daff66a964a3ccef6810cd9e7e79e94ff46bc824c0a7733002b72268b9b5e4cb56ba4fb2de8262044'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '455a7bd104240afbe5404e74'
### iv_xor: '455a7bd104240afbe5404e74'
### authtag: '94f1d1452a985b9382e21c1c43304365'
### authtag: '94f1d1452a985b9382e21c1c43304365'
### ciphertext: '9e201e123ef92c771f8e3daff66a964a3ccef6810cd9e7e79e94ff46bc824c0a7733002b72268b9b5e4cb56ba4fb2de8262044'
### ciphertext: '9e201e123ef92c771f8e3daff66a964a3ccef6810cd9e7e79e94ff46bc824c0a7733002b72268b9b5e4cb56ba4fb2de8262044'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: 'cba0d865f4355107c9474567509833751a22981fcc7dc641d852ef3b36560c16'
### key: 'cba0d865f4355107c9474567509833751a22981fcc7dc641d852ef3b36560c16'
### iv: 'cdf9344b327727f22597b86a'
### iv: 'cdf9344b327727f22597b86a'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'fccf057d054016c512afb86a'
### iv_xor: 'fccf057d054016c512afb86a'
### aad: '126c2d0454afc396167ef87312a6770da1d3c6f8b1382d478833f40868848414'
### aad: '126c2d0454afc396167ef87312a6770da1d3c6f8b1382d478833f40868848414'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '48e5057b55e2646149742f0643be0af803a4618589cd873283fd6e9c7d7b172efa0238bb9597db444dfe5c03c4c40b'
### ciphertext: '48e5057b55e2646149742f0643be0af803a4618589cd873283fd6e9c7d7b172efa0238bb9597db444dfe5c03c4c40b'
### authtag: '9c4b1e62f99bb5b4c6cac0847479e303'
### authtag: '9c4b1e62f99bb5b4c6cac0847479e303'
### cipherinfo: '834a31363136373731373738509c4b1e62f99bb5b4c6cac0847479e303582f48e5057b55e2646149742f0643be0af803a4618589cd873283fd6e9c7d7b172efa0238bb9597db444dfe5c03c4c40b'
### cipherinfo: '834a31363136373731373738509c4b1e62f99bb5b4c6cac0847479e303582f48e5057b55e2646149742f0643be0af803a4618589cd873283fd6e9c7d7b172efa0238bb9597db444dfe5c03c4c40b'

### a recv comm msg from b

### a recv comm msg from b


### noise decrypt
### noise decrypt
### key: 'cba0d865f4355107c9474567509833751a22981fcc7dc641d852ef3b36560c16'
### key: 'cba0d865f4355107c9474567509833751a22981fcc7dc641d852ef3b36560c16'
### iv: 'cdf9344b327727f22597b86a'
### iv: 'cdf9344b327727f22597b86a'
### aad: '126c2d0454afc396167ef87312a6770da1d3c6f8b1382d478833f40868848414'
### aad: '126c2d0454afc396167ef87312a6770da1d3c6f8b1382d478833f40868848414'
### cipherinfo: '834a31363136373731373738509c4b1e62f99bb5b4c6cac0847479e303582f48e5057b55e2646149742f0643be0af803a4618589cd873283fd6e9c7d7b172efa0238bb9597db444dfe5c03c4c40b'
### cipherinfo: '834a31363136373731373738509c4b1e62f99bb5b4c6cac0847479e303582f48e5057b55e2646149742f0643be0af803a4618589cd873283fd6e9c7d7b172efa0238bb9597db444dfe5c03c4c40b'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'fccf057d054016c512afb86a'
### iv_xor: 'fccf057d054016c512afb86a'
### authtag: '9c4b1e62f99bb5b4c6cac0847479e303'
### authtag: '9c4b1e62f99bb5b4c6cac0847479e303'
### ciphertext: '48e5057b55e2646149742f0643be0af803a4618589cd873283fd6e9c7d7b172efa0238bb9597db444dfe5c03c4c40b'
### ciphertext: '48e5057b55e2646149742f0643be0af803a4618589cd873283fd6e9c7d7b172efa0238bb9597db444dfe5c03c4c40b'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'KK',
###                               'test_psk',
###                               1

### -----------end test --------: 'KK',
###                               'test_psk',
###                               1


### -----------start test --------: 'IK',
###                                 undef,
###                                 undef
### -----------start test --------: 'IK',
###                                 undef,
###                                 undef

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IK",
  initiator => 1,
  message_pattens => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => "Noise_IK_secp256r1_AESGCM_SHA256",
    h  => pack("H*","5d67d84f26812693c811d4d6cc2681c5b62f7599e6a8d06f7811136a425fbdc1"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IK",
  initiator => 1,
  message_pattens => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => "Noise_IK_secp256r1_AESGCM_SHA256",
    h  => pack("H*","5d67d84f26812693c811d4d6cc2681c5b62f7599e6a8d06f7811136a425fbdc1"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '0213b9aaf3dc520c6f0165a1b0cfc8201f6f6c9bb17f4fee36c924e2e4b4344c3e'

### public compressed: '0213b9aaf3dc520c6f0165a1b0cfc8201f6f6c9bb17f4fee36c924e2e4b4344c3e'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPAf8VcfjD6OcE/zDcXlIkF44S2ZzsGtm19ozAd2RN3KoAoGCCqGSM49
',
###             'AwEHoUQDQgAEE7mq89xSDG8BZaGwz8ggH29sm7F/T+42ySTi5LQ0TD6DG1eH2IYn
',
###             'HsOh0JlPlP9ToYoWslu3wWaZh4VOvzPqPA==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPAf8VcfjD6OcE/zDcXlIkF44S2ZzsGtm19ozAd2RN3KoAoGCCqGSM49
',
###             'AwEHoUQDQgAEE7mq89xSDG8BZaGwz8ggH29sm7F/T+42ySTi5LQ0TD6DG1eH2IYn
',
###             'HsOh0JlPlP9ToYoWslu3wWaZh4VOvzPqPA==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'fdc4f228ffb2e8f3ae1367bf2a9b317ec5c997dc1c6854c63c0ad089ca0f77a9'
### z: 'fdc4f228ffb2e8f3ae1367bf2a9b317ec5c997dc1c6854c63c0ad089ca0f77a9'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '2a3ba6bf9122611ea625e3378a8dade3ea0cf1751473f57251eafff3b00749c6'
### key: '2a3ba6bf9122611ea625e3378a8dade3ea0cf1751473f57251eafff3b00749c6'
### iv: '1cff64f9d121238e5da1fd18'
### iv: '1cff64f9d121238e5da1fd18'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '2dc955cfe61612b96a99fd18'
### iv_xor: '2dc955cfe61612b96a99fd18'
### aad: '5b7eb0c8dd1f89ec4f29c702f093df026a50257c8ee81064a6a5ade5f18165ad'
### aad: '5b7eb0c8dd1f89ec4f29c702f093df026a50257c8ee81064a6a5ade5f18165ad'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: '9aa93b7580753fa5aaaa6cef18b1c06303016575baed552336646d2a9646de8bad2d22c023cac4c7'
### ciphertext: '9aa93b7580753fa5aaaa6cef18b1c06303016575baed552336646d2a9646de8bad2d22c023cac4c7'
### authtag: 'a0bde92853cc1165bc2d2c6288227b42'
### authtag: 'a0bde92853cc1165bc2d2c6288227b42'
### cipherinfo: '834a3136313637373137373850a0bde92853cc1165bc2d2c6288227b4258289aa93b7580753fa5aaaa6cef18b1c06303016575baed552336646d2a9646de8bad2d22c023cac4c7'
### cipherinfo: '834a3136313637373137373850a0bde92853cc1165bc2d2c6288227b4258289aa93b7580753fa5aaaa6cef18b1c06303016575baed552336646d2a9646de8bad2d22c023cac4c7'

### write message pattern: 'ss'

### write message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### noise encrypt

### noise encrypt
### key: '1eb693f522c76c38f009cfd8a0ba5e0c33b94132aa7c55e473503fb2f1348b17'
### key: '1eb693f522c76c38f009cfd8a0ba5e0c33b94132aa7c55e473503fb2f1348b17'
### iv: '82de1f804fb5ef61b7d998f9'
### iv: '82de1f804fb5ef61b7d998f9'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'b3e82eb67882de5680e198f9'
### iv_xor: 'b3e82eb67882de5680e198f9'
### aad: '653caca8306e7c4dd99f080158962ffbf352732494130b9995d37238c9ced95a'
### aad: '653caca8306e7c4dd99f080158962ffbf352732494130b9995d37238c9ced95a'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '0c8e02a736d149e0'
### ciphertext: '0c8e02a736d149e0'
### authtag: 'c88ee6671a6d1070dba66be4d11dcf0c'
### authtag: 'c88ee6671a6d1070dba66be4d11dcf0c'
### cipherinfo: '834a3136313637373137373850c88ee6671a6d1070dba66be4d11dcf0c480c8e02a736d149e0'
### cipherinfo: '834a3136313637373137373850c88ee6671a6d1070dba66be4d11dcf0c480c8e02a736d149e0'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghAhO5qvPcUgxvAWWhsM/IIB9vbJuxf0/uNskk4uS0NEw+WEeDSjE2MTY3NzE3NzhQoL3pKFPMEWW8LSxiiCJ7Qlgomqk7dYB1P6WqqmzvGLHAYwMBZXW67VUjNmRtKpZG3outLSLAI8rEx1gmg0oxNjE2NzcxNzc4UMiO5mcabRBw26Zr5NEdzwxIDI4CpzbRSeA="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghAhO5qvPcUgxvAWWhsM/IIB9vbJuxf0/uNskk4uS0NEw+WEeDSjE2MTY3NzE3NzhQoL3pKFPMEWW8LSxiiCJ7Qlgomqk7dYB1P6WqqmzvGLHAYwMBZXW67VUjNmRtKpZG3outLSLAI8rEx1gmg0oxNjE2NzcxNzc4UMiO5mcabRBw26Zr5NEdzwxIDI4CpzbRSeA="),
  );
}
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0213b9aaf3dc520c6f0165a1b0cfc8201f6f6c9bb17f4fee36c924e2e4b4344c3e"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 1,
    message_pattens => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","13ba8e14b4aa37515a2b68c86cb008b5c65d27193736b6eadc1cbda04c9807b9"),
      h => pack("H*","ef98a9dc5b8c1d9eeb77f328f72ab6049e028531ad90dbaa9f75bbad0c855222"),
      hasK => 1,
      k => pack("H*","43b60a30baac5430191e26727a0bd2e56528479d84cede91ea3fe9b4ad861317"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0213b9aaf3dc520c6f0165a1b0cfc8201f6f6c9bb17f4fee36c924e2e4b4344c3e"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 1,
    message_pattens => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","13ba8e14b4aa37515a2b68c86cb008b5c65d27193736b6eadc1cbda04c9807b9"),
      h => pack("H*","ef98a9dc5b8c1d9eeb77f328f72ab6049e028531ad90dbaa9f75bbad0c855222"),
      hasK => 1,
      k => pack("H*","43b60a30baac5430191e26727a0bd2e56528479d84cede91ea3fe9b4ad861317"),
    },
    who => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IK",
  initiator => 0,
  message_pattens => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => "Noise_IK_secp256r1_AESGCM_SHA256",
    h  => pack("H*","5d67d84f26812693c811d4d6cc2681c5b62f7599e6a8d06f7811136a425fbdc1"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IK",
  initiator => 0,
  message_pattens => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => "Noise_IK_secp256r1_AESGCM_SHA256",
    h  => pack("H*","5d67d84f26812693c811d4d6cc2681c5b62f7599e6a8d06f7811136a425fbdc1"),
  },
  who => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEE7mq89xSDG8BZaGwz8ggH29sm7F/
',
###           'T+42ySTi5LQ0TD6DG1eH2IYnHsOh0JlPlP9ToYoWslu3wWaZh4VOvzPqPA==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEE7mq89xSDG8BZaGwz8ggH29sm7F/
',
###           'T+42ySTi5LQ0TD6DG1eH2IYnHsOh0JlPlP9ToYoWslu3wWaZh4VOvzPqPA==
',
###           '-----END PUBLIC KEY-----
'
### z: 'fdc4f228ffb2e8f3ae1367bf2a9b317ec5c997dc1c6854c63c0ad089ca0f77a9'
### z: 'fdc4f228ffb2e8f3ae1367bf2a9b317ec5c997dc1c6854c63c0ad089ca0f77a9'


### read message pattern: 's'
### read message pattern: 's'


### noise decrypt
### noise decrypt
### key: '2a3ba6bf9122611ea625e3378a8dade3ea0cf1751473f57251eafff3b00749c6'
### key: '2a3ba6bf9122611ea625e3378a8dade3ea0cf1751473f57251eafff3b00749c6'
### iv: '1cff64f9d121238e5da1fd18'
### iv: '1cff64f9d121238e5da1fd18'
### aad: '5b7eb0c8dd1f89ec4f29c702f093df026a50257c8ee81064a6a5ade5f18165ad'
### aad: '5b7eb0c8dd1f89ec4f29c702f093df026a50257c8ee81064a6a5ade5f18165ad'
### cipherinfo: '834a3136313637373137373850a0bde92853cc1165bc2d2c6288227b4258289aa93b7580753fa5aaaa6cef18b1c06303016575baed552336646d2a9646de8bad2d22c023cac4c7'
### cipherinfo: '834a3136313637373137373850a0bde92853cc1165bc2d2c6288227b4258289aa93b7580753fa5aaaa6cef18b1c06303016575baed552336646d2a9646de8bad2d22c023cac4c7'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '2dc955cfe61612b96a99fd18'
### iv_xor: '2dc955cfe61612b96a99fd18'
### authtag: 'a0bde92853cc1165bc2d2c6288227b42'
### authtag: 'a0bde92853cc1165bc2d2c6288227b42'
### ciphertext: '9aa93b7580753fa5aaaa6cef18b1c06303016575baed552336646d2a9646de8bad2d22c023cac4c7'
### ciphertext: '9aa93b7580753fa5aaaa6cef18b1c06303016575baed552336646d2a9646de8bad2d22c023cac4c7'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### read message pattern: 'ss'

### read message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### noise decrypt
### noise decrypt
### key: '1eb693f522c76c38f009cfd8a0ba5e0c33b94132aa7c55e473503fb2f1348b17'
### key: '1eb693f522c76c38f009cfd8a0ba5e0c33b94132aa7c55e473503fb2f1348b17'
### iv: '82de1f804fb5ef61b7d998f9'
### iv: '82de1f804fb5ef61b7d998f9'
### aad: '653caca8306e7c4dd99f080158962ffbf352732494130b9995d37238c9ced95a'
### aad: '653caca8306e7c4dd99f080158962ffbf352732494130b9995d37238c9ced95a'
### cipherinfo: '834a3136313637373137373850c88ee6671a6d1070dba66be4d11dcf0c480c8e02a736d149e0'
### cipherinfo: '834a3136313637373137373850c88ee6671a6d1070dba66be4d11dcf0c480c8e02a736d149e0'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'b3e82eb67882de5680e198f9'
### iv_xor: 'b3e82eb67882de5680e198f9'
### authtag: 'c88ee6671a6d1070dba66be4d11dcf0c'
### authtag: 'c88ee6671a6d1070dba66be4d11dcf0c'
### ciphertext: '0c8e02a736d149e0'
### ciphertext: '0c8e02a736d149e0'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "IK",
    initiator => 0,
    message_pattens => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","0213b9aaf3dc520c6f0165a1b0cfc8201f6f6c9bb17f4fee36c924e2e4b4344c3e"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","13ba8e14b4aa37515a2b68c86cb008b5c65d27193736b6eadc1cbda04c9807b9"),
      h => pack("H*","ef98a9dc5b8c1d9eeb77f328f72ab6049e028531ad90dbaa9f75bbad0c855222"),
      hasK => 1,
      k => pack("H*","43b60a30baac5430191e26727a0bd2e56528479d84cede91ea3fe9b4ad861317"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "IK",
    initiator => 0,
    message_pattens => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","0213b9aaf3dc520c6f0165a1b0cfc8201f6f6c9bb17f4fee36c924e2e4b4344c3e"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","13ba8e14b4aa37515a2b68c86cb008b5c65d27193736b6eadc1cbda04c9807b9"),
      h => pack("H*","ef98a9dc5b8c1d9eeb77f328f72ab6049e028531ad90dbaa9f75bbad0c855222"),
      hasK => 1,
      k => pack("H*","43b60a30baac5430191e26727a0bd2e56528479d84cede91ea3fe9b4ad861317"),
    },
    who => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '034d6ed912d262d900071504f1772418d5d50fc7fa0f3bb1a7a162cdabda0a2dc0'

### public compressed: '034d6ed912d262d900071504f1772418d5d50fc7fa0f3bb1a7a162cdabda0a2dc0'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPxL/Aic4u9/7EJaJG/I7oI4fb0q8a6S8o3c7ejvggCvoAoGCCqGSM49
',
###             'AwEHoUQDQgAETW7ZEtJi2QAHFQTxdyQY1dUPx/oPO7GnoWLNq9oKLcBH1x5iU5M+
',
###             'JDTYb3gttfFafF7mW273pcCLeFdGFLUN3w==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPxL/Aic4u9/7EJaJG/I7oI4fb0q8a6S8o3c7ejvggCvoAoGCCqGSM49
',
###             'AwEHoUQDQgAETW7ZEtJi2QAHFQTxdyQY1dUPx/oPO7GnoWLNq9oKLcBH1x5iU5M+
',
###             'JDTYb3gttfFafF7mW273pcCLeFdGFLUN3w==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEE7mq89xSDG8BZaGwz8ggH29sm7F/
',
###           'T+42ySTi5LQ0TD6DG1eH2IYnHsOh0JlPlP9ToYoWslu3wWaZh4VOvzPqPA==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEE7mq89xSDG8BZaGwz8ggH29sm7F/
',
###           'T+42ySTi5LQ0TD6DG1eH2IYnHsOh0JlPlP9ToYoWslu3wWaZh4VOvzPqPA==
',
###           '-----END PUBLIC KEY-----
'
### z: '0a4d752351c2d4d305c7184e2ca892de802295638bff0575cb14d4332f990892'
### z: '0a4d752351c2d4d305c7184e2ca892de802295638bff0575cb14d4332f990892'

### write message pattern: 'se'

### write message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPxL/Aic4u9/7EJaJG/I7oI4fb0q8a6S8o3c7ejvggCvoAoGCCqGSM49
',
###             'AwEHoUQDQgAETW7ZEtJi2QAHFQTxdyQY1dUPx/oPO7GnoWLNq9oKLcBH1x5iU5M+
',
###             'JDTYb3gttfFafF7mW273pcCLeFdGFLUN3w==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPxL/Aic4u9/7EJaJG/I7oI4fb0q8a6S8o3c7ejvggCvoAoGCCqGSM49
',
###             'AwEHoUQDQgAETW7ZEtJi2QAHFQTxdyQY1dUPx/oPO7GnoWLNq9oKLcBH1x5iU5M+
',
###             'JDTYb3gttfFafF7mW273pcCLeFdGFLUN3w==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'fa0d0644239d8cee1112a63a43204d3b724f9a3cd3916bfc242791659b417d08'
### z: 'fa0d0644239d8cee1112a63a43204d3b724f9a3cd3916bfc242791659b417d08'


### noise encrypt
### noise encrypt
### key: '3ad150e9dcca8224c96da2f29c4c0f7d20652ebb188b57494fbd85c29495e374'
### key: '3ad150e9dcca8224c96da2f29c4c0f7d20652ebb188b57494fbd85c29495e374'
### iv: 'fe031c0892e37f0dcab1593f'
### iv: 'fe031c0892e37f0dcab1593f'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'cf352d3ea5d44e3afd89593f'
### iv_xor: 'cf352d3ea5d44e3afd89593f'
### aad: '1519ded1783387eab191469439c98b20d164bd08104b47e91622ee0a9c96a47d'
### aad: '1519ded1783387eab191469439c98b20d164bd08104b47e91622ee0a9c96a47d'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: 'dc251adae4fe54b6'
### ciphertext: 'dc251adae4fe54b6'
### authtag: '56556d57aed2f7fffbf04890b0266eb4'
### authtag: '56556d57aed2f7fffbf04890b0266eb4'
### cipherinfo: '834a313631363737313737385056556d57aed2f7fffbf04890b0266eb448dc251adae4fe54b6'
### cipherinfo: '834a313631363737313737385056556d57aed2f7fffbf04890b0266eb448dc251adae4fe54b6'


### b_msg: '825821034d6ed912d262d900071504f1772418d5d50fc7fa0f3bb1a7a162cdabda0a2dc05826834a313631363737313737385056556d57aed2f7fffbf04890b0266eb448dc251adae4fe54b6'
### b_msg: '825821034d6ed912d262d900071504f1772418d5d50fc7fa0f3bb1a7a162cdabda0a2dc05826834a313631363737313737385056556d57aed2f7fffbf04890b0266eb448dc251adae4fe54b6'
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","034d6ed912d262d900071504f1772418d5d50fc7fa0f3bb1a7a162cdabda0a2dc0"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 0,
    message_pattens => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","0213b9aaf3dc520c6f0165a1b0cfc8201f6f6c9bb17f4fee36c924e2e4b4344c3e"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","8732b3b8e57bac8b323d21990a3668f52f9755c26b48f61de19b3c43a924f9ad"),
      h => pack("H*","ac889fa8b278bf120f638c41c2d6b655a8f7dd56586e65611a0991e6b3e3b610"),
      hasK => 1,
      k => pack("H*","99ea41826845aecd67ba832db1da793bfbee787aaafbc0b7f08c3bef4f404929"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","6f70c51ca8b3205027988612e6595fd3abd151f5485fbe26abd98689234bc80d"),
  },
  {
    hasK => 1,
    k => pack("H*","e2acddcb337f5df85fd569499b218cca470e0e68aff026c6ea1fb2667c5b9be7"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","034d6ed912d262d900071504f1772418d5d50fc7fa0f3bb1a7a162cdabda0a2dc0"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 0,
    message_pattens => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","0213b9aaf3dc520c6f0165a1b0cfc8201f6f6c9bb17f4fee36c924e2e4b4344c3e"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","8732b3b8e57bac8b323d21990a3668f52f9755c26b48f61de19b3c43a924f9ad"),
      h => pack("H*","ac889fa8b278bf120f638c41c2d6b655a8f7dd56586e65611a0991e6b3e3b610"),
      hasK => 1,
      k => pack("H*","99ea41826845aecd67ba832db1da793bfbee787aaafbc0b7f08c3bef4f404929"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","6f70c51ca8b3205027988612e6595fd3abd151f5485fbe26abd98689234bc80d"),
  },
  {
    hasK => 1,
    k => pack("H*","e2acddcb337f5df85fd569499b218cca470e0e68aff026c6ea1fb2667c5b9be7"),
  },
)

### a read_message from b

### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPAf8VcfjD6OcE/zDcXlIkF44S2ZzsGtm19ozAd2RN3KoAoGCCqGSM49
',
###             'AwEHoUQDQgAEE7mq89xSDG8BZaGwz8ggH29sm7F/T+42ySTi5LQ0TD6DG1eH2IYn
',
###             'HsOh0JlPlP9ToYoWslu3wWaZh4VOvzPqPA==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPAf8VcfjD6OcE/zDcXlIkF44S2ZzsGtm19ozAd2RN3KoAoGCCqGSM49
',
###             'AwEHoUQDQgAEE7mq89xSDG8BZaGwz8ggH29sm7F/T+42ySTi5LQ0TD6DG1eH2IYn
',
###             'HsOh0JlPlP9ToYoWslu3wWaZh4VOvzPqPA==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAETW7ZEtJi2QAHFQTxdyQY1dUPx/oP
',
###           'O7GnoWLNq9oKLcBH1x5iU5M+JDTYb3gttfFafF7mW273pcCLeFdGFLUN3w==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAETW7ZEtJi2QAHFQTxdyQY1dUPx/oP
',
###           'O7GnoWLNq9oKLcBH1x5iU5M+JDTYb3gttfFafF7mW273pcCLeFdGFLUN3w==
',
###           '-----END PUBLIC KEY-----
'
### z: '0a4d752351c2d4d305c7184e2ca892de802295638bff0575cb14d4332f990892'
### z: '0a4d752351c2d4d305c7184e2ca892de802295638bff0575cb14d4332f990892'

### read message pattern: 'se'

### read message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAETW7ZEtJi2QAHFQTxdyQY1dUPx/oP
',
###           'O7GnoWLNq9oKLcBH1x5iU5M+JDTYb3gttfFafF7mW273pcCLeFdGFLUN3w==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAETW7ZEtJi2QAHFQTxdyQY1dUPx/oP
',
###           'O7GnoWLNq9oKLcBH1x5iU5M+JDTYb3gttfFafF7mW273pcCLeFdGFLUN3w==
',
###           '-----END PUBLIC KEY-----
'
### z: 'fa0d0644239d8cee1112a63a43204d3b724f9a3cd3916bfc242791659b417d08'
### z: 'fa0d0644239d8cee1112a63a43204d3b724f9a3cd3916bfc242791659b417d08'

### noise decrypt

### noise decrypt
### key: '3ad150e9dcca8224c96da2f29c4c0f7d20652ebb188b57494fbd85c29495e374'
### key: '3ad150e9dcca8224c96da2f29c4c0f7d20652ebb188b57494fbd85c29495e374'
### iv: 'fe031c0892e37f0dcab1593f'
### iv: 'fe031c0892e37f0dcab1593f'
### aad: '1519ded1783387eab191469439c98b20d164bd08104b47e91622ee0a9c96a47d'
### aad: '1519ded1783387eab191469439c98b20d164bd08104b47e91622ee0a9c96a47d'
### cipherinfo: '834a313631363737313737385056556d57aed2f7fffbf04890b0266eb448dc251adae4fe54b6'
### cipherinfo: '834a313631363737313737385056556d57aed2f7fffbf04890b0266eb448dc251adae4fe54b6'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'cf352d3ea5d44e3afd89593f'
### iv_xor: 'cf352d3ea5d44e3afd89593f'
### authtag: '56556d57aed2f7fffbf04890b0266eb4'
### authtag: '56556d57aed2f7fffbf04890b0266eb4'
### ciphertext: 'dc251adae4fe54b6'
### ciphertext: 'dc251adae4fe54b6'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0213b9aaf3dc520c6f0165a1b0cfc8201f6f6c9bb17f4fee36c924e2e4b4344c3e"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 1,
    message_pattens => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","034d6ed912d262d900071504f1772418d5d50fc7fa0f3bb1a7a162cdabda0a2dc0"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","8732b3b8e57bac8b323d21990a3668f52f9755c26b48f61de19b3c43a924f9ad"),
      h => pack("H*","ac889fa8b278bf120f638c41c2d6b655a8f7dd56586e65611a0991e6b3e3b610"),
      hasK => 1,
      k => pack("H*","99ea41826845aecd67ba832db1da793bfbee787aaafbc0b7f08c3bef4f404929"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","6f70c51ca8b3205027988612e6595fd3abd151f5485fbe26abd98689234bc80d"),
  },
  {
    hasK => 1,
    k => pack("H*","e2acddcb337f5df85fd569499b218cca470e0e68aff026c6ea1fb2667c5b9be7"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0213b9aaf3dc520c6f0165a1b0cfc8201f6f6c9bb17f4fee36c924e2e4b4344c3e"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 1,
    message_pattens => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","034d6ed912d262d900071504f1772418d5d50fc7fa0f3bb1a7a162cdabda0a2dc0"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","8732b3b8e57bac8b323d21990a3668f52f9755c26b48f61de19b3c43a924f9ad"),
      h => pack("H*","ac889fa8b278bf120f638c41c2d6b655a8f7dd56586e65611a0991e6b3e3b610"),
      hasK => 1,
      k => pack("H*","99ea41826845aecd67ba832db1da793bfbee787aaafbc0b7f08c3bef4f404929"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","6f70c51ca8b3205027988612e6595fd3abd151f5485fbe26abd98689234bc80d"),
  },
  {
    hasK => 1,
    k => pack("H*","e2acddcb337f5df85fd569499b218cca470e0e68aff026c6ea1fb2667c5b9be7"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '7f2743166e1c78c72f26f35f260e073cc3ec375f1025f8b3d305307378cd88dd'
### key: '7f2743166e1c78c72f26f35f260e073cc3ec375f1025f8b3d305307378cd88dd'
### iv: '397c3e08969571032c6d3d26'
### iv: '397c3e08969571032c6d3d26'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '084a0f3ea1a240341b553d26'
### iv_xor: '084a0f3ea1a240341b553d26'
### aad: 'ac889fa8b278bf120f638c41c2d6b655a8f7dd56586e65611a0991e6b3e3b610'
### aad: 'ac889fa8b278bf120f638c41c2d6b655a8f7dd56586e65611a0991e6b3e3b610'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'b35460a70b2252156eb03fa441dd9ae8a0137a61cc05a39fcea5aab935792c38085a050958f0b5bcd72ed10ddc3b1d2291c9cb'
### ciphertext: 'b35460a70b2252156eb03fa441dd9ae8a0137a61cc05a39fcea5aab935792c38085a050958f0b5bcd72ed10ddc3b1d2291c9cb'
### authtag: '6c0737b836ecbfe3302e9f6ddf8956e7'
### authtag: '6c0737b836ecbfe3302e9f6ddf8956e7'
### cipherinfo: '834a31363136373731373738506c0737b836ecbfe3302e9f6ddf8956e75833b35460a70b2252156eb03fa441dd9ae8a0137a61cc05a39fcea5aab935792c38085a050958f0b5bcd72ed10ddc3b1d2291c9cb'
### cipherinfo: '834a31363136373731373738506c0737b836ecbfe3302e9f6ddf8956e75833b35460a70b2252156eb03fa441dd9ae8a0137a61cc05a39fcea5aab935792c38085a050958f0b5bcd72ed10ddc3b1d2291c9cb'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '7f2743166e1c78c72f26f35f260e073cc3ec375f1025f8b3d305307378cd88dd'
### key: '7f2743166e1c78c72f26f35f260e073cc3ec375f1025f8b3d305307378cd88dd'
### iv: '397c3e08969571032c6d3d26'
### iv: '397c3e08969571032c6d3d26'
### aad: 'ac889fa8b278bf120f638c41c2d6b655a8f7dd56586e65611a0991e6b3e3b610'
### aad: 'ac889fa8b278bf120f638c41c2d6b655a8f7dd56586e65611a0991e6b3e3b610'
### cipherinfo: '834a31363136373731373738506c0737b836ecbfe3302e9f6ddf8956e75833b35460a70b2252156eb03fa441dd9ae8a0137a61cc05a39fcea5aab935792c38085a050958f0b5bcd72ed10ddc3b1d2291c9cb'
### cipherinfo: '834a31363136373731373738506c0737b836ecbfe3302e9f6ddf8956e75833b35460a70b2252156eb03fa441dd9ae8a0137a61cc05a39fcea5aab935792c38085a050958f0b5bcd72ed10ddc3b1d2291c9cb'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '084a0f3ea1a240341b553d26'
### iv_xor: '084a0f3ea1a240341b553d26'
### authtag: '6c0737b836ecbfe3302e9f6ddf8956e7'
### authtag: '6c0737b836ecbfe3302e9f6ddf8956e7'
### ciphertext: 'b35460a70b2252156eb03fa441dd9ae8a0137a61cc05a39fcea5aab935792c38085a050958f0b5bcd72ed10ddc3b1d2291c9cb'
### ciphertext: 'b35460a70b2252156eb03fa441dd9ae8a0137a61cc05a39fcea5aab935792c38085a050958f0b5bcd72ed10ddc3b1d2291c9cb'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '9e5422f9cb579db8b5b2dfc1ceb182e27e12e57af6162119e3aadafaea51899c'
### key: '9e5422f9cb579db8b5b2dfc1ceb182e27e12e57af6162119e3aadafaea51899c'
### iv: '282444f84a9acf4f1eb51033'
### iv: '282444f84a9acf4f1eb51033'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '191275ce7dadfe78298d1033'
### iv_xor: '191275ce7dadfe78298d1033'
### aad: 'ac889fa8b278bf120f638c41c2d6b655a8f7dd56586e65611a0991e6b3e3b610'
### aad: 'ac889fa8b278bf120f638c41c2d6b655a8f7dd56586e65611a0991e6b3e3b610'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '53331fba94e8a712854dc752aa1dc9c4a91228f9631637b4cb2922c6bfc87899ed98f2c3d04698fe8847b73186b11d'
### ciphertext: '53331fba94e8a712854dc752aa1dc9c4a91228f9631637b4cb2922c6bfc87899ed98f2c3d04698fe8847b73186b11d'
### authtag: '871fd8dde7f232ee1be4249e0a2edd7f'
### authtag: '871fd8dde7f232ee1be4249e0a2edd7f'
### cipherinfo: '834a3136313637373137373850871fd8dde7f232ee1be4249e0a2edd7f582f53331fba94e8a712854dc752aa1dc9c4a91228f9631637b4cb2922c6bfc87899ed98f2c3d04698fe8847b73186b11d'
### cipherinfo: '834a3136313637373137373850871fd8dde7f232ee1be4249e0a2edd7f582f53331fba94e8a712854dc752aa1dc9c4a91228f9631637b4cb2922c6bfc87899ed98f2c3d04698fe8847b73186b11d'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '9e5422f9cb579db8b5b2dfc1ceb182e27e12e57af6162119e3aadafaea51899c'
### key: '9e5422f9cb579db8b5b2dfc1ceb182e27e12e57af6162119e3aadafaea51899c'
### iv: '282444f84a9acf4f1eb51033'
### iv: '282444f84a9acf4f1eb51033'
### aad: 'ac889fa8b278bf120f638c41c2d6b655a8f7dd56586e65611a0991e6b3e3b610'
### aad: 'ac889fa8b278bf120f638c41c2d6b655a8f7dd56586e65611a0991e6b3e3b610'
### cipherinfo: '834a3136313637373137373850871fd8dde7f232ee1be4249e0a2edd7f582f53331fba94e8a712854dc752aa1dc9c4a91228f9631637b4cb2922c6bfc87899ed98f2c3d04698fe8847b73186b11d'
### cipherinfo: '834a3136313637373137373850871fd8dde7f232ee1be4249e0a2edd7f582f53331fba94e8a712854dc752aa1dc9c4a91228f9631637b4cb2922c6bfc87899ed98f2c3d04698fe8847b73186b11d'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '191275ce7dadfe78298d1033'
### iv_xor: '191275ce7dadfe78298d1033'
### authtag: '871fd8dde7f232ee1be4249e0a2edd7f'
### authtag: '871fd8dde7f232ee1be4249e0a2edd7f'
### ciphertext: '53331fba94e8a712854dc752aa1dc9c4a91228f9631637b4cb2922c6bfc87899ed98f2c3d04698fe8847b73186b11d'
### ciphertext: '53331fba94e8a712854dc752aa1dc9c4a91228f9631637b4cb2922c6bfc87899ed98f2c3d04698fe8847b73186b11d'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'IK',
###                               undef,
###                               undef

### -----------end test --------: 'IK',
###                               undef,
###                               undef

### -----------start test --------: 'IK',
###                                 'test_psk',
###                                 0

### -----------start test --------: 'IK',
###                                 'test_psk',
###                                 0


### a write message to b
### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IK",
  initiator => 1,
  message_pattens => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","b53a056c93f9f6b23deea03a295a7cd8f5bb453fd2fb0275ad34d78d2b277951"),
    h  => pack("H*","2e346b9b945d1240dbd82b6f7c83dd27d20be86ca3a5553f76d84fceccb63a8f"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IK",
  initiator => 1,
  message_pattens => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","b53a056c93f9f6b23deea03a295a7cd8f5bb453fd2fb0275ad34d78d2b277951"),
    h  => pack("H*","2e346b9b945d1240dbd82b6f7c83dd27d20be86ca3a5553f76d84fceccb63a8f"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'psk'

### write message pattern: 'psk'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '0361c71c224c7b77d9859d64332ac4c7a4cfcd3dd176fe6d5454779b14f36d48c7'

### public compressed: '0361c71c224c7b77d9859d64332ac4c7a4cfcd3dd176fe6d5454779b14f36d48c7'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIK9inwAtz6N92v+7pzlJ/3bmCK6xKGRH5FDxXg8Odxu3oAoGCCqGSM49
',
###             'AwEHoUQDQgAEYcccIkx7d9mFnWQzKsTHpM/NPdF2/m1UVHebFPNtSMfG3KXQ3paD
',
###             'Fe4Byeo3Y1DbUxKsfZJBvn3D4BizghAKXw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIK9inwAtz6N92v+7pzlJ/3bmCK6xKGRH5FDxXg8Odxu3oAoGCCqGSM49
',
###             'AwEHoUQDQgAEYcccIkx7d9mFnWQzKsTHpM/NPdF2/m1UVHebFPNtSMfG3KXQ3paD
',
###             'Fe4Byeo3Y1DbUxKsfZJBvn3D4BizghAKXw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '55d1077e0164ff741222048dedcb492f1739abe255298d7f6dcbb8ddbee988df'
### z: '55d1077e0164ff741222048dedcb492f1739abe255298d7f6dcbb8ddbee988df'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: 'b7fb913916ac5c19551bcf7855ec7414bddc704133ab9aa18c94a09e06f76ae5'
### key: 'b7fb913916ac5c19551bcf7855ec7414bddc704133ab9aa18c94a09e06f76ae5'
### iv: '56b1c122700032035e769ca3'
### iv: '56b1c122700032035e769ca3'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '6787f01447370334694e9ca3'
### iv_xor: '6787f01447370334694e9ca3'
### aad: '65b06bc224e973e1186a1514d9f5da4415e21ad53734d1145dd42700e80a9a71'
### aad: '65b06bc224e973e1186a1514d9f5da4415e21ad53734d1145dd42700e80a9a71'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: 'd22c25ffef2bb11e9e6d15c4e85e56c05da37c5a6eeaf037c658d98704bcab60315338599755922f'
### ciphertext: 'd22c25ffef2bb11e9e6d15c4e85e56c05da37c5a6eeaf037c658d98704bcab60315338599755922f'
### authtag: 'e92790bbaab6def835053105275f020e'
### authtag: 'e92790bbaab6def835053105275f020e'
### cipherinfo: '834a3136313637373137373850e92790bbaab6def835053105275f020e5828d22c25ffef2bb11e9e6d15c4e85e56c05da37c5a6eeaf037c658d98704bcab60315338599755922f'
### cipherinfo: '834a3136313637373137373850e92790bbaab6def835053105275f020e5828d22c25ffef2bb11e9e6d15c4e85e56c05da37c5a6eeaf037c658d98704bcab60315338599755922f'

### write message pattern: 'ss'

### write message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### noise encrypt
### noise encrypt
### key: 'dd808951813b6ab739562dfdb2c0b95c0a1610703f11e85c881d1d2d9a63d1c4'
### key: 'dd808951813b6ab739562dfdb2c0b95c0a1610703f11e85c881d1d2d9a63d1c4'
### iv: 'b9833a6e2c3790b43b7661a0'
### iv: 'b9833a6e2c3790b43b7661a0'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '88b50b581b00a1830c4e61a0'
### iv_xor: '88b50b581b00a1830c4e61a0'
### aad: '757296ff564394d529ac34e5ca20d2bb6431ad4fb0f7710c181b71362e5e5dfc'
### aad: '757296ff564394d529ac34e5ca20d2bb6431ad4fb0f7710c181b71362e5e5dfc'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '49fee347e70d22d2'
### ciphertext: '49fee347e70d22d2'
### authtag: 'b7c77df2500af2c843c05306d19bfa21'
### authtag: 'b7c77df2500af2c843c05306d19bfa21'
### cipherinfo: '834a3136313637373137373850b7c77df2500af2c843c05306d19bfa214849fee347e70d22d2'
### cipherinfo: '834a3136313637373137373850b7c77df2500af2c843c05306d19bfa214849fee347e70d22d2'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghA2HHHCJMe3fZhZ1kMyrEx6TPzT3Rdv5tVFR3mxTzbUjHWEeDSjE2MTY3NzE3NzhQ6SeQu6q23vg1BTEFJ18CDlgo0iwl/+8rsR6ebRXE6F5WwF2jfFpu6vA3xljZhwS8q2AxUzhZl1WSL1gmg0oxNjE2NzcxNzc4ULfHffJQCvLIQ8BTBtGb+iFISf7jR+cNItI="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghA2HHHCJMe3fZhZ1kMyrEx6TPzT3Rdv5tVFR3mxTzbUjHWEeDSjE2MTY3NzE3NzhQ6SeQu6q23vg1BTEFJ18CDlgo0iwl/+8rsR6ebRXE6F5WwF2jfFpu6vA3xljZhwS8q2AxUzhZl1WSL1gmg0oxNjE2NzcxNzc4ULfHffJQCvLIQ8BTBtGb+iFISf7jR+cNItI="),
  );
}
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0361c71c224c7b77d9859d64332ac4c7a4cfcd3dd176fe6d5454779b14f36d48c7"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 1,
    message_pattens => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","7b6174e26a0301fe160c8caa5f217aeb3ea76161ca28c1e8e483eec77b3beb16"),
      h => pack("H*","f1cf20a632cdf4271f18740b13e752e9a4d37900f0c18e339a711251ecaea77f"),
      hasK => 1,
      k => pack("H*","1b4b4c68f7bde876fba4861944c7c4e3cf2d55cc6aa120c881dd30e980c7bc56"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0361c71c224c7b77d9859d64332ac4c7a4cfcd3dd176fe6d5454779b14f36d48c7"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 1,
    message_pattens => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","7b6174e26a0301fe160c8caa5f217aeb3ea76161ca28c1e8e483eec77b3beb16"),
      h => pack("H*","f1cf20a632cdf4271f18740b13e752e9a4d37900f0c18e339a711251ecaea77f"),
      hasK => 1,
      k => pack("H*","1b4b4c68f7bde876fba4861944c7c4e3cf2d55cc6aa120c881dd30e980c7bc56"),
    },
    who => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IK",
  initiator => 0,
  message_pattens => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","b53a056c93f9f6b23deea03a295a7cd8f5bb453fd2fb0275ad34d78d2b277951"),
    h  => pack("H*","2e346b9b945d1240dbd82b6f7c83dd27d20be86ca3a5553f76d84fceccb63a8f"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IK",
  initiator => 0,
  message_pattens => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","b53a056c93f9f6b23deea03a295a7cd8f5bb453fd2fb0275ad34d78d2b277951"),
    h  => pack("H*","2e346b9b945d1240dbd82b6f7c83dd27d20be86ca3a5553f76d84fceccb63a8f"),
  },
  who => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'psk'

### read message pattern: 'psk'

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEYcccIkx7d9mFnWQzKsTHpM/NPdF2
',
###           '/m1UVHebFPNtSMfG3KXQ3paDFe4Byeo3Y1DbUxKsfZJBvn3D4BizghAKXw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEYcccIkx7d9mFnWQzKsTHpM/NPdF2
',
###           '/m1UVHebFPNtSMfG3KXQ3paDFe4Byeo3Y1DbUxKsfZJBvn3D4BizghAKXw==
',
###           '-----END PUBLIC KEY-----
'
### z: '55d1077e0164ff741222048dedcb492f1739abe255298d7f6dcbb8ddbee988df'
### z: '55d1077e0164ff741222048dedcb492f1739abe255298d7f6dcbb8ddbee988df'

### read message pattern: 's'

### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: 'b7fb913916ac5c19551bcf7855ec7414bddc704133ab9aa18c94a09e06f76ae5'
### key: 'b7fb913916ac5c19551bcf7855ec7414bddc704133ab9aa18c94a09e06f76ae5'
### iv: '56b1c122700032035e769ca3'
### iv: '56b1c122700032035e769ca3'
### aad: '65b06bc224e973e1186a1514d9f5da4415e21ad53734d1145dd42700e80a9a71'
### aad: '65b06bc224e973e1186a1514d9f5da4415e21ad53734d1145dd42700e80a9a71'
### cipherinfo: '834a3136313637373137373850e92790bbaab6def835053105275f020e5828d22c25ffef2bb11e9e6d15c4e85e56c05da37c5a6eeaf037c658d98704bcab60315338599755922f'
### cipherinfo: '834a3136313637373137373850e92790bbaab6def835053105275f020e5828d22c25ffef2bb11e9e6d15c4e85e56c05da37c5a6eeaf037c658d98704bcab60315338599755922f'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '6787f01447370334694e9ca3'
### iv_xor: '6787f01447370334694e9ca3'
### authtag: 'e92790bbaab6def835053105275f020e'
### authtag: 'e92790bbaab6def835053105275f020e'
### ciphertext: 'd22c25ffef2bb11e9e6d15c4e85e56c05da37c5a6eeaf037c658d98704bcab60315338599755922f'
### ciphertext: 'd22c25ffef2bb11e9e6d15c4e85e56c05da37c5a6eeaf037c658d98704bcab60315338599755922f'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### read message pattern: 'ss'

### read message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### noise decrypt

### noise decrypt
### key: 'dd808951813b6ab739562dfdb2c0b95c0a1610703f11e85c881d1d2d9a63d1c4'
### key: 'dd808951813b6ab739562dfdb2c0b95c0a1610703f11e85c881d1d2d9a63d1c4'
### iv: 'b9833a6e2c3790b43b7661a0'
### iv: 'b9833a6e2c3790b43b7661a0'
### aad: '757296ff564394d529ac34e5ca20d2bb6431ad4fb0f7710c181b71362e5e5dfc'
### aad: '757296ff564394d529ac34e5ca20d2bb6431ad4fb0f7710c181b71362e5e5dfc'
### cipherinfo: '834a3136313637373137373850b7c77df2500af2c843c05306d19bfa214849fee347e70d22d2'
### cipherinfo: '834a3136313637373137373850b7c77df2500af2c843c05306d19bfa214849fee347e70d22d2'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '88b50b581b00a1830c4e61a0'
### iv_xor: '88b50b581b00a1830c4e61a0'
### authtag: 'b7c77df2500af2c843c05306d19bfa21'
### authtag: 'b7c77df2500af2c843c05306d19bfa21'
### ciphertext: '49fee347e70d22d2'
### ciphertext: '49fee347e70d22d2'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "IK",
    initiator => 0,
    message_pattens => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","0361c71c224c7b77d9859d64332ac4c7a4cfcd3dd176fe6d5454779b14f36d48c7"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","7b6174e26a0301fe160c8caa5f217aeb3ea76161ca28c1e8e483eec77b3beb16"),
      h => pack("H*","f1cf20a632cdf4271f18740b13e752e9a4d37900f0c18e339a711251ecaea77f"),
      hasK => 1,
      k => pack("H*","1b4b4c68f7bde876fba4861944c7c4e3cf2d55cc6aa120c881dd30e980c7bc56"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "IK",
    initiator => 0,
    message_pattens => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","0361c71c224c7b77d9859d64332ac4c7a4cfcd3dd176fe6d5454779b14f36d48c7"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","7b6174e26a0301fe160c8caa5f217aeb3ea76161ca28c1e8e483eec77b3beb16"),
      h => pack("H*","f1cf20a632cdf4271f18740b13e752e9a4d37900f0c18e339a711251ecaea77f"),
      hasK => 1,
      k => pack("H*","1b4b4c68f7bde876fba4861944c7c4e3cf2d55cc6aa120c881dd30e980c7bc56"),
    },
    who => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'


### public compressed: '035caf9c9a7eb09a82cdf58cdb0bd063143211f19fccd2aa6c2b0a2551411297f9'
### public compressed: '035caf9c9a7eb09a82cdf58cdb0bd063143211f19fccd2aa6c2b0a2551411297f9'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGyVEmRIF/n9z5QdeWoXgA1PHbpHgfvBPnZlXj8uR2bboAoGCCqGSM49
',
###             'AwEHoUQDQgAEXK+cmn6wmoLN9YzbC9BjFDIR8Z/M0qpsKwolUUESl/kYd9AFrx/w
',
###             'bIJv8BLgMyE5Kpqb+61BNy/wNXzEVkJgYw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGyVEmRIF/n9z5QdeWoXgA1PHbpHgfvBPnZlXj8uR2bboAoGCCqGSM49
',
###             'AwEHoUQDQgAEXK+cmn6wmoLN9YzbC9BjFDIR8Z/M0qpsKwolUUESl/kYd9AFrx/w
',
###             'bIJv8BLgMyE5Kpqb+61BNy/wNXzEVkJgYw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEYcccIkx7d9mFnWQzKsTHpM/NPdF2
',
###           '/m1UVHebFPNtSMfG3KXQ3paDFe4Byeo3Y1DbUxKsfZJBvn3D4BizghAKXw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEYcccIkx7d9mFnWQzKsTHpM/NPdF2
',
###           '/m1UVHebFPNtSMfG3KXQ3paDFe4Byeo3Y1DbUxKsfZJBvn3D4BizghAKXw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'e11c997b7c213b0768826ac35e7c27825955209699f552eebe8038ead430566b'
### z: 'e11c997b7c213b0768826ac35e7c27825955209699f552eebe8038ead430566b'

### write message pattern: 'se'

### write message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGyVEmRIF/n9z5QdeWoXgA1PHbpHgfvBPnZlXj8uR2bboAoGCCqGSM49
',
###             'AwEHoUQDQgAEXK+cmn6wmoLN9YzbC9BjFDIR8Z/M0qpsKwolUUESl/kYd9AFrx/w
',
###             'bIJv8BLgMyE5Kpqb+61BNy/wNXzEVkJgYw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGyVEmRIF/n9z5QdeWoXgA1PHbpHgfvBPnZlXj8uR2bboAoGCCqGSM49
',
###             'AwEHoUQDQgAEXK+cmn6wmoLN9YzbC9BjFDIR8Z/M0qpsKwolUUESl/kYd9AFrx/w
',
###             'bIJv8BLgMyE5Kpqb+61BNy/wNXzEVkJgYw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '529fb1a7c744164382c606aedb85092667a1d0aad4fef1b3bed5a5c8bd3f10be'
### z: '529fb1a7c744164382c606aedb85092667a1d0aad4fef1b3bed5a5c8bd3f10be'

### noise encrypt

### noise encrypt
### key: 'defdb94285fc4ef0a2618df6c0f02cc5e69d952111edfcb3d783f5f6679dba28'
### key: 'defdb94285fc4ef0a2618df6c0f02cc5e69d952111edfcb3d783f5f6679dba28'
### iv: 'df99ccae20d482cc512b9cbd'
### iv: 'df99ccae20d482cc512b9cbd'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'eeaffd9817e3b3fb66139cbd'
### iv_xor: 'eeaffd9817e3b3fb66139cbd'
### aad: 'c5b3618a62e5cb18e05be9c6fbf28671172564b71511a67d8ec2fd0582d60b83'
### aad: 'c5b3618a62e5cb18e05be9c6fbf28671172564b71511a67d8ec2fd0582d60b83'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '151b21d04aee0cf9'
### ciphertext: '151b21d04aee0cf9'
### authtag: '187b6dda5eb83b03f3dbfe183b320628'
### authtag: '187b6dda5eb83b03f3dbfe183b320628'
### cipherinfo: '834a3136313637373137373850187b6dda5eb83b03f3dbfe183b32062848151b21d04aee0cf9'
### cipherinfo: '834a3136313637373137373850187b6dda5eb83b03f3dbfe183b32062848151b21d04aee0cf9'

### b_msg: '825821035caf9c9a7eb09a82cdf58cdb0bd063143211f19fccd2aa6c2b0a2551411297f95826834a3136313637373137373850187b6dda5eb83b03f3dbfe183b32062848151b21d04aee0cf9'

### b_msg: '825821035caf9c9a7eb09a82cdf58cdb0bd063143211f19fccd2aa6c2b0a2551411297f95826834a3136313637373137373850187b6dda5eb83b03f3dbfe183b32062848151b21d04aee0cf9'
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","035caf9c9a7eb09a82cdf58cdb0bd063143211f19fccd2aa6c2b0a2551411297f9"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 0,
    message_pattens => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","0361c71c224c7b77d9859d64332ac4c7a4cfcd3dd176fe6d5454779b14f36d48c7"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","88b9890865ab5bc08ff864095fb8bf0907904749b5115c072174e0712d2c8cb3"),
      h => pack("H*","04803800271e43aa639ea83e29a732db9dd29655419d8394bfba8c51f8a598ea"),
      hasK => 1,
      k => pack("H*","f2e95d0c35ad3f25b6fa95f634e2571e2e0ad8fe653823194cb2d3e32defd613"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","d566a438923bf426cf3c9881190ee9d9d9728ea27ff9accf9daf3d44316af042"),
  },
  {
    hasK => 1,
    k => pack("H*","1da97d53d1142103c0b181cf49c6878bf3755f599b91107e2a897fa636ae5226"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","035caf9c9a7eb09a82cdf58cdb0bd063143211f19fccd2aa6c2b0a2551411297f9"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 0,
    message_pattens => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","0361c71c224c7b77d9859d64332ac4c7a4cfcd3dd176fe6d5454779b14f36d48c7"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","88b9890865ab5bc08ff864095fb8bf0907904749b5115c072174e0712d2c8cb3"),
      h => pack("H*","04803800271e43aa639ea83e29a732db9dd29655419d8394bfba8c51f8a598ea"),
      hasK => 1,
      k => pack("H*","f2e95d0c35ad3f25b6fa95f634e2571e2e0ad8fe653823194cb2d3e32defd613"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","d566a438923bf426cf3c9881190ee9d9d9728ea27ff9accf9daf3d44316af042"),
  },
  {
    hasK => 1,
    k => pack("H*","1da97d53d1142103c0b181cf49c6878bf3755f599b91107e2a897fa636ae5226"),
  },
)

### a read_message from b

### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIK9inwAtz6N92v+7pzlJ/3bmCK6xKGRH5FDxXg8Odxu3oAoGCCqGSM49
',
###             'AwEHoUQDQgAEYcccIkx7d9mFnWQzKsTHpM/NPdF2/m1UVHebFPNtSMfG3KXQ3paD
',
###             'Fe4Byeo3Y1DbUxKsfZJBvn3D4BizghAKXw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIK9inwAtz6N92v+7pzlJ/3bmCK6xKGRH5FDxXg8Odxu3oAoGCCqGSM49
',
###             'AwEHoUQDQgAEYcccIkx7d9mFnWQzKsTHpM/NPdF2/m1UVHebFPNtSMfG3KXQ3paD
',
###             'Fe4Byeo3Y1DbUxKsfZJBvn3D4BizghAKXw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEXK+cmn6wmoLN9YzbC9BjFDIR8Z/M
',
###           '0qpsKwolUUESl/kYd9AFrx/wbIJv8BLgMyE5Kpqb+61BNy/wNXzEVkJgYw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEXK+cmn6wmoLN9YzbC9BjFDIR8Z/M
',
###           '0qpsKwolUUESl/kYd9AFrx/wbIJv8BLgMyE5Kpqb+61BNy/wNXzEVkJgYw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'e11c997b7c213b0768826ac35e7c27825955209699f552eebe8038ead430566b'
### z: 'e11c997b7c213b0768826ac35e7c27825955209699f552eebe8038ead430566b'

### read message pattern: 'se'

### read message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEXK+cmn6wmoLN9YzbC9BjFDIR8Z/M
',
###           '0qpsKwolUUESl/kYd9AFrx/wbIJv8BLgMyE5Kpqb+61BNy/wNXzEVkJgYw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEXK+cmn6wmoLN9YzbC9BjFDIR8Z/M
',
###           '0qpsKwolUUESl/kYd9AFrx/wbIJv8BLgMyE5Kpqb+61BNy/wNXzEVkJgYw==
',
###           '-----END PUBLIC KEY-----
'
### z: '529fb1a7c744164382c606aedb85092667a1d0aad4fef1b3bed5a5c8bd3f10be'
### z: '529fb1a7c744164382c606aedb85092667a1d0aad4fef1b3bed5a5c8bd3f10be'


### noise decrypt
### noise decrypt
### key: 'defdb94285fc4ef0a2618df6c0f02cc5e69d952111edfcb3d783f5f6679dba28'
### key: 'defdb94285fc4ef0a2618df6c0f02cc5e69d952111edfcb3d783f5f6679dba28'
### iv: 'df99ccae20d482cc512b9cbd'
### iv: 'df99ccae20d482cc512b9cbd'
### aad: 'c5b3618a62e5cb18e05be9c6fbf28671172564b71511a67d8ec2fd0582d60b83'
### aad: 'c5b3618a62e5cb18e05be9c6fbf28671172564b71511a67d8ec2fd0582d60b83'
### cipherinfo: '834a3136313637373137373850187b6dda5eb83b03f3dbfe183b32062848151b21d04aee0cf9'
### cipherinfo: '834a3136313637373137373850187b6dda5eb83b03f3dbfe183b32062848151b21d04aee0cf9'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'eeaffd9817e3b3fb66139cbd'
### iv_xor: 'eeaffd9817e3b3fb66139cbd'
### authtag: '187b6dda5eb83b03f3dbfe183b320628'
### authtag: '187b6dda5eb83b03f3dbfe183b320628'
### ciphertext: '151b21d04aee0cf9'
### ciphertext: '151b21d04aee0cf9'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0361c71c224c7b77d9859d64332ac4c7a4cfcd3dd176fe6d5454779b14f36d48c7"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 1,
    message_pattens => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","035caf9c9a7eb09a82cdf58cdb0bd063143211f19fccd2aa6c2b0a2551411297f9"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","88b9890865ab5bc08ff864095fb8bf0907904749b5115c072174e0712d2c8cb3"),
      h => pack("H*","04803800271e43aa639ea83e29a732db9dd29655419d8394bfba8c51f8a598ea"),
      hasK => 1,
      k => pack("H*","f2e95d0c35ad3f25b6fa95f634e2571e2e0ad8fe653823194cb2d3e32defd613"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","d566a438923bf426cf3c9881190ee9d9d9728ea27ff9accf9daf3d44316af042"),
  },
  {
    hasK => 1,
    k => pack("H*","1da97d53d1142103c0b181cf49c6878bf3755f599b91107e2a897fa636ae5226"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0361c71c224c7b77d9859d64332ac4c7a4cfcd3dd176fe6d5454779b14f36d48c7"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 1,
    message_pattens => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","035caf9c9a7eb09a82cdf58cdb0bd063143211f19fccd2aa6c2b0a2551411297f9"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","88b9890865ab5bc08ff864095fb8bf0907904749b5115c072174e0712d2c8cb3"),
      h => pack("H*","04803800271e43aa639ea83e29a732db9dd29655419d8394bfba8c51f8a598ea"),
      hasK => 1,
      k => pack("H*","f2e95d0c35ad3f25b6fa95f634e2571e2e0ad8fe653823194cb2d3e32defd613"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","d566a438923bf426cf3c9881190ee9d9d9728ea27ff9accf9daf3d44316af042"),
  },
  {
    hasK => 1,
    k => pack("H*","1da97d53d1142103c0b181cf49c6878bf3755f599b91107e2a897fa636ae5226"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '897c017acb9c219f029caeb8292e4f797700c616695c5c2b785465f60e7b9421'
### key: '897c017acb9c219f029caeb8292e4f797700c616695c5c2b785465f60e7b9421'
### iv: '808cee95aeba6944054d953d'
### iv: '808cee95aeba6944054d953d'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'b1badfa3998d58733275953d'
### iv_xor: 'b1badfa3998d58733275953d'
### aad: '04803800271e43aa639ea83e29a732db9dd29655419d8394bfba8c51f8a598ea'
### aad: '04803800271e43aa639ea83e29a732db9dd29655419d8394bfba8c51f8a598ea'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '64ba16320bf73d7e13a35b00abbb485aa92dc227732a6fa3abdff467563e1b43daaf216b3314cca4c07b07d0a8e2a780f947e1'
### ciphertext: '64ba16320bf73d7e13a35b00abbb485aa92dc227732a6fa3abdff467563e1b43daaf216b3314cca4c07b07d0a8e2a780f947e1'
### authtag: '07e9f4d1da93618c42280c54da6be305'
### authtag: '07e9f4d1da93618c42280c54da6be305'
### cipherinfo: '834a313631363737313737385007e9f4d1da93618c42280c54da6be305583364ba16320bf73d7e13a35b00abbb485aa92dc227732a6fa3abdff467563e1b43daaf216b3314cca4c07b07d0a8e2a780f947e1'
### cipherinfo: '834a313631363737313737385007e9f4d1da93618c42280c54da6be305583364ba16320bf73d7e13a35b00abbb485aa92dc227732a6fa3abdff467563e1b43daaf216b3314cca4c07b07d0a8e2a780f947e1'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '897c017acb9c219f029caeb8292e4f797700c616695c5c2b785465f60e7b9421'
### key: '897c017acb9c219f029caeb8292e4f797700c616695c5c2b785465f60e7b9421'
### iv: '808cee95aeba6944054d953d'
### iv: '808cee95aeba6944054d953d'
### aad: '04803800271e43aa639ea83e29a732db9dd29655419d8394bfba8c51f8a598ea'
### aad: '04803800271e43aa639ea83e29a732db9dd29655419d8394bfba8c51f8a598ea'
### cipherinfo: '834a313631363737313737385007e9f4d1da93618c42280c54da6be305583364ba16320bf73d7e13a35b00abbb485aa92dc227732a6fa3abdff467563e1b43daaf216b3314cca4c07b07d0a8e2a780f947e1'
### cipherinfo: '834a313631363737313737385007e9f4d1da93618c42280c54da6be305583364ba16320bf73d7e13a35b00abbb485aa92dc227732a6fa3abdff467563e1b43daaf216b3314cca4c07b07d0a8e2a780f947e1'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'b1badfa3998d58733275953d'
### iv_xor: 'b1badfa3998d58733275953d'
### authtag: '07e9f4d1da93618c42280c54da6be305'
### authtag: '07e9f4d1da93618c42280c54da6be305'
### ciphertext: '64ba16320bf73d7e13a35b00abbb485aa92dc227732a6fa3abdff467563e1b43daaf216b3314cca4c07b07d0a8e2a780f947e1'
### ciphertext: '64ba16320bf73d7e13a35b00abbb485aa92dc227732a6fa3abdff467563e1b43daaf216b3314cca4c07b07d0a8e2a780f947e1'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a


### noise encrypt
### noise encrypt
### key: '30153e99cd14dce8dc4339efb0d3a99e315b6dac6c055d08b2245c7f47db4158'
### key: '30153e99cd14dce8dc4339efb0d3a99e315b6dac6c055d08b2245c7f47db4158'
### iv: 'cddbce3d61f7b8877699975f'
### iv: 'cddbce3d61f7b8877699975f'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'fcedff0b56c089b041a1975f'
### iv_xor: 'fcedff0b56c089b041a1975f'
### aad: '04803800271e43aa639ea83e29a732db9dd29655419d8394bfba8c51f8a598ea'
### aad: '04803800271e43aa639ea83e29a732db9dd29655419d8394bfba8c51f8a598ea'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '76963a3dc8f91e642217339b749c749da2cdc1e1acd255279efdc58bd05c157b5fa54561cd2373a303c8e5ea35445e'
### ciphertext: '76963a3dc8f91e642217339b749c749da2cdc1e1acd255279efdc58bd05c157b5fa54561cd2373a303c8e5ea35445e'
### authtag: '43c4a24ca62ab96dfeaf59ff9bb0a20c'
### authtag: '43c4a24ca62ab96dfeaf59ff9bb0a20c'
### cipherinfo: '834a313631363737313737385043c4a24ca62ab96dfeaf59ff9bb0a20c582f76963a3dc8f91e642217339b749c749da2cdc1e1acd255279efdc58bd05c157b5fa54561cd2373a303c8e5ea35445e'
### cipherinfo: '834a313631363737313737385043c4a24ca62ab96dfeaf59ff9bb0a20c582f76963a3dc8f91e642217339b749c749da2cdc1e1acd255279efdc58bd05c157b5fa54561cd2373a303c8e5ea35445e'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '30153e99cd14dce8dc4339efb0d3a99e315b6dac6c055d08b2245c7f47db4158'
### key: '30153e99cd14dce8dc4339efb0d3a99e315b6dac6c055d08b2245c7f47db4158'
### iv: 'cddbce3d61f7b8877699975f'
### iv: 'cddbce3d61f7b8877699975f'
### aad: '04803800271e43aa639ea83e29a732db9dd29655419d8394bfba8c51f8a598ea'
### aad: '04803800271e43aa639ea83e29a732db9dd29655419d8394bfba8c51f8a598ea'
### cipherinfo: '834a313631363737313737385043c4a24ca62ab96dfeaf59ff9bb0a20c582f76963a3dc8f91e642217339b749c749da2cdc1e1acd255279efdc58bd05c157b5fa54561cd2373a303c8e5ea35445e'
### cipherinfo: '834a313631363737313737385043c4a24ca62ab96dfeaf59ff9bb0a20c582f76963a3dc8f91e642217339b749c749da2cdc1e1acd255279efdc58bd05c157b5fa54561cd2373a303c8e5ea35445e'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'fcedff0b56c089b041a1975f'
### iv_xor: 'fcedff0b56c089b041a1975f'
### authtag: '43c4a24ca62ab96dfeaf59ff9bb0a20c'
### authtag: '43c4a24ca62ab96dfeaf59ff9bb0a20c'
### ciphertext: '76963a3dc8f91e642217339b749c749da2cdc1e1acd255279efdc58bd05c157b5fa54561cd2373a303c8e5ea35445e'
### ciphertext: '76963a3dc8f91e642217339b749c749da2cdc1e1acd255279efdc58bd05c157b5fa54561cd2373a303c8e5ea35445e'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'IK',
###                               'test_psk',
###                               0

### -----------end test --------: 'IK',
###                               'test_psk',
###                               0

### -----------start test --------: 'IK',
###                                 'test_psk',
###                                 1

### -----------start test --------: 'IK',
###                                 'test_psk',
###                                 1


### a write message to b
### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IK",
  initiator => 1,
  message_pattens => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","dfe802542cbba7cd505ab5ff533607f16c13c22bcd668861535c5c90fe0d28ce"),
    h  => pack("H*","5729b083c87dd5a3ea643d1f66ad9eba7ff0933bc94f7c5996dc1dc8e8222297"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IK",
  initiator => 1,
  message_pattens => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","dfe802542cbba7cd505ab5ff533607f16c13c22bcd668861535c5c90fe0d28ce"),
    h  => pack("H*","5729b083c87dd5a3ea643d1f66ad9eba7ff0933bc94f7c5996dc1dc8e8222297"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '023e14de9d90cd7fb48345df17f5fc18f45ab583c9a23c43e8d6b1407464d1f998'

### public compressed: '023e14de9d90cd7fb48345df17f5fc18f45ab583c9a23c43e8d6b1407464d1f998'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIKwpf97UjMYUFzY+pPtUUjOBe3J8dGLdMF28dcQd9C1KoAoGCCqGSM49
',
###             'AwEHoUQDQgAEPhTenZDNf7SDRd8X9fwY9Fq1g8miPEPo1rFAdGTR+ZhzKfp4K7+B
',
###             'mUhlAozD2dtt1lwfoGl3SJaszzNvhKfxcg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIKwpf97UjMYUFzY+pPtUUjOBe3J8dGLdMF28dcQd9C1KoAoGCCqGSM49
',
###             'AwEHoUQDQgAEPhTenZDNf7SDRd8X9fwY9Fq1g8miPEPo1rFAdGTR+ZhzKfp4K7+B
',
###             'mUhlAozD2dtt1lwfoGl3SJaszzNvhKfxcg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '4a83948029e55e9b8b905445a91eefa6883c261d4213ae383dc515c0042f9b39'
### z: '4a83948029e55e9b8b905445a91eefa6883c261d4213ae383dc515c0042f9b39'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '6edb94d629c129cc13d1f8332cafd3322bd2a3e090a2519a0da7838a3452962f'
### key: '6edb94d629c129cc13d1f8332cafd3322bd2a3e090a2519a0da7838a3452962f'
### iv: 'eb19b7deab7010ca603f8846'
### iv: 'eb19b7deab7010ca603f8846'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'da2f86e89c4721fd57078846'
### iv_xor: 'da2f86e89c4721fd57078846'
### aad: 'b7027c5dafe9e9676b396c52e3313080aaf3237ecdc84d2372f39693634a4e05'
### aad: 'b7027c5dafe9e9676b396c52e3313080aaf3237ecdc84d2372f39693634a4e05'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: '413a10986c36fea4b3d6b45ecaec56c9bf540af0485f45af04c112b6e5fe5c02d4ce42579e69953e'
### ciphertext: '413a10986c36fea4b3d6b45ecaec56c9bf540af0485f45af04c112b6e5fe5c02d4ce42579e69953e'
### authtag: '717ac08f3e96b8ae521f576b1ddd24c2'
### authtag: '717ac08f3e96b8ae521f576b1ddd24c2'
### cipherinfo: '834a3136313637373137373850717ac08f3e96b8ae521f576b1ddd24c25828413a10986c36fea4b3d6b45ecaec56c9bf540af0485f45af04c112b6e5fe5c02d4ce42579e69953e'
### cipherinfo: '834a3136313637373137373850717ac08f3e96b8ae521f576b1ddd24c25828413a10986c36fea4b3d6b45ecaec56c9bf540af0485f45af04c112b6e5fe5c02d4ce42579e69953e'


### write message pattern: 'ss'
### write message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### write message pattern: 'psk'
### write message pattern: 'psk'

### noise encrypt

### noise encrypt
### key: 'b1fdf19ffad269eb75fa1903a9d7f168774973348ffbafbeeacb08e4bcf1ba6f'
### key: 'b1fdf19ffad269eb75fa1903a9d7f168774973348ffbafbeeacb08e4bcf1ba6f'
### iv: '721577abe8146a6a20ef88aa'
### iv: '721577abe8146a6a20ef88aa'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '4323469ddf235b5d17d788aa'
### iv_xor: '4323469ddf235b5d17d788aa'
### aad: '01266f9fafc3508967df2959c2e2e6f2001aa4acf560bb8c538656ce7573fb17'
### aad: '01266f9fafc3508967df2959c2e2e6f2001aa4acf560bb8c538656ce7573fb17'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '2fa3097c8613a0ea'
### ciphertext: '2fa3097c8613a0ea'
### authtag: '1bcc63e669dbb09d844a3e9b871fca17'
### authtag: '1bcc63e669dbb09d844a3e9b871fca17'
### cipherinfo: '834a31363136373731373738501bcc63e669dbb09d844a3e9b871fca17482fa3097c8613a0ea'
### cipherinfo: '834a31363136373731373738501bcc63e669dbb09d844a3e9b871fca17482fa3097c8613a0ea'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghAj4U3p2QzX+0g0XfF/X8GPRatYPJojxD6NaxQHRk0fmYWEeDSjE2MTY3NzE3NzhQcXrAjz6WuK5SH1drHd0kwlgoQToQmGw2/qSz1rReyuxWyb9UCvBIX0WvBMEStuX+XALUzkJXnmmVPlgmg0oxNjE2NzcxNzc4UBvMY+Zp27CdhEo+m4cfyhdIL6MJfIYToOo="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghAj4U3p2QzX+0g0XfF/X8GPRatYPJojxD6NaxQHRk0fmYWEeDSjE2MTY3NzE3NzhQcXrAjz6WuK5SH1drHd0kwlgoQToQmGw2/qSz1rReyuxWyb9UCvBIX0WvBMEStuX+XALUzkJXnmmVPlgmg0oxNjE2NzcxNzc4UBvMY+Zp27CdhEo+m4cfyhdIL6MJfIYToOo="),
  );
}
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","023e14de9d90cd7fb48345df17f5fc18f45ab583c9a23c43e8d6b1407464d1f998"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 1,
    message_pattens => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","6f19c0125fc217c3ba0b08fcc93f40702dc6aafe9ffbf78f71fd0819b39d82e9"),
      h => pack("H*","1640111c7b20aec520eec4d94bbb6fd9aa24e0ed845b32a70434d6baa772e13d"),
      hasK => 1,
      k => pack("H*","b3b1c0c3384c3887e08785f1ee018c4dd1a9944cd66f95867c418e8c9ba24094"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","023e14de9d90cd7fb48345df17f5fc18f45ab583c9a23c43e8d6b1407464d1f998"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 1,
    message_pattens => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","6f19c0125fc217c3ba0b08fcc93f40702dc6aafe9ffbf78f71fd0819b39d82e9"),
      h => pack("H*","1640111c7b20aec520eec4d94bbb6fd9aa24e0ed845b32a70434d6baa772e13d"),
      hasK => 1,
      k => pack("H*","b3b1c0c3384c3887e08785f1ee018c4dd1a9944cd66f95867c418e8c9ba24094"),
    },
    who => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IK",
  initiator => 0,
  message_pattens => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","dfe802542cbba7cd505ab5ff533607f16c13c22bcd668861535c5c90fe0d28ce"),
    h  => pack("H*","5729b083c87dd5a3ea643d1f66ad9eba7ff0933bc94f7c5996dc1dc8e8222297"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IK",
  initiator => 0,
  message_pattens => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","dfe802542cbba7cd505ab5ff533607f16c13c22bcd668861535c5c90fe0d28ce"),
    h  => pack("H*","5729b083c87dd5a3ea643d1f66ad9eba7ff0933bc94f7c5996dc1dc8e8222297"),
  },
  who => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEPhTenZDNf7SDRd8X9fwY9Fq1g8mi
',
###           'PEPo1rFAdGTR+ZhzKfp4K7+BmUhlAozD2dtt1lwfoGl3SJaszzNvhKfxcg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEPhTenZDNf7SDRd8X9fwY9Fq1g8mi
',
###           'PEPo1rFAdGTR+ZhzKfp4K7+BmUhlAozD2dtt1lwfoGl3SJaszzNvhKfxcg==
',
###           '-----END PUBLIC KEY-----
'
### z: '4a83948029e55e9b8b905445a91eefa6883c261d4213ae383dc515c0042f9b39'
### z: '4a83948029e55e9b8b905445a91eefa6883c261d4213ae383dc515c0042f9b39'

### read message pattern: 's'

### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: '6edb94d629c129cc13d1f8332cafd3322bd2a3e090a2519a0da7838a3452962f'
### key: '6edb94d629c129cc13d1f8332cafd3322bd2a3e090a2519a0da7838a3452962f'
### iv: 'eb19b7deab7010ca603f8846'
### iv: 'eb19b7deab7010ca603f8846'
### aad: 'b7027c5dafe9e9676b396c52e3313080aaf3237ecdc84d2372f39693634a4e05'
### aad: 'b7027c5dafe9e9676b396c52e3313080aaf3237ecdc84d2372f39693634a4e05'
### cipherinfo: '834a3136313637373137373850717ac08f3e96b8ae521f576b1ddd24c25828413a10986c36fea4b3d6b45ecaec56c9bf540af0485f45af04c112b6e5fe5c02d4ce42579e69953e'
### cipherinfo: '834a3136313637373137373850717ac08f3e96b8ae521f576b1ddd24c25828413a10986c36fea4b3d6b45ecaec56c9bf540af0485f45af04c112b6e5fe5c02d4ce42579e69953e'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'da2f86e89c4721fd57078846'
### iv_xor: 'da2f86e89c4721fd57078846'
### authtag: '717ac08f3e96b8ae521f576b1ddd24c2'
### authtag: '717ac08f3e96b8ae521f576b1ddd24c2'
### ciphertext: '413a10986c36fea4b3d6b45ecaec56c9bf540af0485f45af04c112b6e5fe5c02d4ce42579e69953e'
### ciphertext: '413a10986c36fea4b3d6b45ecaec56c9bf540af0485f45af04c112b6e5fe5c02d4ce42579e69953e'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### read message pattern: 'ss'

### read message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### read message pattern: 'psk'

### read message pattern: 'psk'

### noise decrypt

### noise decrypt
### key: 'b1fdf19ffad269eb75fa1903a9d7f168774973348ffbafbeeacb08e4bcf1ba6f'
### key: 'b1fdf19ffad269eb75fa1903a9d7f168774973348ffbafbeeacb08e4bcf1ba6f'
### iv: '721577abe8146a6a20ef88aa'
### iv: '721577abe8146a6a20ef88aa'
### aad: '01266f9fafc3508967df2959c2e2e6f2001aa4acf560bb8c538656ce7573fb17'
### aad: '01266f9fafc3508967df2959c2e2e6f2001aa4acf560bb8c538656ce7573fb17'
### cipherinfo: '834a31363136373731373738501bcc63e669dbb09d844a3e9b871fca17482fa3097c8613a0ea'
### cipherinfo: '834a31363136373731373738501bcc63e669dbb09d844a3e9b871fca17482fa3097c8613a0ea'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '4323469ddf235b5d17d788aa'
### iv_xor: '4323469ddf235b5d17d788aa'
### authtag: '1bcc63e669dbb09d844a3e9b871fca17'
### authtag: '1bcc63e669dbb09d844a3e9b871fca17'
### ciphertext: '2fa3097c8613a0ea'
### ciphertext: '2fa3097c8613a0ea'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "IK",
    initiator => 0,
    message_pattens => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","023e14de9d90cd7fb48345df17f5fc18f45ab583c9a23c43e8d6b1407464d1f998"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","6f19c0125fc217c3ba0b08fcc93f40702dc6aafe9ffbf78f71fd0819b39d82e9"),
      h => pack("H*","1640111c7b20aec520eec4d94bbb6fd9aa24e0ed845b32a70434d6baa772e13d"),
      hasK => 1,
      k => pack("H*","b3b1c0c3384c3887e08785f1ee018c4dd1a9944cd66f95867c418e8c9ba24094"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "IK",
    initiator => 0,
    message_pattens => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","023e14de9d90cd7fb48345df17f5fc18f45ab583c9a23c43e8d6b1407464d1f998"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","6f19c0125fc217c3ba0b08fcc93f40702dc6aafe9ffbf78f71fd0819b39d82e9"),
      h => pack("H*","1640111c7b20aec520eec4d94bbb6fd9aa24e0ed845b32a70434d6baa772e13d"),
      hasK => 1,
      k => pack("H*","b3b1c0c3384c3887e08785f1ee018c4dd1a9944cd66f95867c418e8c9ba24094"),
    },
    who => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '033c55e97fd5f56f81646cbca273d0191603b7bf10633fe0e824e36b88eed9bf1c'

### public compressed: '033c55e97fd5f56f81646cbca273d0191603b7bf10633fe0e824e36b88eed9bf1c'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICDbmbmJTZ5PWv1DWnVjVAOTjZ4vkFgxCYHI5+xIe2RkoAoGCCqGSM49
',
###             'AwEHoUQDQgAEPFXpf9X1b4FkbLyic9AZFgO3vxBjP+DoJONriO7Zvxx0NlOfYZAP
',
###             'r9iIXusguG7mBB9IpevOZa9s/l/0qTQ3DQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICDbmbmJTZ5PWv1DWnVjVAOTjZ4vkFgxCYHI5+xIe2RkoAoGCCqGSM49
',
###             'AwEHoUQDQgAEPFXpf9X1b4FkbLyic9AZFgO3vxBjP+DoJONriO7Zvxx0NlOfYZAP
',
###             'r9iIXusguG7mBB9IpevOZa9s/l/0qTQ3DQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEPhTenZDNf7SDRd8X9fwY9Fq1g8mi
',
###           'PEPo1rFAdGTR+ZhzKfp4K7+BmUhlAozD2dtt1lwfoGl3SJaszzNvhKfxcg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEPhTenZDNf7SDRd8X9fwY9Fq1g8mi
',
###           'PEPo1rFAdGTR+ZhzKfp4K7+BmUhlAozD2dtt1lwfoGl3SJaszzNvhKfxcg==
',
###           '-----END PUBLIC KEY-----
'
### z: '5e40733020a111195ce73e96bd00aaf84c2bb9c5476da9df12fb93759e1ffe56'
### z: '5e40733020a111195ce73e96bd00aaf84c2bb9c5476da9df12fb93759e1ffe56'

### write message pattern: 'se'

### write message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICDbmbmJTZ5PWv1DWnVjVAOTjZ4vkFgxCYHI5+xIe2RkoAoGCCqGSM49
',
###             'AwEHoUQDQgAEPFXpf9X1b4FkbLyic9AZFgO3vxBjP+DoJONriO7Zvxx0NlOfYZAP
',
###             'r9iIXusguG7mBB9IpevOZa9s/l/0qTQ3DQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICDbmbmJTZ5PWv1DWnVjVAOTjZ4vkFgxCYHI5+xIe2RkoAoGCCqGSM49
',
###             'AwEHoUQDQgAEPFXpf9X1b4FkbLyic9AZFgO3vxBjP+DoJONriO7Zvxx0NlOfYZAP
',
###             'r9iIXusguG7mBB9IpevOZa9s/l/0qTQ3DQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'd52db6d6739e38b4ec2f6fca86fd71af2891883e953ae309a29947795958c2b9'
### z: 'd52db6d6739e38b4ec2f6fca86fd71af2891883e953ae309a29947795958c2b9'

### noise encrypt

### noise encrypt
### key: 'd9f44adc3f3af62ff37c04b7c031e3cff580c29372b8506fa106d0deb1fe247d'
### key: 'd9f44adc3f3af62ff37c04b7c031e3cff580c29372b8506fa106d0deb1fe247d'
### iv: '7a6a574e1627777f38627258'
### iv: '7a6a574e1627777f38627258'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '4b5c6678211046480f5a7258'
### iv_xor: '4b5c6678211046480f5a7258'
### aad: '15eea96e1fde7bce910b9c410cee9560702ff36b0965aced4025ac7c8d55fa5f'
### aad: '15eea96e1fde7bce910b9c410cee9560702ff36b0965aced4025ac7c8d55fa5f'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '97780af89e6b66b9'
### ciphertext: '97780af89e6b66b9'
### authtag: '09597aadc146096e47791031bcc27e7b'
### authtag: '09597aadc146096e47791031bcc27e7b'
### cipherinfo: '834a313631363737313737385009597aadc146096e47791031bcc27e7b4897780af89e6b66b9'
### cipherinfo: '834a313631363737313737385009597aadc146096e47791031bcc27e7b4897780af89e6b66b9'

### b_msg: '825821033c55e97fd5f56f81646cbca273d0191603b7bf10633fe0e824e36b88eed9bf1c5826834a313631363737313737385009597aadc146096e47791031bcc27e7b4897780af89e6b66b9'

### b_msg: '825821033c55e97fd5f56f81646cbca273d0191603b7bf10633fe0e824e36b88eed9bf1c5826834a313631363737313737385009597aadc146096e47791031bcc27e7b4897780af89e6b66b9'
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","033c55e97fd5f56f81646cbca273d0191603b7bf10633fe0e824e36b88eed9bf1c"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 0,
    message_pattens => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","023e14de9d90cd7fb48345df17f5fc18f45ab583c9a23c43e8d6b1407464d1f998"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","1133b8827d5754dcb1c68a5656d911ff0b561abe6c0150cba1a6a0a709d2ad25"),
      h => pack("H*","0c5aeabb29fea18270e511448a4a69adf72357fdb7eaccba295d951789702d87"),
      hasK => 1,
      k => pack("H*","e9a565bbf2fdff254984a52e37915b5651590ec85ff9fe2952dc028786baabe5"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","342bebca6b85b8107ce4c6bc60fb70493ec94bcaee7dd5582ed5f1098b287920"),
  },
  {
    hasK => 1,
    k => pack("H*","544a42464813e402660f47095a6eab3b206433c9239b9f0d802b4a0fb4e53387"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","033c55e97fd5f56f81646cbca273d0191603b7bf10633fe0e824e36b88eed9bf1c"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 0,
    message_pattens => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","023e14de9d90cd7fb48345df17f5fc18f45ab583c9a23c43e8d6b1407464d1f998"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","1133b8827d5754dcb1c68a5656d911ff0b561abe6c0150cba1a6a0a709d2ad25"),
      h => pack("H*","0c5aeabb29fea18270e511448a4a69adf72357fdb7eaccba295d951789702d87"),
      hasK => 1,
      k => pack("H*","e9a565bbf2fdff254984a52e37915b5651590ec85ff9fe2952dc028786baabe5"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","342bebca6b85b8107ce4c6bc60fb70493ec94bcaee7dd5582ed5f1098b287920"),
  },
  {
    hasK => 1,
    k => pack("H*","544a42464813e402660f47095a6eab3b206433c9239b9f0d802b4a0fb4e53387"),
  },
)

### a read_message from b

### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIKwpf97UjMYUFzY+pPtUUjOBe3J8dGLdMF28dcQd9C1KoAoGCCqGSM49
',
###             'AwEHoUQDQgAEPhTenZDNf7SDRd8X9fwY9Fq1g8miPEPo1rFAdGTR+ZhzKfp4K7+B
',
###             'mUhlAozD2dtt1lwfoGl3SJaszzNvhKfxcg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIKwpf97UjMYUFzY+pPtUUjOBe3J8dGLdMF28dcQd9C1KoAoGCCqGSM49
',
###             'AwEHoUQDQgAEPhTenZDNf7SDRd8X9fwY9Fq1g8miPEPo1rFAdGTR+ZhzKfp4K7+B
',
###             'mUhlAozD2dtt1lwfoGl3SJaszzNvhKfxcg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEPFXpf9X1b4FkbLyic9AZFgO3vxBj
',
###           'P+DoJONriO7Zvxx0NlOfYZAPr9iIXusguG7mBB9IpevOZa9s/l/0qTQ3DQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEPFXpf9X1b4FkbLyic9AZFgO3vxBj
',
###           'P+DoJONriO7Zvxx0NlOfYZAPr9iIXusguG7mBB9IpevOZa9s/l/0qTQ3DQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '5e40733020a111195ce73e96bd00aaf84c2bb9c5476da9df12fb93759e1ffe56'
### z: '5e40733020a111195ce73e96bd00aaf84c2bb9c5476da9df12fb93759e1ffe56'

### read message pattern: 'se'

### read message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEPFXpf9X1b4FkbLyic9AZFgO3vxBj
',
###           'P+DoJONriO7Zvxx0NlOfYZAPr9iIXusguG7mBB9IpevOZa9s/l/0qTQ3DQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEPFXpf9X1b4FkbLyic9AZFgO3vxBj
',
###           'P+DoJONriO7Zvxx0NlOfYZAPr9iIXusguG7mBB9IpevOZa9s/l/0qTQ3DQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'd52db6d6739e38b4ec2f6fca86fd71af2891883e953ae309a29947795958c2b9'
### z: 'd52db6d6739e38b4ec2f6fca86fd71af2891883e953ae309a29947795958c2b9'

### noise decrypt

### noise decrypt
### key: 'd9f44adc3f3af62ff37c04b7c031e3cff580c29372b8506fa106d0deb1fe247d'
### key: 'd9f44adc3f3af62ff37c04b7c031e3cff580c29372b8506fa106d0deb1fe247d'
### iv: '7a6a574e1627777f38627258'
### iv: '7a6a574e1627777f38627258'
### aad: '15eea96e1fde7bce910b9c410cee9560702ff36b0965aced4025ac7c8d55fa5f'
### aad: '15eea96e1fde7bce910b9c410cee9560702ff36b0965aced4025ac7c8d55fa5f'
### cipherinfo: '834a313631363737313737385009597aadc146096e47791031bcc27e7b4897780af89e6b66b9'
### cipherinfo: '834a313631363737313737385009597aadc146096e47791031bcc27e7b4897780af89e6b66b9'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '4b5c6678211046480f5a7258'
### iv_xor: '4b5c6678211046480f5a7258'
### authtag: '09597aadc146096e47791031bcc27e7b'
### authtag: '09597aadc146096e47791031bcc27e7b'
### ciphertext: '97780af89e6b66b9'
### ciphertext: '97780af89e6b66b9'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","023e14de9d90cd7fb48345df17f5fc18f45ab583c9a23c43e8d6b1407464d1f998"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 1,
    message_pattens => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","033c55e97fd5f56f81646cbca273d0191603b7bf10633fe0e824e36b88eed9bf1c"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","1133b8827d5754dcb1c68a5656d911ff0b561abe6c0150cba1a6a0a709d2ad25"),
      h => pack("H*","0c5aeabb29fea18270e511448a4a69adf72357fdb7eaccba295d951789702d87"),
      hasK => 1,
      k => pack("H*","e9a565bbf2fdff254984a52e37915b5651590ec85ff9fe2952dc028786baabe5"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","342bebca6b85b8107ce4c6bc60fb70493ec94bcaee7dd5582ed5f1098b287920"),
  },
  {
    hasK => 1,
    k => pack("H*","544a42464813e402660f47095a6eab3b206433c9239b9f0d802b4a0fb4e53387"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","023e14de9d90cd7fb48345df17f5fc18f45ab583c9a23c43e8d6b1407464d1f998"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    initiator => 1,
    message_pattens => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","033c55e97fd5f56f81646cbca273d0191603b7bf10633fe0e824e36b88eed9bf1c"),
    },
    re_pub => "a_re_pub.pem",
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","1133b8827d5754dcb1c68a5656d911ff0b561abe6c0150cba1a6a0a709d2ad25"),
      h => pack("H*","0c5aeabb29fea18270e511448a4a69adf72357fdb7eaccba295d951789702d87"),
      hasK => 1,
      k => pack("H*","e9a565bbf2fdff254984a52e37915b5651590ec85ff9fe2952dc028786baabe5"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","342bebca6b85b8107ce4c6bc60fb70493ec94bcaee7dd5582ed5f1098b287920"),
  },
  {
    hasK => 1,
    k => pack("H*","544a42464813e402660f47095a6eab3b206433c9239b9f0d802b4a0fb4e53387"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '647d6742002bda42021cb8945d880cdcad6c8014f3b534e9e61c9f96e59ef13b'
### key: '647d6742002bda42021cb8945d880cdcad6c8014f3b534e9e61c9f96e59ef13b'
### iv: 'fe023bdc02c2368eab95aa56'
### iv: 'fe023bdc02c2368eab95aa56'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'cf340aea35f507b99cadaa56'
### iv_xor: 'cf340aea35f507b99cadaa56'
### aad: '0c5aeabb29fea18270e511448a4a69adf72357fdb7eaccba295d951789702d87'
### aad: '0c5aeabb29fea18270e511448a4a69adf72357fdb7eaccba295d951789702d87'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '8b6a60e4b7d828cb852b5e3f2153c82513fd4d42c4369111dd418ec6c36b29b804f61e04c5ef66f57dc768552374fa9bfa34f9'
### ciphertext: '8b6a60e4b7d828cb852b5e3f2153c82513fd4d42c4369111dd418ec6c36b29b804f61e04c5ef66f57dc768552374fa9bfa34f9'
### authtag: '74180a053270a8ae577bc302599ba13a'
### authtag: '74180a053270a8ae577bc302599ba13a'
### cipherinfo: '834a313631363737313737385074180a053270a8ae577bc302599ba13a58338b6a60e4b7d828cb852b5e3f2153c82513fd4d42c4369111dd418ec6c36b29b804f61e04c5ef66f57dc768552374fa9bfa34f9'
### cipherinfo: '834a313631363737313737385074180a053270a8ae577bc302599ba13a58338b6a60e4b7d828cb852b5e3f2153c82513fd4d42c4369111dd418ec6c36b29b804f61e04c5ef66f57dc768552374fa9bfa34f9'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '647d6742002bda42021cb8945d880cdcad6c8014f3b534e9e61c9f96e59ef13b'
### key: '647d6742002bda42021cb8945d880cdcad6c8014f3b534e9e61c9f96e59ef13b'
### iv: 'fe023bdc02c2368eab95aa56'
### iv: 'fe023bdc02c2368eab95aa56'
### aad: '0c5aeabb29fea18270e511448a4a69adf72357fdb7eaccba295d951789702d87'
### aad: '0c5aeabb29fea18270e511448a4a69adf72357fdb7eaccba295d951789702d87'
### cipherinfo: '834a313631363737313737385074180a053270a8ae577bc302599ba13a58338b6a60e4b7d828cb852b5e3f2153c82513fd4d42c4369111dd418ec6c36b29b804f61e04c5ef66f57dc768552374fa9bfa34f9'
### cipherinfo: '834a313631363737313737385074180a053270a8ae577bc302599ba13a58338b6a60e4b7d828cb852b5e3f2153c82513fd4d42c4369111dd418ec6c36b29b804f61e04c5ef66f57dc768552374fa9bfa34f9'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'cf340aea35f507b99cadaa56'
### iv_xor: 'cf340aea35f507b99cadaa56'
### authtag: '74180a053270a8ae577bc302599ba13a'
### authtag: '74180a053270a8ae577bc302599ba13a'
### ciphertext: '8b6a60e4b7d828cb852b5e3f2153c82513fd4d42c4369111dd418ec6c36b29b804f61e04c5ef66f57dc768552374fa9bfa34f9'
### ciphertext: '8b6a60e4b7d828cb852b5e3f2153c82513fd4d42c4369111dd418ec6c36b29b804f61e04c5ef66f57dc768552374fa9bfa34f9'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '08a2c28eca0d4e9040eb88f7ed41f2fa9d22ea6936e56b1ff4f338fe529cc9a6'
### key: '08a2c28eca0d4e9040eb88f7ed41f2fa9d22ea6936e56b1ff4f338fe529cc9a6'
### iv: '53ef291e3268bc4ca5aa4071'
### iv: '53ef291e3268bc4ca5aa4071'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '62d91828055f8d7b92924071'
### iv_xor: '62d91828055f8d7b92924071'
### aad: '0c5aeabb29fea18270e511448a4a69adf72357fdb7eaccba295d951789702d87'
### aad: '0c5aeabb29fea18270e511448a4a69adf72357fdb7eaccba295d951789702d87'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '410c1971bd6e4cce8b16df33902fa1573f5d86dcb3e2f2878df503ccd12ef6605e73cd31f620ac9d1933d57c448e67'
### ciphertext: '410c1971bd6e4cce8b16df33902fa1573f5d86dcb3e2f2878df503ccd12ef6605e73cd31f620ac9d1933d57c448e67'
### authtag: '7691700d5e24681db8d735630b3920f0'
### authtag: '7691700d5e24681db8d735630b3920f0'
### cipherinfo: '834a31363136373731373738507691700d5e24681db8d735630b3920f0582f410c1971bd6e4cce8b16df33902fa1573f5d86dcb3e2f2878df503ccd12ef6605e73cd31f620ac9d1933d57c448e67'
### cipherinfo: '834a31363136373731373738507691700d5e24681db8d735630b3920f0582f410c1971bd6e4cce8b16df33902fa1573f5d86dcb3e2f2878df503ccd12ef6605e73cd31f620ac9d1933d57c448e67'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '08a2c28eca0d4e9040eb88f7ed41f2fa9d22ea6936e56b1ff4f338fe529cc9a6'
### key: '08a2c28eca0d4e9040eb88f7ed41f2fa9d22ea6936e56b1ff4f338fe529cc9a6'
### iv: '53ef291e3268bc4ca5aa4071'
### iv: '53ef291e3268bc4ca5aa4071'
### aad: '0c5aeabb29fea18270e511448a4a69adf72357fdb7eaccba295d951789702d87'
### aad: '0c5aeabb29fea18270e511448a4a69adf72357fdb7eaccba295d951789702d87'
### cipherinfo: '834a31363136373731373738507691700d5e24681db8d735630b3920f0582f410c1971bd6e4cce8b16df33902fa1573f5d86dcb3e2f2878df503ccd12ef6605e73cd31f620ac9d1933d57c448e67'
### cipherinfo: '834a31363136373731373738507691700d5e24681db8d735630b3920f0582f410c1971bd6e4cce8b16df33902fa1573f5d86dcb3e2f2878df503ccd12ef6605e73cd31f620ac9d1933d57c448e67'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '62d91828055f8d7b92924071'
### iv_xor: '62d91828055f8d7b92924071'
### authtag: '7691700d5e24681db8d735630b3920f0'
### authtag: '7691700d5e24681db8d735630b3920f0'
### ciphertext: '410c1971bd6e4cce8b16df33902fa1573f5d86dcb3e2f2878df503ccd12ef6605e73cd31f620ac9d1933d57c448e67'
### ciphertext: '410c1971bd6e4cce8b16df33902fa1573f5d86dcb3e2f2878df503ccd12ef6605e73cd31f620ac9d1933d57c448e67'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'IK',
###                               'test_psk',
###                               1
### -----------end test --------: 'IK',
###                               'test_psk',
###                               1

### -----------start test --------: 'IX',
###                                 undef,
###                                 undef

### -----------start test --------: 'IX',
###                                 undef,
###                                 undef

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IX",
  initiator => 1,
  message_pattens => [["e", "s"], ["e", "ee", "se", "s", "es"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => "Noise_IX_secp256r1_AESGCM_SHA256",
    h  => pack("H*","88bca2960e537af9b5ef8e38a466a9071624f7b0300661f8a4a58b5ab980c2e9"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IX",
  initiator => 1,
  message_pattens => [["e", "s"], ["e", "ee", "se", "s", "es"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => "Noise_IX_secp256r1_AESGCM_SHA256",
    h  => pack("H*","88bca2960e537af9b5ef8e38a466a9071624f7b0300661f8a4a58b5ab980c2e9"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '03706991dda2fa1315fa1d20bce07fa6536ee8ed94ca4e541f7d280c1e41f55172'

### public compressed: '03706991dda2fa1315fa1d20bce07fa6536ee8ed94ca4e541f7d280c1e41f55172'

### write message pattern: 's'

### write message pattern: 's'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghA3Bpkd2i+hMV+h0gvOB/plNu6O2Uyk5UH30oDB5B9VFyWCiCQ3Jhd1ghA1eeJc8MbZeCuaL2GlYJRTiZOvH3mXi1MxV2F9Ki6t8gSGluaXQuc3lu"),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghA3Bpkd2i+hMV+h0gvOB/plNu6O2Uyk5UH30oDB5B9VFyWCiCQ3Jhd1ghA1eeJc8MbZeCuaL2GlYJRTiZOvH3mXi1MxV2F9Ki6t8gSGluaXQuc3lu"),
  );
}
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03706991dda2fa1315fa1d20bce07fa6536ee8ed94ca4e541f7d280c1e41f55172"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 1,
    message_pattens => [["e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => "Noise_IX_secp256r1_AESGCM_SHA256",
      h  => pack("H*","7d9baf8e442453f5de45eea8f346500268a84c27464deedcdfe61f6068fdf7a0"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03706991dda2fa1315fa1d20bce07fa6536ee8ed94ca4e541f7d280c1e41f55172"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 1,
    message_pattens => [["e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => "Noise_IX_secp256r1_AESGCM_SHA256",
      h  => pack("H*","7d9baf8e442453f5de45eea8f346500268a84c27464deedcdfe61f6068fdf7a0"),
    },
    who => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IX",
  initiator => 0,
  message_pattens => [["e", "s"], ["e", "ee", "se", "s", "es"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => "Noise_IX_secp256r1_AESGCM_SHA256",
    h  => pack("H*","88bca2960e537af9b5ef8e38a466a9071624f7b0300661f8a4a58b5ab980c2e9"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IX",
  initiator => 0,
  message_pattens => [["e", "s"], ["e", "ee", "se", "s", "es"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => "Noise_IX_secp256r1_AESGCM_SHA256",
    h  => pack("H*","88bca2960e537af9b5ef8e38a466a9071624f7b0300661f8a4a58b5ab980c2e9"),
  },
  who => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 's'

### read message pattern: 's'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "IX",
    initiator => 0,
    message_pattens => [["e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","03706991dda2fa1315fa1d20bce07fa6536ee8ed94ca4e541f7d280c1e41f55172"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => "Noise_IX_secp256r1_AESGCM_SHA256",
      h  => pack("H*","7d9baf8e442453f5de45eea8f346500268a84c27464deedcdfe61f6068fdf7a0"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "IX",
    initiator => 0,
    message_pattens => [["e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","03706991dda2fa1315fa1d20bce07fa6536ee8ed94ca4e541f7d280c1e41f55172"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => "Noise_IX_secp256r1_AESGCM_SHA256",
      h  => pack("H*","7d9baf8e442453f5de45eea8f346500268a84c27464deedcdfe61f6068fdf7a0"),
    },
    who => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '028974ed5c1cf5ce561cca9e230544710a7ed69af7f70b270cde2cfb165a873fed'

### public compressed: '028974ed5c1cf5ce561cca9e230544710a7ed69af7f70b270cde2cfb165a873fed'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBOQMiIlSQ2apqZumZAHLuebpY0FYiT1XWQtjyzIyjGtoAoGCCqGSM49
',
###             'AwEHoUQDQgAEiXTtXBz1zlYcyp4jBURxCn7Wmvf3CycM3iz7FlqHP+3yYFxFKY+5
',
###             'Mv9tPgaspozcGUwJJAn6sQn2pLlfip6F2A==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBOQMiIlSQ2apqZumZAHLuebpY0FYiT1XWQtjyzIyjGtoAoGCCqGSM49
',
###             'AwEHoUQDQgAEiXTtXBz1zlYcyp4jBURxCn7Wmvf3CycM3iz7FlqHP+3yYFxFKY+5
',
###             'Mv9tPgaspozcGUwJJAn6sQn2pLlfip6F2A==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEcGmR3aL6ExX6HSC84H+mU27o7ZTK
',
###           'TlQffSgMHkH1UXLya1y60ZhxjCARWcdA2jVGk3+8wRec5QVkvl2FOHHJgQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEcGmR3aL6ExX6HSC84H+mU27o7ZTK
',
###           'TlQffSgMHkH1UXLya1y60ZhxjCARWcdA2jVGk3+8wRec5QVkvl2FOHHJgQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '3a18d6c9a3aa40b5a8a04cafbfb87c01e10176b692025e708827f95fc7f366a2'
### z: '3a18d6c9a3aa40b5a8a04cafbfb87c01e10176b692025e708827f95fc7f366a2'

### write message pattern: 'se'

### write message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBOQMiIlSQ2apqZumZAHLuebpY0FYiT1XWQtjyzIyjGtoAoGCCqGSM49
',
###             'AwEHoUQDQgAEiXTtXBz1zlYcyp4jBURxCn7Wmvf3CycM3iz7FlqHP+3yYFxFKY+5
',
###             'Mv9tPgaspozcGUwJJAn6sQn2pLlfip6F2A==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBOQMiIlSQ2apqZumZAHLuebpY0FYiT1XWQtjyzIyjGtoAoGCCqGSM49
',
###             'AwEHoUQDQgAEiXTtXBz1zlYcyp4jBURxCn7Wmvf3CycM3iz7FlqHP+3yYFxFKY+5
',
###             'Mv9tPgaspozcGUwJJAn6sQn2pLlfip6F2A==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'd49fe92e6fdf07760dd69dcd7dd9d1a31280b33704d83055122672e1a22a0526'
### z: 'd49fe92e6fdf07760dd69dcd7dd9d1a31280b33704d83055122672e1a22a0526'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '924050934576fd9d9db91d79cec65723a15bb65dbf6a0f7af38e0f4c32954e0f'
### key: '924050934576fd9d9db91d79cec65723a15bb65dbf6a0f7af38e0f4c32954e0f'
### iv: '7f9c38cbbb9f3bdf3dd40033'
### iv: '7f9c38cbbb9f3bdf3dd40033'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '4eaa09fd8ca80ae80aec0033'
### iv_xor: '4eaa09fd8ca80ae80aec0033'
### aad: '7dd4ec5424d73c22411fcf0a55ee20e2feacecffe5f8fb07fe7559c15cb45c24'
### aad: '7dd4ec5424d73c22411fcf0a55ee20e2feacecffe5f8fb07fe7559c15cb45c24'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### ciphertext: '0493c9eb2e41fb2c152f78b134f4a8f29cdbe152aabc0f7422f6017ebc30b4d4e1cfa6c8ddff1924'
### ciphertext: '0493c9eb2e41fb2c152f78b134f4a8f29cdbe152aabc0f7422f6017ebc30b4d4e1cfa6c8ddff1924'
### authtag: 'b7cc4dded0ceb866118f603962678a53'
### authtag: 'b7cc4dded0ceb866118f603962678a53'
### cipherinfo: '834a3136313637373137373850b7cc4dded0ceb866118f603962678a5358280493c9eb2e41fb2c152f78b134f4a8f29cdbe152aabc0f7422f6017ebc30b4d4e1cfa6c8ddff1924'
### cipherinfo: '834a3136313637373137373850b7cc4dded0ceb866118f603962678a5358280493c9eb2e41fb2c152f78b134f4a8f29cdbe152aabc0f7422f6017ebc30b4d4e1cfa6c8ddff1924'

### write message pattern: 'es'

### write message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEcGmR3aL6ExX6HSC84H+mU27o7ZTK
',
###           'TlQffSgMHkH1UXLya1y60ZhxjCARWcdA2jVGk3+8wRec5QVkvl2FOHHJgQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEcGmR3aL6ExX6HSC84H+mU27o7ZTK
',
###           'TlQffSgMHkH1UXLya1y60ZhxjCARWcdA2jVGk3+8wRec5QVkvl2FOHHJgQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '015c0011544c0868b52d1cea5696535b7b71091e4bb1a835bd15e2b6f0802c08'
### z: '015c0011544c0868b52d1cea5696535b7b71091e4bb1a835bd15e2b6f0802c08'

### noise encrypt

### noise encrypt
### key: 'a95e47dbb198d892001bc44ae73f2ca4831fb5ee15e28a7f74751515ef5e1ab2'
### key: 'a95e47dbb198d892001bc44ae73f2ca4831fb5ee15e28a7f74751515ef5e1ab2'
### iv: '8c9dbcc0f3642f170d14ce5b'
### iv: '8c9dbcc0f3642f170d14ce5b'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'bdab8df6c4531e203a2cce5b'
### iv_xor: 'bdab8df6c4531e203a2cce5b'
### aad: '9511f025dafb99799ccac7df92da040aef6550c748bd5b404e9977d9713ec27d'
### aad: '9511f025dafb99799ccac7df92da040aef6550c748bd5b404e9977d9713ec27d'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '14d7176dadcad039'
### ciphertext: '14d7176dadcad039'
### authtag: 'b868ce509803152649ab8a56afcd7371'
### authtag: 'b868ce509803152649ab8a56afcd7371'
### cipherinfo: '834a3136313637373137373850b868ce509803152649ab8a56afcd73714814d7176dadcad039'
### cipherinfo: '834a3136313637373137373850b868ce509803152649ab8a56afcd73714814d7176dadcad039'

### b_msg: '835821028974ed5c1cf5ce561cca9e230544710a7ed69af7f70b270cde2cfb165a873fed5847834a3136313637373137373850b7cc4dded0ceb866118f603962678a5358280493c9eb2e41fb2c152f78b134f4a8f29cdbe152aabc0f7422f6017ebc30b4d4e1cfa6c8ddff19245826834a3136313637373137373850b868ce509803152649ab8a56afcd73714814d7176dadcad039'

### b_msg: '835821028974ed5c1cf5ce561cca9e230544710a7ed69af7f70b270cde2cfb165a873fed5847834a3136313637373137373850b7cc4dded0ceb866118f603962678a5358280493c9eb2e41fb2c152f78b134f4a8f29cdbe152aabc0f7422f6017ebc30b4d4e1cfa6c8ddff19245826834a3136313637373137373850b868ce509803152649ab8a56afcd73714814d7176dadcad039'
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","028974ed5c1cf5ce561cca9e230544710a7ed69af7f70b270cde2cfb165a873fed"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 0,
    message_pattens => [["e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","03706991dda2fa1315fa1d20bce07fa6536ee8ed94ca4e541f7d280c1e41f55172"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","c0c2321c2a6f12cc698fa8e0156238d9c814e7a8ba03a91f9a1d5f9ff6c32d4f"),
      h => pack("H*","dadab88678791f7edbee3a703d2d01b13dfb056d1ee0636bd38a9840d8a53898"),
      hasK => 1,
      k => pack("H*","5c6ea6c7007d170ea49c83ca86acaf590061755485db6bf8697f4f8f26d92835"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","13e54dae02f2a059fbbdc23de3f58fbcc4f3e9a11058a871a736d28d0c85be0a"),
  },
  {
    hasK => 1,
    k => pack("H*","2414bb48eae2d35f69b1fea9b4c14f9c5ae8d94e2ae0a2e13b19dab9ff00aa58"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","028974ed5c1cf5ce561cca9e230544710a7ed69af7f70b270cde2cfb165a873fed"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 0,
    message_pattens => [["e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","03706991dda2fa1315fa1d20bce07fa6536ee8ed94ca4e541f7d280c1e41f55172"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","c0c2321c2a6f12cc698fa8e0156238d9c814e7a8ba03a91f9a1d5f9ff6c32d4f"),
      h => pack("H*","dadab88678791f7edbee3a703d2d01b13dfb056d1ee0636bd38a9840d8a53898"),
      hasK => 1,
      k => pack("H*","5c6ea6c7007d170ea49c83ca86acaf590061755485db6bf8697f4f8f26d92835"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","13e54dae02f2a059fbbdc23de3f58fbcc4f3e9a11058a871a736d28d0c85be0a"),
  },
  {
    hasK => 1,
    k => pack("H*","2414bb48eae2d35f69b1fea9b4c14f9c5ae8d94e2ae0a2e13b19dab9ff00aa58"),
  },
)

### a read_message from b

### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIB12TyUkV+tb3sO7W71TqZz5gNSR8N5FGPupUkYzCXWPoAoGCCqGSM49
',
###             'AwEHoUQDQgAEcGmR3aL6ExX6HSC84H+mU27o7ZTKTlQffSgMHkH1UXLya1y60Zhx
',
###             'jCARWcdA2jVGk3+8wRec5QVkvl2FOHHJgQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIB12TyUkV+tb3sO7W71TqZz5gNSR8N5FGPupUkYzCXWPoAoGCCqGSM49
',
###             'AwEHoUQDQgAEcGmR3aL6ExX6HSC84H+mU27o7ZTKTlQffSgMHkH1UXLya1y60Zhx
',
###             'jCARWcdA2jVGk3+8wRec5QVkvl2FOHHJgQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEiXTtXBz1zlYcyp4jBURxCn7Wmvf3
',
###           'CycM3iz7FlqHP+3yYFxFKY+5Mv9tPgaspozcGUwJJAn6sQn2pLlfip6F2A==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEiXTtXBz1zlYcyp4jBURxCn7Wmvf3
',
###           'CycM3iz7FlqHP+3yYFxFKY+5Mv9tPgaspozcGUwJJAn6sQn2pLlfip6F2A==
',
###           '-----END PUBLIC KEY-----
'
### z: '3a18d6c9a3aa40b5a8a04cafbfb87c01e10176b692025e708827f95fc7f366a2'
### z: '3a18d6c9a3aa40b5a8a04cafbfb87c01e10176b692025e708827f95fc7f366a2'

### read message pattern: 'se'

### read message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEiXTtXBz1zlYcyp4jBURxCn7Wmvf3
',
###           'CycM3iz7FlqHP+3yYFxFKY+5Mv9tPgaspozcGUwJJAn6sQn2pLlfip6F2A==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEiXTtXBz1zlYcyp4jBURxCn7Wmvf3
',
###           'CycM3iz7FlqHP+3yYFxFKY+5Mv9tPgaspozcGUwJJAn6sQn2pLlfip6F2A==
',
###           '-----END PUBLIC KEY-----
'
### z: 'd49fe92e6fdf07760dd69dcd7dd9d1a31280b33704d83055122672e1a22a0526'
### z: 'd49fe92e6fdf07760dd69dcd7dd9d1a31280b33704d83055122672e1a22a0526'


### read message pattern: 's'
### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: '924050934576fd9d9db91d79cec65723a15bb65dbf6a0f7af38e0f4c32954e0f'
### key: '924050934576fd9d9db91d79cec65723a15bb65dbf6a0f7af38e0f4c32954e0f'
### iv: '7f9c38cbbb9f3bdf3dd40033'
### iv: '7f9c38cbbb9f3bdf3dd40033'
### aad: '7dd4ec5424d73c22411fcf0a55ee20e2feacecffe5f8fb07fe7559c15cb45c24'
### aad: '7dd4ec5424d73c22411fcf0a55ee20e2feacecffe5f8fb07fe7559c15cb45c24'
### cipherinfo: '834a3136313637373137373850b7cc4dded0ceb866118f603962678a5358280493c9eb2e41fb2c152f78b134f4a8f29cdbe152aabc0f7422f6017ebc30b4d4e1cfa6c8ddff1924'
### cipherinfo: '834a3136313637373137373850b7cc4dded0ceb866118f603962678a5358280493c9eb2e41fb2c152f78b134f4a8f29cdbe152aabc0f7422f6017ebc30b4d4e1cfa6c8ddff1924'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '4eaa09fd8ca80ae80aec0033'
### iv_xor: '4eaa09fd8ca80ae80aec0033'
### authtag: 'b7cc4dded0ceb866118f603962678a53'
### authtag: 'b7cc4dded0ceb866118f603962678a53'
### ciphertext: '0493c9eb2e41fb2c152f78b134f4a8f29cdbe152aabc0f7422f6017ebc30b4d4e1cfa6c8ddff1924'
### ciphertext: '0493c9eb2e41fb2c152f78b134f4a8f29cdbe152aabc0f7422f6017ebc30b4d4e1cfa6c8ddff1924'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'


### read message pattern: 'es'
### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIB12TyUkV+tb3sO7W71TqZz5gNSR8N5FGPupUkYzCXWPoAoGCCqGSM49
',
###             'AwEHoUQDQgAEcGmR3aL6ExX6HSC84H+mU27o7ZTKTlQffSgMHkH1UXLya1y60Zhx
',
###             'jCARWcdA2jVGk3+8wRec5QVkvl2FOHHJgQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIB12TyUkV+tb3sO7W71TqZz5gNSR8N5FGPupUkYzCXWPoAoGCCqGSM49
',
###             'AwEHoUQDQgAEcGmR3aL6ExX6HSC84H+mU27o7ZTKTlQffSgMHkH1UXLya1y60Zhx
',
###             'jCARWcdA2jVGk3+8wRec5QVkvl2FOHHJgQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '015c0011544c0868b52d1cea5696535b7b71091e4bb1a835bd15e2b6f0802c08'
### z: '015c0011544c0868b52d1cea5696535b7b71091e4bb1a835bd15e2b6f0802c08'

### noise decrypt

### noise decrypt
### key: 'a95e47dbb198d892001bc44ae73f2ca4831fb5ee15e28a7f74751515ef5e1ab2'
### key: 'a95e47dbb198d892001bc44ae73f2ca4831fb5ee15e28a7f74751515ef5e1ab2'
### iv: '8c9dbcc0f3642f170d14ce5b'
### iv: '8c9dbcc0f3642f170d14ce5b'
### aad: '9511f025dafb99799ccac7df92da040aef6550c748bd5b404e9977d9713ec27d'
### aad: '9511f025dafb99799ccac7df92da040aef6550c748bd5b404e9977d9713ec27d'
### cipherinfo: '834a3136313637373137373850b868ce509803152649ab8a56afcd73714814d7176dadcad039'
### cipherinfo: '834a3136313637373137373850b868ce509803152649ab8a56afcd73714814d7176dadcad039'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'bdab8df6c4531e203a2cce5b'
### iv_xor: 'bdab8df6c4531e203a2cce5b'
### authtag: 'b868ce509803152649ab8a56afcd7371'
### authtag: 'b868ce509803152649ab8a56afcd7371'
### ciphertext: '14d7176dadcad039'
### ciphertext: '14d7176dadcad039'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03706991dda2fa1315fa1d20bce07fa6536ee8ed94ca4e541f7d280c1e41f55172"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 1,
    message_pattens => [["e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","028974ed5c1cf5ce561cca9e230544710a7ed69af7f70b270cde2cfb165a873fed"),
    },
    re_pub => "a_re_pub.pem",
    rs => {
      pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    },
    rs_pub => "a_rs_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","c0c2321c2a6f12cc698fa8e0156238d9c814e7a8ba03a91f9a1d5f9ff6c32d4f"),
      h => pack("H*","dadab88678791f7edbee3a703d2d01b13dfb056d1ee0636bd38a9840d8a53898"),
      hasK => 1,
      k => pack("H*","5c6ea6c7007d170ea49c83ca86acaf590061755485db6bf8697f4f8f26d92835"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","13e54dae02f2a059fbbdc23de3f58fbcc4f3e9a11058a871a736d28d0c85be0a"),
  },
  {
    hasK => 1,
    k => pack("H*","2414bb48eae2d35f69b1fea9b4c14f9c5ae8d94e2ae0a2e13b19dab9ff00aa58"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03706991dda2fa1315fa1d20bce07fa6536ee8ed94ca4e541f7d280c1e41f55172"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 1,
    message_pattens => [["e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id => 2,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","028974ed5c1cf5ce561cca9e230544710a7ed69af7f70b270cde2cfb165a873fed"),
    },
    re_pub => "a_re_pub.pem",
    rs => {
      pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    },
    rs_pub => "a_rs_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","c0c2321c2a6f12cc698fa8e0156238d9c814e7a8ba03a91f9a1d5f9ff6c32d4f"),
      h => pack("H*","dadab88678791f7edbee3a703d2d01b13dfb056d1ee0636bd38a9840d8a53898"),
      hasK => 1,
      k => pack("H*","5c6ea6c7007d170ea49c83ca86acaf590061755485db6bf8697f4f8f26d92835"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","13e54dae02f2a059fbbdc23de3f58fbcc4f3e9a11058a871a736d28d0c85be0a"),
  },
  {
    hasK => 1,
    k => pack("H*","2414bb48eae2d35f69b1fea9b4c14f9c5ae8d94e2ae0a2e13b19dab9ff00aa58"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '6b31d70a21164f2b74c52ee47fa1be92663518a9f7004e749cb5ca61517a476f'
### key: '6b31d70a21164f2b74c52ee47fa1be92663518a9f7004e749cb5ca61517a476f'
### iv: '819d5556315e903f09cf1469'
### iv: '819d5556315e903f09cf1469'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'b0ab64600669a1083ef71469'
### iv_xor: 'b0ab64600669a1083ef71469'
### aad: 'dadab88678791f7edbee3a703d2d01b13dfb056d1ee0636bd38a9840d8a53898'
### aad: 'dadab88678791f7edbee3a703d2d01b13dfb056d1ee0636bd38a9840d8a53898'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '58bd35b7666eea76b50308cd44fff9f6ef1949110f86a738fb6c08022c3a579b3b32b62fcfa9f1ca63671f4fb96804a0681e94'
### ciphertext: '58bd35b7666eea76b50308cd44fff9f6ef1949110f86a738fb6c08022c3a579b3b32b62fcfa9f1ca63671f4fb96804a0681e94'
### authtag: '0bb05e119213353bbdfad53b00853352'
### authtag: '0bb05e119213353bbdfad53b00853352'
### cipherinfo: '834a31363136373731373738500bb05e119213353bbdfad53b00853352583358bd35b7666eea76b50308cd44fff9f6ef1949110f86a738fb6c08022c3a579b3b32b62fcfa9f1ca63671f4fb96804a0681e94'
### cipherinfo: '834a31363136373731373738500bb05e119213353bbdfad53b00853352583358bd35b7666eea76b50308cd44fff9f6ef1949110f86a738fb6c08022c3a579b3b32b62fcfa9f1ca63671f4fb96804a0681e94'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '6b31d70a21164f2b74c52ee47fa1be92663518a9f7004e749cb5ca61517a476f'
### key: '6b31d70a21164f2b74c52ee47fa1be92663518a9f7004e749cb5ca61517a476f'
### iv: '819d5556315e903f09cf1469'
### iv: '819d5556315e903f09cf1469'
### aad: 'dadab88678791f7edbee3a703d2d01b13dfb056d1ee0636bd38a9840d8a53898'
### aad: 'dadab88678791f7edbee3a703d2d01b13dfb056d1ee0636bd38a9840d8a53898'
### cipherinfo: '834a31363136373731373738500bb05e119213353bbdfad53b00853352583358bd35b7666eea76b50308cd44fff9f6ef1949110f86a738fb6c08022c3a579b3b32b62fcfa9f1ca63671f4fb96804a0681e94'
### cipherinfo: '834a31363136373731373738500bb05e119213353bbdfad53b00853352583358bd35b7666eea76b50308cd44fff9f6ef1949110f86a738fb6c08022c3a579b3b32b62fcfa9f1ca63671f4fb96804a0681e94'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'b0ab64600669a1083ef71469'
### iv_xor: 'b0ab64600669a1083ef71469'
### authtag: '0bb05e119213353bbdfad53b00853352'
### authtag: '0bb05e119213353bbdfad53b00853352'
### ciphertext: '58bd35b7666eea76b50308cd44fff9f6ef1949110f86a738fb6c08022c3a579b3b32b62fcfa9f1ca63671f4fb96804a0681e94'
### ciphertext: '58bd35b7666eea76b50308cd44fff9f6ef1949110f86a738fb6c08022c3a579b3b32b62fcfa9f1ca63671f4fb96804a0681e94'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '08edb270e93664c0ba200f87a7d9228bbe76939dc38b4272697c971ba2481f47'
### key: '08edb270e93664c0ba200f87a7d9228bbe76939dc38b4272697c971ba2481f47'
### iv: 'bd943ca40933a148339820e8'
### iv: 'bd943ca40933a148339820e8'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '8ca20d923e04907f04a020e8'
### iv_xor: '8ca20d923e04907f04a020e8'
### aad: 'dadab88678791f7edbee3a703d2d01b13dfb056d1ee0636bd38a9840d8a53898'
### aad: 'dadab88678791f7edbee3a703d2d01b13dfb056d1ee0636bd38a9840d8a53898'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'f1b98b0ebdd5f06f38cd2a12f65644d7d83621614a1b38cb4b5e6791377b90cb2b9329e0e00d61d658ed1d3e5cbc50'
### ciphertext: 'f1b98b0ebdd5f06f38cd2a12f65644d7d83621614a1b38cb4b5e6791377b90cb2b9329e0e00d61d658ed1d3e5cbc50'
### authtag: '5161d15fe0125710a2e515d0c8e2d3fc'
### authtag: '5161d15fe0125710a2e515d0c8e2d3fc'
### cipherinfo: '834a31363136373731373738505161d15fe0125710a2e515d0c8e2d3fc582ff1b98b0ebdd5f06f38cd2a12f65644d7d83621614a1b38cb4b5e6791377b90cb2b9329e0e00d61d658ed1d3e5cbc50'
### cipherinfo: '834a31363136373731373738505161d15fe0125710a2e515d0c8e2d3fc582ff1b98b0ebdd5f06f38cd2a12f65644d7d83621614a1b38cb4b5e6791377b90cb2b9329e0e00d61d658ed1d3e5cbc50'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '08edb270e93664c0ba200f87a7d9228bbe76939dc38b4272697c971ba2481f47'
### key: '08edb270e93664c0ba200f87a7d9228bbe76939dc38b4272697c971ba2481f47'
### iv: 'bd943ca40933a148339820e8'
### iv: 'bd943ca40933a148339820e8'
### aad: 'dadab88678791f7edbee3a703d2d01b13dfb056d1ee0636bd38a9840d8a53898'
### aad: 'dadab88678791f7edbee3a703d2d01b13dfb056d1ee0636bd38a9840d8a53898'
### cipherinfo: '834a31363136373731373738505161d15fe0125710a2e515d0c8e2d3fc582ff1b98b0ebdd5f06f38cd2a12f65644d7d83621614a1b38cb4b5e6791377b90cb2b9329e0e00d61d658ed1d3e5cbc50'
### cipherinfo: '834a31363136373731373738505161d15fe0125710a2e515d0c8e2d3fc582ff1b98b0ebdd5f06f38cd2a12f65644d7d83621614a1b38cb4b5e6791377b90cb2b9329e0e00d61d658ed1d3e5cbc50'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '8ca20d923e04907f04a020e8'
### iv_xor: '8ca20d923e04907f04a020e8'
### authtag: '5161d15fe0125710a2e515d0c8e2d3fc'
### authtag: '5161d15fe0125710a2e515d0c8e2d3fc'
### ciphertext: 'f1b98b0ebdd5f06f38cd2a12f65644d7d83621614a1b38cb4b5e6791377b90cb2b9329e0e00d61d658ed1d3e5cbc50'
### ciphertext: 'f1b98b0ebdd5f06f38cd2a12f65644d7d83621614a1b38cb4b5e6791377b90cb2b9329e0e00d61d658ed1d3e5cbc50'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'IX',
###                               undef,
###                               undef

### -----------end test --------: 'IX',
###                               undef,
###                               undef

### -----------start test --------: 'IX',
###                                 'test_psk',
###                                 0

### -----------start test --------: 'IX',
###                                 'test_psk',
###                                 0

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IX",
  initiator => 1,
  message_pattens => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","853d47396ff004d26261481964cf4e602863a265e6c8eeffc45d8be8a19fd450"),
    h  => pack("H*","7f40b20e674ae0d816f97c5a0efbbea3b45d322388c165134cc7472fc995c949"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IX",
  initiator => 1,
  message_pattens => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","853d47396ff004d26261481964cf4e602863a265e6c8eeffc45d8be8a19fd450"),
    h  => pack("H*","7f40b20e674ae0d816f97c5a0efbbea3b45d322388c165134cc7472fc995c949"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'psk'

### write message pattern: 'psk'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '030199e5e8f72925d7222f357e330653ca7519d3edb6feac94c8ff99faeacb0d8c'

### public compressed: '030199e5e8f72925d7222f357e330653ca7519d3edb6feac94c8ff99faeacb0d8c'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: 'd77827d4a6ea9cef0dc464943ec27404ddc015353ff8105a88232c435200a2f3'
### key: 'd77827d4a6ea9cef0dc464943ec27404ddc015353ff8105a88232c435200a2f3'
### iv: 'c3f931fdca59157cc0964b7a'
### iv: 'c3f931fdca59157cc0964b7a'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'f2cf00cbfd6e244bf7ae4b7a'
### iv_xor: 'f2cf00cbfd6e244bf7ae4b7a'
### aad: 'd528c96369a1269abf8d3f06d3e3b443278bd88683ed7fd687d94a46ce9f8e76'
### aad: 'd528c96369a1269abf8d3f06d3e3b443278bd88683ed7fd687d94a46ce9f8e76'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: '8426b676ba276e3a3e529c301520f952c8d4c7af514e7d50671c7a91d3c3ed77d28b8bfce05c8bd6'
### ciphertext: '8426b676ba276e3a3e529c301520f952c8d4c7af514e7d50671c7a91d3c3ed77d28b8bfce05c8bd6'
### authtag: 'cf4c371ec4f103424b371b4afcbf5f96'
### authtag: 'cf4c371ec4f103424b371b4afcbf5f96'
### cipherinfo: '834a3136313637373137373850cf4c371ec4f103424b371b4afcbf5f9658288426b676ba276e3a3e529c301520f952c8d4c7af514e7d50671c7a91d3c3ed77d28b8bfce05c8bd6'
### cipherinfo: '834a3136313637373137373850cf4c371ec4f103424b371b4afcbf5f9658288426b676ba276e3a3e529c301520f952c8d4c7af514e7d50671c7a91d3c3ed77d28b8bfce05c8bd6'

### noise encrypt

### noise encrypt
### key: 'd77827d4a6ea9cef0dc464943ec27404ddc015353ff8105a88232c435200a2f3'
### key: 'd77827d4a6ea9cef0dc464943ec27404ddc015353ff8105a88232c435200a2f3'
### iv: 'c3f931fdca59157cc0964b7a'
### iv: 'c3f931fdca59157cc0964b7a'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'f2cf00cbfd6e244bf7ae4b7a'
### iv_xor: 'f2cf00cbfd6e244bf7ae4b7a'
### aad: '2eae916cf5d44bb58f774dedbff2ca8843e47bb1c210a355b0828e29f9bd8118'
### aad: '2eae916cf5d44bb58f774dedbff2ca8843e47bb1c210a355b0828e29f9bd8118'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '6f0bad63e30c3657'
### ciphertext: '6f0bad63e30c3657'
### authtag: 'b07855880ed213809ca46ea5721bed16'
### authtag: 'b07855880ed213809ca46ea5721bed16'
### cipherinfo: '834a3136313637373137373850b07855880ed213809ca46ea5721bed16486f0bad63e30c3657'
### cipherinfo: '834a3136313637373137373850b07855880ed213809ca46ea5721bed16486f0bad63e30c3657'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghAwGZ5ej3KSXXIi81fjMGU8p1GdPttv6slMj/mfrqyw2MWEeDSjE2MTY3NzE3NzhQz0w3HsTxA0JLNxtK/L9fllgohCa2dronbjo+UpwwFSD5UsjUx69RTn1QZxx6kdPD7XfSi4v84FyL1lgmg0oxNjE2NzcxNzc4ULB4VYgO0hOAnKRupXIb7RZIbwutY+MMNlc="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghAwGZ5ej3KSXXIi81fjMGU8p1GdPttv6slMj/mfrqyw2MWEeDSjE2MTY3NzE3NzhQz0w3HsTxA0JLNxtK/L9fllgohCa2dronbjo+UpwwFSD5UsjUx69RTn1QZxx6kdPD7XfSi4v84FyL1lgmg0oxNjE2NzcxNzc4ULB4VYgO0hOAnKRupXIb7RZIbwutY+MMNlc="),
  );
}
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","030199e5e8f72925d7222f357e330653ca7519d3edb6feac94c8ff99faeacb0d8c"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 1,
    message_pattens => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","0b1713427748776fd506037d5dc50be8cb5099c6403e21f34cfc4ae61bb1d359"),
      h => pack("H*","29b923dcdf2689b248bba1264cb2be9eff5acbee4a9633fbccae1e089dcc3e7a"),
      hasK => 1,
      k => pack("H*","c426a5fb669e7ef3d1eb9ef1bd1aa27092c83980a169f0e8b5e1d4e45ddc0df9"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","030199e5e8f72925d7222f357e330653ca7519d3edb6feac94c8ff99faeacb0d8c"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 1,
    message_pattens => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","0b1713427748776fd506037d5dc50be8cb5099c6403e21f34cfc4ae61bb1d359"),
      h => pack("H*","29b923dcdf2689b248bba1264cb2be9eff5acbee4a9633fbccae1e089dcc3e7a"),
      hasK => 1,
      k => pack("H*","c426a5fb669e7ef3d1eb9ef1bd1aa27092c83980a169f0e8b5e1d4e45ddc0df9"),
    },
    who => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IX",
  initiator => 0,
  message_pattens => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","853d47396ff004d26261481964cf4e602863a265e6c8eeffc45d8be8a19fd450"),
    h  => pack("H*","7f40b20e674ae0d816f97c5a0efbbea3b45d322388c165134cc7472fc995c949"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IX",
  initiator => 0,
  message_pattens => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","853d47396ff004d26261481964cf4e602863a265e6c8eeffc45d8be8a19fd450"),
    h  => pack("H*","7f40b20e674ae0d816f97c5a0efbbea3b45d322388c165134cc7472fc995c949"),
  },
  who => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'psk'

### read message pattern: 'psk'

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 's'

### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: 'd77827d4a6ea9cef0dc464943ec27404ddc015353ff8105a88232c435200a2f3'
### key: 'd77827d4a6ea9cef0dc464943ec27404ddc015353ff8105a88232c435200a2f3'
### iv: 'c3f931fdca59157cc0964b7a'
### iv: 'c3f931fdca59157cc0964b7a'
### aad: 'd528c96369a1269abf8d3f06d3e3b443278bd88683ed7fd687d94a46ce9f8e76'
### aad: 'd528c96369a1269abf8d3f06d3e3b443278bd88683ed7fd687d94a46ce9f8e76'
### cipherinfo: '834a3136313637373137373850cf4c371ec4f103424b371b4afcbf5f9658288426b676ba276e3a3e529c301520f952c8d4c7af514e7d50671c7a91d3c3ed77d28b8bfce05c8bd6'
### cipherinfo: '834a3136313637373137373850cf4c371ec4f103424b371b4afcbf5f9658288426b676ba276e3a3e529c301520f952c8d4c7af514e7d50671c7a91d3c3ed77d28b8bfce05c8bd6'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'f2cf00cbfd6e244bf7ae4b7a'
### iv_xor: 'f2cf00cbfd6e244bf7ae4b7a'
### authtag: 'cf4c371ec4f103424b371b4afcbf5f96'
### authtag: 'cf4c371ec4f103424b371b4afcbf5f96'
### ciphertext: '8426b676ba276e3a3e529c301520f952c8d4c7af514e7d50671c7a91d3c3ed77d28b8bfce05c8bd6'
### ciphertext: '8426b676ba276e3a3e529c301520f952c8d4c7af514e7d50671c7a91d3c3ed77d28b8bfce05c8bd6'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'


### noise decrypt
### noise decrypt
### key: 'd77827d4a6ea9cef0dc464943ec27404ddc015353ff8105a88232c435200a2f3'
### key: 'd77827d4a6ea9cef0dc464943ec27404ddc015353ff8105a88232c435200a2f3'
### iv: 'c3f931fdca59157cc0964b7a'
### iv: 'c3f931fdca59157cc0964b7a'
### aad: '2eae916cf5d44bb58f774dedbff2ca8843e47bb1c210a355b0828e29f9bd8118'
### aad: '2eae916cf5d44bb58f774dedbff2ca8843e47bb1c210a355b0828e29f9bd8118'
### cipherinfo: '834a3136313637373137373850b07855880ed213809ca46ea5721bed16486f0bad63e30c3657'
### cipherinfo: '834a3136313637373137373850b07855880ed213809ca46ea5721bed16486f0bad63e30c3657'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'f2cf00cbfd6e244bf7ae4b7a'
### iv_xor: 'f2cf00cbfd6e244bf7ae4b7a'
### authtag: 'b07855880ed213809ca46ea5721bed16'
### authtag: 'b07855880ed213809ca46ea5721bed16'
### ciphertext: '6f0bad63e30c3657'
### ciphertext: '6f0bad63e30c3657'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "IX",
    initiator => 0,
    message_pattens => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","030199e5e8f72925d7222f357e330653ca7519d3edb6feac94c8ff99faeacb0d8c"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","0b1713427748776fd506037d5dc50be8cb5099c6403e21f34cfc4ae61bb1d359"),
      h => pack("H*","29b923dcdf2689b248bba1264cb2be9eff5acbee4a9633fbccae1e089dcc3e7a"),
      hasK => 1,
      k => pack("H*","c426a5fb669e7ef3d1eb9ef1bd1aa27092c83980a169f0e8b5e1d4e45ddc0df9"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "IX",
    initiator => 0,
    message_pattens => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","030199e5e8f72925d7222f357e330653ca7519d3edb6feac94c8ff99faeacb0d8c"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","0b1713427748776fd506037d5dc50be8cb5099c6403e21f34cfc4ae61bb1d359"),
      h => pack("H*","29b923dcdf2689b248bba1264cb2be9eff5acbee4a9633fbccae1e089dcc3e7a"),
      hasK => 1,
      k => pack("H*","c426a5fb669e7ef3d1eb9ef1bd1aa27092c83980a169f0e8b5e1d4e45ddc0df9"),
    },
    who => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '0240c684dc79833f27c884c94b664d0e373e1755c46966341abe9941e5bc6a09d0'

### public compressed: '0240c684dc79833f27c884c94b664d0e373e1755c46966341abe9941e5bc6a09d0'

### write message pattern: 'ee'

### write message pattern: 'ee'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOVIMuAK2fJNlIXZUNeKxnYvz9AZCRyWcvp44QkdaOzPoAoGCCqGSM49
',
###             'AwEHoUQDQgAEQMaE3HmDPyfIhMlLZk0ONz4XVcRpZjQavplB5bxqCdAyU5XL9fhd
',
###             'bf6gwiBKtScNxg8q1tXUvKFvwYSNS3hI+g==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOVIMuAK2fJNlIXZUNeKxnYvz9AZCRyWcvp44QkdaOzPoAoGCCqGSM49
',
###             'AwEHoUQDQgAEQMaE3HmDPyfIhMlLZk0ONz4XVcRpZjQavplB5bxqCdAyU5XL9fhd
',
###             'bf6gwiBKtScNxg8q1tXUvKFvwYSNS3hI+g==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEAZnl6PcpJdciLzV+MwZTynUZ0+22
',
###           '/qyUyP+Z+urLDYxvLD+Zgh9dwsU2PMcIuSeo0ywuyMrqdkWXouMPnI80tw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEAZnl6PcpJdciLzV+MwZTynUZ0+22
',
###           '/qyUyP+Z+urLDYxvLD+Zgh9dwsU2PMcIuSeo0ywuyMrqdkWXouMPnI80tw==
',
###           '-----END PUBLIC KEY-----
'
### z: '2087434560eb93e2a44be12174842cf7de3e15f09dbd8d80f07ef81bf30eeaad'
### z: '2087434560eb93e2a44be12174842cf7de3e15f09dbd8d80f07ef81bf30eeaad'

### write message pattern: 'se'

### write message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOVIMuAK2fJNlIXZUNeKxnYvz9AZCRyWcvp44QkdaOzPoAoGCCqGSM49
',
###             'AwEHoUQDQgAEQMaE3HmDPyfIhMlLZk0ONz4XVcRpZjQavplB5bxqCdAyU5XL9fhd
',
###             'bf6gwiBKtScNxg8q1tXUvKFvwYSNS3hI+g==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOVIMuAK2fJNlIXZUNeKxnYvz9AZCRyWcvp44QkdaOzPoAoGCCqGSM49
',
###             'AwEHoUQDQgAEQMaE3HmDPyfIhMlLZk0ONz4XVcRpZjQavplB5bxqCdAyU5XL9fhd
',
###             'bf6gwiBKtScNxg8q1tXUvKFvwYSNS3hI+g==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '6b78104e93b72ce8bb74ef352bbbfa2c39cbdfe3ea99f9c4f7dd7945241858ab'
### z: '6b78104e93b72ce8bb74ef352bbbfa2c39cbdfe3ea99f9c4f7dd7945241858ab'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '26c6ba782f875d9bc7aca72c572256ccc6366f39e45c1b325d9c5859e84d7de7'
### key: '26c6ba782f875d9bc7aca72c572256ccc6366f39e45c1b325d9c5859e84d7de7'
### iv: '4063b291d591e3e5831c0e25'
### iv: '4063b291d591e3e5831c0e25'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '715583a7e2a6d2d2b4240e25'
### iv_xor: '715583a7e2a6d2d2b4240e25'
### aad: '092110829f642b3a439ebf4e8a991bf12b00ae8bc7d4814a71df39534802d8da'
### aad: '092110829f642b3a439ebf4e8a991bf12b00ae8bc7d4814a71df39534802d8da'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### ciphertext: 'a29b9fb5ff640111f9f074eb17ff8d1a77ad03a2eb0fa48542c8d71435fa67c448a2e6063c2b773d'
### ciphertext: 'a29b9fb5ff640111f9f074eb17ff8d1a77ad03a2eb0fa48542c8d71435fa67c448a2e6063c2b773d'
### authtag: '9bbe8278c01ac8796768262722bdfe43'
### authtag: '9bbe8278c01ac8796768262722bdfe43'
### cipherinfo: '834a31363136373731373738509bbe8278c01ac8796768262722bdfe435828a29b9fb5ff640111f9f074eb17ff8d1a77ad03a2eb0fa48542c8d71435fa67c448a2e6063c2b773d'
### cipherinfo: '834a31363136373731373738509bbe8278c01ac8796768262722bdfe435828a29b9fb5ff640111f9f074eb17ff8d1a77ad03a2eb0fa48542c8d71435fa67c448a2e6063c2b773d'

### write message pattern: 'es'

### write message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEAZnl6PcpJdciLzV+MwZTynUZ0+22
',
###           '/qyUyP+Z+urLDYxvLD+Zgh9dwsU2PMcIuSeo0ywuyMrqdkWXouMPnI80tw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEAZnl6PcpJdciLzV+MwZTynUZ0+22
',
###           '/qyUyP+Z+urLDYxvLD+Zgh9dwsU2PMcIuSeo0ywuyMrqdkWXouMPnI80tw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'c8b62dfc75992e5c535806f1ba992ba17050efdaa7c8d0073d5892abad261e34'
### z: 'c8b62dfc75992e5c535806f1ba992ba17050efdaa7c8d0073d5892abad261e34'

### noise encrypt

### noise encrypt
### key: 'e5b9bf87180a2f3b5afd4cb73aba0eca6299f1586d67509bfc327f3af124c2c4'
### key: 'e5b9bf87180a2f3b5afd4cb73aba0eca6299f1586d67509bfc327f3af124c2c4'
### iv: '0ba95277b920fd88ccce0502'
### iv: '0ba95277b920fd88ccce0502'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '3a9f63418e17ccbffbf60502'
### iv_xor: '3a9f63418e17ccbffbf60502'
### aad: '42277874a4b571c460fc06e78cf7e8f836fbf605fba1a0656d2a75599f1d62ea'
### aad: '42277874a4b571c460fc06e78cf7e8f836fbf605fba1a0656d2a75599f1d62ea'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '5fc172f7c003259d'
### ciphertext: '5fc172f7c003259d'
### authtag: '056e0dabb19f646db75538613dfd8bcf'
### authtag: '056e0dabb19f646db75538613dfd8bcf'
### cipherinfo: '834a3136313637373137373850056e0dabb19f646db75538613dfd8bcf485fc172f7c003259d'
### cipherinfo: '834a3136313637373137373850056e0dabb19f646db75538613dfd8bcf485fc172f7c003259d'

### b_msg: '8358210240c684dc79833f27c884c94b664d0e373e1755c46966341abe9941e5bc6a09d05847834a31363136373731373738509bbe8278c01ac8796768262722bdfe435828a29b9fb5ff640111f9f074eb17ff8d1a77ad03a2eb0fa48542c8d71435fa67c448a2e6063c2b773d5826834a3136313637373137373850056e0dabb19f646db75538613dfd8bcf485fc172f7c003259d'

### b_msg: '8358210240c684dc79833f27c884c94b664d0e373e1755c46966341abe9941e5bc6a09d05847834a31363136373731373738509bbe8278c01ac8796768262722bdfe435828a29b9fb5ff640111f9f074eb17ff8d1a77ad03a2eb0fa48542c8d71435fa67c448a2e6063c2b773d5826834a3136313637373137373850056e0dabb19f646db75538613dfd8bcf485fc172f7c003259d'
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0240c684dc79833f27c884c94b664d0e373e1755c46966341abe9941e5bc6a09d0"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 0,
    message_pattens => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","030199e5e8f72925d7222f357e330653ca7519d3edb6feac94c8ff99faeacb0d8c"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","98652319feaa53f57c5ef07d555b127af573216cbcfb5cc4041393d839cfd422"),
      h => pack("H*","0f00bfd09107739e496335dea3d87c144b53166b913cb41ee781d697781aa846"),
      hasK => 1,
      k => pack("H*","266cb9603b8b2d3ee8944f58495f5361f1fc3481ed91f1650d364f1a4638ff1f"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","aad959bda2f0a7bb98f71c5b2cc424243ef74325099ba02aca95b35a1f9e271e"),
  },
  {
    hasK => 1,
    k => pack("H*","d2206bcd3a3b2b11c67d3d4dafdd9feece0ac3a9d4ff44f0b586568257fd1f76"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0240c684dc79833f27c884c94b664d0e373e1755c46966341abe9941e5bc6a09d0"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 0,
    message_pattens => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","030199e5e8f72925d7222f357e330653ca7519d3edb6feac94c8ff99faeacb0d8c"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","98652319feaa53f57c5ef07d555b127af573216cbcfb5cc4041393d839cfd422"),
      h => pack("H*","0f00bfd09107739e496335dea3d87c144b53166b913cb41ee781d697781aa846"),
      hasK => 1,
      k => pack("H*","266cb9603b8b2d3ee8944f58495f5361f1fc3481ed91f1650d364f1a4638ff1f"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","aad959bda2f0a7bb98f71c5b2cc424243ef74325099ba02aca95b35a1f9e271e"),
  },
  {
    hasK => 1,
    k => pack("H*","d2206bcd3a3b2b11c67d3d4dafdd9feece0ac3a9d4ff44f0b586568257fd1f76"),
  },
)


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGMk2P+jGjIsSzM8MUsGracKUfO73p+rrsXAvjkONRUdoAoGCCqGSM49
',
###             'AwEHoUQDQgAEAZnl6PcpJdciLzV+MwZTynUZ0+22/qyUyP+Z+urLDYxvLD+Zgh9d
',
###             'wsU2PMcIuSeo0ywuyMrqdkWXouMPnI80tw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGMk2P+jGjIsSzM8MUsGracKUfO73p+rrsXAvjkONRUdoAoGCCqGSM49
',
###             'AwEHoUQDQgAEAZnl6PcpJdciLzV+MwZTynUZ0+22/qyUyP+Z+urLDYxvLD+Zgh9d
',
###             'wsU2PMcIuSeo0ywuyMrqdkWXouMPnI80tw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQMaE3HmDPyfIhMlLZk0ONz4XVcRp
',
###           'ZjQavplB5bxqCdAyU5XL9fhdbf6gwiBKtScNxg8q1tXUvKFvwYSNS3hI+g==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQMaE3HmDPyfIhMlLZk0ONz4XVcRp
',
###           'ZjQavplB5bxqCdAyU5XL9fhdbf6gwiBKtScNxg8q1tXUvKFvwYSNS3hI+g==
',
###           '-----END PUBLIC KEY-----
'
### z: '2087434560eb93e2a44be12174842cf7de3e15f09dbd8d80f07ef81bf30eeaad'
### z: '2087434560eb93e2a44be12174842cf7de3e15f09dbd8d80f07ef81bf30eeaad'

### read message pattern: 'se'

### read message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQMaE3HmDPyfIhMlLZk0ONz4XVcRp
',
###           'ZjQavplB5bxqCdAyU5XL9fhdbf6gwiBKtScNxg8q1tXUvKFvwYSNS3hI+g==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQMaE3HmDPyfIhMlLZk0ONz4XVcRp
',
###           'ZjQavplB5bxqCdAyU5XL9fhdbf6gwiBKtScNxg8q1tXUvKFvwYSNS3hI+g==
',
###           '-----END PUBLIC KEY-----
'
### z: '6b78104e93b72ce8bb74ef352bbbfa2c39cbdfe3ea99f9c4f7dd7945241858ab'
### z: '6b78104e93b72ce8bb74ef352bbbfa2c39cbdfe3ea99f9c4f7dd7945241858ab'

### read message pattern: 's'

### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: '26c6ba782f875d9bc7aca72c572256ccc6366f39e45c1b325d9c5859e84d7de7'
### key: '26c6ba782f875d9bc7aca72c572256ccc6366f39e45c1b325d9c5859e84d7de7'
### iv: '4063b291d591e3e5831c0e25'
### iv: '4063b291d591e3e5831c0e25'
### aad: '092110829f642b3a439ebf4e8a991bf12b00ae8bc7d4814a71df39534802d8da'
### aad: '092110829f642b3a439ebf4e8a991bf12b00ae8bc7d4814a71df39534802d8da'
### cipherinfo: '834a31363136373731373738509bbe8278c01ac8796768262722bdfe435828a29b9fb5ff640111f9f074eb17ff8d1a77ad03a2eb0fa48542c8d71435fa67c448a2e6063c2b773d'
### cipherinfo: '834a31363136373731373738509bbe8278c01ac8796768262722bdfe435828a29b9fb5ff640111f9f074eb17ff8d1a77ad03a2eb0fa48542c8d71435fa67c448a2e6063c2b773d'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '715583a7e2a6d2d2b4240e25'
### iv_xor: '715583a7e2a6d2d2b4240e25'
### authtag: '9bbe8278c01ac8796768262722bdfe43'
### authtag: '9bbe8278c01ac8796768262722bdfe43'
### ciphertext: 'a29b9fb5ff640111f9f074eb17ff8d1a77ad03a2eb0fa48542c8d71435fa67c448a2e6063c2b773d'
### ciphertext: 'a29b9fb5ff640111f9f074eb17ff8d1a77ad03a2eb0fa48542c8d71435fa67c448a2e6063c2b773d'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGMk2P+jGjIsSzM8MUsGracKUfO73p+rrsXAvjkONRUdoAoGCCqGSM49
',
###             'AwEHoUQDQgAEAZnl6PcpJdciLzV+MwZTynUZ0+22/qyUyP+Z+urLDYxvLD+Zgh9d
',
###             'wsU2PMcIuSeo0ywuyMrqdkWXouMPnI80tw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGMk2P+jGjIsSzM8MUsGracKUfO73p+rrsXAvjkONRUdoAoGCCqGSM49
',
###             'AwEHoUQDQgAEAZnl6PcpJdciLzV+MwZTynUZ0+22/qyUyP+Z+urLDYxvLD+Zgh9d
',
###             'wsU2PMcIuSeo0ywuyMrqdkWXouMPnI80tw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'c8b62dfc75992e5c535806f1ba992ba17050efdaa7c8d0073d5892abad261e34'
### z: 'c8b62dfc75992e5c535806f1ba992ba17050efdaa7c8d0073d5892abad261e34'

### noise decrypt

### noise decrypt
### key: 'e5b9bf87180a2f3b5afd4cb73aba0eca6299f1586d67509bfc327f3af124c2c4'
### key: 'e5b9bf87180a2f3b5afd4cb73aba0eca6299f1586d67509bfc327f3af124c2c4'
### iv: '0ba95277b920fd88ccce0502'
### iv: '0ba95277b920fd88ccce0502'
### aad: '42277874a4b571c460fc06e78cf7e8f836fbf605fba1a0656d2a75599f1d62ea'
### aad: '42277874a4b571c460fc06e78cf7e8f836fbf605fba1a0656d2a75599f1d62ea'
### cipherinfo: '834a3136313637373137373850056e0dabb19f646db75538613dfd8bcf485fc172f7c003259d'
### cipherinfo: '834a3136313637373137373850056e0dabb19f646db75538613dfd8bcf485fc172f7c003259d'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '3a9f63418e17ccbffbf60502'
### iv_xor: '3a9f63418e17ccbffbf60502'
### authtag: '056e0dabb19f646db75538613dfd8bcf'
### authtag: '056e0dabb19f646db75538613dfd8bcf'
### ciphertext: '5fc172f7c003259d'
### ciphertext: '5fc172f7c003259d'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","030199e5e8f72925d7222f357e330653ca7519d3edb6feac94c8ff99faeacb0d8c"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 1,
    message_pattens => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","0240c684dc79833f27c884c94b664d0e373e1755c46966341abe9941e5bc6a09d0"),
    },
    re_pub => "a_re_pub.pem",
    rs => {
      pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    },
    rs_pub => "a_rs_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","98652319feaa53f57c5ef07d555b127af573216cbcfb5cc4041393d839cfd422"),
      h => pack("H*","0f00bfd09107739e496335dea3d87c144b53166b913cb41ee781d697781aa846"),
      hasK => 1,
      k => pack("H*","266cb9603b8b2d3ee8944f58495f5361f1fc3481ed91f1650d364f1a4638ff1f"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","aad959bda2f0a7bb98f71c5b2cc424243ef74325099ba02aca95b35a1f9e271e"),
  },
  {
    hasK => 1,
    k => pack("H*","d2206bcd3a3b2b11c67d3d4dafdd9feece0ac3a9d4ff44f0b586568257fd1f76"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","030199e5e8f72925d7222f357e330653ca7519d3edb6feac94c8ff99faeacb0d8c"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 1,
    message_pattens => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","0240c684dc79833f27c884c94b664d0e373e1755c46966341abe9941e5bc6a09d0"),
    },
    re_pub => "a_re_pub.pem",
    rs => {
      pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    },
    rs_pub => "a_rs_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","98652319feaa53f57c5ef07d555b127af573216cbcfb5cc4041393d839cfd422"),
      h => pack("H*","0f00bfd09107739e496335dea3d87c144b53166b913cb41ee781d697781aa846"),
      hasK => 1,
      k => pack("H*","266cb9603b8b2d3ee8944f58495f5361f1fc3481ed91f1650d364f1a4638ff1f"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","aad959bda2f0a7bb98f71c5b2cc424243ef74325099ba02aca95b35a1f9e271e"),
  },
  {
    hasK => 1,
    k => pack("H*","d2206bcd3a3b2b11c67d3d4dafdd9feece0ac3a9d4ff44f0b586568257fd1f76"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '9dd9a0d7324acd513ebeb4a5850c7b4fb331bf354bc3acd94271483ef05b8dfd'
### key: '9dd9a0d7324acd513ebeb4a5850c7b4fb331bf354bc3acd94271483ef05b8dfd'
### iv: '0a934704243393fd57ae6735'
### iv: '0a934704243393fd57ae6735'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '3ba576321304a2ca60966735'
### iv_xor: '3ba576321304a2ca60966735'
### aad: '0f00bfd09107739e496335dea3d87c144b53166b913cb41ee781d697781aa846'
### aad: '0f00bfd09107739e496335dea3d87c144b53166b913cb41ee781d697781aa846'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '086d0a306149c65173f9c129a8f7740eea91261cb260401be5942fb232b07c076636a30a0f96700a81faaca608a3e8a8c90f67'
### ciphertext: '086d0a306149c65173f9c129a8f7740eea91261cb260401be5942fb232b07c076636a30a0f96700a81faaca608a3e8a8c90f67'
### authtag: '11db8022ebf50fb2296d38ad8b5613ac'
### authtag: '11db8022ebf50fb2296d38ad8b5613ac'
### cipherinfo: '834a313631363737313737385011db8022ebf50fb2296d38ad8b5613ac5833086d0a306149c65173f9c129a8f7740eea91261cb260401be5942fb232b07c076636a30a0f96700a81faaca608a3e8a8c90f67'
### cipherinfo: '834a313631363737313737385011db8022ebf50fb2296d38ad8b5613ac5833086d0a306149c65173f9c129a8f7740eea91261cb260401be5942fb232b07c076636a30a0f96700a81faaca608a3e8a8c90f67'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '9dd9a0d7324acd513ebeb4a5850c7b4fb331bf354bc3acd94271483ef05b8dfd'
### key: '9dd9a0d7324acd513ebeb4a5850c7b4fb331bf354bc3acd94271483ef05b8dfd'
### iv: '0a934704243393fd57ae6735'
### iv: '0a934704243393fd57ae6735'
### aad: '0f00bfd09107739e496335dea3d87c144b53166b913cb41ee781d697781aa846'
### aad: '0f00bfd09107739e496335dea3d87c144b53166b913cb41ee781d697781aa846'
### cipherinfo: '834a313631363737313737385011db8022ebf50fb2296d38ad8b5613ac5833086d0a306149c65173f9c129a8f7740eea91261cb260401be5942fb232b07c076636a30a0f96700a81faaca608a3e8a8c90f67'
### cipherinfo: '834a313631363737313737385011db8022ebf50fb2296d38ad8b5613ac5833086d0a306149c65173f9c129a8f7740eea91261cb260401be5942fb232b07c076636a30a0f96700a81faaca608a3e8a8c90f67'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '3ba576321304a2ca60966735'
### iv_xor: '3ba576321304a2ca60966735'
### authtag: '11db8022ebf50fb2296d38ad8b5613ac'
### authtag: '11db8022ebf50fb2296d38ad8b5613ac'
### ciphertext: '086d0a306149c65173f9c129a8f7740eea91261cb260401be5942fb232b07c076636a30a0f96700a81faaca608a3e8a8c90f67'
### ciphertext: '086d0a306149c65173f9c129a8f7740eea91261cb260401be5942fb232b07c076636a30a0f96700a81faaca608a3e8a8c90f67'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: 'f3473bc74e752bded35e487b6eac05129b8a551435056540ddf7dd7d63fbdfe9'
### key: 'f3473bc74e752bded35e487b6eac05129b8a551435056540ddf7dd7d63fbdfe9'
### iv: '1b604f3bff304d0735703c14'
### iv: '1b604f3bff304d0735703c14'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '2a567e0dc8077c3002483c14'
### iv_xor: '2a567e0dc8077c3002483c14'
### aad: '0f00bfd09107739e496335dea3d87c144b53166b913cb41ee781d697781aa846'
### aad: '0f00bfd09107739e496335dea3d87c144b53166b913cb41ee781d697781aa846'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'e1db36a46064e6dae3e5a9e97fbb387c73bb8f2f64bd6c3b754bf13ffffb748f8639d35b0b5cdd6e8966d7673e6288'
### ciphertext: 'e1db36a46064e6dae3e5a9e97fbb387c73bb8f2f64bd6c3b754bf13ffffb748f8639d35b0b5cdd6e8966d7673e6288'
### authtag: 'c06eae4bd21676ffd7dbb8ed07073825'
### authtag: 'c06eae4bd21676ffd7dbb8ed07073825'
### cipherinfo: '834a3136313637373137373850c06eae4bd21676ffd7dbb8ed07073825582fe1db36a46064e6dae3e5a9e97fbb387c73bb8f2f64bd6c3b754bf13ffffb748f8639d35b0b5cdd6e8966d7673e6288'
### cipherinfo: '834a3136313637373137373850c06eae4bd21676ffd7dbb8ed07073825582fe1db36a46064e6dae3e5a9e97fbb387c73bb8f2f64bd6c3b754bf13ffffb748f8639d35b0b5cdd6e8966d7673e6288'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: 'f3473bc74e752bded35e487b6eac05129b8a551435056540ddf7dd7d63fbdfe9'
### key: 'f3473bc74e752bded35e487b6eac05129b8a551435056540ddf7dd7d63fbdfe9'
### iv: '1b604f3bff304d0735703c14'
### iv: '1b604f3bff304d0735703c14'
### aad: '0f00bfd09107739e496335dea3d87c144b53166b913cb41ee781d697781aa846'
### aad: '0f00bfd09107739e496335dea3d87c144b53166b913cb41ee781d697781aa846'
### cipherinfo: '834a3136313637373137373850c06eae4bd21676ffd7dbb8ed07073825582fe1db36a46064e6dae3e5a9e97fbb387c73bb8f2f64bd6c3b754bf13ffffb748f8639d35b0b5cdd6e8966d7673e6288'
### cipherinfo: '834a3136313637373137373850c06eae4bd21676ffd7dbb8ed07073825582fe1db36a46064e6dae3e5a9e97fbb387c73bb8f2f64bd6c3b754bf13ffffb748f8639d35b0b5cdd6e8966d7673e6288'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '2a567e0dc8077c3002483c14'
### iv_xor: '2a567e0dc8077c3002483c14'
### authtag: 'c06eae4bd21676ffd7dbb8ed07073825'
### authtag: 'c06eae4bd21676ffd7dbb8ed07073825'
### ciphertext: 'e1db36a46064e6dae3e5a9e97fbb387c73bb8f2f64bd6c3b754bf13ffffb748f8639d35b0b5cdd6e8966d7673e6288'
### ciphertext: 'e1db36a46064e6dae3e5a9e97fbb387c73bb8f2f64bd6c3b754bf13ffffb748f8639d35b0b5cdd6e8966d7673e6288'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'IX',
###                               'test_psk',
###                               0

### -----------end test --------: 'IX',
###                               'test_psk',
###                               0

### -----------start test --------: 'IX',
###                                 'test_psk',
###                                 1

### -----------start test --------: 'IX',
###                                 'test_psk',
###                                 1


### a write message to b
### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IX",
  initiator => 1,
  message_pattens => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","54b12bf0108f1be22aa1f3a2a728ed42c90bb464fb6f288144d1bba93acd5fd1"),
    h  => pack("H*","a51366879d1414a6cc66272b9f59c4839472e691700ab1384f392c2ab3495988"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IX",
  initiator => 1,
  message_pattens => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","54b12bf0108f1be22aa1f3a2a728ed42c90bb464fb6f288144d1bba93acd5fd1"),
    h  => pack("H*","a51366879d1414a6cc66272b9f59c4839472e691700ab1384f392c2ab3495988"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '0358ea28efed403aa01a31a814d144225233944e07cedc99e34c5532fcd81ba2cb'

### public compressed: '0358ea28efed403aa01a31a814d144225233944e07cedc99e34c5532fcd81ba2cb'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '7e4163a2bb1e5471419099cc50cda4768e97dcb33b8009da1caf14ca1e881e9e'
### key: '7e4163a2bb1e5471419099cc50cda4768e97dcb33b8009da1caf14ca1e881e9e'
### iv: '5de6922124f79bef99cef9d0'
### iv: '5de6922124f79bef99cef9d0'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '6cd0a31713c0aad8aef6f9d0'
### iv_xor: '6cd0a31713c0aad8aef6f9d0'
### aad: 'ed8e53a410737835dd5f11234c143c64b6574f78590881e2de7ad1f97fcc05ae'
### aad: 'ed8e53a410737835dd5f11234c143c64b6574f78590881e2de7ad1f97fcc05ae'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: '1940dab925c3ce5e26e2a090b92d6edfb057a56d92e6640e17dccd62ca9af48737ab5db59767f757'
### ciphertext: '1940dab925c3ce5e26e2a090b92d6edfb057a56d92e6640e17dccd62ca9af48737ab5db59767f757'
### authtag: 'adbd8f780541a34d245cde63d4d5e2c3'
### authtag: 'adbd8f780541a34d245cde63d4d5e2c3'
### cipherinfo: '834a3136313637373137373850adbd8f780541a34d245cde63d4d5e2c358281940dab925c3ce5e26e2a090b92d6edfb057a56d92e6640e17dccd62ca9af48737ab5db59767f757'
### cipherinfo: '834a3136313637373137373850adbd8f780541a34d245cde63d4d5e2c358281940dab925c3ce5e26e2a090b92d6edfb057a56d92e6640e17dccd62ca9af48737ab5db59767f757'

### write message pattern: 'psk'

### write message pattern: 'psk'

### noise encrypt

### noise encrypt
### key: '88334f5c247fa60073cbaa50fce7d65b7b771cc041585dfa651a6eba0ef7062d'
### key: '88334f5c247fa60073cbaa50fce7d65b7b771cc041585dfa651a6eba0ef7062d'
### iv: 'fa2a36e940f57faef3403899'
### iv: 'fa2a36e940f57faef3403899'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'cb1c07df77c24e99c4783899'
### iv_xor: 'cb1c07df77c24e99c4783899'
### aad: '42fbe505137e2200b8711c79e815402490c47ea80a8f8b4fcadfa6a8c9c6920c'
### aad: '42fbe505137e2200b8711c79e815402490c47ea80a8f8b4fcadfa6a8c9c6920c'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '470bbdb0bd14a147'
### ciphertext: '470bbdb0bd14a147'
### authtag: '8db9c153df3da8f9a4395d757e0dbc42'
### authtag: '8db9c153df3da8f9a4395d757e0dbc42'
### cipherinfo: '834a31363136373731373738508db9c153df3da8f9a4395d757e0dbc4248470bbdb0bd14a147'
### cipherinfo: '834a31363136373731373738508db9c153df3da8f9a4395d757e0dbc4248470bbdb0bd14a147'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghA1jqKO/tQDqgGjGoFNFEIlIzlE4HztyZ40xVMvzYG6LLWEeDSjE2MTY3NzE3NzhQrb2PeAVBo00kXN5j1NXiw1goGUDauSXDzl4m4qCQuS1u37BXpW2S5mQOF9zNYsqa9Ic3q121l2f3V1gmg0oxNjE2NzcxNzc4UI25wVPfPaj5pDlddX4NvEJIRwu9sL0UoUc="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghA1jqKO/tQDqgGjGoFNFEIlIzlE4HztyZ40xVMvzYG6LLWEeDSjE2MTY3NzE3NzhQrb2PeAVBo00kXN5j1NXiw1goGUDauSXDzl4m4qCQuS1u37BXpW2S5mQOF9zNYsqa9Ic3q121l2f3V1gmg0oxNjE2NzcxNzc4UI25wVPfPaj5pDlddX4NvEJIRwu9sL0UoUc="),
  );
}
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0358ea28efed403aa01a31a814d144225233944e07cedc99e34c5532fcd81ba2cb"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 1,
    message_pattens => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","d751f82ad4351b4288ac414646a859ed493cf31996dc99604f0a1b4c359db989"),
      h => pack("H*","4cf7b67a552fc8e7685f0afa5f0a4abd82c6a1677f2d54d291776980743f266e"),
      hasK => 1,
      k => pack("H*","1e3a9245fcc6c6fdb257df9f218d76b34d98ae8b3fef2e444395a86d71a3f387"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0358ea28efed403aa01a31a814d144225233944e07cedc99e34c5532fcd81ba2cb"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 1,
    message_pattens => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","d751f82ad4351b4288ac414646a859ed493cf31996dc99604f0a1b4c359db989"),
      h => pack("H*","4cf7b67a552fc8e7685f0afa5f0a4abd82c6a1677f2d54d291776980743f266e"),
      hasK => 1,
      k => pack("H*","1e3a9245fcc6c6fdb257df9f218d76b34d98ae8b3fef2e444395a86d71a3f387"),
    },
    who => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IX",
  initiator => 0,
  message_pattens => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","54b12bf0108f1be22aa1f3a2a728ed42c90bb464fb6f288144d1bba93acd5fd1"),
    h  => pack("H*","a51366879d1414a6cc66272b9f59c4839472e691700ab1384f392c2ab3495988"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "IX",
  initiator => 0,
  message_pattens => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","54b12bf0108f1be22aa1f3a2a728ed42c90bb464fb6f288144d1bba93acd5fd1"),
    h  => pack("H*","a51366879d1414a6cc66272b9f59c4839472e691700ab1384f392c2ab3495988"),
  },
  who => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 's'

### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: '7e4163a2bb1e5471419099cc50cda4768e97dcb33b8009da1caf14ca1e881e9e'
### key: '7e4163a2bb1e5471419099cc50cda4768e97dcb33b8009da1caf14ca1e881e9e'
### iv: '5de6922124f79bef99cef9d0'
### iv: '5de6922124f79bef99cef9d0'
### aad: 'ed8e53a410737835dd5f11234c143c64b6574f78590881e2de7ad1f97fcc05ae'
### aad: 'ed8e53a410737835dd5f11234c143c64b6574f78590881e2de7ad1f97fcc05ae'
### cipherinfo: '834a3136313637373137373850adbd8f780541a34d245cde63d4d5e2c358281940dab925c3ce5e26e2a090b92d6edfb057a56d92e6640e17dccd62ca9af48737ab5db59767f757'
### cipherinfo: '834a3136313637373137373850adbd8f780541a34d245cde63d4d5e2c358281940dab925c3ce5e26e2a090b92d6edfb057a56d92e6640e17dccd62ca9af48737ab5db59767f757'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '6cd0a31713c0aad8aef6f9d0'
### iv_xor: '6cd0a31713c0aad8aef6f9d0'
### authtag: 'adbd8f780541a34d245cde63d4d5e2c3'
### authtag: 'adbd8f780541a34d245cde63d4d5e2c3'
### ciphertext: '1940dab925c3ce5e26e2a090b92d6edfb057a56d92e6640e17dccd62ca9af48737ab5db59767f757'
### ciphertext: '1940dab925c3ce5e26e2a090b92d6edfb057a56d92e6640e17dccd62ca9af48737ab5db59767f757'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### read message pattern: 'psk'

### read message pattern: 'psk'

### noise decrypt

### noise decrypt
### key: '88334f5c247fa60073cbaa50fce7d65b7b771cc041585dfa651a6eba0ef7062d'
### key: '88334f5c247fa60073cbaa50fce7d65b7b771cc041585dfa651a6eba0ef7062d'
### iv: 'fa2a36e940f57faef3403899'
### iv: 'fa2a36e940f57faef3403899'
### aad: '42fbe505137e2200b8711c79e815402490c47ea80a8f8b4fcadfa6a8c9c6920c'
### aad: '42fbe505137e2200b8711c79e815402490c47ea80a8f8b4fcadfa6a8c9c6920c'
### cipherinfo: '834a31363136373731373738508db9c153df3da8f9a4395d757e0dbc4248470bbdb0bd14a147'
### cipherinfo: '834a31363136373731373738508db9c153df3da8f9a4395d757e0dbc4248470bbdb0bd14a147'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'cb1c07df77c24e99c4783899'
### iv_xor: 'cb1c07df77c24e99c4783899'
### authtag: '8db9c153df3da8f9a4395d757e0dbc42'
### authtag: '8db9c153df3da8f9a4395d757e0dbc42'
### ciphertext: '470bbdb0bd14a147'
### ciphertext: '470bbdb0bd14a147'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "IX",
    initiator => 0,
    message_pattens => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","0358ea28efed403aa01a31a814d144225233944e07cedc99e34c5532fcd81ba2cb"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","d751f82ad4351b4288ac414646a859ed493cf31996dc99604f0a1b4c359db989"),
      h => pack("H*","4cf7b67a552fc8e7685f0afa5f0a4abd82c6a1677f2d54d291776980743f266e"),
      hasK => 1,
      k => pack("H*","1e3a9245fcc6c6fdb257df9f218d76b34d98ae8b3fef2e444395a86d71a3f387"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "IX",
    initiator => 0,
    message_pattens => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","0358ea28efed403aa01a31a814d144225233944e07cedc99e34c5532fcd81ba2cb"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","d751f82ad4351b4288ac414646a859ed493cf31996dc99604f0a1b4c359db989"),
      h => pack("H*","4cf7b67a552fc8e7685f0afa5f0a4abd82c6a1677f2d54d291776980743f266e"),
      hasK => 1,
      k => pack("H*","1e3a9245fcc6c6fdb257df9f218d76b34d98ae8b3fef2e444395a86d71a3f387"),
    },
    who => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '0235cc7e0e3a97337230482a3742587b8f7b94e41542433c495a7acf012a86591c'

### public compressed: '0235cc7e0e3a97337230482a3742587b8f7b94e41542433c495a7acf012a86591c'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICQ7wnZFtb6myeCszw3IfgEfGLOymLUZg53Rtrs1sLMvoAoGCCqGSM49
',
###             'AwEHoUQDQgAENcx+DjqXM3IwSCo3Qlh7j3uU5BVCQzxJWnrPASqGWRy5ZSLS/lid
',
###             'LVZhZVhw5KPq3b0MdIbGforIDsmieWjd4A==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICQ7wnZFtb6myeCszw3IfgEfGLOymLUZg53Rtrs1sLMvoAoGCCqGSM49
',
###             'AwEHoUQDQgAENcx+DjqXM3IwSCo3Qlh7j3uU5BVCQzxJWnrPASqGWRy5ZSLS/lid
',
###             'LVZhZVhw5KPq3b0MdIbGforIDsmieWjd4A==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEWOoo7+1AOqAaMagU0UQiUjOUTgfO
',
###           '3JnjTFUy/NgbosttTbBO+WJwbB3pt6TFCqLp3qq6AcBz4feWrcXT1YTngQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEWOoo7+1AOqAaMagU0UQiUjOUTgfO
',
###           '3JnjTFUy/NgbosttTbBO+WJwbB3pt6TFCqLp3qq6AcBz4feWrcXT1YTngQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'b3348047711a15122186ff3eec7ca7cd7cee953dbebec00ccb492dee2b592fe1'
### z: 'b3348047711a15122186ff3eec7ca7cd7cee953dbebec00ccb492dee2b592fe1'

### write message pattern: 'se'

### write message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICQ7wnZFtb6myeCszw3IfgEfGLOymLUZg53Rtrs1sLMvoAoGCCqGSM49
',
###             'AwEHoUQDQgAENcx+DjqXM3IwSCo3Qlh7j3uU5BVCQzxJWnrPASqGWRy5ZSLS/lid
',
###             'LVZhZVhw5KPq3b0MdIbGforIDsmieWjd4A==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICQ7wnZFtb6myeCszw3IfgEfGLOymLUZg53Rtrs1sLMvoAoGCCqGSM49
',
###             'AwEHoUQDQgAENcx+DjqXM3IwSCo3Qlh7j3uU5BVCQzxJWnrPASqGWRy5ZSLS/lid
',
###             'LVZhZVhw5KPq3b0MdIbGforIDsmieWjd4A==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '248fcadd5ee06c317d019a82ef9465ac2a3628cfbe572dda1bc9abc4e427b455'
### z: '248fcadd5ee06c317d019a82ef9465ac2a3628cfbe572dda1bc9abc4e427b455'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: 'db5fee7e4e2c26010039205e757ece296e0c1889425cb13725cbd0ec5e9a7e0c'
### key: 'db5fee7e4e2c26010039205e757ece296e0c1889425cb13725cbd0ec5e9a7e0c'
### iv: 'a07ed215f2b1b58f8dcb0cc1'
### iv: 'a07ed215f2b1b58f8dcb0cc1'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '9148e323c58684b8baf30cc1'
### iv_xor: '9148e323c58684b8baf30cc1'
### aad: '3500fbbb11384af5c11da350a722b003adb7b9bab9df4e8511464cd981cb8ef6'
### aad: '3500fbbb11384af5c11da350a722b003adb7b9bab9df4e8511464cd981cb8ef6'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### ciphertext: 'e98bd05284d7cefc2aee945d57e2f5f5fff0010139886bc660b34fa4c9e8d7a9acc8396b5a967261'
### ciphertext: 'e98bd05284d7cefc2aee945d57e2f5f5fff0010139886bc660b34fa4c9e8d7a9acc8396b5a967261'
### authtag: '3dc189fa30159c42782b337efe9c94ab'
### authtag: '3dc189fa30159c42782b337efe9c94ab'
### cipherinfo: '834a31363136373731373738503dc189fa30159c42782b337efe9c94ab5828e98bd05284d7cefc2aee945d57e2f5f5fff0010139886bc660b34fa4c9e8d7a9acc8396b5a967261'
### cipherinfo: '834a31363136373731373738503dc189fa30159c42782b337efe9c94ab5828e98bd05284d7cefc2aee945d57e2f5f5fff0010139886bc660b34fa4c9e8d7a9acc8396b5a967261'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEWOoo7+1AOqAaMagU0UQiUjOUTgfO
',
###           '3JnjTFUy/NgbosttTbBO+WJwbB3pt6TFCqLp3qq6AcBz4feWrcXT1YTngQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEWOoo7+1AOqAaMagU0UQiUjOUTgfO
',
###           '3JnjTFUy/NgbosttTbBO+WJwbB3pt6TFCqLp3qq6AcBz4feWrcXT1YTngQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '549108e58dec65c3e915f89431000a889a4b799cbaa00c29569cd264cc93a695'
### z: '549108e58dec65c3e915f89431000a889a4b799cbaa00c29569cd264cc93a695'

### noise encrypt

### noise encrypt
### key: '9f39a6f7ae56dcc22ba307d4ae7feaada5109b2aab8a0a04b8d31bca115456ec'
### key: '9f39a6f7ae56dcc22ba307d4ae7feaada5109b2aab8a0a04b8d31bca115456ec'
### iv: '42c6cca97323fcea7e954abf'
### iv: '42c6cca97323fcea7e954abf'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '73f0fd9f4414cddd49ad4abf'
### iv_xor: '73f0fd9f4414cddd49ad4abf'
### aad: 'bc0cc3818967cb73a993851d68b0fc12c978e439d26a801c18a83d7602e79bd0'
### aad: 'bc0cc3818967cb73a993851d68b0fc12c978e439d26a801c18a83d7602e79bd0'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '77e7a48eca80887e'
### ciphertext: '77e7a48eca80887e'
### authtag: 'ba9437fa8ad69bb7db3be32b53ddc204'
### authtag: 'ba9437fa8ad69bb7db3be32b53ddc204'
### cipherinfo: '834a3136313637373137373850ba9437fa8ad69bb7db3be32b53ddc2044877e7a48eca80887e'
### cipherinfo: '834a3136313637373137373850ba9437fa8ad69bb7db3be32b53ddc2044877e7a48eca80887e'


### b_msg: '8358210235cc7e0e3a97337230482a3742587b8f7b94e41542433c495a7acf012a86591c5847834a31363136373731373738503dc189fa30159c42782b337efe9c94ab5828e98bd05284d7cefc2aee945d57e2f5f5fff0010139886bc660b34fa4c9e8d7a9acc8396b5a9672615826834a3136313637373137373850ba9437fa8ad69bb7db3be32b53ddc2044877e7a48eca80887e'
### b_msg: '8358210235cc7e0e3a97337230482a3742587b8f7b94e41542433c495a7acf012a86591c5847834a31363136373731373738503dc189fa30159c42782b337efe9c94ab5828e98bd05284d7cefc2aee945d57e2f5f5fff0010139886bc660b34fa4c9e8d7a9acc8396b5a9672615826834a3136313637373137373850ba9437fa8ad69bb7db3be32b53ddc2044877e7a48eca80887e'
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => "\x025\xCC~\16:\x973r0H*7BX{\x8F{\x94\xE4\25BC<IZz\xCF\1*\x86Y\34",
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 0,
    message_pattens => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","0358ea28efed403aa01a31a814d144225233944e07cedc99e34c5532fcd81ba2cb"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","268d42b121265938f5b2b7a6e0a1860f8e7fb074ed3a33a8a702283e79cb3bff"),
      h => pack("H*","3d46166b48f5fd314123d7be29f565227986f2e04d25fc29f8e5949e2232286f"),
      hasK => 1,
      k => pack("H*","d72328e3eb4bf8fd6ee02041de5168d54081f098072583c0b61027d05021df42"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","e5fd71f98ca570701a06b025eb77b2f1982d10ef3e27c2e5c08df88ca973ea7a"),
  },
  {
    hasK => 1,
    k => pack("H*","05ffad2459d022573f8038cf5a879d916f80dcb6209cc27b318b5f25903c9175"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => "\x025\xCC~\16:\x973r0H*7BX{\x8F{\x94\xE4\25BC<IZz\xCF\1*\x86Y\34",
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 0,
    message_pattens => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","0358ea28efed403aa01a31a814d144225233944e07cedc99e34c5532fcd81ba2cb"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 0,
    ss => {
      ck => pack("H*","268d42b121265938f5b2b7a6e0a1860f8e7fb074ed3a33a8a702283e79cb3bff"),
      h => pack("H*","3d46166b48f5fd314123d7be29f565227986f2e04d25fc29f8e5949e2232286f"),
      hasK => 1,
      k => pack("H*","d72328e3eb4bf8fd6ee02041de5168d54081f098072583c0b61027d05021df42"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","e5fd71f98ca570701a06b025eb77b2f1982d10ef3e27c2e5c08df88ca973ea7a"),
  },
  {
    hasK => 1,
    k => pack("H*","05ffad2459d022573f8038cf5a879d916f80dcb6209cc27b318b5f25903c9175"),
  },
)

### a read_message from b

### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIP1+qvvocxTsdMFuWL3nX+skbudr/aCfEmHhRdzYMZ+doAoGCCqGSM49
',
###             'AwEHoUQDQgAEWOoo7+1AOqAaMagU0UQiUjOUTgfO3JnjTFUy/NgbosttTbBO+WJw
',
###             'bB3pt6TFCqLp3qq6AcBz4feWrcXT1YTngQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIP1+qvvocxTsdMFuWL3nX+skbudr/aCfEmHhRdzYMZ+doAoGCCqGSM49
',
###             'AwEHoUQDQgAEWOoo7+1AOqAaMagU0UQiUjOUTgfO3JnjTFUy/NgbosttTbBO+WJw
',
###             'bB3pt6TFCqLp3qq6AcBz4feWrcXT1YTngQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAENcx+DjqXM3IwSCo3Qlh7j3uU5BVC
',
###           'QzxJWnrPASqGWRy5ZSLS/lidLVZhZVhw5KPq3b0MdIbGforIDsmieWjd4A==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAENcx+DjqXM3IwSCo3Qlh7j3uU5BVC
',
###           'QzxJWnrPASqGWRy5ZSLS/lidLVZhZVhw5KPq3b0MdIbGforIDsmieWjd4A==
',
###           '-----END PUBLIC KEY-----
'
### z: 'b3348047711a15122186ff3eec7ca7cd7cee953dbebec00ccb492dee2b592fe1'
### z: 'b3348047711a15122186ff3eec7ca7cd7cee953dbebec00ccb492dee2b592fe1'

### read message pattern: 'se'

### read message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAENcx+DjqXM3IwSCo3Qlh7j3uU5BVC
',
###           'QzxJWnrPASqGWRy5ZSLS/lidLVZhZVhw5KPq3b0MdIbGforIDsmieWjd4A==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAENcx+DjqXM3IwSCo3Qlh7j3uU5BVC
',
###           'QzxJWnrPASqGWRy5ZSLS/lidLVZhZVhw5KPq3b0MdIbGforIDsmieWjd4A==
',
###           '-----END PUBLIC KEY-----
'
### z: '248fcadd5ee06c317d019a82ef9465ac2a3628cfbe572dda1bc9abc4e427b455'
### z: '248fcadd5ee06c317d019a82ef9465ac2a3628cfbe572dda1bc9abc4e427b455'

### read message pattern: 's'

### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: 'db5fee7e4e2c26010039205e757ece296e0c1889425cb13725cbd0ec5e9a7e0c'
### key: 'db5fee7e4e2c26010039205e757ece296e0c1889425cb13725cbd0ec5e9a7e0c'
### iv: 'a07ed215f2b1b58f8dcb0cc1'
### iv: 'a07ed215f2b1b58f8dcb0cc1'
### aad: '3500fbbb11384af5c11da350a722b003adb7b9bab9df4e8511464cd981cb8ef6'
### aad: '3500fbbb11384af5c11da350a722b003adb7b9bab9df4e8511464cd981cb8ef6'
### cipherinfo: '834a31363136373731373738503dc189fa30159c42782b337efe9c94ab5828e98bd05284d7cefc2aee945d57e2f5f5fff0010139886bc660b34fa4c9e8d7a9acc8396b5a967261'
### cipherinfo: '834a31363136373731373738503dc189fa30159c42782b337efe9c94ab5828e98bd05284d7cefc2aee945d57e2f5f5fff0010139886bc660b34fa4c9e8d7a9acc8396b5a967261'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '9148e323c58684b8baf30cc1'
### iv_xor: '9148e323c58684b8baf30cc1'
### authtag: '3dc189fa30159c42782b337efe9c94ab'
### authtag: '3dc189fa30159c42782b337efe9c94ab'
### ciphertext: 'e98bd05284d7cefc2aee945d57e2f5f5fff0010139886bc660b34fa4c9e8d7a9acc8396b5a967261'
### ciphertext: 'e98bd05284d7cefc2aee945d57e2f5f5fff0010139886bc660b34fa4c9e8d7a9acc8396b5a967261'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'


### read message pattern: 'es'
### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIP1+qvvocxTsdMFuWL3nX+skbudr/aCfEmHhRdzYMZ+doAoGCCqGSM49
',
###             'AwEHoUQDQgAEWOoo7+1AOqAaMagU0UQiUjOUTgfO3JnjTFUy/NgbosttTbBO+WJw
',
###             'bB3pt6TFCqLp3qq6AcBz4feWrcXT1YTngQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIP1+qvvocxTsdMFuWL3nX+skbudr/aCfEmHhRdzYMZ+doAoGCCqGSM49
',
###             'AwEHoUQDQgAEWOoo7+1AOqAaMagU0UQiUjOUTgfO3JnjTFUy/NgbosttTbBO+WJw
',
###             'bB3pt6TFCqLp3qq6AcBz4feWrcXT1YTngQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '549108e58dec65c3e915f89431000a889a4b799cbaa00c29569cd264cc93a695'
### z: '549108e58dec65c3e915f89431000a889a4b799cbaa00c29569cd264cc93a695'

### noise decrypt

### noise decrypt
### key: '9f39a6f7ae56dcc22ba307d4ae7feaada5109b2aab8a0a04b8d31bca115456ec'
### key: '9f39a6f7ae56dcc22ba307d4ae7feaada5109b2aab8a0a04b8d31bca115456ec'
### iv: '42c6cca97323fcea7e954abf'
### iv: '42c6cca97323fcea7e954abf'
### aad: 'bc0cc3818967cb73a993851d68b0fc12c978e439d26a801c18a83d7602e79bd0'
### aad: 'bc0cc3818967cb73a993851d68b0fc12c978e439d26a801c18a83d7602e79bd0'
### cipherinfo: '834a3136313637373137373850ba9437fa8ad69bb7db3be32b53ddc2044877e7a48eca80887e'
### cipherinfo: '834a3136313637373137373850ba9437fa8ad69bb7db3be32b53ddc2044877e7a48eca80887e'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '73f0fd9f4414cddd49ad4abf'
### iv_xor: '73f0fd9f4414cddd49ad4abf'
### authtag: 'ba9437fa8ad69bb7db3be32b53ddc204'
### authtag: 'ba9437fa8ad69bb7db3be32b53ddc204'
### ciphertext: '77e7a48eca80887e'
### ciphertext: '77e7a48eca80887e'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0358ea28efed403aa01a31a814d144225233944e07cedc99e34c5532fcd81ba2cb"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 1,
    message_pattens => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => "\x025\xCC~\16:\x973r0H*7BX{\x8F{\x94\xE4\25BC<IZz\xCF\1*\x86Y\34",
    },
    re_pub => "a_re_pub.pem",
    rs => {
      pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    },
    rs_pub => "a_rs_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","268d42b121265938f5b2b7a6e0a1860f8e7fb074ed3a33a8a702283e79cb3bff"),
      h => pack("H*","3d46166b48f5fd314123d7be29f565227986f2e04d25fc29f8e5949e2232286f"),
      hasK => 1,
      k => pack("H*","d72328e3eb4bf8fd6ee02041de5168d54081f098072583c0b61027d05021df42"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","e5fd71f98ca570701a06b025eb77b2f1982d10ef3e27c2e5c08df88ca973ea7a"),
  },
  {
    hasK => 1,
    k => pack("H*","05ffad2459d022573f8038cf5a879d916f80dcb6209cc27b318b5f25903c9175"),
  },
)
(
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0358ea28efed403aa01a31a814d144225233944e07cedc99e34c5532fcd81ba2cb"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    initiator => 1,
    message_pattens => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
    msg_id => 2,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => "\x025\xCC~\16:\x973r0H*7BX{\x8F{\x94\xE4\25BC<IZz\xCF\1*\x86Y\34",
    },
    re_pub => "a_re_pub.pem",
    rs => {
      pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    },
    rs_pub => "a_rs_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 1,
    ss => {
      ck => pack("H*","268d42b121265938f5b2b7a6e0a1860f8e7fb074ed3a33a8a702283e79cb3bff"),
      h => pack("H*","3d46166b48f5fd314123d7be29f565227986f2e04d25fc29f8e5949e2232286f"),
      hasK => 1,
      k => pack("H*","d72328e3eb4bf8fd6ee02041de5168d54081f098072583c0b61027d05021df42"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","e5fd71f98ca570701a06b025eb77b2f1982d10ef3e27c2e5c08df88ca973ea7a"),
  },
  {
    hasK => 1,
    k => pack("H*","05ffad2459d022573f8038cf5a879d916f80dcb6209cc27b318b5f25903c9175"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '72ef560c20fbcd1d6c7da86b3f76747e5c25525640d6bfddb137d64607752076'
### key: '72ef560c20fbcd1d6c7da86b3f76747e5c25525640d6bfddb137d64607752076'
### iv: '627522979e46108fce373491'
### iv: '627522979e46108fce373491'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '534313a1a97121b8f90f3491'
### iv_xor: '534313a1a97121b8f90f3491'
### aad: '3d46166b48f5fd314123d7be29f565227986f2e04d25fc29f8e5949e2232286f'
### aad: '3d46166b48f5fd314123d7be29f565227986f2e04d25fc29f8e5949e2232286f'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'bb38fe73711e9c136723a29a4f76f06f4768ab1035fb6ed276e978f845d96a114f9f2b04d2a8cd5544cc4ef894023df92e19c7'
### ciphertext: 'bb38fe73711e9c136723a29a4f76f06f4768ab1035fb6ed276e978f845d96a114f9f2b04d2a8cd5544cc4ef894023df92e19c7'
### authtag: '83235fb208d3395a6a50890022fae718'
### authtag: '83235fb208d3395a6a50890022fae718'
### cipherinfo: '834a313631363737313737385083235fb208d3395a6a50890022fae7185833bb38fe73711e9c136723a29a4f76f06f4768ab1035fb6ed276e978f845d96a114f9f2b04d2a8cd5544cc4ef894023df92e19c7'
### cipherinfo: '834a313631363737313737385083235fb208d3395a6a50890022fae7185833bb38fe73711e9c136723a29a4f76f06f4768ab1035fb6ed276e978f845d96a114f9f2b04d2a8cd5544cc4ef894023df92e19c7'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '72ef560c20fbcd1d6c7da86b3f76747e5c25525640d6bfddb137d64607752076'
### key: '72ef560c20fbcd1d6c7da86b3f76747e5c25525640d6bfddb137d64607752076'
### iv: '627522979e46108fce373491'
### iv: '627522979e46108fce373491'
### aad: '3d46166b48f5fd314123d7be29f565227986f2e04d25fc29f8e5949e2232286f'
### aad: '3d46166b48f5fd314123d7be29f565227986f2e04d25fc29f8e5949e2232286f'
### cipherinfo: '834a313631363737313737385083235fb208d3395a6a50890022fae7185833bb38fe73711e9c136723a29a4f76f06f4768ab1035fb6ed276e978f845d96a114f9f2b04d2a8cd5544cc4ef894023df92e19c7'
### cipherinfo: '834a313631363737313737385083235fb208d3395a6a50890022fae7185833bb38fe73711e9c136723a29a4f76f06f4768ab1035fb6ed276e978f845d96a114f9f2b04d2a8cd5544cc4ef894023df92e19c7'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '534313a1a97121b8f90f3491'
### iv_xor: '534313a1a97121b8f90f3491'
### authtag: '83235fb208d3395a6a50890022fae718'
### authtag: '83235fb208d3395a6a50890022fae718'
### ciphertext: 'bb38fe73711e9c136723a29a4f76f06f4768ab1035fb6ed276e978f845d96a114f9f2b04d2a8cd5544cc4ef894023df92e19c7'
### ciphertext: 'bb38fe73711e9c136723a29a4f76f06f4768ab1035fb6ed276e978f845d96a114f9f2b04d2a8cd5544cc4ef894023df92e19c7'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'


### b to a , plain_b.txt to trans_cipherinfo_b
### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a


### noise encrypt
### noise encrypt
### key: 'df6678f5c91e44e04144a611dd6fc93782eb6925aad90a5f3645fb99898058bb'
### key: 'df6678f5c91e44e04144a611dd6fc93782eb6925aad90a5f3645fb99898058bb'
### iv: 'e2e82e1c4b74244c474debbf'
### iv: 'e2e82e1c4b74244c474debbf'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'd3de1f2a7c43157b7075ebbf'
### iv_xor: 'd3de1f2a7c43157b7075ebbf'
### aad: '3d46166b48f5fd314123d7be29f565227986f2e04d25fc29f8e5949e2232286f'
### aad: '3d46166b48f5fd314123d7be29f565227986f2e04d25fc29f8e5949e2232286f'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '57db70695e98cafa462c41e3b6e23b17feda965fd6d6825f415fc887202975c95796a91448f04f91cd35573392162a'
### ciphertext: '57db70695e98cafa462c41e3b6e23b17feda965fd6d6825f415fc887202975c95796a91448f04f91cd35573392162a'
### authtag: '5c283a88272bc1c7df97414e194d3eb4'
### authtag: '5c283a88272bc1c7df97414e194d3eb4'
### cipherinfo: '834a31363136373731373738505c283a88272bc1c7df97414e194d3eb4582f57db70695e98cafa462c41e3b6e23b17feda965fd6d6825f415fc887202975c95796a91448f04f91cd35573392162a'
### cipherinfo: '834a31363136373731373738505c283a88272bc1c7df97414e194d3eb4582f57db70695e98cafa462c41e3b6e23b17feda965fd6d6825f415fc887202975c95796a91448f04f91cd35573392162a'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: 'df6678f5c91e44e04144a611dd6fc93782eb6925aad90a5f3645fb99898058bb'
### key: 'df6678f5c91e44e04144a611dd6fc93782eb6925aad90a5f3645fb99898058bb'
### iv: 'e2e82e1c4b74244c474debbf'
### iv: 'e2e82e1c4b74244c474debbf'
### aad: '3d46166b48f5fd314123d7be29f565227986f2e04d25fc29f8e5949e2232286f'
### aad: '3d46166b48f5fd314123d7be29f565227986f2e04d25fc29f8e5949e2232286f'
### cipherinfo: '834a31363136373731373738505c283a88272bc1c7df97414e194d3eb4582f57db70695e98cafa462c41e3b6e23b17feda965fd6d6825f415fc887202975c95796a91448f04f91cd35573392162a'
### cipherinfo: '834a31363136373731373738505c283a88272bc1c7df97414e194d3eb4582f57db70695e98cafa462c41e3b6e23b17feda965fd6d6825f415fc887202975c95796a91448f04f91cd35573392162a'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'd3de1f2a7c43157b7075ebbf'
### iv_xor: 'd3de1f2a7c43157b7075ebbf'
### authtag: '5c283a88272bc1c7df97414e194d3eb4'
### authtag: '5c283a88272bc1c7df97414e194d3eb4'
### ciphertext: '57db70695e98cafa462c41e3b6e23b17feda965fd6d6825f415fc887202975c95796a91448f04f91cd35573392162a'
### ciphertext: '57db70695e98cafa462c41e3b6e23b17feda965fd6d6825f415fc887202975c95796a91448f04f91cd35573392162a'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'IX',
###                               'test_psk',
###                               1

### -----------end test --------: 'IX',
###                               'test_psk',
###                               1

### -----------start test --------: 'XX',
###                                 undef,
###                                 undef

### -----------start test --------: 'XX',
###                                 undef,
###                                 undef


### a write message to b
### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "XX",
  initiator => 1,
  message_pattens => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => "Noise_XX_secp256r1_AESGCM_SHA256",
    h  => pack("H*","774dcdb08916a9cc54826a411a835fef89711c6733e7ecb5cf12e627d9f3a356"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "XX",
  initiator => 1,
  message_pattens => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => "Noise_XX_secp256r1_AESGCM_SHA256",
    h  => pack("H*","774dcdb08916a9cc54826a411a835fef89711c6733e7ecb5cf12e627d9f3a356"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '0399b56cd92f4b63c4ed2c35acf8ad7084baec4e2498ae28f4fa37988ead85b8be'

### public compressed: '0399b56cd92f4b63c4ed2c35acf8ad7084baec4e2498ae28f4fa37988ead85b8be'
(
  "a_msg",
  pack("H*","8258210399b56cd92f4b63c4ed2c35acf8ad7084baec4e2498ae28f4fa37988ead85b8be48696e69742e73796e"),
)
(
  "a_msg",
  pack("H*","8258210399b56cd92f4b63c4ed2c35acf8ad7084baec4e2498ae28f4fa37988ead85b8be48696e69742e73796e"),
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0399b56cd92f4b63c4ed2c35acf8ad7084baec4e2498ae28f4fa37988ead85b8be"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 1,
    message_pattens => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => "Noise_XX_secp256r1_AESGCM_SHA256",
      h  => pack("H*","e465b8e4ca071747a01ebeb076ce1438540d96859a2096c5b4f6ab16a899d901"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0399b56cd92f4b63c4ed2c35acf8ad7084baec4e2498ae28f4fa37988ead85b8be"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 1,
    message_pattens => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => "Noise_XX_secp256r1_AESGCM_SHA256",
      h  => pack("H*","e465b8e4ca071747a01ebeb076ce1438540d96859a2096c5b4f6ab16a899d901"),
    },
    who => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "XX",
  initiator => 0,
  message_pattens => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => "Noise_XX_secp256r1_AESGCM_SHA256",
    h  => pack("H*","774dcdb08916a9cc54826a411a835fef89711c6733e7ecb5cf12e627d9f3a356"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "XX",
  initiator => 0,
  message_pattens => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => "Noise_XX_secp256r1_AESGCM_SHA256",
    h  => pack("H*","774dcdb08916a9cc54826a411a835fef89711c6733e7ecb5cf12e627d9f3a356"),
  },
  who => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "XX",
    initiator => 0,
    message_pattens => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","0399b56cd92f4b63c4ed2c35acf8ad7084baec4e2498ae28f4fa37988ead85b8be"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => "Noise_XX_secp256r1_AESGCM_SHA256",
      h  => pack("H*","e465b8e4ca071747a01ebeb076ce1438540d96859a2096c5b4f6ab16a899d901"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "XX",
    initiator => 0,
    message_pattens => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","0399b56cd92f4b63c4ed2c35acf8ad7084baec4e2498ae28f4fa37988ead85b8be"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => "Noise_XX_secp256r1_AESGCM_SHA256",
      h  => pack("H*","e465b8e4ca071747a01ebeb076ce1438540d96859a2096c5b4f6ab16a899d901"),
    },
    who => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '02a0830ea475c1337b314352c868af21c86c6ef368a9de3a9234f50c9338addfc5'

### public compressed: '02a0830ea475c1337b314352c868af21c86c6ef368a9de3a9234f50c9338addfc5'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIK5FFarlbzEZRdhJ84RGr4mhrLb8J6qi4RDfPN0q4foioAoGCCqGSM49
',
###             'AwEHoUQDQgAEoIMOpHXBM3sxQ1LIaK8hyGxu82ip3jqSNPUMkzit38XRbHDw60Sw
',
###             '7aaMHyeQ3PYIhQ/Ulnqzki5FmLLD0g1u4A==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIK5FFarlbzEZRdhJ84RGr4mhrLb8J6qi4RDfPN0q4foioAoGCCqGSM49
',
###             'AwEHoUQDQgAEoIMOpHXBM3sxQ1LIaK8hyGxu82ip3jqSNPUMkzit38XRbHDw60Sw
',
###             '7aaMHyeQ3PYIhQ/Ulnqzki5FmLLD0g1u4A==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEmbVs2S9LY8TtLDWs+K1whLrsTiSY
',
###           'rij0+jeYjq2FuL7Bicv3Y9sCZpVDADxAXH/dKEYsq5n7WUd0yQL99EqPkw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEmbVs2S9LY8TtLDWs+K1whLrsTiSY
',
###           'rij0+jeYjq2FuL7Bicv3Y9sCZpVDADxAXH/dKEYsq5n7WUd0yQL99EqPkw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'b584fa5f377178ca2abdf2057b1539a9608e6bae0978ea895367946e09507bec'
### z: 'b584fa5f377178ca2abdf2057b1539a9608e6bae0978ea895367946e09507bec'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: 'e16a883211eeb2b51bbe429e96b49e24be0e3cd89bd4af1aabd5be7a34662e5c'
### key: 'e16a883211eeb2b51bbe429e96b49e24be0e3cd89bd4af1aabd5be7a34662e5c'
### iv: '150b6bbed5ddf23552f8c221'
### iv: '150b6bbed5ddf23552f8c221'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '243d5a88e2eac30265c0c221'
### iv_xor: '243d5a88e2eac30265c0c221'
### aad: '6069d8940305a3c47944bdc4f276bbece95d21e5b7830f3a6d7ea715de3c3c04'
### aad: '6069d8940305a3c47944bdc4f276bbece95d21e5b7830f3a6d7ea715de3c3c04'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### ciphertext: '44f85fdc7fc92e4b4eaf50581009b9c820c3fc2a32fdd05987f054ba4fc5ff3173540283a62a7ca4'
### ciphertext: '44f85fdc7fc92e4b4eaf50581009b9c820c3fc2a32fdd05987f054ba4fc5ff3173540283a62a7ca4'
### authtag: '329f5818c8cecb277183da329e9ee29d'
### authtag: '329f5818c8cecb277183da329e9ee29d'
### cipherinfo: '834a3136313637373137373850329f5818c8cecb277183da329e9ee29d582844f85fdc7fc92e4b4eaf50581009b9c820c3fc2a32fdd05987f054ba4fc5ff3173540283a62a7ca4'
### cipherinfo: '834a3136313637373137373850329f5818c8cecb277183da329e9ee29d582844f85fdc7fc92e4b4eaf50581009b9c820c3fc2a32fdd05987f054ba4fc5ff3173540283a62a7ca4'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEmbVs2S9LY8TtLDWs+K1whLrsTiSY
',
###           'rij0+jeYjq2FuL7Bicv3Y9sCZpVDADxAXH/dKEYsq5n7WUd0yQL99EqPkw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEmbVs2S9LY8TtLDWs+K1whLrsTiSY
',
###           'rij0+jeYjq2FuL7Bicv3Y9sCZpVDADxAXH/dKEYsq5n7WUd0yQL99EqPkw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'dc73f94cfb9dd886cf2542596fcd691d5a7a9bbbbfaa40d160b392ab86645dee'
### z: 'dc73f94cfb9dd886cf2542596fcd691d5a7a9bbbbfaa40d160b392ab86645dee'

### noise encrypt

### noise encrypt
### key: '057660be5a2814bb109dbf188e60ff63255ac9c6105385cd8e1ea1573d4a72a1'
### key: '057660be5a2814bb109dbf188e60ff63255ac9c6105385cd8e1ea1573d4a72a1'
### iv: '084addf901261d7220654585'
### iv: '084addf901261d7220654585'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '397ceccf36112c45175d4585'
### iv_xor: '397ceccf36112c45175d4585'
### aad: 'ed2ee5e13556f05279321bc0c35d6a4109f9c12234f77ee068e2381333c3c1d4'
### aad: 'ed2ee5e13556f05279321bc0c35d6a4109f9c12234f77ee068e2381333c3c1d4'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '98100474d17160b1'
### ciphertext: '98100474d17160b1'
### authtag: '44e89494277ab8c849b27607b084a152'
### authtag: '44e89494277ab8c849b27607b084a152'
### cipherinfo: '834a313631363737313737385044e89494277ab8c849b27607b084a1524898100474d17160b1'
### cipherinfo: '834a313631363737313737385044e89494277ab8c849b27607b084a1524898100474d17160b1'

### b_msg: '83582102a0830ea475c1337b314352c868af21c86c6ef368a9de3a9234f50c9338addfc55847834a3136313637373137373850329f5818c8cecb277183da329e9ee29d582844f85fdc7fc92e4b4eaf50581009b9c820c3fc2a32fdd05987f054ba4fc5ff3173540283a62a7ca45826834a313631363737313737385044e89494277ab8c849b27607b084a1524898100474d17160b1'

### b_msg: '83582102a0830ea475c1337b314352c868af21c86c6ef368a9de3a9234f50c9338addfc55847834a3136313637373137373850329f5818c8cecb277183da329e9ee29d582844f85fdc7fc92e4b4eaf50581009b9c820c3fc2a32fdd05987f054ba4fc5ff3173540283a62a7ca45826834a313631363737313737385044e89494277ab8c849b27607b084a1524898100474d17160b1'
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  e => {
    pub => pack("H*","02a0830ea475c1337b314352c868af21c86c6ef368a9de3a9234f50c9338addfc5"),
  },
  e_priv => "b_e_priv.pem",
  e_pub => "b_e_pub.pem",
  handshake_pattern_name => "XX",
  initiator => 0,
  message_pattens => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 2,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  re => {
    pub => pack("H*","0399b56cd92f4b63c4ed2c35acf8ad7084baec4e2498ae28f4fa37988ead85b8be"),
  },
  re_pub => "b_re_pub.pem",
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","0b8cb140af6c6cdc2c98e1eee5902b124c4349d9e96c7c99d8a15e3344808228"),
    h => pack("H*","d7fd627e59bedb044079cfe470189d18729f27162765e5a96cacf916447b1a08"),
    hasK => 1,
    k => pack("H*","bba2c7572059b2545590f198e6969e9b2c21ea85842698cff11094150f3056da"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  e => {
    pub => pack("H*","02a0830ea475c1337b314352c868af21c86c6ef368a9de3a9234f50c9338addfc5"),
  },
  e_priv => "b_e_priv.pem",
  e_pub => "b_e_pub.pem",
  handshake_pattern_name => "XX",
  initiator => 0,
  message_pattens => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 2,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  re => {
    pub => pack("H*","0399b56cd92f4b63c4ed2c35acf8ad7084baec4e2498ae28f4fa37988ead85b8be"),
  },
  re_pub => "b_re_pub.pem",
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","0b8cb140af6c6cdc2c98e1eee5902b124c4349d9e96c7c99d8a15e3344808228"),
    h => pack("H*","d7fd627e59bedb044079cfe470189d18729f27162765e5a96cacf916447b1a08"),
    hasK => 1,
    k => pack("H*","bba2c7572059b2545590f198e6969e9b2c21ea85842698cff11094150f3056da"),
  },
  who => "b",
}

### a read_message from b

### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIAraWSKZ3Urw6Z8Z01OOWYu854KQNzNH0E+tiiA+Vpk9oAoGCCqGSM49
',
###             'AwEHoUQDQgAEmbVs2S9LY8TtLDWs+K1whLrsTiSYrij0+jeYjq2FuL7Bicv3Y9sC
',
###             'ZpVDADxAXH/dKEYsq5n7WUd0yQL99EqPkw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIAraWSKZ3Urw6Z8Z01OOWYu854KQNzNH0E+tiiA+Vpk9oAoGCCqGSM49
',
###             'AwEHoUQDQgAEmbVs2S9LY8TtLDWs+K1whLrsTiSYrij0+jeYjq2FuL7Bicv3Y9sC
',
###             'ZpVDADxAXH/dKEYsq5n7WUd0yQL99EqPkw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEoIMOpHXBM3sxQ1LIaK8hyGxu82ip
',
###           '3jqSNPUMkzit38XRbHDw60Sw7aaMHyeQ3PYIhQ/Ulnqzki5FmLLD0g1u4A==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEoIMOpHXBM3sxQ1LIaK8hyGxu82ip
',
###           '3jqSNPUMkzit38XRbHDw60Sw7aaMHyeQ3PYIhQ/Ulnqzki5FmLLD0g1u4A==
',
###           '-----END PUBLIC KEY-----
'
### z: 'b584fa5f377178ca2abdf2057b1539a9608e6bae0978ea895367946e09507bec'
### z: 'b584fa5f377178ca2abdf2057b1539a9608e6bae0978ea895367946e09507bec'

### read message pattern: 's'

### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: 'e16a883211eeb2b51bbe429e96b49e24be0e3cd89bd4af1aabd5be7a34662e5c'
### key: 'e16a883211eeb2b51bbe429e96b49e24be0e3cd89bd4af1aabd5be7a34662e5c'
### iv: '150b6bbed5ddf23552f8c221'
### iv: '150b6bbed5ddf23552f8c221'
### aad: '6069d8940305a3c47944bdc4f276bbece95d21e5b7830f3a6d7ea715de3c3c04'
### aad: '6069d8940305a3c47944bdc4f276bbece95d21e5b7830f3a6d7ea715de3c3c04'
### cipherinfo: '834a3136313637373137373850329f5818c8cecb277183da329e9ee29d582844f85fdc7fc92e4b4eaf50581009b9c820c3fc2a32fdd05987f054ba4fc5ff3173540283a62a7ca4'
### cipherinfo: '834a3136313637373137373850329f5818c8cecb277183da329e9ee29d582844f85fdc7fc92e4b4eaf50581009b9c820c3fc2a32fdd05987f054ba4fc5ff3173540283a62a7ca4'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '243d5a88e2eac30265c0c221'
### iv_xor: '243d5a88e2eac30265c0c221'
### authtag: '329f5818c8cecb277183da329e9ee29d'
### authtag: '329f5818c8cecb277183da329e9ee29d'
### ciphertext: '44f85fdc7fc92e4b4eaf50581009b9c820c3fc2a32fdd05987f054ba4fc5ff3173540283a62a7ca4'
### ciphertext: '44f85fdc7fc92e4b4eaf50581009b9c820c3fc2a32fdd05987f054ba4fc5ff3173540283a62a7ca4'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIAraWSKZ3Urw6Z8Z01OOWYu854KQNzNH0E+tiiA+Vpk9oAoGCCqGSM49
',
###             'AwEHoUQDQgAEmbVs2S9LY8TtLDWs+K1whLrsTiSYrij0+jeYjq2FuL7Bicv3Y9sC
',
###             'ZpVDADxAXH/dKEYsq5n7WUd0yQL99EqPkw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIAraWSKZ3Urw6Z8Z01OOWYu854KQNzNH0E+tiiA+Vpk9oAoGCCqGSM49
',
###             'AwEHoUQDQgAEmbVs2S9LY8TtLDWs+K1whLrsTiSYrij0+jeYjq2FuL7Bicv3Y9sC
',
###             'ZpVDADxAXH/dKEYsq5n7WUd0yQL99EqPkw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'dc73f94cfb9dd886cf2542596fcd691d5a7a9bbbbfaa40d160b392ab86645dee'
### z: 'dc73f94cfb9dd886cf2542596fcd691d5a7a9bbbbfaa40d160b392ab86645dee'

### noise decrypt

### noise decrypt
### key: '057660be5a2814bb109dbf188e60ff63255ac9c6105385cd8e1ea1573d4a72a1'
### key: '057660be5a2814bb109dbf188e60ff63255ac9c6105385cd8e1ea1573d4a72a1'
### iv: '084addf901261d7220654585'
### iv: '084addf901261d7220654585'
### aad: 'ed2ee5e13556f05279321bc0c35d6a4109f9c12234f77ee068e2381333c3c1d4'
### aad: 'ed2ee5e13556f05279321bc0c35d6a4109f9c12234f77ee068e2381333c3c1d4'
### cipherinfo: '834a313631363737313737385044e89494277ab8c849b27607b084a1524898100474d17160b1'
### cipherinfo: '834a313631363737313737385044e89494277ab8c849b27607b084a1524898100474d17160b1'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '397ceccf36112c45175d4585'
### iv_xor: '397ceccf36112c45175d4585'
### authtag: '44e89494277ab8c849b27607b084a152'
### authtag: '44e89494277ab8c849b27607b084a152'
### ciphertext: '98100474d17160b1'
### ciphertext: '98100474d17160b1'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  e => {
    pub => pack("H*","0399b56cd92f4b63c4ed2c35acf8ad7084baec4e2498ae28f4fa37988ead85b8be"),
  },
  e_priv => "a_e_priv.pem",
  e_pub => "a_e_pub.pem",
  handshake_pattern_name => "XX",
  initiator => 1,
  message_pattens => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 2,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  re => {
    pub => pack("H*","02a0830ea475c1337b314352c868af21c86c6ef368a9de3a9234f50c9338addfc5"),
  },
  re_pub => "a_re_pub.pem",
  rs => {
    pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  },
  rs_pub => "a_rs_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","0b8cb140af6c6cdc2c98e1eee5902b124c4349d9e96c7c99d8a15e3344808228"),
    h => pack("H*","d7fd627e59bedb044079cfe470189d18729f27162765e5a96cacf916447b1a08"),
    hasK => 1,
    k => pack("H*","bba2c7572059b2545590f198e6969e9b2c21ea85842698cff11094150f3056da"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  e => {
    pub => pack("H*","0399b56cd92f4b63c4ed2c35acf8ad7084baec4e2498ae28f4fa37988ead85b8be"),
  },
  e_priv => "a_e_priv.pem",
  e_pub => "a_e_pub.pem",
  handshake_pattern_name => "XX",
  initiator => 1,
  message_pattens => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 2,
  prologue => "some_info",
  psk => undef,
  psk_id => undef,
  re => {
    pub => pack("H*","02a0830ea475c1337b314352c868af21c86c6ef368a9de3a9234f50c9338addfc5"),
  },
  re_pub => "a_re_pub.pem",
  rs => {
    pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  },
  rs_pub => "a_rs_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","0b8cb140af6c6cdc2c98e1eee5902b124c4349d9e96c7c99d8a15e3344808228"),
    h => pack("H*","d7fd627e59bedb044079cfe470189d18729f27162765e5a96cacf916447b1a08"),
    hasK => 1,
    k => pack("H*","bba2c7572059b2545590f198e6969e9b2c21ea85842698cff11094150f3056da"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### $a_msg2_src: 'init.ack'

### $a_msg2_src: 'init.ack'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '057660be5a2814bb109dbf188e60ff63255ac9c6105385cd8e1ea1573d4a72a1'
### key: '057660be5a2814bb109dbf188e60ff63255ac9c6105385cd8e1ea1573d4a72a1'
### iv: '084addf901261d7220654585'
### iv: '084addf901261d7220654585'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '397ceccf36112c45175d4585'
### iv_xor: '397ceccf36112c45175d4585'
### aad: 'd7fd627e59bedb044079cfe470189d18729f27162765e5a96cacf916447b1a08'
### aad: 'd7fd627e59bedb044079cfe470189d18729f27162765e5a96cacf916447b1a08'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: '68360565884822d9af4e0f650ddba95f2d0a0bd58af9d2ede94d0d96b5bf5aa8d85daecadc5a06ae'
### ciphertext: '68360565884822d9af4e0f650ddba95f2d0a0bd58af9d2ede94d0d96b5bf5aa8d85daecadc5a06ae'
### authtag: '4b31048f9cef38319856b7afb373a3bc'
### authtag: '4b31048f9cef38319856b7afb373a3bc'
### cipherinfo: '834a31363136373731373738504b31048f9cef38319856b7afb373a3bc582868360565884822d9af4e0f650ddba95f2d0a0bd58af9d2ede94d0d96b5bf5aa8d85daecadc5a06ae'
### cipherinfo: '834a31363136373731373738504b31048f9cef38319856b7afb373a3bc582868360565884822d9af4e0f650ddba95f2d0a0bd58af9d2ede94d0d96b5bf5aa8d85daecadc5a06ae'

### write message pattern: 'se'

### write message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEoIMOpHXBM3sxQ1LIaK8hyGxu82ip
',
###           '3jqSNPUMkzit38XRbHDw60Sw7aaMHyeQ3PYIhQ/Ulnqzki5FmLLD0g1u4A==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEoIMOpHXBM3sxQ1LIaK8hyGxu82ip
',
###           '3jqSNPUMkzit38XRbHDw60Sw7aaMHyeQ3PYIhQ/Ulnqzki5FmLLD0g1u4A==
',
###           '-----END PUBLIC KEY-----
'
### z: '5f168c93341ddf2fc376ea9ab8a59cc85bf5b609f21e926b8df21f77932af8d1'
### z: '5f168c93341ddf2fc376ea9ab8a59cc85bf5b609f21e926b8df21f77932af8d1'

### noise encrypt

### noise encrypt
### key: 'f0a50706e86de2cc052774f385c9dc5bf912f017c47cf72b26ac1ace54f0f846'
### key: 'f0a50706e86de2cc052774f385c9dc5bf912f017c47cf72b26ac1ace54f0f846'
### iv: '3a397d0cab12af8c676fe45e'
### iv: '3a397d0cab12af8c676fe45e'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '0b0f4c3a9c259ebb5057e45e'
### iv_xor: '0b0f4c3a9c259ebb5057e45e'
### aad: '5e23cae187a043f4946a5c3a54032a5e1c3c1cc5a2809b80fb2080e6d89a80c1'
### aad: '5e23cae187a043f4946a5c3a54032a5e1c3c1cc5a2809b80fb2080e6d89a80c1'
### plaintext: '696e69742e61636b'
### plaintext: '696e69742e61636b'
### ciphertext: 'af221eaaa67c82f4'
### ciphertext: 'af221eaaa67c82f4'
### authtag: '2888f8ca5007761f6f1427a6ff3e0dbe'
### authtag: '2888f8ca5007761f6f1427a6ff3e0dbe'
### cipherinfo: '834a31363136373731373738502888f8ca5007761f6f1427a6ff3e0dbe48af221eaaa67c82f4'
### cipherinfo: '834a31363136373731373738502888f8ca5007761f6f1427a6ff3e0dbe48af221eaaa67c82f4'

### a_msg2: '825847834a31363136373731373738504b31048f9cef38319856b7afb373a3bc582868360565884822d9af4e0f650ddba95f2d0a0bd58af9d2ede94d0d96b5bf5aa8d85daecadc5a06ae5826834a31363136373731373738502888f8ca5007761f6f1427a6ff3e0dbe48af221eaaa67c82f4'

### a_msg2: '825847834a31363136373731373738504b31048f9cef38319856b7afb373a3bc582868360565884822d9af4e0f650ddba95f2d0a0bd58af9d2ede94d0d96b5bf5aa8d85daecadc5a06ae5826834a31363136373731373738502888f8ca5007761f6f1427a6ff3e0dbe48af221eaaa67c82f4'
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0399b56cd92f4b63c4ed2c35acf8ad7084baec4e2498ae28f4fa37988ead85b8be"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 1,
    message_pattens => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 3,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","02a0830ea475c1337b314352c868af21c86c6ef368a9de3a9234f50c9338addfc5"),
    },
    re_pub => "a_re_pub.pem",
    rs => {
      pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    },
    rs_pub => "a_rs_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","43b183450e8fa8ef4b88a3a95973f34bc318300420d35158ee3eaa5c5d6a950e"),
      h => pack("H*","fc37de383b706032dcf9e76c2d1429626a3d476d38fe0496849e79609da3b94b"),
      hasK => 1,
      k => pack("H*","115e623606adb84df6d8a53c05abb56f1dfc7f13fd197e49f7500c7e32c67100"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","ecdd95dfb53f318a2fbb132dfae8b3477242a26d6da5b9747d40ffbd0fdb23e8"),
  },
  {
    hasK => 1,
    k => pack("H*","c2e348cf82c39b5e64a577a4c4324be1e87ed2563d22ced034bc02b7d6d68697"),
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0399b56cd92f4b63c4ed2c35acf8ad7084baec4e2498ae28f4fa37988ead85b8be"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 1,
    message_pattens => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 3,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","02a0830ea475c1337b314352c868af21c86c6ef368a9de3a9234f50c9338addfc5"),
    },
    re_pub => "a_re_pub.pem",
    rs => {
      pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    },
    rs_pub => "a_rs_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","43b183450e8fa8ef4b88a3a95973f34bc318300420d35158ee3eaa5c5d6a950e"),
      h => pack("H*","fc37de383b706032dcf9e76c2d1429626a3d476d38fe0496849e79609da3b94b"),
      hasK => 1,
      k => pack("H*","115e623606adb84df6d8a53c05abb56f1dfc7f13fd197e49f7500c7e32c67100"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","ecdd95dfb53f318a2fbb132dfae8b3477242a26d6da5b9747d40ffbd0fdb23e8"),
  },
  {
    hasK => 1,
    k => pack("H*","c2e348cf82c39b5e64a577a4c4324be1e87ed2563d22ced034bc02b7d6d68697"),
  },
)

### b recv msg from a

### b recv msg from a

### read message pattern: 's'

### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: '057660be5a2814bb109dbf188e60ff63255ac9c6105385cd8e1ea1573d4a72a1'
### key: '057660be5a2814bb109dbf188e60ff63255ac9c6105385cd8e1ea1573d4a72a1'
### iv: '084addf901261d7220654585'
### iv: '084addf901261d7220654585'
### aad: 'd7fd627e59bedb044079cfe470189d18729f27162765e5a96cacf916447b1a08'
### aad: 'd7fd627e59bedb044079cfe470189d18729f27162765e5a96cacf916447b1a08'
### cipherinfo: '834a31363136373731373738504b31048f9cef38319856b7afb373a3bc582868360565884822d9af4e0f650ddba95f2d0a0bd58af9d2ede94d0d96b5bf5aa8d85daecadc5a06ae'
### cipherinfo: '834a31363136373731373738504b31048f9cef38319856b7afb373a3bc582868360565884822d9af4e0f650ddba95f2d0a0bd58af9d2ede94d0d96b5bf5aa8d85daecadc5a06ae'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '397ceccf36112c45175d4585'
### iv_xor: '397ceccf36112c45175d4585'
### authtag: '4b31048f9cef38319856b7afb373a3bc'
### authtag: '4b31048f9cef38319856b7afb373a3bc'
### ciphertext: '68360565884822d9af4e0f650ddba95f2d0a0bd58af9d2ede94d0d96b5bf5aa8d85daecadc5a06ae'
### ciphertext: '68360565884822d9af4e0f650ddba95f2d0a0bd58af9d2ede94d0d96b5bf5aa8d85daecadc5a06ae'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### read message pattern: 'se'

### read message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIK5FFarlbzEZRdhJ84RGr4mhrLb8J6qi4RDfPN0q4foioAoGCCqGSM49
',
###             'AwEHoUQDQgAEoIMOpHXBM3sxQ1LIaK8hyGxu82ip3jqSNPUMkzit38XRbHDw60Sw
',
###             '7aaMHyeQ3PYIhQ/Ulnqzki5FmLLD0g1u4A==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIK5FFarlbzEZRdhJ84RGr4mhrLb8J6qi4RDfPN0q4foioAoGCCqGSM49
',
###             'AwEHoUQDQgAEoIMOpHXBM3sxQ1LIaK8hyGxu82ip3jqSNPUMkzit38XRbHDw60Sw
',
###             '7aaMHyeQ3PYIhQ/Ulnqzki5FmLLD0g1u4A==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '5f168c93341ddf2fc376ea9ab8a59cc85bf5b609f21e926b8df21f77932af8d1'
### z: '5f168c93341ddf2fc376ea9ab8a59cc85bf5b609f21e926b8df21f77932af8d1'

### noise decrypt

### noise decrypt
### key: 'f0a50706e86de2cc052774f385c9dc5bf912f017c47cf72b26ac1ace54f0f846'
### key: 'f0a50706e86de2cc052774f385c9dc5bf912f017c47cf72b26ac1ace54f0f846'
### iv: '3a397d0cab12af8c676fe45e'
### iv: '3a397d0cab12af8c676fe45e'
### aad: '5e23cae187a043f4946a5c3a54032a5e1c3c1cc5a2809b80fb2080e6d89a80c1'
### aad: '5e23cae187a043f4946a5c3a54032a5e1c3c1cc5a2809b80fb2080e6d89a80c1'
### cipherinfo: '834a31363136373731373738502888f8ca5007761f6f1427a6ff3e0dbe48af221eaaa67c82f4'
### cipherinfo: '834a31363136373731373738502888f8ca5007761f6f1427a6ff3e0dbe48af221eaaa67c82f4'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '0b0f4c3a9c259ebb5057e45e'
### iv_xor: '0b0f4c3a9c259ebb5057e45e'
### authtag: '2888f8ca5007761f6f1427a6ff3e0dbe'
### authtag: '2888f8ca5007761f6f1427a6ff3e0dbe'
### ciphertext: 'af221eaaa67c82f4'
### ciphertext: 'af221eaaa67c82f4'
### plaintext: '696e69742e61636b'
### plaintext: '696e69742e61636b'

### b_recv_a_msg2: 'init.ack'

### b_recv_a_msg2: 'init.ack'
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02a0830ea475c1337b314352c868af21c86c6ef368a9de3a9234f50c9338addfc5"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 0,
    message_pattens => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 3,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","0399b56cd92f4b63c4ed2c35acf8ad7084baec4e2498ae28f4fa37988ead85b8be"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","43b183450e8fa8ef4b88a3a95973f34bc318300420d35158ee3eaa5c5d6a950e"),
      h => pack("H*","fc37de383b706032dcf9e76c2d1429626a3d476d38fe0496849e79609da3b94b"),
      hasK => 1,
      k => pack("H*","115e623606adb84df6d8a53c05abb56f1dfc7f13fd197e49f7500c7e32c67100"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","ecdd95dfb53f318a2fbb132dfae8b3477242a26d6da5b9747d40ffbd0fdb23e8"),
  },
  {
    hasK => 1,
    k => pack("H*","c2e348cf82c39b5e64a577a4c4324be1e87ed2563d22ced034bc02b7d6d68697"),
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","02a0830ea475c1337b314352c868af21c86c6ef368a9de3a9234f50c9338addfc5"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 0,
    message_pattens => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 3,
    prologue => "some_info",
    psk => undef,
    psk_id => undef,
    re => {
      pub => pack("H*","0399b56cd92f4b63c4ed2c35acf8ad7084baec4e2498ae28f4fa37988ead85b8be"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","43b183450e8fa8ef4b88a3a95973f34bc318300420d35158ee3eaa5c5d6a950e"),
      h => pack("H*","fc37de383b706032dcf9e76c2d1429626a3d476d38fe0496849e79609da3b94b"),
      hasK => 1,
      k => pack("H*","115e623606adb84df6d8a53c05abb56f1dfc7f13fd197e49f7500c7e32c67100"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","ecdd95dfb53f318a2fbb132dfae8b3477242a26d6da5b9747d40ffbd0fdb23e8"),
  },
  {
    hasK => 1,
    k => pack("H*","c2e348cf82c39b5e64a577a4c4324be1e87ed2563d22ced034bc02b7d6d68697"),
  },
)

### a send comm msg to b

### a send comm msg to b


### noise encrypt
### noise encrypt
### key: 'c22c17d3fe3e2a87ad11415b87b9091468a981eb74066f570ec5850426f138f1'
### key: 'c22c17d3fe3e2a87ad11415b87b9091468a981eb74066f570ec5850426f138f1'
### iv: 'c05f789c52c00edc068e5d83'
### iv: 'c05f789c52c00edc068e5d83'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'f16949aa65f73feb31b65d83'
### iv_xor: 'f16949aa65f73feb31b65d83'
### aad: 'fc37de383b706032dcf9e76c2d1429626a3d476d38fe0496849e79609da3b94b'
### aad: 'fc37de383b706032dcf9e76c2d1429626a3d476d38fe0496849e79609da3b94b'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '2a3e860dbfc60db0c7b1555cf31ae268c7259f0486f9052ac26478505c7af19a3904f1eb6ff83819d98b7d1eec13ec144407cd'
### ciphertext: '2a3e860dbfc60db0c7b1555cf31ae268c7259f0486f9052ac26478505c7af19a3904f1eb6ff83819d98b7d1eec13ec144407cd'
### authtag: '3e7d248766ec65e4392dd16ed073de4d'
### authtag: '3e7d248766ec65e4392dd16ed073de4d'
### cipherinfo: '834a31363136373731373738503e7d248766ec65e4392dd16ed073de4d58332a3e860dbfc60db0c7b1555cf31ae268c7259f0486f9052ac26478505c7af19a3904f1eb6ff83819d98b7d1eec13ec144407cd'
### cipherinfo: '834a31363136373731373738503e7d248766ec65e4392dd16ed073de4d58332a3e860dbfc60db0c7b1555cf31ae268c7259f0486f9052ac26478505c7af19a3904f1eb6ff83819d98b7d1eec13ec144407cd'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: 'c22c17d3fe3e2a87ad11415b87b9091468a981eb74066f570ec5850426f138f1'
### key: 'c22c17d3fe3e2a87ad11415b87b9091468a981eb74066f570ec5850426f138f1'
### iv: 'c05f789c52c00edc068e5d83'
### iv: 'c05f789c52c00edc068e5d83'
### aad: 'fc37de383b706032dcf9e76c2d1429626a3d476d38fe0496849e79609da3b94b'
### aad: 'fc37de383b706032dcf9e76c2d1429626a3d476d38fe0496849e79609da3b94b'
### cipherinfo: '834a31363136373731373738503e7d248766ec65e4392dd16ed073de4d58332a3e860dbfc60db0c7b1555cf31ae268c7259f0486f9052ac26478505c7af19a3904f1eb6ff83819d98b7d1eec13ec144407cd'
### cipherinfo: '834a31363136373731373738503e7d248766ec65e4392dd16ed073de4d58332a3e860dbfc60db0c7b1555cf31ae268c7259f0486f9052ac26478505c7af19a3904f1eb6ff83819d98b7d1eec13ec144407cd'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'f16949aa65f73feb31b65d83'
### iv_xor: 'f16949aa65f73feb31b65d83'
### authtag: '3e7d248766ec65e4392dd16ed073de4d'
### authtag: '3e7d248766ec65e4392dd16ed073de4d'
### ciphertext: '2a3e860dbfc60db0c7b1555cf31ae268c7259f0486f9052ac26478505c7af19a3904f1eb6ff83819d98b7d1eec13ec144407cd'
### ciphertext: '2a3e860dbfc60db0c7b1555cf31ae268c7259f0486f9052ac26478505c7af19a3904f1eb6ff83819d98b7d1eec13ec144407cd'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '26867deaf60a3964170edbc08410575a8cfdeef73ee70667876dd029782526ed'
### key: '26867deaf60a3964170edbc08410575a8cfdeef73ee70667876dd029782526ed'
### iv: '99d71b5a24679e988117aebd'
### iv: '99d71b5a24679e988117aebd'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'a8e12a6c1350afafb62faebd'
### iv_xor: 'a8e12a6c1350afafb62faebd'
### aad: 'fc37de383b706032dcf9e76c2d1429626a3d476d38fe0496849e79609da3b94b'
### aad: 'fc37de383b706032dcf9e76c2d1429626a3d476d38fe0496849e79609da3b94b'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '5657c11cdb6f8c0bae0b96a3c60fd1da2742372216a4226818ad3515606004daa4ce5bbdec750e584282e876371881'
### ciphertext: '5657c11cdb6f8c0bae0b96a3c60fd1da2742372216a4226818ad3515606004daa4ce5bbdec750e584282e876371881'
### authtag: 'e92421a95f3d29bf28cb79fe0eeab09b'
### authtag: 'e92421a95f3d29bf28cb79fe0eeab09b'
### cipherinfo: '834a3136313637373137373850e92421a95f3d29bf28cb79fe0eeab09b582f5657c11cdb6f8c0bae0b96a3c60fd1da2742372216a4226818ad3515606004daa4ce5bbdec750e584282e876371881'
### cipherinfo: '834a3136313637373137373850e92421a95f3d29bf28cb79fe0eeab09b582f5657c11cdb6f8c0bae0b96a3c60fd1da2742372216a4226818ad3515606004daa4ce5bbdec750e584282e876371881'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '26867deaf60a3964170edbc08410575a8cfdeef73ee70667876dd029782526ed'
### key: '26867deaf60a3964170edbc08410575a8cfdeef73ee70667876dd029782526ed'
### iv: '99d71b5a24679e988117aebd'
### iv: '99d71b5a24679e988117aebd'
### aad: 'fc37de383b706032dcf9e76c2d1429626a3d476d38fe0496849e79609da3b94b'
### aad: 'fc37de383b706032dcf9e76c2d1429626a3d476d38fe0496849e79609da3b94b'
### cipherinfo: '834a3136313637373137373850e92421a95f3d29bf28cb79fe0eeab09b582f5657c11cdb6f8c0bae0b96a3c60fd1da2742372216a4226818ad3515606004daa4ce5bbdec750e584282e876371881'
### cipherinfo: '834a3136313637373137373850e92421a95f3d29bf28cb79fe0eeab09b582f5657c11cdb6f8c0bae0b96a3c60fd1da2742372216a4226818ad3515606004daa4ce5bbdec750e584282e876371881'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'a8e12a6c1350afafb62faebd'
### iv_xor: 'a8e12a6c1350afafb62faebd'
### authtag: 'e92421a95f3d29bf28cb79fe0eeab09b'
### authtag: 'e92421a95f3d29bf28cb79fe0eeab09b'
### ciphertext: '5657c11cdb6f8c0bae0b96a3c60fd1da2742372216a4226818ad3515606004daa4ce5bbdec750e584282e876371881'
### ciphertext: '5657c11cdb6f8c0bae0b96a3c60fd1da2742372216a4226818ad3515606004daa4ce5bbdec750e584282e876371881'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'XX',
###                               undef,
###                               undef

### -----------end test --------: 'XX',
###                               undef,
###                               undef


### -----------start test --------: 'XX',
###                                 'test_psk',
###                                 0
### -----------start test --------: 'XX',
###                                 'test_psk',
###                                 0


### a write message to b
### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "XX",
  initiator => 1,
  message_pattens => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","d8aea04050b19a967cd541e3a399096aa6f474a563dfe717cc9a69105f4f7af1"),
    h  => pack("H*","efdd423b6e50f7ad9fafc771999d800e2f22a80b6c79bf0b9badf1a38bc66fd8"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "XX",
  initiator => 1,
  message_pattens => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","d8aea04050b19a967cd541e3a399096aa6f474a563dfe717cc9a69105f4f7af1"),
    h  => pack("H*","efdd423b6e50f7ad9fafc771999d800e2f22a80b6c79bf0b9badf1a38bc66fd8"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'psk'

### write message pattern: 'psk'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '0391c10167f080f8b2cd688202af7edbb67cc3c47c5c35e621adcd356db5ab7cf7'

### public compressed: '0391c10167f080f8b2cd688202af7edbb67cc3c47c5c35e621adcd356db5ab7cf7'

### noise encrypt

### noise encrypt
### key: '48007baaffb3c311759d88e92939e1ee757afced4374cd3c72e32a3999549fe2'
### key: '48007baaffb3c311759d88e92939e1ee757afced4374cd3c72e32a3999549fe2'
### iv: '4a3733a2e47899978c19d873'
### iv: '4a3733a2e47899978c19d873'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '7b010294d34fa8a0bb21d873'
### iv_xor: '7b010294d34fa8a0bb21d873'
### aad: 'c583c0e00f6cc25720978e8663bb4f93d7eb786cba02971f85160dedfb37a34c'
### aad: 'c583c0e00f6cc25720978e8663bb4f93d7eb786cba02971f85160dedfb37a34c'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: 'f57498a0190630fd'
### ciphertext: 'f57498a0190630fd'
### authtag: '2cde9cca08aac97d581eb42428fbfebf'
### authtag: '2cde9cca08aac97d581eb42428fbfebf'
### cipherinfo: '834a31363136373731373738502cde9cca08aac97d581eb42428fbfebf48f57498a0190630fd'
### cipherinfo: '834a31363136373731373738502cde9cca08aac97d581eb42428fbfebf48f57498a0190630fd'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA5HBAWfwgPiyzWiCAq9+27Z8w8R8XDXmIa3NNW21q3z3WCaDSjE2MTY3NzE3NzhQLN6cygiqyX1YHrQkKPv+v0j1dJigGQYw/Q=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA5HBAWfwgPiyzWiCAq9+27Z8w8R8XDXmIa3NNW21q3z3WCaDSjE2MTY3NzE3NzhQLN6cygiqyX1YHrQkKPv+v0j1dJigGQYw/Q=="),
  );
}
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0391c10167f080f8b2cd688202af7edbb67cc3c47c5c35e621adcd356db5ab7cf7"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 1,
    message_pattens => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","58a730cfe0efd10484ac71a2054095e7a76fd58d393d54fb06cdf8f4d3455794"),
      h => pack("H*","914170465c561eb4e7d18f6cba120903bac61c1b96feb0874d81b68726cd1be5"),
      hasK => 1,
      k => pack("H*","14255305aacb9f6a4c95e396429e6a344cb5d941ad96e1aef2ae5f9a38778942"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0391c10167f080f8b2cd688202af7edbb67cc3c47c5c35e621adcd356db5ab7cf7"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 1,
    message_pattens => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","58a730cfe0efd10484ac71a2054095e7a76fd58d393d54fb06cdf8f4d3455794"),
      h => pack("H*","914170465c561eb4e7d18f6cba120903bac61c1b96feb0874d81b68726cd1be5"),
      hasK => 1,
      k => pack("H*","14255305aacb9f6a4c95e396429e6a344cb5d941ad96e1aef2ae5f9a38778942"),
    },
    who => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "XX",
  initiator => 0,
  message_pattens => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","d8aea04050b19a967cd541e3a399096aa6f474a563dfe717cc9a69105f4f7af1"),
    h  => pack("H*","efdd423b6e50f7ad9fafc771999d800e2f22a80b6c79bf0b9badf1a38bc66fd8"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "XX",
  initiator => 0,
  message_pattens => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","d8aea04050b19a967cd541e3a399096aa6f474a563dfe717cc9a69105f4f7af1"),
    h  => pack("H*","efdd423b6e50f7ad9fafc771999d800e2f22a80b6c79bf0b9badf1a38bc66fd8"),
  },
  who => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'psk'

### read message pattern: 'psk'

### read message pattern: 'e'

### read message pattern: 'e'

### noise decrypt

### noise decrypt
### key: '48007baaffb3c311759d88e92939e1ee757afced4374cd3c72e32a3999549fe2'
### key: '48007baaffb3c311759d88e92939e1ee757afced4374cd3c72e32a3999549fe2'
### iv: '4a3733a2e47899978c19d873'
### iv: '4a3733a2e47899978c19d873'
### aad: 'c583c0e00f6cc25720978e8663bb4f93d7eb786cba02971f85160dedfb37a34c'
### aad: 'c583c0e00f6cc25720978e8663bb4f93d7eb786cba02971f85160dedfb37a34c'
### cipherinfo: '834a31363136373731373738502cde9cca08aac97d581eb42428fbfebf48f57498a0190630fd'
### cipherinfo: '834a31363136373731373738502cde9cca08aac97d581eb42428fbfebf48f57498a0190630fd'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '7b010294d34fa8a0bb21d873'
### iv_xor: '7b010294d34fa8a0bb21d873'
### authtag: '2cde9cca08aac97d581eb42428fbfebf'
### authtag: '2cde9cca08aac97d581eb42428fbfebf'
### ciphertext: 'f57498a0190630fd'
### ciphertext: 'f57498a0190630fd'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "XX",
    initiator => 0,
    message_pattens => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","0391c10167f080f8b2cd688202af7edbb67cc3c47c5c35e621adcd356db5ab7cf7"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","58a730cfe0efd10484ac71a2054095e7a76fd58d393d54fb06cdf8f4d3455794"),
      h => pack("H*","914170465c561eb4e7d18f6cba120903bac61c1b96feb0874d81b68726cd1be5"),
      hasK => 1,
      k => pack("H*","14255305aacb9f6a4c95e396429e6a344cb5d941ad96e1aef2ae5f9a38778942"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "XX",
    initiator => 0,
    message_pattens => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","0391c10167f080f8b2cd688202af7edbb67cc3c47c5c35e621adcd356db5ab7cf7"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","58a730cfe0efd10484ac71a2054095e7a76fd58d393d54fb06cdf8f4d3455794"),
      h => pack("H*","914170465c561eb4e7d18f6cba120903bac61c1b96feb0874d81b68726cd1be5"),
      hasK => 1,
      k => pack("H*","14255305aacb9f6a4c95e396429e6a344cb5d941ad96e1aef2ae5f9a38778942"),
    },
    who => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '03714ace97861dc0c8bc20d2a3ae0bff3079a50ae9fe525e15a7bacfcb4f0a8177'

### public compressed: '03714ace97861dc0c8bc20d2a3ae0bff3079a50ae9fe525e15a7bacfcb4f0a8177'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDXlWZ3hgZXrlZJf9bCX3jakvN04BYtBNsonnXpgJz6poAoGCCqGSM49
',
###             'AwEHoUQDQgAEcUrOl4YdwMi8INKjrgv/MHmlCun+Ul4Vp7rPy08KgXeXoF80se66
',
###             'gxfojldnBRYm5S2ETUzQSG6/In0R0hpHQw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDXlWZ3hgZXrlZJf9bCX3jakvN04BYtBNsonnXpgJz6poAoGCCqGSM49
',
###             'AwEHoUQDQgAEcUrOl4YdwMi8INKjrgv/MHmlCun+Ul4Vp7rPy08KgXeXoF80se66
',
###             'gxfojldnBRYm5S2ETUzQSG6/In0R0hpHQw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEkcEBZ/CA+LLNaIICr37btnzDxHxc
',
###           'NeYhrc01bbWrfPeVi+LhXXHIivzO5+rHZ0LxpuZ+epD0XTvzr4geANhItQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEkcEBZ/CA+LLNaIICr37btnzDxHxc
',
###           'NeYhrc01bbWrfPeVi+LhXXHIivzO5+rHZ0LxpuZ+epD0XTvzr4geANhItQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '43e388f9f67c8ae4275b85cc12cc1f783c684e3e8015088c77577766d9325041'
### z: '43e388f9f67c8ae4275b85cc12cc1f783c684e3e8015088c77577766d9325041'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '456e5c4c5ba4bea20333d4cced06241b407ee3b5eba9da2ad714aead74544820'
### key: '456e5c4c5ba4bea20333d4cced06241b407ee3b5eba9da2ad714aead74544820'
### iv: '907face06c0b00559b493bbb'
### iv: '907face06c0b00559b493bbb'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'a1499dd65b3c3162ac713bbb'
### iv_xor: 'a1499dd65b3c3162ac713bbb'
### aad: '84ebd8cffb9d2b8fc9dd234775d028a5937f4536d24918c693f0532c9c504534'
### aad: '84ebd8cffb9d2b8fc9dd234775d028a5937f4536d24918c693f0532c9c504534'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### ciphertext: '88412183138770ac0fd7bb7731b0ec9d86ab778af5309d7cc0ca5aae535f5e69ec613e3646d8f8bc'
### ciphertext: '88412183138770ac0fd7bb7731b0ec9d86ab778af5309d7cc0ca5aae535f5e69ec613e3646d8f8bc'
### authtag: '3e0a1055f80ddef4f9e66f98d49459ef'
### authtag: '3e0a1055f80ddef4f9e66f98d49459ef'
### cipherinfo: '834a31363136373731373738503e0a1055f80ddef4f9e66f98d49459ef582888412183138770ac0fd7bb7731b0ec9d86ab778af5309d7cc0ca5aae535f5e69ec613e3646d8f8bc'
### cipherinfo: '834a31363136373731373738503e0a1055f80ddef4f9e66f98d49459ef582888412183138770ac0fd7bb7731b0ec9d86ab778af5309d7cc0ca5aae535f5e69ec613e3646d8f8bc'

### write message pattern: 'es'

### write message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEkcEBZ/CA+LLNaIICr37btnzDxHxc
',
###           'NeYhrc01bbWrfPeVi+LhXXHIivzO5+rHZ0LxpuZ+epD0XTvzr4geANhItQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEkcEBZ/CA+LLNaIICr37btnzDxHxc
',
###           'NeYhrc01bbWrfPeVi+LhXXHIivzO5+rHZ0LxpuZ+epD0XTvzr4geANhItQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '8a8d2f09ae546131b745e7ae247f95606f6c01db5bc52e9ae69f52d4e4e98308'
### z: '8a8d2f09ae546131b745e7ae247f95606f6c01db5bc52e9ae69f52d4e4e98308'

### noise encrypt

### noise encrypt
### key: 'c781cf2d86bc71a7816c8eb99a9c8a374ddf8518d763503ee98a4ccb796a3637'
### key: 'c781cf2d86bc71a7816c8eb99a9c8a374ddf8518d763503ee98a4ccb796a3637'
### iv: '5194b0afa795dde11cb28538'
### iv: '5194b0afa795dde11cb28538'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '60a2819990a2ecd62b8a8538'
### iv_xor: '60a2819990a2ecd62b8a8538'
### aad: 'ed0137467937a41ab51758e56d065c97ed3c79151b588200ca1c6d6e56bcfa8d'
### aad: 'ed0137467937a41ab51758e56d065c97ed3c79151b588200ca1c6d6e56bcfa8d'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '476613341363c818'
### ciphertext: '476613341363c818'
### authtag: 'b96b494bbc6fc46289ade90b0fc4129e'
### authtag: 'b96b494bbc6fc46289ade90b0fc4129e'
### cipherinfo: '834a3136313637373137373850b96b494bbc6fc46289ade90b0fc4129e48476613341363c818'
### cipherinfo: '834a3136313637373137373850b96b494bbc6fc46289ade90b0fc4129e48476613341363c818'

### b_msg: '83582103714ace97861dc0c8bc20d2a3ae0bff3079a50ae9fe525e15a7bacfcb4f0a81775847834a31363136373731373738503e0a1055f80ddef4f9e66f98d49459ef582888412183138770ac0fd7bb7731b0ec9d86ab778af5309d7cc0ca5aae535f5e69ec613e3646d8f8bc5826834a3136313637373137373850b96b494bbc6fc46289ade90b0fc4129e48476613341363c818'

### b_msg: '83582103714ace97861dc0c8bc20d2a3ae0bff3079a50ae9fe525e15a7bacfcb4f0a81775847834a31363136373731373738503e0a1055f80ddef4f9e66f98d49459ef582888412183138770ac0fd7bb7731b0ec9d86ab778af5309d7cc0ca5aae535f5e69ec613e3646d8f8bc5826834a3136313637373137373850b96b494bbc6fc46289ade90b0fc4129e48476613341363c818'
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  e => {
    pub => pack("H*","03714ace97861dc0c8bc20d2a3ae0bff3079a50ae9fe525e15a7bacfcb4f0a8177"),
  },
  e_priv => "b_e_priv.pem",
  e_pub => "b_e_pub.pem",
  handshake_pattern_name => "XX",
  initiator => 0,
  message_pattens => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 2,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  re => {
    pub => pack("H*","0391c10167f080f8b2cd688202af7edbb67cc3c47c5c35e621adcd356db5ab7cf7"),
  },
  re_pub => "b_re_pub.pem",
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","49bf6b2ba3f308579c5b4138bf9c0bfcee39955699fab4d1576f790a4692f5c8"),
    h => pack("H*","66910505256efbca1ae5eaeba0ab6c863167acebedc00f13663c0e99bd27db1d"),
    hasK => 1,
    k => pack("H*","72840bdbbf6f2f419b2811b8bb35c70f807b60ab4e9feeb01a04cc1061b27814"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  e => {
    pub => pack("H*","03714ace97861dc0c8bc20d2a3ae0bff3079a50ae9fe525e15a7bacfcb4f0a8177"),
  },
  e_priv => "b_e_priv.pem",
  e_pub => "b_e_pub.pem",
  handshake_pattern_name => "XX",
  initiator => 0,
  message_pattens => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 2,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  re => {
    pub => pack("H*","0391c10167f080f8b2cd688202af7edbb67cc3c47c5c35e621adcd356db5ab7cf7"),
  },
  re_pub => "b_re_pub.pem",
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","49bf6b2ba3f308579c5b4138bf9c0bfcee39955699fab4d1576f790a4692f5c8"),
    h => pack("H*","66910505256efbca1ae5eaeba0ab6c863167acebedc00f13663c0e99bd27db1d"),
    hasK => 1,
    k => pack("H*","72840bdbbf6f2f419b2811b8bb35c70f807b60ab4e9feeb01a04cc1061b27814"),
  },
  who => "b",
}

### a read_message from b

### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINdBFgPU4IfWY1HeAKFBLWz+n4s2KUa4OHBhJCcreXFioAoGCCqGSM49
',
###             'AwEHoUQDQgAEkcEBZ/CA+LLNaIICr37btnzDxHxcNeYhrc01bbWrfPeVi+LhXXHI
',
###             'ivzO5+rHZ0LxpuZ+epD0XTvzr4geANhItQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINdBFgPU4IfWY1HeAKFBLWz+n4s2KUa4OHBhJCcreXFioAoGCCqGSM49
',
###             'AwEHoUQDQgAEkcEBZ/CA+LLNaIICr37btnzDxHxcNeYhrc01bbWrfPeVi+LhXXHI
',
###             'ivzO5+rHZ0LxpuZ+epD0XTvzr4geANhItQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEcUrOl4YdwMi8INKjrgv/MHmlCun+
',
###           'Ul4Vp7rPy08KgXeXoF80se66gxfojldnBRYm5S2ETUzQSG6/In0R0hpHQw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEcUrOl4YdwMi8INKjrgv/MHmlCun+
',
###           'Ul4Vp7rPy08KgXeXoF80se66gxfojldnBRYm5S2ETUzQSG6/In0R0hpHQw==
',
###           '-----END PUBLIC KEY-----
'
### z: '43e388f9f67c8ae4275b85cc12cc1f783c684e3e8015088c77577766d9325041'
### z: '43e388f9f67c8ae4275b85cc12cc1f783c684e3e8015088c77577766d9325041'

### read message pattern: 's'

### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: '456e5c4c5ba4bea20333d4cced06241b407ee3b5eba9da2ad714aead74544820'
### key: '456e5c4c5ba4bea20333d4cced06241b407ee3b5eba9da2ad714aead74544820'
### iv: '907face06c0b00559b493bbb'
### iv: '907face06c0b00559b493bbb'
### aad: '84ebd8cffb9d2b8fc9dd234775d028a5937f4536d24918c693f0532c9c504534'
### aad: '84ebd8cffb9d2b8fc9dd234775d028a5937f4536d24918c693f0532c9c504534'
### cipherinfo: '834a31363136373731373738503e0a1055f80ddef4f9e66f98d49459ef582888412183138770ac0fd7bb7731b0ec9d86ab778af5309d7cc0ca5aae535f5e69ec613e3646d8f8bc'
### cipherinfo: '834a31363136373731373738503e0a1055f80ddef4f9e66f98d49459ef582888412183138770ac0fd7bb7731b0ec9d86ab778af5309d7cc0ca5aae535f5e69ec613e3646d8f8bc'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'a1499dd65b3c3162ac713bbb'
### iv_xor: 'a1499dd65b3c3162ac713bbb'
### authtag: '3e0a1055f80ddef4f9e66f98d49459ef'
### authtag: '3e0a1055f80ddef4f9e66f98d49459ef'
### ciphertext: '88412183138770ac0fd7bb7731b0ec9d86ab778af5309d7cc0ca5aae535f5e69ec613e3646d8f8bc'
### ciphertext: '88412183138770ac0fd7bb7731b0ec9d86ab778af5309d7cc0ca5aae535f5e69ec613e3646d8f8bc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINdBFgPU4IfWY1HeAKFBLWz+n4s2KUa4OHBhJCcreXFioAoGCCqGSM49
',
###             'AwEHoUQDQgAEkcEBZ/CA+LLNaIICr37btnzDxHxcNeYhrc01bbWrfPeVi+LhXXHI
',
###             'ivzO5+rHZ0LxpuZ+epD0XTvzr4geANhItQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINdBFgPU4IfWY1HeAKFBLWz+n4s2KUa4OHBhJCcreXFioAoGCCqGSM49
',
###             'AwEHoUQDQgAEkcEBZ/CA+LLNaIICr37btnzDxHxcNeYhrc01bbWrfPeVi+LhXXHI
',
###             'ivzO5+rHZ0LxpuZ+epD0XTvzr4geANhItQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '8a8d2f09ae546131b745e7ae247f95606f6c01db5bc52e9ae69f52d4e4e98308'
### z: '8a8d2f09ae546131b745e7ae247f95606f6c01db5bc52e9ae69f52d4e4e98308'

### noise decrypt

### noise decrypt
### key: 'c781cf2d86bc71a7816c8eb99a9c8a374ddf8518d763503ee98a4ccb796a3637'
### key: 'c781cf2d86bc71a7816c8eb99a9c8a374ddf8518d763503ee98a4ccb796a3637'
### iv: '5194b0afa795dde11cb28538'
### iv: '5194b0afa795dde11cb28538'
### aad: 'ed0137467937a41ab51758e56d065c97ed3c79151b588200ca1c6d6e56bcfa8d'
### aad: 'ed0137467937a41ab51758e56d065c97ed3c79151b588200ca1c6d6e56bcfa8d'
### cipherinfo: '834a3136313637373137373850b96b494bbc6fc46289ade90b0fc4129e48476613341363c818'
### cipherinfo: '834a3136313637373137373850b96b494bbc6fc46289ade90b0fc4129e48476613341363c818'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '60a2819990a2ecd62b8a8538'
### iv_xor: '60a2819990a2ecd62b8a8538'
### authtag: 'b96b494bbc6fc46289ade90b0fc4129e'
### authtag: 'b96b494bbc6fc46289ade90b0fc4129e'
### ciphertext: '476613341363c818'
### ciphertext: '476613341363c818'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  e => {
    pub => pack("H*","0391c10167f080f8b2cd688202af7edbb67cc3c47c5c35e621adcd356db5ab7cf7"),
  },
  e_priv => "a_e_priv.pem",
  e_pub => "a_e_pub.pem",
  handshake_pattern_name => "XX",
  initiator => 1,
  message_pattens => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 2,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  re => {
    pub => pack("H*","03714ace97861dc0c8bc20d2a3ae0bff3079a50ae9fe525e15a7bacfcb4f0a8177"),
  },
  re_pub => "a_re_pub.pem",
  rs => {
    pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  },
  rs_pub => "a_rs_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","49bf6b2ba3f308579c5b4138bf9c0bfcee39955699fab4d1576f790a4692f5c8"),
    h => pack("H*","66910505256efbca1ae5eaeba0ab6c863167acebedc00f13663c0e99bd27db1d"),
    hasK => 1,
    k => pack("H*","72840bdbbf6f2f419b2811b8bb35c70f807b60ab4e9feeb01a04cc1061b27814"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  e => {
    pub => pack("H*","0391c10167f080f8b2cd688202af7edbb67cc3c47c5c35e621adcd356db5ab7cf7"),
  },
  e_priv => "a_e_priv.pem",
  e_pub => "a_e_pub.pem",
  handshake_pattern_name => "XX",
  initiator => 1,
  message_pattens => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 2,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 0,
  re => {
    pub => pack("H*","03714ace97861dc0c8bc20d2a3ae0bff3079a50ae9fe525e15a7bacfcb4f0a8177"),
  },
  re_pub => "a_re_pub.pem",
  rs => {
    pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  },
  rs_pub => "a_rs_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","49bf6b2ba3f308579c5b4138bf9c0bfcee39955699fab4d1576f790a4692f5c8"),
    h => pack("H*","66910505256efbca1ae5eaeba0ab6c863167acebedc00f13663c0e99bd27db1d"),
    hasK => 1,
    k => pack("H*","72840bdbbf6f2f419b2811b8bb35c70f807b60ab4e9feeb01a04cc1061b27814"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### $a_msg2_src: 'init.ack'

### $a_msg2_src: 'init.ack'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: 'c781cf2d86bc71a7816c8eb99a9c8a374ddf8518d763503ee98a4ccb796a3637'
### key: 'c781cf2d86bc71a7816c8eb99a9c8a374ddf8518d763503ee98a4ccb796a3637'
### iv: '5194b0afa795dde11cb28538'
### iv: '5194b0afa795dde11cb28538'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '60a2819990a2ecd62b8a8538'
### iv_xor: '60a2819990a2ecd62b8a8538'
### aad: '66910505256efbca1ae5eaeba0ab6c863167acebedc00f13663c0e99bd27db1d'
### aad: '66910505256efbca1ae5eaeba0ab6c863167acebedc00f13663c0e99bd27db1d'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: 'b74012254a5a8a70f2982e32401a196d5061d6e3952d3323ad0b3c2e9965de7227d3ec6fcbbd575f'
### ciphertext: 'b74012254a5a8a70f2982e32401a196d5061d6e3952d3323ad0b3c2e9965de7227d3ec6fcbbd575f'
### authtag: '0d9c3fd1d8c26a5c08960e4eaf2e911a'
### authtag: '0d9c3fd1d8c26a5c08960e4eaf2e911a'
### cipherinfo: '834a31363136373731373738500d9c3fd1d8c26a5c08960e4eaf2e911a5828b74012254a5a8a70f2982e32401a196d5061d6e3952d3323ad0b3c2e9965de7227d3ec6fcbbd575f'
### cipherinfo: '834a31363136373731373738500d9c3fd1d8c26a5c08960e4eaf2e911a5828b74012254a5a8a70f2982e32401a196d5061d6e3952d3323ad0b3c2e9965de7227d3ec6fcbbd575f'

### write message pattern: 'se'

### write message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEcUrOl4YdwMi8INKjrgv/MHmlCun+
',
###           'Ul4Vp7rPy08KgXeXoF80se66gxfojldnBRYm5S2ETUzQSG6/In0R0hpHQw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEcUrOl4YdwMi8INKjrgv/MHmlCun+
',
###           'Ul4Vp7rPy08KgXeXoF80se66gxfojldnBRYm5S2ETUzQSG6/In0R0hpHQw==
',
###           '-----END PUBLIC KEY-----
'
### z: '65d58e794608460b63b2ca0e73a5bf437d25e1c9723d81537d7c11323b02c14d'
### z: '65d58e794608460b63b2ca0e73a5bf437d25e1c9723d81537d7c11323b02c14d'

### noise encrypt

### noise encrypt
### key: 'b248895cd9a3aabda0886d8615983c96a73e956a39348cb0912f400eaaa90482'
### key: 'b248895cd9a3aabda0886d8615983c96a73e956a39348cb0912f400eaaa90482'
### iv: 'f754dec13b7e48cf692af3e6'
### iv: 'f754dec13b7e48cf692af3e6'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'c662eff70c4979f85e12f3e6'
### iv_xor: 'c662eff70c4979f85e12f3e6'
### aad: '730dc71c6c04a494dd6d2161bd515d9a8ff9ee172309d3bc326a1f0acc16f07f'
### aad: '730dc71c6c04a494dd6d2161bd515d9a8ff9ee172309d3bc326a1f0acc16f07f'
### plaintext: '696e69742e61636b'
### plaintext: '696e69742e61636b'
### ciphertext: 'f097c4b9dc1cffd7'
### ciphertext: 'f097c4b9dc1cffd7'
### authtag: '46c3c47af1c37bac1392c9045d46a1a8'
### authtag: '46c3c47af1c37bac1392c9045d46a1a8'
### cipherinfo: '834a313631363737313737385046c3c47af1c37bac1392c9045d46a1a848f097c4b9dc1cffd7'
### cipherinfo: '834a313631363737313737385046c3c47af1c37bac1392c9045d46a1a848f097c4b9dc1cffd7'

### a_msg2: '825847834a31363136373731373738500d9c3fd1d8c26a5c08960e4eaf2e911a5828b74012254a5a8a70f2982e32401a196d5061d6e3952d3323ad0b3c2e9965de7227d3ec6fcbbd575f5826834a313631363737313737385046c3c47af1c37bac1392c9045d46a1a848f097c4b9dc1cffd7'

### a_msg2: '825847834a31363136373731373738500d9c3fd1d8c26a5c08960e4eaf2e911a5828b74012254a5a8a70f2982e32401a196d5061d6e3952d3323ad0b3c2e9965de7227d3ec6fcbbd575f5826834a313631363737313737385046c3c47af1c37bac1392c9045d46a1a848f097c4b9dc1cffd7'
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0391c10167f080f8b2cd688202af7edbb67cc3c47c5c35e621adcd356db5ab7cf7"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 1,
    message_pattens => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 3,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","03714ace97861dc0c8bc20d2a3ae0bff3079a50ae9fe525e15a7bacfcb4f0a8177"),
    },
    re_pub => "a_re_pub.pem",
    rs => {
      pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    },
    rs_pub => "a_rs_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","fd0c368b48a2416e563cad8198a53414ad290c6a3f750e741bd917f67eae1706"),
      h => pack("H*","b77496f46c8499baf93d1956a75173b53ea97afce2c18fca174beebab0db46a5"),
      hasK => 1,
      k => pack("H*","8735be7a04e7ea8c4e2bbbf87cf6576c97a886378b6d048ca299b4a6e409d34e"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","485c17055bb084078eeabfaa5133e7208fc291cd5a4da71e5dffdc8248bfb10c"),
  },
  {
    hasK => 1,
    k => pack("H*","4ea9e688c4e1c0c7576d5a51fec78d4a0eb5a4afb3d9d59535ebac7fc0ef35cc"),
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0391c10167f080f8b2cd688202af7edbb67cc3c47c5c35e621adcd356db5ab7cf7"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 1,
    message_pattens => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 3,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","03714ace97861dc0c8bc20d2a3ae0bff3079a50ae9fe525e15a7bacfcb4f0a8177"),
    },
    re_pub => "a_re_pub.pem",
    rs => {
      pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    },
    rs_pub => "a_rs_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","fd0c368b48a2416e563cad8198a53414ad290c6a3f750e741bd917f67eae1706"),
      h => pack("H*","b77496f46c8499baf93d1956a75173b53ea97afce2c18fca174beebab0db46a5"),
      hasK => 1,
      k => pack("H*","8735be7a04e7ea8c4e2bbbf87cf6576c97a886378b6d048ca299b4a6e409d34e"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","485c17055bb084078eeabfaa5133e7208fc291cd5a4da71e5dffdc8248bfb10c"),
  },
  {
    hasK => 1,
    k => pack("H*","4ea9e688c4e1c0c7576d5a51fec78d4a0eb5a4afb3d9d59535ebac7fc0ef35cc"),
  },
)

### b recv msg from a

### b recv msg from a

### read message pattern: 's'

### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: 'c781cf2d86bc71a7816c8eb99a9c8a374ddf8518d763503ee98a4ccb796a3637'
### key: 'c781cf2d86bc71a7816c8eb99a9c8a374ddf8518d763503ee98a4ccb796a3637'
### iv: '5194b0afa795dde11cb28538'
### iv: '5194b0afa795dde11cb28538'
### aad: '66910505256efbca1ae5eaeba0ab6c863167acebedc00f13663c0e99bd27db1d'
### aad: '66910505256efbca1ae5eaeba0ab6c863167acebedc00f13663c0e99bd27db1d'
### cipherinfo: '834a31363136373731373738500d9c3fd1d8c26a5c08960e4eaf2e911a5828b74012254a5a8a70f2982e32401a196d5061d6e3952d3323ad0b3c2e9965de7227d3ec6fcbbd575f'
### cipherinfo: '834a31363136373731373738500d9c3fd1d8c26a5c08960e4eaf2e911a5828b74012254a5a8a70f2982e32401a196d5061d6e3952d3323ad0b3c2e9965de7227d3ec6fcbbd575f'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '60a2819990a2ecd62b8a8538'
### iv_xor: '60a2819990a2ecd62b8a8538'
### authtag: '0d9c3fd1d8c26a5c08960e4eaf2e911a'
### authtag: '0d9c3fd1d8c26a5c08960e4eaf2e911a'
### ciphertext: 'b74012254a5a8a70f2982e32401a196d5061d6e3952d3323ad0b3c2e9965de7227d3ec6fcbbd575f'
### ciphertext: 'b74012254a5a8a70f2982e32401a196d5061d6e3952d3323ad0b3c2e9965de7227d3ec6fcbbd575f'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### read message pattern: 'se'

### read message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDXlWZ3hgZXrlZJf9bCX3jakvN04BYtBNsonnXpgJz6poAoGCCqGSM49
',
###             'AwEHoUQDQgAEcUrOl4YdwMi8INKjrgv/MHmlCun+Ul4Vp7rPy08KgXeXoF80se66
',
###             'gxfojldnBRYm5S2ETUzQSG6/In0R0hpHQw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDXlWZ3hgZXrlZJf9bCX3jakvN04BYtBNsonnXpgJz6poAoGCCqGSM49
',
###             'AwEHoUQDQgAEcUrOl4YdwMi8INKjrgv/MHmlCun+Ul4Vp7rPy08KgXeXoF80se66
',
###             'gxfojldnBRYm5S2ETUzQSG6/In0R0hpHQw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '65d58e794608460b63b2ca0e73a5bf437d25e1c9723d81537d7c11323b02c14d'
### z: '65d58e794608460b63b2ca0e73a5bf437d25e1c9723d81537d7c11323b02c14d'

### noise decrypt

### noise decrypt
### key: 'b248895cd9a3aabda0886d8615983c96a73e956a39348cb0912f400eaaa90482'
### key: 'b248895cd9a3aabda0886d8615983c96a73e956a39348cb0912f400eaaa90482'
### iv: 'f754dec13b7e48cf692af3e6'
### iv: 'f754dec13b7e48cf692af3e6'
### aad: '730dc71c6c04a494dd6d2161bd515d9a8ff9ee172309d3bc326a1f0acc16f07f'
### aad: '730dc71c6c04a494dd6d2161bd515d9a8ff9ee172309d3bc326a1f0acc16f07f'
### cipherinfo: '834a313631363737313737385046c3c47af1c37bac1392c9045d46a1a848f097c4b9dc1cffd7'
### cipherinfo: '834a313631363737313737385046c3c47af1c37bac1392c9045d46a1a848f097c4b9dc1cffd7'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'c662eff70c4979f85e12f3e6'
### iv_xor: 'c662eff70c4979f85e12f3e6'
### authtag: '46c3c47af1c37bac1392c9045d46a1a8'
### authtag: '46c3c47af1c37bac1392c9045d46a1a8'
### ciphertext: 'f097c4b9dc1cffd7'
### ciphertext: 'f097c4b9dc1cffd7'
### plaintext: '696e69742e61636b'
### plaintext: '696e69742e61636b'

### b_recv_a_msg2: 'init.ack'

### b_recv_a_msg2: 'init.ack'
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03714ace97861dc0c8bc20d2a3ae0bff3079a50ae9fe525e15a7bacfcb4f0a8177"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 0,
    message_pattens => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 3,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","0391c10167f080f8b2cd688202af7edbb67cc3c47c5c35e621adcd356db5ab7cf7"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","fd0c368b48a2416e563cad8198a53414ad290c6a3f750e741bd917f67eae1706"),
      h => pack("H*","b77496f46c8499baf93d1956a75173b53ea97afce2c18fca174beebab0db46a5"),
      hasK => 1,
      k => pack("H*","8735be7a04e7ea8c4e2bbbf87cf6576c97a886378b6d048ca299b4a6e409d34e"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","485c17055bb084078eeabfaa5133e7208fc291cd5a4da71e5dffdc8248bfb10c"),
  },
  {
    hasK => 1,
    k => pack("H*","4ea9e688c4e1c0c7576d5a51fec78d4a0eb5a4afb3d9d59535ebac7fc0ef35cc"),
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","03714ace97861dc0c8bc20d2a3ae0bff3079a50ae9fe525e15a7bacfcb4f0a8177"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 0,
    message_pattens => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 3,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 0,
    re => {
      pub => pack("H*","0391c10167f080f8b2cd688202af7edbb67cc3c47c5c35e621adcd356db5ab7cf7"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","fd0c368b48a2416e563cad8198a53414ad290c6a3f750e741bd917f67eae1706"),
      h => pack("H*","b77496f46c8499baf93d1956a75173b53ea97afce2c18fca174beebab0db46a5"),
      hasK => 1,
      k => pack("H*","8735be7a04e7ea8c4e2bbbf87cf6576c97a886378b6d048ca299b4a6e409d34e"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","485c17055bb084078eeabfaa5133e7208fc291cd5a4da71e5dffdc8248bfb10c"),
  },
  {
    hasK => 1,
    k => pack("H*","4ea9e688c4e1c0c7576d5a51fec78d4a0eb5a4afb3d9d59535ebac7fc0ef35cc"),
  },
)


### a send comm msg to b
### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '9861c08b14e5650f2684df5de55140469a326b6d245296c374848c5792d81ade'
### key: '9861c08b14e5650f2684df5de55140469a326b6d245296c374848c5792d81ade'
### iv: 'ee55d40161963f567c611843'
### iv: 'ee55d40161963f567c611843'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'df63e53756a10e614b591843'
### iv_xor: 'df63e53756a10e614b591843'
### aad: 'b77496f46c8499baf93d1956a75173b53ea97afce2c18fca174beebab0db46a5'
### aad: 'b77496f46c8499baf93d1956a75173b53ea97afce2c18fca174beebab0db46a5'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '69002e42241a18851f3b755b1fe8252a4712e521cd90ce9ee6ecbd6e1859c858d490eb76f3e9acb48720a0963a9d6f19a9dcda'
### ciphertext: '69002e42241a18851f3b755b1fe8252a4712e521cd90ce9ee6ecbd6e1859c858d490eb76f3e9acb48720a0963a9d6f19a9dcda'
### authtag: 'eb0c900c95fcfb6356d7ff477c772144'
### authtag: 'eb0c900c95fcfb6356d7ff477c772144'
### cipherinfo: '834a3136313637373137373850eb0c900c95fcfb6356d7ff477c772144583369002e42241a18851f3b755b1fe8252a4712e521cd90ce9ee6ecbd6e1859c858d490eb76f3e9acb48720a0963a9d6f19a9dcda'
### cipherinfo: '834a3136313637373137373850eb0c900c95fcfb6356d7ff477c772144583369002e42241a18851f3b755b1fe8252a4712e521cd90ce9ee6ecbd6e1859c858d490eb76f3e9acb48720a0963a9d6f19a9dcda'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '9861c08b14e5650f2684df5de55140469a326b6d245296c374848c5792d81ade'
### key: '9861c08b14e5650f2684df5de55140469a326b6d245296c374848c5792d81ade'
### iv: 'ee55d40161963f567c611843'
### iv: 'ee55d40161963f567c611843'
### aad: 'b77496f46c8499baf93d1956a75173b53ea97afce2c18fca174beebab0db46a5'
### aad: 'b77496f46c8499baf93d1956a75173b53ea97afce2c18fca174beebab0db46a5'
### cipherinfo: '834a3136313637373137373850eb0c900c95fcfb6356d7ff477c772144583369002e42241a18851f3b755b1fe8252a4712e521cd90ce9ee6ecbd6e1859c858d490eb76f3e9acb48720a0963a9d6f19a9dcda'
### cipherinfo: '834a3136313637373137373850eb0c900c95fcfb6356d7ff477c772144583369002e42241a18851f3b755b1fe8252a4712e521cd90ce9ee6ecbd6e1859c858d490eb76f3e9acb48720a0963a9d6f19a9dcda'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'df63e53756a10e614b591843'
### iv_xor: 'df63e53756a10e614b591843'
### authtag: 'eb0c900c95fcfb6356d7ff477c772144'
### authtag: 'eb0c900c95fcfb6356d7ff477c772144'
### ciphertext: '69002e42241a18851f3b755b1fe8252a4712e521cd90ce9ee6ecbd6e1859c858d490eb76f3e9acb48720a0963a9d6f19a9dcda'
### ciphertext: '69002e42241a18851f3b755b1fe8252a4712e521cd90ce9ee6ecbd6e1859c858d490eb76f3e9acb48720a0963a9d6f19a9dcda'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: 'fd769d2e8f714adb89ef6afdccee5b6e94726343382f2080eec4368e50ea50cb'
### key: 'fd769d2e8f714adb89ef6afdccee5b6e94726343382f2080eec4368e50ea50cb'
### iv: 'cd9f7e49c7eee42702309b9a'
### iv: 'cd9f7e49c7eee42702309b9a'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'fca94f7ff0d9d51035089b9a'
### iv_xor: 'fca94f7ff0d9d51035089b9a'
### aad: 'b77496f46c8499baf93d1956a75173b53ea97afce2c18fca174beebab0db46a5'
### aad: 'b77496f46c8499baf93d1956a75173b53ea97afce2c18fca174beebab0db46a5'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'b17ce7ed045e268845bae90d4e7c09f0e8b872a375c77eee26e7747b072e7f826282e75348c32ec059e5dc130d693d'
### ciphertext: 'b17ce7ed045e268845bae90d4e7c09f0e8b872a375c77eee26e7747b072e7f826282e75348c32ec059e5dc130d693d'
### authtag: '49b6cd5cc7106f9097f3d92f6c14490f'
### authtag: '49b6cd5cc7106f9097f3d92f6c14490f'
### cipherinfo: '834a313631363737313737385049b6cd5cc7106f9097f3d92f6c14490f582fb17ce7ed045e268845bae90d4e7c09f0e8b872a375c77eee26e7747b072e7f826282e75348c32ec059e5dc130d693d'
### cipherinfo: '834a313631363737313737385049b6cd5cc7106f9097f3d92f6c14490f582fb17ce7ed045e268845bae90d4e7c09f0e8b872a375c77eee26e7747b072e7f826282e75348c32ec059e5dc130d693d'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: 'fd769d2e8f714adb89ef6afdccee5b6e94726343382f2080eec4368e50ea50cb'
### key: 'fd769d2e8f714adb89ef6afdccee5b6e94726343382f2080eec4368e50ea50cb'
### iv: 'cd9f7e49c7eee42702309b9a'
### iv: 'cd9f7e49c7eee42702309b9a'
### aad: 'b77496f46c8499baf93d1956a75173b53ea97afce2c18fca174beebab0db46a5'
### aad: 'b77496f46c8499baf93d1956a75173b53ea97afce2c18fca174beebab0db46a5'
### cipherinfo: '834a313631363737313737385049b6cd5cc7106f9097f3d92f6c14490f582fb17ce7ed045e268845bae90d4e7c09f0e8b872a375c77eee26e7747b072e7f826282e75348c32ec059e5dc130d693d'
### cipherinfo: '834a313631363737313737385049b6cd5cc7106f9097f3d92f6c14490f582fb17ce7ed045e268845bae90d4e7c09f0e8b872a375c77eee26e7747b072e7f826282e75348c32ec059e5dc130d693d'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'fca94f7ff0d9d51035089b9a'
### iv_xor: 'fca94f7ff0d9d51035089b9a'
### authtag: '49b6cd5cc7106f9097f3d92f6c14490f'
### authtag: '49b6cd5cc7106f9097f3d92f6c14490f'
### ciphertext: 'b17ce7ed045e268845bae90d4e7c09f0e8b872a375c77eee26e7747b072e7f826282e75348c32ec059e5dc130d693d'
### ciphertext: 'b17ce7ed045e268845bae90d4e7c09f0e8b872a375c77eee26e7747b072e7f826282e75348c32ec059e5dc130d693d'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'XX',
###                               'test_psk',
###                               0

### -----------end test --------: 'XX',
###                               'test_psk',
###                               0

### -----------start test --------: 'XX',
###                                 'test_psk',
###                                 1

### -----------start test --------: 'XX',
###                                 'test_psk',
###                                 1

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "XX",
  initiator => 1,
  message_pattens => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","621523a8048500f43d58bb7791873ef685d9ab18e9fe740388130f365fda5aff"),
    h  => pack("H*","4a47c7698d705dc2062eca7415782c6e385cfd3cf464d0e83f5080f5ea026905"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "XX",
  initiator => 1,
  message_pattens => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "b_s_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","621523a8048500f43d58bb7791873ef685d9ab18e9fe740388130f365fda5aff"),
    h  => pack("H*","4a47c7698d705dc2062eca7415782c6e385cfd3cf464d0e83f5080f5ea026905"),
  },
  who => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '0378936d14da5bfd7d1eece8767a21359492d28b7226a9908af0805b7b50217398'

### public compressed: '0378936d14da5bfd7d1eece8767a21359492d28b7226a9908af0805b7b50217398'

### write message pattern: 'psk'

### write message pattern: 'psk'

### noise encrypt

### noise encrypt
### key: 'f635624049e12937ddb816b1056535ad73327d0ada8f19ed8f8364cfde808c27'
### key: 'f635624049e12937ddb816b1056535ad73327d0ada8f19ed8f8364cfde808c27'
### iv: '2c2b155f001c886ca9ba6967'
### iv: '2c2b155f001c886ca9ba6967'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '1d1d2469372bb95b9e826967'
### iv_xor: '1d1d2469372bb95b9e826967'
### aad: '4e4cc23000f5e55efcff0bcde609bdadd4cdf9d7ab6398e70652c9e91a35a117'
### aad: '4e4cc23000f5e55efcff0bcde609bdadd4cdf9d7ab6398e70652c9e91a35a117'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '0e1747587f3cc1f6'
### ciphertext: '0e1747587f3cc1f6'
### authtag: 'faed185715b3b96023a5a3718eb92bc2'
### authtag: 'faed185715b3b96023a5a3718eb92bc2'
### cipherinfo: '834a3136313637373137373850faed185715b3b96023a5a3718eb92bc2480e1747587f3cc1f6'
### cipherinfo: '834a3136313637373137373850faed185715b3b96023a5a3718eb92bc2480e1747587f3cc1f6'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA3iTbRTaW/19HuzodnohNZSS0otyJqmQivCAW3tQIXOYWCaDSjE2MTY3NzE3NzhQ+u0YVxWzuWAjpaNxjrkrwkgOF0dYfzzB9g=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA3iTbRTaW/19HuzodnohNZSS0otyJqmQivCAW3tQIXOYWCaDSjE2MTY3NzE3NzhQ+u0YVxWzuWAjpaNxjrkrwkgOF0dYfzzB9g=="),
  );
}
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0378936d14da5bfd7d1eece8767a21359492d28b7226a9908af0805b7b50217398"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 1,
    message_pattens => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","0950713cd653c98a9303992cb54f576a4b68b4b623325c121c26550c33e5601e"),
      h => pack("H*","81f6750b4dfed7508a93d071ab13165d1564eee268b95eb79b7ebf958729194d"),
      hasK => 1,
      k => pack("H*","0e2f5f142164b1960731b1ec9c9ef802622a3f4f7a119641ea11c41aff80b41d"),
    },
    who => "a",
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0378936d14da5bfd7d1eece8767a21359492d28b7226a9908af0805b7b50217398"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 1,
    message_pattens => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    rs_pub => "b_s_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","0950713cd653c98a9303992cb54f576a4b68b4b623325c121c26550c33e5601e"),
      h => pack("H*","81f6750b4dfed7508a93d071ab13165d1564eee268b95eb79b7ebf958729194d"),
      hasK => 1,
      k => pack("H*","0e2f5f142164b1960731b1ec9c9ef802622a3f4f7a119641ea11c41aff80b41d"),
    },
    who => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "XX",
  initiator => 0,
  message_pattens => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","621523a8048500f43d58bb7791873ef685d9ab18e9fe740388130f365fda5aff"),
    h  => pack("H*","4a47c7698d705dc2062eca7415782c6e385cfd3cf464d0e83f5080f5ea026905"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  handshake_pattern_name => "XX",
  initiator => 0,
  message_pattens => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 0,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","621523a8048500f43d58bb7791873ef685d9ab18e9fe740388130f365fda5aff"),
    h  => pack("H*","4a47c7698d705dc2062eca7415782c6e385cfd3cf464d0e83f5080f5ea026905"),
  },
  who => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'psk'

### read message pattern: 'psk'

### noise decrypt

### noise decrypt
### key: 'f635624049e12937ddb816b1056535ad73327d0ada8f19ed8f8364cfde808c27'
### key: 'f635624049e12937ddb816b1056535ad73327d0ada8f19ed8f8364cfde808c27'
### iv: '2c2b155f001c886ca9ba6967'
### iv: '2c2b155f001c886ca9ba6967'
### aad: '4e4cc23000f5e55efcff0bcde609bdadd4cdf9d7ab6398e70652c9e91a35a117'
### aad: '4e4cc23000f5e55efcff0bcde609bdadd4cdf9d7ab6398e70652c9e91a35a117'
### cipherinfo: '834a3136313637373137373850faed185715b3b96023a5a3718eb92bc2480e1747587f3cc1f6'
### cipherinfo: '834a3136313637373137373850faed185715b3b96023a5a3718eb92bc2480e1747587f3cc1f6'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '1d1d2469372bb95b9e826967'
### iv_xor: '1d1d2469372bb95b9e826967'
### authtag: 'faed185715b3b96023a5a3718eb92bc2'
### authtag: 'faed185715b3b96023a5a3718eb92bc2'
### ciphertext: '0e1747587f3cc1f6'
### ciphertext: '0e1747587f3cc1f6'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "XX",
    initiator => 0,
    message_pattens => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","0378936d14da5bfd7d1eece8767a21359492d28b7226a9908af0805b7b50217398"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","0950713cd653c98a9303992cb54f576a4b68b4b623325c121c26550c33e5601e"),
      h => pack("H*","81f6750b4dfed7508a93d071ab13165d1564eee268b95eb79b7ebf958729194d"),
      hasK => 1,
      k => pack("H*","0e2f5f142164b1960731b1ec9c9ef802622a3f4f7a119641ea11c41aff80b41d"),
    },
    who => "b",
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    handshake_pattern_name => "XX",
    initiator => 0,
    message_pattens => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 1,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","0378936d14da5bfd7d1eece8767a21359492d28b7226a9908af0805b7b50217398"),
    },
    re_pub => "b_re_pub.pem",
    rs_pub => "a_s_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","0950713cd653c98a9303992cb54f576a4b68b4b623325c121c26550c33e5601e"),
      h => pack("H*","81f6750b4dfed7508a93d071ab13165d1564eee268b95eb79b7ebf958729194d"),
      hasK => 1,
      k => pack("H*","0e2f5f142164b1960731b1ec9c9ef802622a3f4f7a119641ea11c41aff80b41d"),
    },
    who => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '028823346960f1b46057bb16387f2a7c1132a25f4d9cac6dc067abf93f309389c1'

### public compressed: '028823346960f1b46057bb16387f2a7c1132a25f4d9cac6dc067abf93f309389c1'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIAew/+xsWiPTJm1mthuPo8uSb+Oo9RjJSOIn8/OX5jB4oAoGCCqGSM49
',
###             'AwEHoUQDQgAEiCM0aWDxtGBXuxY4fyp8ETKiX02crG3AZ6v5PzCTicFB9H49675g
',
###             '9H0S0zg180PDu6S8ynfxCZFiypBXLY++og==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIAew/+xsWiPTJm1mthuPo8uSb+Oo9RjJSOIn8/OX5jB4oAoGCCqGSM49
',
###             'AwEHoUQDQgAEiCM0aWDxtGBXuxY4fyp8ETKiX02crG3AZ6v5PzCTicFB9H49675g
',
###             '9H0S0zg180PDu6S8ynfxCZFiypBXLY++og==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEeJNtFNpb/X0e7Oh2eiE1lJLSi3Im
',
###           'qZCK8IBbe1Ahc5hfNH9BJu14Ew2gt3wyqlunOyVxxOzq41wqtO+4Qbgrmw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEeJNtFNpb/X0e7Oh2eiE1lJLSi3Im
',
###           'qZCK8IBbe1Ahc5hfNH9BJu14Ew2gt3wyqlunOyVxxOzq41wqtO+4Qbgrmw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'd8622a27ce0e22e3de3f156acd92966ab3e8197bca26aae1d3f1d7ddbf9061b0'
### z: 'd8622a27ce0e22e3de3f156acd92966ab3e8197bca26aae1d3f1d7ddbf9061b0'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '1a69746356d96aebafba35083c0f08dc757c229a4272f468bf378c19e730ddaf'
### key: '1a69746356d96aebafba35083c0f08dc757c229a4272f468bf378c19e730ddaf'
### iv: '8e3e5d214415542932561cb6'
### iv: '8e3e5d214415542932561cb6'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'bf086c177322651e056e1cb6'
### iv_xor: 'bf086c177322651e056e1cb6'
### aad: '90d15a59703c7df8d1c6b73689618c6b181757d9185f6a7fcf17b9180adc42a9'
### aad: '90d15a59703c7df8d1c6b73689618c6b181757d9185f6a7fcf17b9180adc42a9'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### ciphertext: '6accaea3fc16beb01578e6dcc748a58a6f7e1144e026612553ad178565ba305f7ec73c253224c7b7'
### ciphertext: '6accaea3fc16beb01578e6dcc748a58a6f7e1144e026612553ad178565ba305f7ec73c253224c7b7'
### authtag: '474b9b77b3f70c63f3027f626a05ceb4'
### authtag: '474b9b77b3f70c63f3027f626a05ceb4'
### cipherinfo: '834a3136313637373137373850474b9b77b3f70c63f3027f626a05ceb458286accaea3fc16beb01578e6dcc748a58a6f7e1144e026612553ad178565ba305f7ec73c253224c7b7'
### cipherinfo: '834a3136313637373137373850474b9b77b3f70c63f3027f626a05ceb458286accaea3fc16beb01578e6dcc748a58a6f7e1144e026612553ad178565ba305f7ec73c253224c7b7'


### write message pattern: 'es'
### write message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEeJNtFNpb/X0e7Oh2eiE1lJLSi3Im
',
###           'qZCK8IBbe1Ahc5hfNH9BJu14Ew2gt3wyqlunOyVxxOzq41wqtO+4Qbgrmw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEeJNtFNpb/X0e7Oh2eiE1lJLSi3Im
',
###           'qZCK8IBbe1Ahc5hfNH9BJu14Ew2gt3wyqlunOyVxxOzq41wqtO+4Qbgrmw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'bc0ba064b7534a63994718028db6bd34ab7c923da9a8d7299ed79e1c6d624e1f'
### z: 'bc0ba064b7534a63994718028db6bd34ab7c923da9a8d7299ed79e1c6d624e1f'

### noise encrypt

### noise encrypt
### key: 'b05816067ef151c5a1ffe045a944e93b0976b8856f6db44cc3c69686cabffa83'
### key: 'b05816067ef151c5a1ffe045a944e93b0976b8856f6db44cc3c69686cabffa83'
### iv: '6e5ddd13bab4cbb359b72d52'
### iv: '6e5ddd13bab4cbb359b72d52'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '5f6bec258d83fa846e8f2d52'
### iv_xor: '5f6bec258d83fa846e8f2d52'
### aad: 'a9bd6e59d14fff19d911622ab8dd7e886cb46a26a27ad61be590c661cd3b9c96'
### aad: 'a9bd6e59d14fff19d911622ab8dd7e886cb46a26a27ad61be590c661cd3b9c96'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '091133249c87b7ee'
### ciphertext: '091133249c87b7ee'
### authtag: '4afdc6c8bd80d7667f2eae5350efdc0d'
### authtag: '4afdc6c8bd80d7667f2eae5350efdc0d'
### cipherinfo: '834a31363136373731373738504afdc6c8bd80d7667f2eae5350efdc0d48091133249c87b7ee'
### cipherinfo: '834a31363136373731373738504afdc6c8bd80d7667f2eae5350efdc0d48091133249c87b7ee'

### b_msg: '835821028823346960f1b46057bb16387f2a7c1132a25f4d9cac6dc067abf93f309389c15847834a3136313637373137373850474b9b77b3f70c63f3027f626a05ceb458286accaea3fc16beb01578e6dcc748a58a6f7e1144e026612553ad178565ba305f7ec73c253224c7b75826834a31363136373731373738504afdc6c8bd80d7667f2eae5350efdc0d48091133249c87b7ee'

### b_msg: '835821028823346960f1b46057bb16387f2a7c1132a25f4d9cac6dc067abf93f309389c15847834a3136313637373137373850474b9b77b3f70c63f3027f626a05ceb458286accaea3fc16beb01578e6dcc748a58a6f7e1144e026612553ad178565ba305f7ec73c253224c7b75826834a31363136373731373738504afdc6c8bd80d7667f2eae5350efdc0d48091133249c87b7ee'
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  e => {
    pub => pack("H*","028823346960f1b46057bb16387f2a7c1132a25f4d9cac6dc067abf93f309389c1"),
  },
  e_priv => "b_e_priv.pem",
  e_pub => "b_e_pub.pem",
  handshake_pattern_name => "XX",
  initiator => 0,
  message_pattens => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 2,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  re => {
    pub => pack("H*","0378936d14da5bfd7d1eece8767a21359492d28b7226a9908af0805b7b50217398"),
  },
  re_pub => "b_re_pub.pem",
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","1de68751945a99f071f24efcfcd4c931addea1b1717fc38474fbaee78d3586a6"),
    h => pack("H*","24e4a830ff520cc807c5fd9321e3e13a342cb56528e19fc929ba9c28b2b89eec"),
    hasK => 1,
    k => pack("H*","805ada27dc46eb320b10dadebd3cb4ed5a9b71a12cc42793ab10ed4530021e9a"),
  },
  who => "b",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  e => {
    pub => pack("H*","028823346960f1b46057bb16387f2a7c1132a25f4d9cac6dc067abf93f309389c1"),
  },
  e_priv => "b_e_priv.pem",
  e_pub => "b_e_pub.pem",
  handshake_pattern_name => "XX",
  initiator => 0,
  message_pattens => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 2,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  re => {
    pub => pack("H*","0378936d14da5bfd7d1eece8767a21359492d28b7226a9908af0805b7b50217398"),
  },
  re_pub => "b_re_pub.pem",
  rs_pub => "a_s_pub.pem",
  s_priv => "b_s_priv.pem",
  s_pub => "b_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write => 0,
  ss => {
    ck => pack("H*","1de68751945a99f071f24efcfcd4c931addea1b1717fc38474fbaee78d3586a6"),
    h => pack("H*","24e4a830ff520cc807c5fd9321e3e13a342cb56528e19fc929ba9c28b2b89eec"),
    hasK => 1,
    k => pack("H*","805ada27dc46eb320b10dadebd3cb4ed5a9b71a12cc42793ab10ed4530021e9a"),
  },
  who => "b",
}


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIB7UfAZJon90/+re7rcqP89DQzoXcAV/j7AGFMwcTw3FoAoGCCqGSM49
',
###             'AwEHoUQDQgAEeJNtFNpb/X0e7Oh2eiE1lJLSi3ImqZCK8IBbe1Ahc5hfNH9BJu14
',
###             'Ew2gt3wyqlunOyVxxOzq41wqtO+4Qbgrmw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIB7UfAZJon90/+re7rcqP89DQzoXcAV/j7AGFMwcTw3FoAoGCCqGSM49
',
###             'AwEHoUQDQgAEeJNtFNpb/X0e7Oh2eiE1lJLSi3ImqZCK8IBbe1Ahc5hfNH9BJu14
',
###             'Ew2gt3wyqlunOyVxxOzq41wqtO+4Qbgrmw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEiCM0aWDxtGBXuxY4fyp8ETKiX02c
',
###           'rG3AZ6v5PzCTicFB9H49675g9H0S0zg180PDu6S8ynfxCZFiypBXLY++og==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEiCM0aWDxtGBXuxY4fyp8ETKiX02c
',
###           'rG3AZ6v5PzCTicFB9H49675g9H0S0zg180PDu6S8ynfxCZFiypBXLY++og==
',
###           '-----END PUBLIC KEY-----
'
### z: 'd8622a27ce0e22e3de3f156acd92966ab3e8197bca26aae1d3f1d7ddbf9061b0'
### z: 'd8622a27ce0e22e3de3f156acd92966ab3e8197bca26aae1d3f1d7ddbf9061b0'

### read message pattern: 's'

### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: '1a69746356d96aebafba35083c0f08dc757c229a4272f468bf378c19e730ddaf'
### key: '1a69746356d96aebafba35083c0f08dc757c229a4272f468bf378c19e730ddaf'
### iv: '8e3e5d214415542932561cb6'
### iv: '8e3e5d214415542932561cb6'
### aad: '90d15a59703c7df8d1c6b73689618c6b181757d9185f6a7fcf17b9180adc42a9'
### aad: '90d15a59703c7df8d1c6b73689618c6b181757d9185f6a7fcf17b9180adc42a9'
### cipherinfo: '834a3136313637373137373850474b9b77b3f70c63f3027f626a05ceb458286accaea3fc16beb01578e6dcc748a58a6f7e1144e026612553ad178565ba305f7ec73c253224c7b7'
### cipherinfo: '834a3136313637373137373850474b9b77b3f70c63f3027f626a05ceb458286accaea3fc16beb01578e6dcc748a58a6f7e1144e026612553ad178565ba305f7ec73c253224c7b7'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'bf086c177322651e056e1cb6'
### iv_xor: 'bf086c177322651e056e1cb6'
### authtag: '474b9b77b3f70c63f3027f626a05ceb4'
### authtag: '474b9b77b3f70c63f3027f626a05ceb4'
### ciphertext: '6accaea3fc16beb01578e6dcc748a58a6f7e1144e026612553ad178565ba305f7ec73c253224c7b7'
### ciphertext: '6accaea3fc16beb01578e6dcc748a58a6f7e1144e026612553ad178565ba305f7ec73c253224c7b7'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'


### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'


### read message pattern: 'es'
### read message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIB7UfAZJon90/+re7rcqP89DQzoXcAV/j7AGFMwcTw3FoAoGCCqGSM49
',
###             'AwEHoUQDQgAEeJNtFNpb/X0e7Oh2eiE1lJLSi3ImqZCK8IBbe1Ahc5hfNH9BJu14
',
###             'Ew2gt3wyqlunOyVxxOzq41wqtO+4Qbgrmw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIB7UfAZJon90/+re7rcqP89DQzoXcAV/j7AGFMwcTw3FoAoGCCqGSM49
',
###             'AwEHoUQDQgAEeJNtFNpb/X0e7Oh2eiE1lJLSi3ImqZCK8IBbe1Ahc5hfNH9BJu14
',
###             'Ew2gt3wyqlunOyVxxOzq41wqtO+4Qbgrmw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'bc0ba064b7534a63994718028db6bd34ab7c923da9a8d7299ed79e1c6d624e1f'
### z: 'bc0ba064b7534a63994718028db6bd34ab7c923da9a8d7299ed79e1c6d624e1f'


### noise decrypt
### noise decrypt
### key: 'b05816067ef151c5a1ffe045a944e93b0976b8856f6db44cc3c69686cabffa83'
### key: 'b05816067ef151c5a1ffe045a944e93b0976b8856f6db44cc3c69686cabffa83'
### iv: '6e5ddd13bab4cbb359b72d52'
### iv: '6e5ddd13bab4cbb359b72d52'
### aad: 'a9bd6e59d14fff19d911622ab8dd7e886cb46a26a27ad61be590c661cd3b9c96'
### aad: 'a9bd6e59d14fff19d911622ab8dd7e886cb46a26a27ad61be590c661cd3b9c96'
### cipherinfo: '834a31363136373731373738504afdc6c8bd80d7667f2eae5350efdc0d48091133249c87b7ee'
### cipherinfo: '834a31363136373731373738504afdc6c8bd80d7667f2eae5350efdc0d48091133249c87b7ee'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '5f6bec258d83fa846e8f2d52'
### iv_xor: '5f6bec258d83fa846e8f2d52'
### authtag: '4afdc6c8bd80d7667f2eae5350efdc0d'
### authtag: '4afdc6c8bd80d7667f2eae5350efdc0d'
### ciphertext: '091133249c87b7ee'
### ciphertext: '091133249c87b7ee'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  e => {
    pub => pack("H*","0378936d14da5bfd7d1eece8767a21359492d28b7226a9908af0805b7b50217398"),
  },
  e_priv => "a_e_priv.pem",
  e_pub => "a_e_pub.pem",
  handshake_pattern_name => "XX",
  initiator => 1,
  message_pattens => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 2,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  re => {
    pub => pack("H*","028823346960f1b46057bb16387f2a7c1132a25f4d9cac6dc067abf93f309389c1"),
  },
  re_pub => "a_re_pub.pem",
  rs => {
    pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  },
  rs_pub => "a_rs_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","1de68751945a99f071f24efcfcd4c931addea1b1717fc38474fbaee78d3586a6"),
    h => pack("H*","24e4a830ff520cc807c5fd9321e3e13a342cb56528e19fc929ba9c28b2b89eec"),
    hasK => 1,
    k => pack("H*","805ada27dc46eb320b10dadebd3cb4ed5a9b71a12cc42793ab10ed4530021e9a"),
  },
  who => "a",
}
{
  ciphersuite_name => "secp256r1_AESGCM_SHA256",
  e => {
    pub => pack("H*","0378936d14da5bfd7d1eece8767a21359492d28b7226a9908af0805b7b50217398"),
  },
  e_priv => "a_e_priv.pem",
  e_pub => "a_e_pub.pem",
  handshake_pattern_name => "XX",
  initiator => 1,
  message_pattens => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id => 2,
  prologue => "some_info",
  psk => "test_psk",
  psk_id => 1,
  re => {
    pub => pack("H*","028823346960f1b46057bb16387f2a7c1132a25f4d9cac6dc067abf93f309389c1"),
  },
  re_pub => "a_re_pub.pem",
  rs => {
    pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  },
  rs_pub => "a_rs_pub.pem",
  s_priv => "a_s_priv.pem",
  s_pub => "a_s_pub.pem",
  s_pub_info_type => "raw",
  s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write => 1,
  ss => {
    ck => pack("H*","1de68751945a99f071f24efcfcd4c931addea1b1717fc38474fbaee78d3586a6"),
    h => pack("H*","24e4a830ff520cc807c5fd9321e3e13a342cb56528e19fc929ba9c28b2b89eec"),
    hasK => 1,
    k => pack("H*","805ada27dc46eb320b10dadebd3cb4ed5a9b71a12cc42793ab10ed4530021e9a"),
  },
  who => "a",
}


### a send msg to b
### a send msg to b

### $a_msg2_src: 'init.ack'

### $a_msg2_src: 'init.ack'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: 'b05816067ef151c5a1ffe045a944e93b0976b8856f6db44cc3c69686cabffa83'
### key: 'b05816067ef151c5a1ffe045a944e93b0976b8856f6db44cc3c69686cabffa83'
### iv: '6e5ddd13bab4cbb359b72d52'
### iv: '6e5ddd13bab4cbb359b72d52'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '5f6bec258d83fa846e8f2d52'
### iv_xor: '5f6bec258d83fa846e8f2d52'
### aad: '24e4a830ff520cc807c5fd9321e3e13a342cb56528e19fc929ba9c28b2b89eec'
### aad: '24e4a830ff520cc807c5fd9321e3e13a342cb56528e19fc929ba9c28b2b89eec'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: 'f9373235c5bef586e5bdd857e378e5a42597f71b192bfb830bb4b6ffe87d913225c239b73d05547b'
### ciphertext: 'f9373235c5bef586e5bdd857e378e5a42597f71b192bfb830bb4b6ffe87d913225c239b73d05547b'
### authtag: 'facdc216ace267af64f4938511f4e258'
### authtag: 'facdc216ace267af64f4938511f4e258'
### cipherinfo: '834a3136313637373137373850facdc216ace267af64f4938511f4e2585828f9373235c5bef586e5bdd857e378e5a42597f71b192bfb830bb4b6ffe87d913225c239b73d05547b'
### cipherinfo: '834a3136313637373137373850facdc216ace267af64f4938511f4e2585828f9373235c5bef586e5bdd857e378e5a42597f71b192bfb830bb4b6ffe87d913225c239b73d05547b'

### write message pattern: 'se'

### write message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEiCM0aWDxtGBXuxY4fyp8ETKiX02c
',
###           'rG3AZ6v5PzCTicFB9H49675g9H0S0zg180PDu6S8ynfxCZFiypBXLY++og==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEiCM0aWDxtGBXuxY4fyp8ETKiX02c
',
###           'rG3AZ6v5PzCTicFB9H49675g9H0S0zg180PDu6S8ynfxCZFiypBXLY++og==
',
###           '-----END PUBLIC KEY-----
'
### z: '710221d569e33ab0194c63d44ef54030237feda8a8a52e4d9348886d1b23ab85'
### z: '710221d569e33ab0194c63d44ef54030237feda8a8a52e4d9348886d1b23ab85'


### noise encrypt
### noise encrypt
### key: '57f42cac26c02c674cc7ba9888b23a3df79ce84a6b59e9d5b7f7c8f5480a6e7a'
### key: '57f42cac26c02c674cc7ba9888b23a3df79ce84a6b59e9d5b7f7c8f5480a6e7a'
### iv: 'c0f222e448d8cf5d027ac763'
### iv: 'c0f222e448d8cf5d027ac763'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'f1c413d27feffe6a3542c763'
### iv_xor: 'f1c413d27feffe6a3542c763'
### aad: '5dbfb014fd50ad6dfec55c2bf2c0fcfd9014e21110523fba7a2869a7ce48b838'
### aad: '5dbfb014fd50ad6dfec55c2bf2c0fcfd9014e21110523fba7a2869a7ce48b838'
### plaintext: '696e69742e61636b'
### plaintext: '696e69742e61636b'
### ciphertext: '7562ced97d461f53'
### ciphertext: '7562ced97d461f53'
### authtag: 'b008c70fdf7c417bcf19fed03199cb38'
### authtag: 'b008c70fdf7c417bcf19fed03199cb38'
### cipherinfo: '834a3136313637373137373850b008c70fdf7c417bcf19fed03199cb38487562ced97d461f53'
### cipherinfo: '834a3136313637373137373850b008c70fdf7c417bcf19fed03199cb38487562ced97d461f53'


### a_msg2: '825847834a3136313637373137373850facdc216ace267af64f4938511f4e2585828f9373235c5bef586e5bdd857e378e5a42597f71b192bfb830bb4b6ffe87d913225c239b73d05547b5826834a3136313637373137373850b008c70fdf7c417bcf19fed03199cb38487562ced97d461f53'
### a_msg2: '825847834a3136313637373137373850facdc216ace267af64f4938511f4e2585828f9373235c5bef586e5bdd857e378e5a42597f71b192bfb830bb4b6ffe87d913225c239b73d05547b5826834a3136313637373137373850b008c70fdf7c417bcf19fed03199cb38487562ced97d461f53'
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0378936d14da5bfd7d1eece8767a21359492d28b7226a9908af0805b7b50217398"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 1,
    message_pattens => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 3,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","028823346960f1b46057bb16387f2a7c1132a25f4d9cac6dc067abf93f309389c1"),
    },
    re_pub => "a_re_pub.pem",
    rs => {
      pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    },
    rs_pub => "a_rs_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","9f06f1f348bd58075602247a360807544776cc678f99f7e160c6b05c33c42f9d"),
      h => pack("H*","53305fdb838acc711076dc0833791046cee3d5a8eec1e43de5e1d37d594afc83"),
      hasK => 1,
      k => pack("H*","65a658f6b347fbcd5efdb3c53f9007ba0a040249925bfa8c7a574f284606fa5b"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","69d4cc0da7ccb285759d16bb11e9834962c52f2a6c6f0ae8beb7f0b690f984c5"),
  },
  {
    hasK => 1,
    k => pack("H*","465d89a5b63b6653e441be0a3c6d9b444e13f8d8cf2f165ac09158be1ed8f1f3"),
  },
)
(
  "a_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","0378936d14da5bfd7d1eece8767a21359492d28b7226a9908af0805b7b50217398"),
    },
    e_priv => "a_e_priv.pem",
    e_pub => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 1,
    message_pattens => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 3,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","028823346960f1b46057bb16387f2a7c1132a25f4d9cac6dc067abf93f309389c1"),
    },
    re_pub => "a_re_pub.pem",
    rs => {
      pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    },
    rs_pub => "a_rs_pub.pem",
    s_priv => "a_s_priv.pem",
    s_pub => "a_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write => 0,
    ss => {
      ck => pack("H*","9f06f1f348bd58075602247a360807544776cc678f99f7e160c6b05c33c42f9d"),
      h => pack("H*","53305fdb838acc711076dc0833791046cee3d5a8eec1e43de5e1d37d594afc83"),
      hasK => 1,
      k => pack("H*","65a658f6b347fbcd5efdb3c53f9007ba0a040249925bfa8c7a574f284606fa5b"),
    },
    who => "a",
  },
  {
    hasK => 1,
    k => pack("H*","69d4cc0da7ccb285759d16bb11e9834962c52f2a6c6f0ae8beb7f0b690f984c5"),
  },
  {
    hasK => 1,
    k => pack("H*","465d89a5b63b6653e441be0a3c6d9b444e13f8d8cf2f165ac09158be1ed8f1f3"),
  },
)

### b recv msg from a

### b recv msg from a

### read message pattern: 's'

### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: 'b05816067ef151c5a1ffe045a944e93b0976b8856f6db44cc3c69686cabffa83'
### key: 'b05816067ef151c5a1ffe045a944e93b0976b8856f6db44cc3c69686cabffa83'
### iv: '6e5ddd13bab4cbb359b72d52'
### iv: '6e5ddd13bab4cbb359b72d52'
### aad: '24e4a830ff520cc807c5fd9321e3e13a342cb56528e19fc929ba9c28b2b89eec'
### aad: '24e4a830ff520cc807c5fd9321e3e13a342cb56528e19fc929ba9c28b2b89eec'
### cipherinfo: '834a3136313637373137373850facdc216ace267af64f4938511f4e2585828f9373235c5bef586e5bdd857e378e5a42597f71b192bfb830bb4b6ffe87d913225c239b73d05547b'
### cipherinfo: '834a3136313637373137373850facdc216ace267af64f4938511f4e2585828f9373235c5bef586e5bdd857e378e5a42597f71b192bfb830bb4b6ffe87d913225c239b73d05547b'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '5f6bec258d83fa846e8f2d52'
### iv_xor: '5f6bec258d83fa846e8f2d52'
### authtag: 'facdc216ace267af64f4938511f4e258'
### authtag: 'facdc216ace267af64f4938511f4e258'
### ciphertext: 'f9373235c5bef586e5bdd857e378e5a42597f71b192bfb830bb4b6ffe87d913225c239b73d05547b'
### ciphertext: 'f9373235c5bef586e5bdd857e378e5a42597f71b192bfb830bb4b6ffe87d913225c239b73d05547b'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'


### read message pattern: 'se'
### read message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIAew/+xsWiPTJm1mthuPo8uSb+Oo9RjJSOIn8/OX5jB4oAoGCCqGSM49
',
###             'AwEHoUQDQgAEiCM0aWDxtGBXuxY4fyp8ETKiX02crG3AZ6v5PzCTicFB9H49675g
',
###             '9H0S0zg180PDu6S8ynfxCZFiypBXLY++og==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIAew/+xsWiPTJm1mthuPo8uSb+Oo9RjJSOIn8/OX5jB4oAoGCCqGSM49
',
###             'AwEHoUQDQgAEiCM0aWDxtGBXuxY4fyp8ETKiX02crG3AZ6v5PzCTicFB9H49675g
',
###             '9H0S0zg180PDu6S8ynfxCZFiypBXLY++og==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '710221d569e33ab0194c63d44ef54030237feda8a8a52e4d9348886d1b23ab85'
### z: '710221d569e33ab0194c63d44ef54030237feda8a8a52e4d9348886d1b23ab85'

### noise decrypt

### noise decrypt
### key: '57f42cac26c02c674cc7ba9888b23a3df79ce84a6b59e9d5b7f7c8f5480a6e7a'
### key: '57f42cac26c02c674cc7ba9888b23a3df79ce84a6b59e9d5b7f7c8f5480a6e7a'
### iv: 'c0f222e448d8cf5d027ac763'
### iv: 'c0f222e448d8cf5d027ac763'
### aad: '5dbfb014fd50ad6dfec55c2bf2c0fcfd9014e21110523fba7a2869a7ce48b838'
### aad: '5dbfb014fd50ad6dfec55c2bf2c0fcfd9014e21110523fba7a2869a7ce48b838'
### cipherinfo: '834a3136313637373137373850b008c70fdf7c417bcf19fed03199cb38487562ced97d461f53'
### cipherinfo: '834a3136313637373137373850b008c70fdf7c417bcf19fed03199cb38487562ced97d461f53'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: 'f1c413d27feffe6a3542c763'
### iv_xor: 'f1c413d27feffe6a3542c763'
### authtag: 'b008c70fdf7c417bcf19fed03199cb38'
### authtag: 'b008c70fdf7c417bcf19fed03199cb38'
### ciphertext: '7562ced97d461f53'
### ciphertext: '7562ced97d461f53'
### plaintext: '696e69742e61636b'
### plaintext: '696e69742e61636b'

### b_recv_a_msg2: 'init.ack'

### b_recv_a_msg2: 'init.ack'
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","028823346960f1b46057bb16387f2a7c1132a25f4d9cac6dc067abf93f309389c1"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 0,
    message_pattens => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 3,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","0378936d14da5bfd7d1eece8767a21359492d28b7226a9908af0805b7b50217398"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","9f06f1f348bd58075602247a360807544776cc678f99f7e160c6b05c33c42f9d"),
      h => pack("H*","53305fdb838acc711076dc0833791046cee3d5a8eec1e43de5e1d37d594afc83"),
      hasK => 1,
      k => pack("H*","65a658f6b347fbcd5efdb3c53f9007ba0a040249925bfa8c7a574f284606fa5b"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","69d4cc0da7ccb285759d16bb11e9834962c52f2a6c6f0ae8beb7f0b690f984c5"),
  },
  {
    hasK => 1,
    k => pack("H*","465d89a5b63b6653e441be0a3c6d9b444e13f8d8cf2f165ac09158be1ed8f1f3"),
  },
)
(
  "b_hs",
  {
    ciphersuite_name => "secp256r1_AESGCM_SHA256",
    e => {
      pub => pack("H*","028823346960f1b46057bb16387f2a7c1132a25f4d9cac6dc067abf93f309389c1"),
    },
    e_priv => "b_e_priv.pem",
    e_pub => "b_e_pub.pem",
    handshake_pattern_name => "XX",
    initiator => 0,
    message_pattens => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id => 3,
    prologue => "some_info",
    psk => "test_psk",
    psk_id => 1,
    re => {
      pub => pack("H*","0378936d14da5bfd7d1eece8767a21359492d28b7226a9908af0805b7b50217398"),
    },
    re_pub => "b_re_pub.pem",
    rs => {
      pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    },
    rs_pub => "b_rs_pub.pem",
    s_priv => "b_s_priv.pem",
    s_pub => "b_s_pub.pem",
    s_pub_info_type => "raw",
    s_pub_info_value => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write => 1,
    ss => {
      ck => pack("H*","9f06f1f348bd58075602247a360807544776cc678f99f7e160c6b05c33c42f9d"),
      h => pack("H*","53305fdb838acc711076dc0833791046cee3d5a8eec1e43de5e1d37d594afc83"),
      hasK => 1,
      k => pack("H*","65a658f6b347fbcd5efdb3c53f9007ba0a040249925bfa8c7a574f284606fa5b"),
    },
    who => "b",
  },
  {
    hasK => 1,
    k => pack("H*","69d4cc0da7ccb285759d16bb11e9834962c52f2a6c6f0ae8beb7f0b690f984c5"),
  },
  {
    hasK => 1,
    k => pack("H*","465d89a5b63b6653e441be0a3c6d9b444e13f8d8cf2f165ac09158be1ed8f1f3"),
  },
)

### a send comm msg to b

### a send comm msg to b


### noise encrypt
### noise encrypt
### key: 'ddf9c9db9b771c999f6cc29ba1666a181f25370e7146652ecdced6d9b9ab51d4'
### key: 'ddf9c9db9b771c999f6cc29ba1666a181f25370e7146652ecdced6d9b9ab51d4'
### iv: '4135b8e7dce495491b203433'
### iv: '4135b8e7dce495491b203433'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '700389d1ebd3a47e2c183433'
### iv_xor: '700389d1ebd3a47e2c183433'
### aad: '53305fdb838acc711076dc0833791046cee3d5a8eec1e43de5e1d37d594afc83'
### aad: '53305fdb838acc711076dc0833791046cee3d5a8eec1e43de5e1d37d594afc83'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '5ebe73f82910aed6b76a0b0c031d04daddfee2e86ed7366b6b961e0e51b708de5c8561b46268cd51f0fb5e1f0c26a34cb99d0d'
### ciphertext: '5ebe73f82910aed6b76a0b0c031d04daddfee2e86ed7366b6b961e0e51b708de5c8561b46268cd51f0fb5e1f0c26a34cb99d0d'
### authtag: '55c0bf03380a8b4b998499f7ccce5a72'
### authtag: '55c0bf03380a8b4b998499f7ccce5a72'
### cipherinfo: '834a313631363737313737385055c0bf03380a8b4b998499f7ccce5a7258335ebe73f82910aed6b76a0b0c031d04daddfee2e86ed7366b6b961e0e51b708de5c8561b46268cd51f0fb5e1f0c26a34cb99d0d'
### cipherinfo: '834a313631363737313737385055c0bf03380a8b4b998499f7ccce5a7258335ebe73f82910aed6b76a0b0c031d04daddfee2e86ed7366b6b961e0e51b708de5c8561b46268cd51f0fb5e1f0c26a34cb99d0d'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: 'ddf9c9db9b771c999f6cc29ba1666a181f25370e7146652ecdced6d9b9ab51d4'
### key: 'ddf9c9db9b771c999f6cc29ba1666a181f25370e7146652ecdced6d9b9ab51d4'
### iv: '4135b8e7dce495491b203433'
### iv: '4135b8e7dce495491b203433'
### aad: '53305fdb838acc711076dc0833791046cee3d5a8eec1e43de5e1d37d594afc83'
### aad: '53305fdb838acc711076dc0833791046cee3d5a8eec1e43de5e1d37d594afc83'
### cipherinfo: '834a313631363737313737385055c0bf03380a8b4b998499f7ccce5a7258335ebe73f82910aed6b76a0b0c031d04daddfee2e86ed7366b6b961e0e51b708de5c8561b46268cd51f0fb5e1f0c26a34cb99d0d'
### cipherinfo: '834a313631363737313737385055c0bf03380a8b4b998499f7ccce5a7258335ebe73f82910aed6b76a0b0c031d04daddfee2e86ed7366b6b961e0e51b708de5c8561b46268cd51f0fb5e1f0c26a34cb99d0d'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '700389d1ebd3a47e2c183433'
### iv_xor: '700389d1ebd3a47e2c183433'
### authtag: '55c0bf03380a8b4b998499f7ccce5a72'
### authtag: '55c0bf03380a8b4b998499f7ccce5a72'
### ciphertext: '5ebe73f82910aed6b76a0b0c031d04daddfee2e86ed7366b6b961e0e51b708de5c8561b46268cd51f0fb5e1f0c26a34cb99d0d'
### ciphertext: '5ebe73f82910aed6b76a0b0c031d04daddfee2e86ed7366b6b961e0e51b708de5c8561b46268cd51f0fb5e1f0c26a34cb99d0d'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '9701fbc221d4af460d9e696ef9ce096f8461add80d702193e1e645785804e7b6'
### key: '9701fbc221d4af460d9e696ef9ce096f8461add80d702193e1e645785804e7b6'
### iv: '42a3931ae2c5b64b16f37cbd'
### iv: '42a3931ae2c5b64b16f37cbd'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '7395a22cd5f2877c21cb7cbd'
### iv_xor: '7395a22cd5f2877c21cb7cbd'
### aad: '53305fdb838acc711076dc0833791046cee3d5a8eec1e43de5e1d37d594afc83'
### aad: '53305fdb838acc711076dc0833791046cee3d5a8eec1e43de5e1d37d594afc83'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '7c869854f5b66b636f44073072bceb2af74cda6c095a51f9f1db67ce10cb11e460364ac2e751a6fa45707eaf1a89d1'
### ciphertext: '7c869854f5b66b636f44073072bceb2af74cda6c095a51f9f1db67ce10cb11e460364ac2e751a6fa45707eaf1a89d1'
### authtag: '89c36c6284275be3763efdf0bce7dc65'
### authtag: '89c36c6284275be3763efdf0bce7dc65'
### cipherinfo: '834a313631363737313737385089c36c6284275be3763efdf0bce7dc65582f7c869854f5b66b636f44073072bceb2af74cda6c095a51f9f1db67ce10cb11e460364ac2e751a6fa45707eaf1a89d1'
### cipherinfo: '834a313631363737313737385089c36c6284275be3763efdf0bce7dc65582f7c869854f5b66b636f44073072bceb2af74cda6c095a51f9f1db67ce10cb11e460364ac2e751a6fa45707eaf1a89d1'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '9701fbc221d4af460d9e696ef9ce096f8461add80d702193e1e645785804e7b6'
### key: '9701fbc221d4af460d9e696ef9ce096f8461add80d702193e1e645785804e7b6'
### iv: '42a3931ae2c5b64b16f37cbd'
### iv: '42a3931ae2c5b64b16f37cbd'
### aad: '53305fdb838acc711076dc0833791046cee3d5a8eec1e43de5e1d37d594afc83'
### aad: '53305fdb838acc711076dc0833791046cee3d5a8eec1e43de5e1d37d594afc83'
### cipherinfo: '834a313631363737313737385089c36c6284275be3763efdf0bce7dc65582f7c869854f5b66b636f44073072bceb2af74cda6c095a51f9f1db67ce10cb11e460364ac2e751a6fa45707eaf1a89d1'
### cipherinfo: '834a313631363737313737385089c36c6284275be3763efdf0bce7dc65582f7c869854f5b66b636f44073072bceb2af74cda6c095a51f9f1db67ce10cb11e460364ac2e751a6fa45707eaf1a89d1'
### time: '31363136373731373738'
### time: '31363136373731373738'
### iv_xor: '7395a22cd5f2877c21cb7cbd'
### iv_xor: '7395a22cd5f2877c21cb7cbd'
### authtag: '89c36c6284275be3763efdf0bce7dc65'
### authtag: '89c36c6284275be3763efdf0bce7dc65'
### ciphertext: '7c869854f5b66b636f44073072bceb2af74cda6c095a51f9f1db67ce10cb11e460364ac2e751a6fa45707eaf1a89d1'
### ciphertext: '7c869854f5b66b636f44073072bceb2af74cda6c095a51f9f1db67ce10cb11e460364ac2e751a6fa45707eaf1a89d1'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'XX',
###                               'test_psk',
###                               1

### -----------end test --------: 'XX',
###                               'test_psk',
###                               1
