
### -----------start test --------: 'N',
###                                 undef,
###                                 undef

### -----------start test --------: 'N',
###                                 undef,
###                                 undef

### init a_hs

### init a_hs
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_N_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => "Noise_N_secp256r1_AESGCM_SHA256\0",
                                h  => pack("H*","5122d7db16f328beef51c179246347d527a4f4ba9233a649657fd8106764de06"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_N_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => "Noise_N_secp256r1_AESGCM_SHA256\0",
                                h  => pack("H*","5122d7db16f328beef51c179246347d527a4f4ba9233a649657fd8106764de06"),
                              },
    who                    => "a",
  },
)

### a send msg to b

### a send msg to b

### $a_msg_src: 'init.syn'

### $a_msg_src: 'init.syn'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '03208d459ede052dd6b96621fc6b5248ff262bc1e345f18b3e8b974aa43b3b4ae9'

### public compressed: '03208d459ede052dd6b96621fc6b5248ff262bc1e345f18b3e8b974aa43b3b4ae9'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEILCAAY2rVtrdYrnmNrWfBlLwS3j5/8H2d9cZs6U+vY2QoAoGCCqGSM49
',
###             'AwEHoUQDQgAEII1Fnt4FLda5ZiH8a1JI/yYrweNF8Ys+i5dKpDs7Sul37nQIj9Xy
',
###             'RC/g/xI8Nnpg2UR+k7F9kakW7Lek0fC7GQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEILCAAY2rVtrdYrnmNrWfBlLwS3j5/8H2d9cZs6U+vY2QoAoGCCqGSM49
',
###             'AwEHoUQDQgAEII1Fnt4FLda5ZiH8a1JI/yYrweNF8Ys+i5dKpDs7Sul37nQIj9Xy
',
###             'RC/g/xI8Nnpg2UR+k7F9kakW7Lek0fC7GQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '051422ad69dd4a1988ca9d3070dca4c5bd2c660f21c7855abd781fc8c593fc39'
### z: '051422ad69dd4a1988ca9d3070dca4c5bd2c660f21c7855abd781fc8c593fc39'

### noise encrypt

### noise encrypt
### key: '78ed675d03662ca588845de90950fc5843a5bb403d9f2f17e8d7d01da5dc0804'
### key: '78ed675d03662ca588845de90950fc5843a5bb403d9f2f17e8d7d01da5dc0804'
### iv: '7b7b9de2b4ef4306aa0f76f5'
### iv: '7b7b9de2b4ef4306aa0f76f5'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '4a4dacd48ddf77329b3b76f5'
### iv_xor: '4a4dacd48ddf77329b3b76f5'
### aad: 'ba13f7d9f979c8a0e007e29f7b80a7734a37568a5cc3cc831122a767ddc37429'
### aad: 'ba13f7d9f979c8a0e007e29f7b80a7734a37568a5cc3cc831122a767ddc37429'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '5eefb6473fd0f384'
### ciphertext: '5eefb6473fd0f384'
### authtag: 'df911f3e9c086a8ca70f4e6367879fb8'
### authtag: 'df911f3e9c086a8ca70f4e6367879fb8'
### cipherinfo: '834a3136313639303434313450df911f3e9c086a8ca70f4e6367879fb8485eefb6473fd0f384'
### cipherinfo: '834a3136313639303434313450df911f3e9c086a8ca70f4e6367879fb8485eefb6473fd0f384'

### a_msg: '82582103208d459ede052dd6b96621fc6b5248ff262bc1e345f18b3e8b974aa43b3b4ae95826834a3136313639303434313450df911f3e9c086a8ca70f4e6367879fb8485eefb6473fd0f384'

### a_msg: '82582103208d459ede052dd6b96621fc6b5248ff262bc1e345f18b3e8b974aa43b3b4ae95826834a3136313639303434313450df911f3e9c086a8ca70f4e6367879fb8485eefb6473fd0f384'
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03208d459ede052dd6b96621fc6b5248ff262bc1e345f18b3e8b974aa43b3b4ae9"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_N_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","88c8ae2ec7b71ff2b2ccb8042a5088dc2031b53ebb7f53a171f23c93b3f02f4e"),
                                h => pack("H*","ecf356e170d500c3dfabf09f79de71b2b67806ab45c40ea267a132b521783976"),
                                hasK => 1,
                                k => pack("H*","e3ea8faa79f969177b8294f9099d4df3460f4fa98bdfe3a5a6a0c8cebce9fe84"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","75e3fa5c5c2e540164e3da0c9af990baebced5e2d29dc93fe1ae59c3a8ba8483"),
  },
  {
    hasK => 1,
    k => pack("H*","bd6301aacfab39387b439f9ba55d4564b866aa04748b284aa1f242dd3380a222"),
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03208d459ede052dd6b96621fc6b5248ff262bc1e345f18b3e8b974aa43b3b4ae9"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_N_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","88c8ae2ec7b71ff2b2ccb8042a5088dc2031b53ebb7f53a171f23c93b3f02f4e"),
                                h => pack("H*","ecf356e170d500c3dfabf09f79de71b2b67806ab45c40ea267a132b521783976"),
                                hasK => 1,
                                k => pack("H*","e3ea8faa79f969177b8294f9099d4df3460f4fa98bdfe3a5a6a0c8cebce9fe84"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","75e3fa5c5c2e540164e3da0c9af990baebced5e2d29dc93fe1ae59c3a8ba8483"),
  },
  {
    hasK => 1,
    k => pack("H*","bd6301aacfab39387b439f9ba55d4564b866aa04748b284aa1f242dd3380a222"),
  },
)

### init b_hs

### init b_hs
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_N_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => "Noise_N_secp256r1_AESGCM_SHA256\0",
                                h  => pack("H*","5122d7db16f328beef51c179246347d527a4f4ba9233a649657fd8106764de06"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_N_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => "Noise_N_secp256r1_AESGCM_SHA256\0",
                                h  => pack("H*","5122d7db16f328beef51c179246347d527a4f4ba9233a649657fd8106764de06"),
                              },
    who                    => "b",
  },
)

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEII1Fnt4FLda5ZiH8a1JI/yYrweNF
',
###           '8Ys+i5dKpDs7Sul37nQIj9XyRC/g/xI8Nnpg2UR+k7F9kakW7Lek0fC7GQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEII1Fnt4FLda5ZiH8a1JI/yYrweNF
',
###           '8Ys+i5dKpDs7Sul37nQIj9XyRC/g/xI8Nnpg2UR+k7F9kakW7Lek0fC7GQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '051422ad69dd4a1988ca9d3070dca4c5bd2c660f21c7855abd781fc8c593fc39'
### z: '051422ad69dd4a1988ca9d3070dca4c5bd2c660f21c7855abd781fc8c593fc39'

### noise decrypt

### noise decrypt
### key: '78ed675d03662ca588845de90950fc5843a5bb403d9f2f17e8d7d01da5dc0804'
### key: '78ed675d03662ca588845de90950fc5843a5bb403d9f2f17e8d7d01da5dc0804'
### iv: '7b7b9de2b4ef4306aa0f76f5'
### iv: '7b7b9de2b4ef4306aa0f76f5'
### aad: 'ba13f7d9f979c8a0e007e29f7b80a7734a37568a5cc3cc831122a767ddc37429'
### aad: 'ba13f7d9f979c8a0e007e29f7b80a7734a37568a5cc3cc831122a767ddc37429'
### cipherinfo: '834a3136313639303434313450df911f3e9c086a8ca70f4e6367879fb8485eefb6473fd0f384'
### cipherinfo: '834a3136313639303434313450df911f3e9c086a8ca70f4e6367879fb8485eefb6473fd0f384'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '4a4dacd48ddf77329b3b76f5'
### iv_xor: '4a4dacd48ddf77329b3b76f5'
### authtag: 'df911f3e9c086a8ca70f4e6367879fb8'
### authtag: 'df911f3e9c086a8ca70f4e6367879fb8'
### ciphertext: '5eefb6473fd0f384'
### ciphertext: '5eefb6473fd0f384'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'

### b_recv_a_msg: 'init.syn'

### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_N_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","03208d459ede052dd6b96621fc6b5248ff262bc1e345f18b3e8b974aa43b3b4ae9"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","88c8ae2ec7b71ff2b2ccb8042a5088dc2031b53ebb7f53a171f23c93b3f02f4e"),
                                h => pack("H*","ecf356e170d500c3dfabf09f79de71b2b67806ab45c40ea267a132b521783976"),
                                hasK => 1,
                                k => pack("H*","e3ea8faa79f969177b8294f9099d4df3460f4fa98bdfe3a5a6a0c8cebce9fe84"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","75e3fa5c5c2e540164e3da0c9af990baebced5e2d29dc93fe1ae59c3a8ba8483"),
  },
  {
    hasK => 1,
    k => pack("H*","bd6301aacfab39387b439f9ba55d4564b866aa04748b284aa1f242dd3380a222"),
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_N_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","03208d459ede052dd6b96621fc6b5248ff262bc1e345f18b3e8b974aa43b3b4ae9"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","88c8ae2ec7b71ff2b2ccb8042a5088dc2031b53ebb7f53a171f23c93b3f02f4e"),
                                h => pack("H*","ecf356e170d500c3dfabf09f79de71b2b67806ab45c40ea267a132b521783976"),
                                hasK => 1,
                                k => pack("H*","e3ea8faa79f969177b8294f9099d4df3460f4fa98bdfe3a5a6a0c8cebce9fe84"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","75e3fa5c5c2e540164e3da0c9af990baebced5e2d29dc93fe1ae59c3a8ba8483"),
  },
  {
    hasK => 1,
    k => pack("H*","bd6301aacfab39387b439f9ba55d4564b866aa04748b284aa1f242dd3380a222"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: 'cd6c3b6dba2bb9ffae84d20e4b0cd06e2e87e23a3532b7e101cc904140a9caf4'
### key: 'cd6c3b6dba2bb9ffae84d20e4b0cd06e2e87e23a3532b7e101cc904140a9caf4'
### iv: 'a04c48b5795e1e4a8c5e6a33'
### iv: 'a04c48b5795e1e4a8c5e6a33'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '917a7983406e2a7ebd6a6a33'
### iv_xor: '917a7983406e2a7ebd6a6a33'
### aad: 'ecf356e170d500c3dfabf09f79de71b2b67806ab45c40ea267a132b521783976'
### aad: 'ecf356e170d500c3dfabf09f79de71b2b67806ab45c40ea267a132b521783976'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '6521e3722bc5b02401b86bd03c19abb3f032727f9a4394bd223af98394846e7b62321ed374fb373033b5391a49eebcf34e1548'
### ciphertext: '6521e3722bc5b02401b86bd03c19abb3f032727f9a4394bd223af98394846e7b62321ed374fb373033b5391a49eebcf34e1548'
### authtag: 'b68d316cc5c1a66347603e16ecb0f701'
### authtag: 'b68d316cc5c1a66347603e16ecb0f701'
### cipherinfo: '834a3136313639303434313450b68d316cc5c1a66347603e16ecb0f70158336521e3722bc5b02401b86bd03c19abb3f032727f9a4394bd223af98394846e7b62321ed374fb373033b5391a49eebcf34e1548'
### cipherinfo: '834a3136313639303434313450b68d316cc5c1a66347603e16ecb0f70158336521e3722bc5b02401b86bd03c19abb3f032727f9a4394bd223af98394846e7b62321ed374fb373033b5391a49eebcf34e1548'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: 'cd6c3b6dba2bb9ffae84d20e4b0cd06e2e87e23a3532b7e101cc904140a9caf4'
### key: 'cd6c3b6dba2bb9ffae84d20e4b0cd06e2e87e23a3532b7e101cc904140a9caf4'
### iv: 'a04c48b5795e1e4a8c5e6a33'
### iv: 'a04c48b5795e1e4a8c5e6a33'
### aad: 'ecf356e170d500c3dfabf09f79de71b2b67806ab45c40ea267a132b521783976'
### aad: 'ecf356e170d500c3dfabf09f79de71b2b67806ab45c40ea267a132b521783976'
### cipherinfo: '834a3136313639303434313450b68d316cc5c1a66347603e16ecb0f70158336521e3722bc5b02401b86bd03c19abb3f032727f9a4394bd223af98394846e7b62321ed374fb373033b5391a49eebcf34e1548'
### cipherinfo: '834a3136313639303434313450b68d316cc5c1a66347603e16ecb0f70158336521e3722bc5b02401b86bd03c19abb3f032727f9a4394bd223af98394846e7b62321ed374fb373033b5391a49eebcf34e1548'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '917a7983406e2a7ebd6a6a33'
### iv_xor: '917a7983406e2a7ebd6a6a33'
### authtag: 'b68d316cc5c1a66347603e16ecb0f701'
### authtag: 'b68d316cc5c1a66347603e16ecb0f701'
### ciphertext: '6521e3722bc5b02401b86bd03c19abb3f032727f9a4394bd223af98394846e7b62321ed374fb373033b5391a49eebcf34e1548'
### ciphertext: '6521e3722bc5b02401b86bd03c19abb3f032727f9a4394bd223af98394846e7b62321ed374fb373033b5391a49eebcf34e1548'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b send comm msg to a

### b send comm msg to a

### noise encrypt

### noise encrypt
### key: 'cd3b86a3759dbce2804774591030c659f487b85bf1f38a872e324c0f78f2451d'
### key: 'cd3b86a3759dbce2804774591030c659f487b85bf1f38a872e324c0f78f2451d'
### iv: '1116ccda4074fdf2a19e8d72'
### iv: '1116ccda4074fdf2a19e8d72'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '2020fdec7944c9c690aa8d72'
### iv_xor: '2020fdec7944c9c690aa8d72'
### aad: 'ecf356e170d500c3dfabf09f79de71b2b67806ab45c40ea267a132b521783976'
### aad: 'ecf356e170d500c3dfabf09f79de71b2b67806ab45c40ea267a132b521783976'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'c7528b410493f9521bceab48dfa389e0ff17d79d8c4ca27d139ee0c7a9a482af8028202462cac659011bb54fc43fb3'
### ciphertext: 'c7528b410493f9521bceab48dfa389e0ff17d79d8c4ca27d139ee0c7a9a482af8028202462cac659011bb54fc43fb3'
### authtag: '2f802846c033e48846da13f2809a4d84'
### authtag: '2f802846c033e48846da13f2809a4d84'
### cipherinfo: '834a31363136393034343134502f802846c033e48846da13f2809a4d84582fc7528b410493f9521bceab48dfa389e0ff17d79d8c4ca27d139ee0c7a9a482af8028202462cac659011bb54fc43fb3'
### cipherinfo: '834a31363136393034343134502f802846c033e48846da13f2809a4d84582fc7528b410493f9521bceab48dfa389e0ff17d79d8c4ca27d139ee0c7a9a482af8028202462cac659011bb54fc43fb3'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: 'cd3b86a3759dbce2804774591030c659f487b85bf1f38a872e324c0f78f2451d'
### key: 'cd3b86a3759dbce2804774591030c659f487b85bf1f38a872e324c0f78f2451d'
### iv: '1116ccda4074fdf2a19e8d72'
### iv: '1116ccda4074fdf2a19e8d72'
### aad: 'ecf356e170d500c3dfabf09f79de71b2b67806ab45c40ea267a132b521783976'
### aad: 'ecf356e170d500c3dfabf09f79de71b2b67806ab45c40ea267a132b521783976'
### cipherinfo: '834a31363136393034343134502f802846c033e48846da13f2809a4d84582fc7528b410493f9521bceab48dfa389e0ff17d79d8c4ca27d139ee0c7a9a482af8028202462cac659011bb54fc43fb3'
### cipherinfo: '834a31363136393034343134502f802846c033e48846da13f2809a4d84582fc7528b410493f9521bceab48dfa389e0ff17d79d8c4ca27d139ee0c7a9a482af8028202462cac659011bb54fc43fb3'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '2020fdec7944c9c690aa8d72'
### iv_xor: '2020fdec7944c9c690aa8d72'
### authtag: '2f802846c033e48846da13f2809a4d84'
### authtag: '2f802846c033e48846da13f2809a4d84'
### ciphertext: 'c7528b410493f9521bceab48dfa389e0ff17d79d8c4ca27d139ee0c7a9a482af8028202462cac659011bb54fc43fb3'
### ciphertext: 'c7528b410493f9521bceab48dfa389e0ff17d79d8c4ca27d139ee0c7a9a482af8028202462cac659011bb54fc43fb3'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'N',
###                               undef,
###                               undef

### -----------end test --------: 'N',
###                               undef,
###                               undef

### -----------start test --------: 'N',
###                                 'test_psk',
###                                 0

### -----------start test --------: 'N',
###                                 'test_psk',
###                                 0

### init a_hs

### init a_hs
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Npsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","80ba8731247a7e2307f2cadb33975afc5897a2e7e3d3eeee3471d9e40f9a6b2d"),
                                h  => pack("H*","edeeabd3d3407158ba6ae57fdcf4ec52115d19b97f4b4f98d0111c559653b457"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Npsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","80ba8731247a7e2307f2cadb33975afc5897a2e7e3d3eeee3471d9e40f9a6b2d"),
                                h  => pack("H*","edeeabd3d3407158ba6ae57fdcf4ec52115d19b97f4b4f98d0111c559653b457"),
                              },
    who                    => "a",
  },
)

### a send msg to b

### a send msg to b

### $a_msg_src: 'init.syn'

### $a_msg_src: 'init.syn'

### write message pattern: 'psk'

### write message pattern: 'psk'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '024f8fce5a51828e9192515464e145a2191055ca83958332334178a571d18dab6f'

### public compressed: '024f8fce5a51828e9192515464e145a2191055ca83958332334178a571d18dab6f'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDKtYf4FjB9EIdbR9gaaayjaL1v8buIDaOPkB+q/9fL8oAoGCCqGSM49
',
###             'AwEHoUQDQgAET4/OWlGCjpGSUVRk4UWiGRBVyoOVgzIzQXilcdGNq28kQfIYC9VB
',
###             'sEJxHwM5I8bQ/o1asLjiknagi80X9V2vJg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDKtYf4FjB9EIdbR9gaaayjaL1v8buIDaOPkB+q/9fL8oAoGCCqGSM49
',
###             'AwEHoUQDQgAET4/OWlGCjpGSUVRk4UWiGRBVyoOVgzIzQXilcdGNq28kQfIYC9VB
',
###             'sEJxHwM5I8bQ/o1asLjiknagi80X9V2vJg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '7d0a8cb8e050114d37d62eaf240fd90ffdaac2911da0e4b5aa8785351cd2d4b9'
### z: '7d0a8cb8e050114d37d62eaf240fd90ffdaac2911da0e4b5aa8785351cd2d4b9'

### noise encrypt

### noise encrypt
### key: '56f38399e39b1db1c15bba55804245d1bd5c05394596e613fc9d70a3857e644c'
### key: '56f38399e39b1db1c15bba55804245d1bd5c05394596e613fc9d70a3857e644c'
### iv: '2fcb319e7470dd2b973ec2b2'
### iv: '2fcb319e7470dd2b973ec2b2'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '1efd00a84d40e91fa60ac2b2'
### iv_xor: '1efd00a84d40e91fa60ac2b2'
### aad: '40fddc301f8617c84ec404c7d25e80491470c8e940f00e8766c736c608021e57'
### aad: '40fddc301f8617c84ec404c7d25e80491470c8e940f00e8766c736c608021e57'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: 'f9359e214a9cd2d3'
### ciphertext: 'f9359e214a9cd2d3'
### authtag: '021bd2401afe3fbb832a7e0c7f0cbc82'
### authtag: '021bd2401afe3fbb832a7e0c7f0cbc82'
### cipherinfo: '834a3136313639303434313450021bd2401afe3fbb832a7e0c7f0cbc8248f9359e214a9cd2d3'
### cipherinfo: '834a3136313639303434313450021bd2401afe3fbb832a7e0c7f0cbc8248f9359e214a9cd2d3'

### a_msg: '825821024f8fce5a51828e9192515464e145a2191055ca83958332334178a571d18dab6f5826834a3136313639303434313450021bd2401afe3fbb832a7e0c7f0cbc8248f9359e214a9cd2d3'

### a_msg: '825821024f8fce5a51828e9192515464e145a2191055ca83958332334178a571d18dab6f5826834a3136313639303434313450021bd2401afe3fbb832a7e0c7f0cbc8248f9359e214a9cd2d3'
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","024f8fce5a51828e9192515464e145a2191055ca83958332334178a571d18dab6f"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Npsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","636d9479832162e96a3404e4e904ef4ec9a0e4b9f802015753fc6a55e02b6c45"),
                                h => pack("H*","afae74c07b0aaf9d8907b0ec1d688815862aaa7fe1ebb996bfd23fb588cc0d45"),
                                hasK => 1,
                                k => pack("H*","cbaed7593a101a7c98deeae6d0e0abf6de5adc0003fcf860dc816ff588840628"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","882d5446c85acf454c94a48475cb1f675ac74d198a0279dd447c057c8852d73b"),
  },
  {
    hasK => 1,
    k => pack("H*","7fa531ec2c68cc7f81f01ba3d8fc89bd62cc4efd7b0ce050b221b5a2339eebb2"),
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","024f8fce5a51828e9192515464e145a2191055ca83958332334178a571d18dab6f"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Npsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","636d9479832162e96a3404e4e904ef4ec9a0e4b9f802015753fc6a55e02b6c45"),
                                h => pack("H*","afae74c07b0aaf9d8907b0ec1d688815862aaa7fe1ebb996bfd23fb588cc0d45"),
                                hasK => 1,
                                k => pack("H*","cbaed7593a101a7c98deeae6d0e0abf6de5adc0003fcf860dc816ff588840628"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","882d5446c85acf454c94a48475cb1f675ac74d198a0279dd447c057c8852d73b"),
  },
  {
    hasK => 1,
    k => pack("H*","7fa531ec2c68cc7f81f01ba3d8fc89bd62cc4efd7b0ce050b221b5a2339eebb2"),
  },
)

### init b_hs

### init b_hs
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Npsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","80ba8731247a7e2307f2cadb33975afc5897a2e7e3d3eeee3471d9e40f9a6b2d"),
                                h  => pack("H*","edeeabd3d3407158ba6ae57fdcf4ec52115d19b97f4b4f98d0111c559653b457"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Npsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","80ba8731247a7e2307f2cadb33975afc5897a2e7e3d3eeee3471d9e40f9a6b2d"),
                                h  => pack("H*","edeeabd3d3407158ba6ae57fdcf4ec52115d19b97f4b4f98d0111c559653b457"),
                              },
    who                    => "b",
  },
)

### b recv msg from a

### b recv msg from a

### read message pattern: 'psk'

### read message pattern: 'psk'

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAET4/OWlGCjpGSUVRk4UWiGRBVyoOV
',
###           'gzIzQXilcdGNq28kQfIYC9VBsEJxHwM5I8bQ/o1asLjiknagi80X9V2vJg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAET4/OWlGCjpGSUVRk4UWiGRBVyoOV
',
###           'gzIzQXilcdGNq28kQfIYC9VBsEJxHwM5I8bQ/o1asLjiknagi80X9V2vJg==
',
###           '-----END PUBLIC KEY-----
'
### z: '7d0a8cb8e050114d37d62eaf240fd90ffdaac2911da0e4b5aa8785351cd2d4b9'
### z: '7d0a8cb8e050114d37d62eaf240fd90ffdaac2911da0e4b5aa8785351cd2d4b9'

### noise decrypt

### noise decrypt
### key: '56f38399e39b1db1c15bba55804245d1bd5c05394596e613fc9d70a3857e644c'
### key: '56f38399e39b1db1c15bba55804245d1bd5c05394596e613fc9d70a3857e644c'
### iv: '2fcb319e7470dd2b973ec2b2'
### iv: '2fcb319e7470dd2b973ec2b2'
### aad: '40fddc301f8617c84ec404c7d25e80491470c8e940f00e8766c736c608021e57'
### aad: '40fddc301f8617c84ec404c7d25e80491470c8e940f00e8766c736c608021e57'
### cipherinfo: '834a3136313639303434313450021bd2401afe3fbb832a7e0c7f0cbc8248f9359e214a9cd2d3'
### cipherinfo: '834a3136313639303434313450021bd2401afe3fbb832a7e0c7f0cbc8248f9359e214a9cd2d3'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '1efd00a84d40e91fa60ac2b2'
### iv_xor: '1efd00a84d40e91fa60ac2b2'
### authtag: '021bd2401afe3fbb832a7e0c7f0cbc82'
### authtag: '021bd2401afe3fbb832a7e0c7f0cbc82'
### ciphertext: 'f9359e214a9cd2d3'
### ciphertext: 'f9359e214a9cd2d3'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'

### b_recv_a_msg: 'init.syn'

### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Npsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","024f8fce5a51828e9192515464e145a2191055ca83958332334178a571d18dab6f"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","636d9479832162e96a3404e4e904ef4ec9a0e4b9f802015753fc6a55e02b6c45"),
                                h => pack("H*","afae74c07b0aaf9d8907b0ec1d688815862aaa7fe1ebb996bfd23fb588cc0d45"),
                                hasK => 1,
                                k => pack("H*","cbaed7593a101a7c98deeae6d0e0abf6de5adc0003fcf860dc816ff588840628"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","882d5446c85acf454c94a48475cb1f675ac74d198a0279dd447c057c8852d73b"),
  },
  {
    hasK => 1,
    k => pack("H*","7fa531ec2c68cc7f81f01ba3d8fc89bd62cc4efd7b0ce050b221b5a2339eebb2"),
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Npsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","024f8fce5a51828e9192515464e145a2191055ca83958332334178a571d18dab6f"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","636d9479832162e96a3404e4e904ef4ec9a0e4b9f802015753fc6a55e02b6c45"),
                                h => pack("H*","afae74c07b0aaf9d8907b0ec1d688815862aaa7fe1ebb996bfd23fb588cc0d45"),
                                hasK => 1,
                                k => pack("H*","cbaed7593a101a7c98deeae6d0e0abf6de5adc0003fcf860dc816ff588840628"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","882d5446c85acf454c94a48475cb1f675ac74d198a0279dd447c057c8852d73b"),
  },
  {
    hasK => 1,
    k => pack("H*","7fa531ec2c68cc7f81f01ba3d8fc89bd62cc4efd7b0ce050b221b5a2339eebb2"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: 'ecbb9a95016cf9b43293479447c38c1fd12718ad1a85ebd3a3039b204a9d4952'
### key: 'ecbb9a95016cf9b43293479447c38c1fd12718ad1a85ebd3a3039b204a9d4952'
### iv: '615cbbdb407b4554d85fdffe'
### iv: '615cbbdb407b4554d85fdffe'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '506a8aed794b7160e96bdffe'
### iv_xor: '506a8aed794b7160e96bdffe'
### aad: 'afae74c07b0aaf9d8907b0ec1d688815862aaa7fe1ebb996bfd23fb588cc0d45'
### aad: 'afae74c07b0aaf9d8907b0ec1d688815862aaa7fe1ebb996bfd23fb588cc0d45'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'a859aa003b9e7e508ac8856abdca77307fbd65f06cb5ae53742679d11927ba7700cb06e81165beb3f7e26755acc874121f73b3'
### ciphertext: 'a859aa003b9e7e508ac8856abdca77307fbd65f06cb5ae53742679d11927ba7700cb06e81165beb3f7e26755acc874121f73b3'
### authtag: '4947fa0f49ab862e7dffaa34f068560c'
### authtag: '4947fa0f49ab862e7dffaa34f068560c'
### cipherinfo: '834a31363136393034343134504947fa0f49ab862e7dffaa34f068560c5833a859aa003b9e7e508ac8856abdca77307fbd65f06cb5ae53742679d11927ba7700cb06e81165beb3f7e26755acc874121f73b3'
### cipherinfo: '834a31363136393034343134504947fa0f49ab862e7dffaa34f068560c5833a859aa003b9e7e508ac8856abdca77307fbd65f06cb5ae53742679d11927ba7700cb06e81165beb3f7e26755acc874121f73b3'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: 'ecbb9a95016cf9b43293479447c38c1fd12718ad1a85ebd3a3039b204a9d4952'
### key: 'ecbb9a95016cf9b43293479447c38c1fd12718ad1a85ebd3a3039b204a9d4952'
### iv: '615cbbdb407b4554d85fdffe'
### iv: '615cbbdb407b4554d85fdffe'
### aad: 'afae74c07b0aaf9d8907b0ec1d688815862aaa7fe1ebb996bfd23fb588cc0d45'
### aad: 'afae74c07b0aaf9d8907b0ec1d688815862aaa7fe1ebb996bfd23fb588cc0d45'
### cipherinfo: '834a31363136393034343134504947fa0f49ab862e7dffaa34f068560c5833a859aa003b9e7e508ac8856abdca77307fbd65f06cb5ae53742679d11927ba7700cb06e81165beb3f7e26755acc874121f73b3'
### cipherinfo: '834a31363136393034343134504947fa0f49ab862e7dffaa34f068560c5833a859aa003b9e7e508ac8856abdca77307fbd65f06cb5ae53742679d11927ba7700cb06e81165beb3f7e26755acc874121f73b3'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '506a8aed794b7160e96bdffe'
### iv_xor: '506a8aed794b7160e96bdffe'
### authtag: '4947fa0f49ab862e7dffaa34f068560c'
### authtag: '4947fa0f49ab862e7dffaa34f068560c'
### ciphertext: 'a859aa003b9e7e508ac8856abdca77307fbd65f06cb5ae53742679d11927ba7700cb06e81165beb3f7e26755acc874121f73b3'
### ciphertext: 'a859aa003b9e7e508ac8856abdca77307fbd65f06cb5ae53742679d11927ba7700cb06e81165beb3f7e26755acc874121f73b3'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b send comm msg to a

### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '5b29621c4bbd4dbd7b5171cec0ece3c7c87ff222c8cce64fac8cd376ee6470a3'
### key: '5b29621c4bbd4dbd7b5171cec0ece3c7c87ff222c8cce64fac8cd376ee6470a3'
### iv: '8b151c06108d64daf9854929'
### iv: '8b151c06108d64daf9854929'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'ba232d3029bd50eec8b14929'
### iv_xor: 'ba232d3029bd50eec8b14929'
### aad: 'afae74c07b0aaf9d8907b0ec1d688815862aaa7fe1ebb996bfd23fb588cc0d45'
### aad: 'afae74c07b0aaf9d8907b0ec1d688815862aaa7fe1ebb996bfd23fb588cc0d45'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'f6b73dc6cd95128b6f8066ae099a241bb39da61d97a3bd88290e996f6e1e77a5c167c7406f5eac851b205bb90dc76f'
### ciphertext: 'f6b73dc6cd95128b6f8066ae099a241bb39da61d97a3bd88290e996f6e1e77a5c167c7406f5eac851b205bb90dc76f'
### authtag: 'a38890294bea7905fe6d9b63c2c26edb'
### authtag: 'a38890294bea7905fe6d9b63c2c26edb'
### cipherinfo: '834a3136313639303434313450a38890294bea7905fe6d9b63c2c26edb582ff6b73dc6cd95128b6f8066ae099a241bb39da61d97a3bd88290e996f6e1e77a5c167c7406f5eac851b205bb90dc76f'
### cipherinfo: '834a3136313639303434313450a38890294bea7905fe6d9b63c2c26edb582ff6b73dc6cd95128b6f8066ae099a241bb39da61d97a3bd88290e996f6e1e77a5c167c7406f5eac851b205bb90dc76f'


### a recv comm msg from b
### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '5b29621c4bbd4dbd7b5171cec0ece3c7c87ff222c8cce64fac8cd376ee6470a3'
### key: '5b29621c4bbd4dbd7b5171cec0ece3c7c87ff222c8cce64fac8cd376ee6470a3'
### iv: '8b151c06108d64daf9854929'
### iv: '8b151c06108d64daf9854929'
### aad: 'afae74c07b0aaf9d8907b0ec1d688815862aaa7fe1ebb996bfd23fb588cc0d45'
### aad: 'afae74c07b0aaf9d8907b0ec1d688815862aaa7fe1ebb996bfd23fb588cc0d45'
### cipherinfo: '834a3136313639303434313450a38890294bea7905fe6d9b63c2c26edb582ff6b73dc6cd95128b6f8066ae099a241bb39da61d97a3bd88290e996f6e1e77a5c167c7406f5eac851b205bb90dc76f'
### cipherinfo: '834a3136313639303434313450a38890294bea7905fe6d9b63c2c26edb582ff6b73dc6cd95128b6f8066ae099a241bb39da61d97a3bd88290e996f6e1e77a5c167c7406f5eac851b205bb90dc76f'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'ba232d3029bd50eec8b14929'
### iv_xor: 'ba232d3029bd50eec8b14929'
### authtag: 'a38890294bea7905fe6d9b63c2c26edb'
### authtag: 'a38890294bea7905fe6d9b63c2c26edb'
### ciphertext: 'f6b73dc6cd95128b6f8066ae099a241bb39da61d97a3bd88290e996f6e1e77a5c167c7406f5eac851b205bb90dc76f'
### ciphertext: 'f6b73dc6cd95128b6f8066ae099a241bb39da61d97a3bd88290e996f6e1e77a5c167c7406f5eac851b205bb90dc76f'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'N',
###                               'test_psk',
###                               0

### -----------end test --------: 'N',
###                               'test_psk',
###                               0

### -----------start test --------: 'N',
###                                 'test_psk',
###                                 1

### -----------start test --------: 'N',
###                                 'test_psk',
###                                 1

### init a_hs

### init a_hs
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "psk"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Npsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","5b5ba9531f6781ac7fea3df8dba4290d0131906b9be3312a7e71db656d0118b8"),
                                h  => pack("H*","0d1cca270f8fe51b0ab1960aabbe9ba8c8d55a00beeeaf899a7c4494f6944e19"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "psk"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Npsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","5b5ba9531f6781ac7fea3df8dba4290d0131906b9be3312a7e71db656d0118b8"),
                                h  => pack("H*","0d1cca270f8fe51b0ab1960aabbe9ba8c8d55a00beeeaf899a7c4494f6944e19"),
                              },
    who                    => "a",
  },
)

### a send msg to b

### a send msg to b

### $a_msg_src: 'init.syn'

### $a_msg_src: 'init.syn'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '03814f927ab06092037f855aa2bc21d30c8387a98df6e70ad55b1bc7787c5568bd'

### public compressed: '03814f927ab06092037f855aa2bc21d30c8387a98df6e70ad55b1bc7787c5568bd'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIA6/X2AU4KE4nxptTrnftXbxUXFVsZvEP9X3N4o9HKQFoAoGCCqGSM49
',
###             'AwEHoUQDQgAEgU+SerBgkgN/hVqivCHTDIOHqY325wrVWxvHeHxVaL0PkKntOrQw
',
###             'SgpzPf7BjDSS2YwLpX9bHN2em+MoLYAopQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIA6/X2AU4KE4nxptTrnftXbxUXFVsZvEP9X3N4o9HKQFoAoGCCqGSM49
',
###             'AwEHoUQDQgAEgU+SerBgkgN/hVqivCHTDIOHqY325wrVWxvHeHxVaL0PkKntOrQw
',
###             'SgpzPf7BjDSS2YwLpX9bHN2em+MoLYAopQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '4585773401c0228d90f82cb496e0df33d0d2aca5f925c5344eebac104de6b597'
### z: '4585773401c0228d90f82cb496e0df33d0d2aca5f925c5344eebac104de6b597'

### write message pattern: 'psk'

### write message pattern: 'psk'

### noise encrypt

### noise encrypt
### key: '66508e62f8ed8b63c1a2267ac0e1e02ed42a13debb63db191be4ac4416ff9e88'
### key: '66508e62f8ed8b63c1a2267ac0e1e02ed42a13debb63db191be4ac4416ff9e88'
### iv: 'b44878af4294f8dd803d874b'
### iv: 'b44878af4294f8dd803d874b'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '857e49997ba4cce9b109874b'
### iv_xor: '857e49997ba4cce9b109874b'
### aad: 'cf83c79287a21c11d8f877256db7a5c7d7a924fd6379c68453cd87ea1f9ef11e'
### aad: 'cf83c79287a21c11d8f877256db7a5c7d7a924fd6379c68453cd87ea1f9ef11e'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '3e56fe1b7e2f4cab'
### ciphertext: '3e56fe1b7e2f4cab'
### authtag: '50d99890a072591d5d56b2a1eef147c1'
### authtag: '50d99890a072591d5d56b2a1eef147c1'
### cipherinfo: '834a313631363930343431345050d99890a072591d5d56b2a1eef147c1483e56fe1b7e2f4cab'
### cipherinfo: '834a313631363930343431345050d99890a072591d5d56b2a1eef147c1483e56fe1b7e2f4cab'

### a_msg: '82582103814f927ab06092037f855aa2bc21d30c8387a98df6e70ad55b1bc7787c5568bd5826834a313631363930343431345050d99890a072591d5d56b2a1eef147c1483e56fe1b7e2f4cab'

### a_msg: '82582103814f927ab06092037f855aa2bc21d30c8387a98df6e70ad55b1bc7787c5568bd5826834a313631363930343431345050d99890a072591d5d56b2a1eef147c1483e56fe1b7e2f4cab'
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03814f927ab06092037f855aa2bc21d30c8387a98df6e70ad55b1bc7787c5568bd"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "psk"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Npsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","220982b4fb4f1c85cd1f42d64b0d4aa117aaa50973a2c2ebd53d2b59e39f35c8"),
                                h => pack("H*","a5e4bc7329a59f9a0648d0e2e6e05a8819348e80552c96c05277708e1dd54b9d"),
                                hasK => 1,
                                k => pack("H*","a8344064e28af8e9a63c3bb7688527359227acc9ff13b6f15e645c0573da74d3"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","770aec01b8dee460e658cd835acc0184f1f90aa679fe2e00cbfd898db4cf9d7c"),
  },
  {
    hasK => 1,
    k => pack("H*","7dd6efd286d828c5715d9b1d58d09f656b196877a88bb455fa2595807f3de230"),
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03814f927ab06092037f855aa2bc21d30c8387a98df6e70ad55b1bc7787c5568bd"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "psk"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Npsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","220982b4fb4f1c85cd1f42d64b0d4aa117aaa50973a2c2ebd53d2b59e39f35c8"),
                                h => pack("H*","a5e4bc7329a59f9a0648d0e2e6e05a8819348e80552c96c05277708e1dd54b9d"),
                                hasK => 1,
                                k => pack("H*","a8344064e28af8e9a63c3bb7688527359227acc9ff13b6f15e645c0573da74d3"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","770aec01b8dee460e658cd835acc0184f1f90aa679fe2e00cbfd898db4cf9d7c"),
  },
  {
    hasK => 1,
    k => pack("H*","7dd6efd286d828c5715d9b1d58d09f656b196877a88bb455fa2595807f3de230"),
  },
)

### init b_hs

### init b_hs
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "psk"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Npsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","5b5ba9531f6781ac7fea3df8dba4290d0131906b9be3312a7e71db656d0118b8"),
                                h  => pack("H*","0d1cca270f8fe51b0ab1960aabbe9ba8c8d55a00beeeaf899a7c4494f6944e19"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "psk"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Npsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","5b5ba9531f6781ac7fea3df8dba4290d0131906b9be3312a7e71db656d0118b8"),
                                h  => pack("H*","0d1cca270f8fe51b0ab1960aabbe9ba8c8d55a00beeeaf899a7c4494f6944e19"),
                              },
    who                    => "b",
  },
)

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEgU+SerBgkgN/hVqivCHTDIOHqY32
',
###           '5wrVWxvHeHxVaL0PkKntOrQwSgpzPf7BjDSS2YwLpX9bHN2em+MoLYAopQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEgU+SerBgkgN/hVqivCHTDIOHqY32
',
###           '5wrVWxvHeHxVaL0PkKntOrQwSgpzPf7BjDSS2YwLpX9bHN2em+MoLYAopQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '4585773401c0228d90f82cb496e0df33d0d2aca5f925c5344eebac104de6b597'
### z: '4585773401c0228d90f82cb496e0df33d0d2aca5f925c5344eebac104de6b597'

### read message pattern: 'psk'

### read message pattern: 'psk'

### noise decrypt

### noise decrypt
### key: '66508e62f8ed8b63c1a2267ac0e1e02ed42a13debb63db191be4ac4416ff9e88'
### key: '66508e62f8ed8b63c1a2267ac0e1e02ed42a13debb63db191be4ac4416ff9e88'
### iv: 'b44878af4294f8dd803d874b'
### iv: 'b44878af4294f8dd803d874b'
### aad: 'cf83c79287a21c11d8f877256db7a5c7d7a924fd6379c68453cd87ea1f9ef11e'
### aad: 'cf83c79287a21c11d8f877256db7a5c7d7a924fd6379c68453cd87ea1f9ef11e'
### cipherinfo: '834a313631363930343431345050d99890a072591d5d56b2a1eef147c1483e56fe1b7e2f4cab'
### cipherinfo: '834a313631363930343431345050d99890a072591d5d56b2a1eef147c1483e56fe1b7e2f4cab'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '857e49997ba4cce9b109874b'
### iv_xor: '857e49997ba4cce9b109874b'
### authtag: '50d99890a072591d5d56b2a1eef147c1'
### authtag: '50d99890a072591d5d56b2a1eef147c1'
### ciphertext: '3e56fe1b7e2f4cab'
### ciphertext: '3e56fe1b7e2f4cab'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'


### b_recv_a_msg: 'init.syn'
### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "psk"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Npsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","03814f927ab06092037f855aa2bc21d30c8387a98df6e70ad55b1bc7787c5568bd"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","220982b4fb4f1c85cd1f42d64b0d4aa117aaa50973a2c2ebd53d2b59e39f35c8"),
                                h => pack("H*","a5e4bc7329a59f9a0648d0e2e6e05a8819348e80552c96c05277708e1dd54b9d"),
                                hasK => 1,
                                k => pack("H*","a8344064e28af8e9a63c3bb7688527359227acc9ff13b6f15e645c0573da74d3"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","770aec01b8dee460e658cd835acc0184f1f90aa679fe2e00cbfd898db4cf9d7c"),
  },
  {
    hasK => 1,
    k => pack("H*","7dd6efd286d828c5715d9b1d58d09f656b196877a88bb455fa2595807f3de230"),
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "N",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "psk"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Npsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","03814f927ab06092037f855aa2bc21d30c8387a98df6e70ad55b1bc7787c5568bd"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","220982b4fb4f1c85cd1f42d64b0d4aa117aaa50973a2c2ebd53d2b59e39f35c8"),
                                h => pack("H*","a5e4bc7329a59f9a0648d0e2e6e05a8819348e80552c96c05277708e1dd54b9d"),
                                hasK => 1,
                                k => pack("H*","a8344064e28af8e9a63c3bb7688527359227acc9ff13b6f15e645c0573da74d3"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","770aec01b8dee460e658cd835acc0184f1f90aa679fe2e00cbfd898db4cf9d7c"),
  },
  {
    hasK => 1,
    k => pack("H*","7dd6efd286d828c5715d9b1d58d09f656b196877a88bb455fa2595807f3de230"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '330fd9c8ed008a4e1d6bc5ea3e990fb6014f3b53310fe430a10068b9ed59fc29'
### key: '330fd9c8ed008a4e1d6bc5ea3e990fb6014f3b53310fe430a10068b9ed59fc29'
### iv: 'a8f2b6b45c9c9f79b4ddd994'
### iv: 'a8f2b6b45c9c9f79b4ddd994'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '99c4878265acab4d85e9d994'
### iv_xor: '99c4878265acab4d85e9d994'
### aad: 'a5e4bc7329a59f9a0648d0e2e6e05a8819348e80552c96c05277708e1dd54b9d'
### aad: 'a5e4bc7329a59f9a0648d0e2e6e05a8819348e80552c96c05277708e1dd54b9d'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '15342ce64f6abd55f9d0aa2d99cb59e0c513d9fdf6e318d61c5c1b05bc82d15e6dbb95e73267f35d7289909be09b3eb137428e'
### ciphertext: '15342ce64f6abd55f9d0aa2d99cb59e0c513d9fdf6e318d61c5c1b05bc82d15e6dbb95e73267f35d7289909be09b3eb137428e'
### authtag: '9c71458a78e28bef5f26747b2ff8af0e'
### authtag: '9c71458a78e28bef5f26747b2ff8af0e'
### cipherinfo: '834a31363136393034343134509c71458a78e28bef5f26747b2ff8af0e583315342ce64f6abd55f9d0aa2d99cb59e0c513d9fdf6e318d61c5c1b05bc82d15e6dbb95e73267f35d7289909be09b3eb137428e'
### cipherinfo: '834a31363136393034343134509c71458a78e28bef5f26747b2ff8af0e583315342ce64f6abd55f9d0aa2d99cb59e0c513d9fdf6e318d61c5c1b05bc82d15e6dbb95e73267f35d7289909be09b3eb137428e'


### b recv comm msg from a
### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: '330fd9c8ed008a4e1d6bc5ea3e990fb6014f3b53310fe430a10068b9ed59fc29'
### key: '330fd9c8ed008a4e1d6bc5ea3e990fb6014f3b53310fe430a10068b9ed59fc29'
### iv: 'a8f2b6b45c9c9f79b4ddd994'
### iv: 'a8f2b6b45c9c9f79b4ddd994'
### aad: 'a5e4bc7329a59f9a0648d0e2e6e05a8819348e80552c96c05277708e1dd54b9d'
### aad: 'a5e4bc7329a59f9a0648d0e2e6e05a8819348e80552c96c05277708e1dd54b9d'
### cipherinfo: '834a31363136393034343134509c71458a78e28bef5f26747b2ff8af0e583315342ce64f6abd55f9d0aa2d99cb59e0c513d9fdf6e318d61c5c1b05bc82d15e6dbb95e73267f35d7289909be09b3eb137428e'
### cipherinfo: '834a31363136393034343134509c71458a78e28bef5f26747b2ff8af0e583315342ce64f6abd55f9d0aa2d99cb59e0c513d9fdf6e318d61c5c1b05bc82d15e6dbb95e73267f35d7289909be09b3eb137428e'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '99c4878265acab4d85e9d994'
### iv_xor: '99c4878265acab4d85e9d994'
### authtag: '9c71458a78e28bef5f26747b2ff8af0e'
### authtag: '9c71458a78e28bef5f26747b2ff8af0e'
### ciphertext: '15342ce64f6abd55f9d0aa2d99cb59e0c513d9fdf6e318d61c5c1b05bc82d15e6dbb95e73267f35d7289909be09b3eb137428e'
### ciphertext: '15342ce64f6abd55f9d0aa2d99cb59e0c513d9fdf6e318d61c5c1b05bc82d15e6dbb95e73267f35d7289909be09b3eb137428e'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'


### b send comm msg to a
### b send comm msg to a


### noise encrypt
### noise encrypt
### key: '570a02fcb409fd718740fce47c60004f8dca13a9eef56fc2b8447f174a699d55'
### key: '570a02fcb409fd718740fce47c60004f8dca13a9eef56fc2b8447f174a699d55'
### iv: '3adc1f97996ef90cc19fd081'
### iv: '3adc1f97996ef90cc19fd081'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '0bea2ea1a05ecd38f0abd081'
### iv_xor: '0bea2ea1a05ecd38f0abd081'
### aad: 'a5e4bc7329a59f9a0648d0e2e6e05a8819348e80552c96c05277708e1dd54b9d'
### aad: 'a5e4bc7329a59f9a0648d0e2e6e05a8819348e80552c96c05277708e1dd54b9d'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '4031d48c8efef3b1332cd9738a73cfd0a42cf8981240cbbb56d93a715a9f27d746b6807bf145cd583d780d66bd6e94'
### ciphertext: '4031d48c8efef3b1332cd9738a73cfd0a42cf8981240cbbb56d93a715a9f27d746b6807bf145cd583d780d66bd6e94'
### authtag: '5dfd18d977965343e81914793c2bf0d1'
### authtag: '5dfd18d977965343e81914793c2bf0d1'
### cipherinfo: '834a31363136393034343134505dfd18d977965343e81914793c2bf0d1582f4031d48c8efef3b1332cd9738a73cfd0a42cf8981240cbbb56d93a715a9f27d746b6807bf145cd583d780d66bd6e94'
### cipherinfo: '834a31363136393034343134505dfd18d977965343e81914793c2bf0d1582f4031d48c8efef3b1332cd9738a73cfd0a42cf8981240cbbb56d93a715a9f27d746b6807bf145cd583d780d66bd6e94'


### a recv comm msg from b
### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '570a02fcb409fd718740fce47c60004f8dca13a9eef56fc2b8447f174a699d55'
### key: '570a02fcb409fd718740fce47c60004f8dca13a9eef56fc2b8447f174a699d55'
### iv: '3adc1f97996ef90cc19fd081'
### iv: '3adc1f97996ef90cc19fd081'
### aad: 'a5e4bc7329a59f9a0648d0e2e6e05a8819348e80552c96c05277708e1dd54b9d'
### aad: 'a5e4bc7329a59f9a0648d0e2e6e05a8819348e80552c96c05277708e1dd54b9d'
### cipherinfo: '834a31363136393034343134505dfd18d977965343e81914793c2bf0d1582f4031d48c8efef3b1332cd9738a73cfd0a42cf8981240cbbb56d93a715a9f27d746b6807bf145cd583d780d66bd6e94'
### cipherinfo: '834a31363136393034343134505dfd18d977965343e81914793c2bf0d1582f4031d48c8efef3b1332cd9738a73cfd0a42cf8981240cbbb56d93a715a9f27d746b6807bf145cd583d780d66bd6e94'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '0bea2ea1a05ecd38f0abd081'
### iv_xor: '0bea2ea1a05ecd38f0abd081'
### authtag: '5dfd18d977965343e81914793c2bf0d1'
### authtag: '5dfd18d977965343e81914793c2bf0d1'
### ciphertext: '4031d48c8efef3b1332cd9738a73cfd0a42cf8981240cbbb56d93a715a9f27d746b6807bf145cd583d780d66bd6e94'
### ciphertext: '4031d48c8efef3b1332cd9738a73cfd0a42cf8981240cbbb56d93a715a9f27d746b6807bf145cd583d780d66bd6e94'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'N',
###                               'test_psk',
###                               1
### -----------end test --------: 'N',
###                               'test_psk',
###                               1


### -----------start test --------: 'K',
###                                 undef,
###                                 undef
### -----------start test --------: 'K',
###                                 undef,
###                                 undef

### init a_hs

### init a_hs
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_K_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => "Noise_K_secp256r1_AESGCM_SHA256\0",
                                h  => pack("H*","3f41c8dbd0856fb6cb1966bb7bdaa1be23523534651f850a5c232f38fc8a25c8"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_K_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => "Noise_K_secp256r1_AESGCM_SHA256\0",
                                h  => pack("H*","3f41c8dbd0856fb6cb1966bb7bdaa1be23523534651f850a5c232f38fc8a25c8"),
                              },
    who                    => "a",
  },
)

### a send msg to b

### a send msg to b


### $a_msg_src: 'init.syn'
### $a_msg_src: 'init.syn'


### write message pattern: 'e'
### write message pattern: 'e'

### public compressed: '039f97ae2783e2a03e162a3a31de558ff65b05951e73f1fce011346c667b3ee2b1'

### public compressed: '039f97ae2783e2a03e162a3a31de558ff65b05951e73f1fce011346c667b3ee2b1'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIKDRPxcyIQc6XpDS4GtxVdlUKRGfiO7VZOsoLkrMOlZMoAoGCCqGSM49
',
###             'AwEHoUQDQgAEn5euJ4PioD4WKjox3lWP9lsFlR5z8fzgETRsZns+4rHZeN+sgQlT
',
###             'gZBPbwZ/98xKef/UEEPb4U72cxJw3jSSuw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIKDRPxcyIQc6XpDS4GtxVdlUKRGfiO7VZOsoLkrMOlZMoAoGCCqGSM49
',
###             'AwEHoUQDQgAEn5euJ4PioD4WKjox3lWP9lsFlR5z8fzgETRsZns+4rHZeN+sgQlT
',
###             'gZBPbwZ/98xKef/UEEPb4U72cxJw3jSSuw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'c4c7b6521a5953c002bb99c50306b02d91e338229a8f0266ee2e9bb9181c4ec3'
### z: 'c4c7b6521a5953c002bb99c50306b02d91e338229a8f0266ee2e9bb9181c4ec3'

### write message pattern: 'ss'

### write message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### noise encrypt
### noise encrypt
### key: '8fab4e5d8fb9d55d8bbbefd1d355e41552ed7c4327cd0908587e01b1ed03397d'
### key: '8fab4e5d8fb9d55d8bbbefd1d355e41552ed7c4327cd0908587e01b1ed03397d'
### iv: 'a22bbaf7bad5b9a0d7673537'
### iv: 'a22bbaf7bad5b9a0d7673537'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '931d8bc183e58d94e6533537'
### iv_xor: '931d8bc183e58d94e6533537'
### aad: 'ec497ca2716b5dd23329fbb4cb5b1172afda976561a950993bff26cfed3e23c4'
### aad: 'ec497ca2716b5dd23329fbb4cb5b1172afda976561a950993bff26cfed3e23c4'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '0fbc7c669dac936c'
### ciphertext: '0fbc7c669dac936c'
### authtag: '8128b80f87cd981873a5671c7713a4b7'
### authtag: '8128b80f87cd981873a5671c7713a4b7'
### cipherinfo: '834a31363136393034343134508128b80f87cd981873a5671c7713a4b7480fbc7c669dac936c'
### cipherinfo: '834a31363136393034343134508128b80f87cd981873a5671c7713a4b7480fbc7c669dac936c'


### a_msg: '825821039f97ae2783e2a03e162a3a31de558ff65b05951e73f1fce011346c667b3ee2b15826834a31363136393034343134508128b80f87cd981873a5671c7713a4b7480fbc7c669dac936c'
### a_msg: '825821039f97ae2783e2a03e162a3a31de558ff65b05951e73f1fce011346c667b3ee2b15826834a31363136393034343134508128b80f87cd981873a5671c7713a4b7480fbc7c669dac936c'
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","039f97ae2783e2a03e162a3a31de558ff65b05951e73f1fce011346c667b3ee2b1"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_K_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","ee3967af25bd5451b83c130444de7499d1c33660e8bc16dcb15be52fff791dbc"),
                                h => pack("H*","c28ee9514b75de0ce377014a077d0e631a2f7779f01d2bbedb0562eb65d79172"),
                                hasK => 1,
                                k => pack("H*","5d235d9045dad5172ca7596c608a03c9389c4c86c474de5f5cc55a379d695862"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","b2e1c64e7cbd8e395b3f3f8e4afab2ad4bc6d9cead9faee799e44992264f0372"),
  },
  {
    hasK => 1,
    k => pack("H*","0827baabf6cd9ab5de3de1c21b73c9ae60eb44d439b67125aef29472f40b7b25"),
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","039f97ae2783e2a03e162a3a31de558ff65b05951e73f1fce011346c667b3ee2b1"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_K_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","ee3967af25bd5451b83c130444de7499d1c33660e8bc16dcb15be52fff791dbc"),
                                h => pack("H*","c28ee9514b75de0ce377014a077d0e631a2f7779f01d2bbedb0562eb65d79172"),
                                hasK => 1,
                                k => pack("H*","5d235d9045dad5172ca7596c608a03c9389c4c86c474de5f5cc55a379d695862"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","b2e1c64e7cbd8e395b3f3f8e4afab2ad4bc6d9cead9faee799e44992264f0372"),
  },
  {
    hasK => 1,
    k => pack("H*","0827baabf6cd9ab5de3de1c21b73c9ae60eb44d439b67125aef29472f40b7b25"),
  },
)

### init b_hs

### init b_hs
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_K_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => "Noise_K_secp256r1_AESGCM_SHA256\0",
                                h  => pack("H*","3f41c8dbd0856fb6cb1966bb7bdaa1be23523534651f850a5c232f38fc8a25c8"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_K_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => "Noise_K_secp256r1_AESGCM_SHA256\0",
                                h  => pack("H*","3f41c8dbd0856fb6cb1966bb7bdaa1be23523534651f850a5c232f38fc8a25c8"),
                              },
    who                    => "b",
  },
)


### b recv msg from a
### b recv msg from a


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEn5euJ4PioD4WKjox3lWP9lsFlR5z
',
###           '8fzgETRsZns+4rHZeN+sgQlTgZBPbwZ/98xKef/UEEPb4U72cxJw3jSSuw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEn5euJ4PioD4WKjox3lWP9lsFlR5z
',
###           '8fzgETRsZns+4rHZeN+sgQlTgZBPbwZ/98xKef/UEEPb4U72cxJw3jSSuw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'c4c7b6521a5953c002bb99c50306b02d91e338229a8f0266ee2e9bb9181c4ec3'
### z: 'c4c7b6521a5953c002bb99c50306b02d91e338229a8f0266ee2e9bb9181c4ec3'


### read message pattern: 'ss'
### read message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### noise decrypt
### noise decrypt
### key: '8fab4e5d8fb9d55d8bbbefd1d355e41552ed7c4327cd0908587e01b1ed03397d'
### key: '8fab4e5d8fb9d55d8bbbefd1d355e41552ed7c4327cd0908587e01b1ed03397d'
### iv: 'a22bbaf7bad5b9a0d7673537'
### iv: 'a22bbaf7bad5b9a0d7673537'
### aad: 'ec497ca2716b5dd23329fbb4cb5b1172afda976561a950993bff26cfed3e23c4'
### aad: 'ec497ca2716b5dd23329fbb4cb5b1172afda976561a950993bff26cfed3e23c4'
### cipherinfo: '834a31363136393034343134508128b80f87cd981873a5671c7713a4b7480fbc7c669dac936c'
### cipherinfo: '834a31363136393034343134508128b80f87cd981873a5671c7713a4b7480fbc7c669dac936c'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '931d8bc183e58d94e6533537'
### iv_xor: '931d8bc183e58d94e6533537'
### authtag: '8128b80f87cd981873a5671c7713a4b7'
### authtag: '8128b80f87cd981873a5671c7713a4b7'
### ciphertext: '0fbc7c669dac936c'
### ciphertext: '0fbc7c669dac936c'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'


### b_recv_a_msg: 'init.syn'
### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_K_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","039f97ae2783e2a03e162a3a31de558ff65b05951e73f1fce011346c667b3ee2b1"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","ee3967af25bd5451b83c130444de7499d1c33660e8bc16dcb15be52fff791dbc"),
                                h => pack("H*","c28ee9514b75de0ce377014a077d0e631a2f7779f01d2bbedb0562eb65d79172"),
                                hasK => 1,
                                k => pack("H*","5d235d9045dad5172ca7596c608a03c9389c4c86c474de5f5cc55a379d695862"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","b2e1c64e7cbd8e395b3f3f8e4afab2ad4bc6d9cead9faee799e44992264f0372"),
  },
  {
    hasK => 1,
    k => pack("H*","0827baabf6cd9ab5de3de1c21b73c9ae60eb44d439b67125aef29472f40b7b25"),
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_K_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","039f97ae2783e2a03e162a3a31de558ff65b05951e73f1fce011346c667b3ee2b1"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","ee3967af25bd5451b83c130444de7499d1c33660e8bc16dcb15be52fff791dbc"),
                                h => pack("H*","c28ee9514b75de0ce377014a077d0e631a2f7779f01d2bbedb0562eb65d79172"),
                                hasK => 1,
                                k => pack("H*","5d235d9045dad5172ca7596c608a03c9389c4c86c474de5f5cc55a379d695862"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","b2e1c64e7cbd8e395b3f3f8e4afab2ad4bc6d9cead9faee799e44992264f0372"),
  },
  {
    hasK => 1,
    k => pack("H*","0827baabf6cd9ab5de3de1c21b73c9ae60eb44d439b67125aef29472f40b7b25"),
  },
)


### a send comm msg to b
### a send comm msg to b

### noise encrypt

### noise encrypt
### key: 'f7c9d0069e73b1a653ccde7ea6399deb99d21226bdd4ca24eb8079ea704dd1bf'
### key: 'f7c9d0069e73b1a653ccde7ea6399deb99d21226bdd4ca24eb8079ea704dd1bf'
### iv: '2da6f12ce68f2c8b53664485'
### iv: '2da6f12ce68f2c8b53664485'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '1c90c01adfbf18bf62524485'
### iv_xor: '1c90c01adfbf18bf62524485'
### aad: 'c28ee9514b75de0ce377014a077d0e631a2f7779f01d2bbedb0562eb65d79172'
### aad: 'c28ee9514b75de0ce377014a077d0e631a2f7779f01d2bbedb0562eb65d79172'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '11dc4653b47937e24900164742faf603213ce209bb4861243655d735091f3d306a7e027e98bf0fd65e281c167867048b9af4f4'
### ciphertext: '11dc4653b47937e24900164742faf603213ce209bb4861243655d735091f3d306a7e027e98bf0fd65e281c167867048b9af4f4'
### authtag: 'c69f9e134f30163bdcca95de0a8a7928'
### authtag: 'c69f9e134f30163bdcca95de0a8a7928'
### cipherinfo: '834a3136313639303434313450c69f9e134f30163bdcca95de0a8a7928583311dc4653b47937e24900164742faf603213ce209bb4861243655d735091f3d306a7e027e98bf0fd65e281c167867048b9af4f4'
### cipherinfo: '834a3136313639303434313450c69f9e134f30163bdcca95de0a8a7928583311dc4653b47937e24900164742faf603213ce209bb4861243655d735091f3d306a7e027e98bf0fd65e281c167867048b9af4f4'


### b recv comm msg from a
### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: 'f7c9d0069e73b1a653ccde7ea6399deb99d21226bdd4ca24eb8079ea704dd1bf'
### key: 'f7c9d0069e73b1a653ccde7ea6399deb99d21226bdd4ca24eb8079ea704dd1bf'
### iv: '2da6f12ce68f2c8b53664485'
### iv: '2da6f12ce68f2c8b53664485'
### aad: 'c28ee9514b75de0ce377014a077d0e631a2f7779f01d2bbedb0562eb65d79172'
### aad: 'c28ee9514b75de0ce377014a077d0e631a2f7779f01d2bbedb0562eb65d79172'
### cipherinfo: '834a3136313639303434313450c69f9e134f30163bdcca95de0a8a7928583311dc4653b47937e24900164742faf603213ce209bb4861243655d735091f3d306a7e027e98bf0fd65e281c167867048b9af4f4'
### cipherinfo: '834a3136313639303434313450c69f9e134f30163bdcca95de0a8a7928583311dc4653b47937e24900164742faf603213ce209bb4861243655d735091f3d306a7e027e98bf0fd65e281c167867048b9af4f4'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '1c90c01adfbf18bf62524485'
### iv_xor: '1c90c01adfbf18bf62524485'
### authtag: 'c69f9e134f30163bdcca95de0a8a7928'
### authtag: 'c69f9e134f30163bdcca95de0a8a7928'
### ciphertext: '11dc4653b47937e24900164742faf603213ce209bb4861243655d735091f3d306a7e027e98bf0fd65e281c167867048b9af4f4'
### ciphertext: '11dc4653b47937e24900164742faf603213ce209bb4861243655d735091f3d306a7e027e98bf0fd65e281c167867048b9af4f4'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'


### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: 'e8e9a2ed12abddbc7edd1e082e2e6698aa53692b831924050a5f55818f2d2508'
### key: 'e8e9a2ed12abddbc7edd1e082e2e6698aa53692b831924050a5f55818f2d2508'
### iv: '6f6927cb3dae368ea3168cf0'
### iv: '6f6927cb3dae368ea3168cf0'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '5e5f16fd049e02ba92228cf0'
### iv_xor: '5e5f16fd049e02ba92228cf0'
### aad: 'c28ee9514b75de0ce377014a077d0e631a2f7779f01d2bbedb0562eb65d79172'
### aad: 'c28ee9514b75de0ce377014a077d0e631a2f7779f01d2bbedb0562eb65d79172'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '38ab87d2efbb4fdec799621d174e1287f915689676cc5576fbc8ba9e9827cfd6a5ff9e34c400fd5da1ed23b3dfb4bd'
### ciphertext: '38ab87d2efbb4fdec799621d174e1287f915689676cc5576fbc8ba9e9827cfd6a5ff9e34c400fd5da1ed23b3dfb4bd'
### authtag: 'f603c9bbc911b4c1d1c8eaea56f2201c'
### authtag: 'f603c9bbc911b4c1d1c8eaea56f2201c'
### cipherinfo: '834a3136313639303434313450f603c9bbc911b4c1d1c8eaea56f2201c582f38ab87d2efbb4fdec799621d174e1287f915689676cc5576fbc8ba9e9827cfd6a5ff9e34c400fd5da1ed23b3dfb4bd'
### cipherinfo: '834a3136313639303434313450f603c9bbc911b4c1d1c8eaea56f2201c582f38ab87d2efbb4fdec799621d174e1287f915689676cc5576fbc8ba9e9827cfd6a5ff9e34c400fd5da1ed23b3dfb4bd'


### a recv comm msg from b
### a recv comm msg from b


### noise decrypt
### noise decrypt
### key: 'e8e9a2ed12abddbc7edd1e082e2e6698aa53692b831924050a5f55818f2d2508'
### key: 'e8e9a2ed12abddbc7edd1e082e2e6698aa53692b831924050a5f55818f2d2508'
### iv: '6f6927cb3dae368ea3168cf0'
### iv: '6f6927cb3dae368ea3168cf0'
### aad: 'c28ee9514b75de0ce377014a077d0e631a2f7779f01d2bbedb0562eb65d79172'
### aad: 'c28ee9514b75de0ce377014a077d0e631a2f7779f01d2bbedb0562eb65d79172'
### cipherinfo: '834a3136313639303434313450f603c9bbc911b4c1d1c8eaea56f2201c582f38ab87d2efbb4fdec799621d174e1287f915689676cc5576fbc8ba9e9827cfd6a5ff9e34c400fd5da1ed23b3dfb4bd'
### cipherinfo: '834a3136313639303434313450f603c9bbc911b4c1d1c8eaea56f2201c582f38ab87d2efbb4fdec799621d174e1287f915689676cc5576fbc8ba9e9827cfd6a5ff9e34c400fd5da1ed23b3dfb4bd'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '5e5f16fd049e02ba92228cf0'
### iv_xor: '5e5f16fd049e02ba92228cf0'
### authtag: 'f603c9bbc911b4c1d1c8eaea56f2201c'
### authtag: 'f603c9bbc911b4c1d1c8eaea56f2201c'
### ciphertext: '38ab87d2efbb4fdec799621d174e1287f915689676cc5576fbc8ba9e9827cfd6a5ff9e34c400fd5da1ed23b3dfb4bd'
### ciphertext: '38ab87d2efbb4fdec799621d174e1287f915689676cc5576fbc8ba9e9827cfd6a5ff9e34c400fd5da1ed23b3dfb4bd'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'K',
###                               undef,
###                               undef
### -----------end test --------: 'K',
###                               undef,
###                               undef

### -----------start test --------: 'K',
###                                 'test_psk',
###                                 0

### -----------start test --------: 'K',
###                                 'test_psk',
###                                 0

### init a_hs

### init a_hs
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "ss"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Kpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","bf69632863943204f11283fb6f35efb04f3b67aa6928feac950eac389be8dc59"),
                                h  => pack("H*","71bb1a14c377d8d909631cc607d441a916419f6a53d99e57ec3c948a230ef722"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "ss"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Kpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","bf69632863943204f11283fb6f35efb04f3b67aa6928feac950eac389be8dc59"),
                                h  => pack("H*","71bb1a14c377d8d909631cc607d441a916419f6a53d99e57ec3c948a230ef722"),
                              },
    who                    => "a",
  },
)

### a send msg to b

### a send msg to b

### $a_msg_src: 'init.syn'

### $a_msg_src: 'init.syn'

### write message pattern: 'psk'

### write message pattern: 'psk'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '03407b04171e81337f272c82406655ffc302b869fe09a164f364afd2626588c9d7'

### public compressed: '03407b04171e81337f272c82406655ffc302b869fe09a164f364afd2626588c9d7'

### write message pattern: 'es'

### write message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINLIG8K429p8y5dWWUB+AYB06O1W4KXW5cLka9mmkf2boAoGCCqGSM49
',
###             'AwEHoUQDQgAEQHsEFx6BM38nLIJAZlX/wwK4af4JoWTzZK/SYmWIydeIk49Wkz3J
',
###             '38IDw6pCDg564mb6j2LwhbcMp3zFR2hW+Q==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEINLIG8K429p8y5dWWUB+AYB06O1W4KXW5cLka9mmkf2boAoGCCqGSM49
',
###             'AwEHoUQDQgAEQHsEFx6BM38nLIJAZlX/wwK4af4JoWTzZK/SYmWIydeIk49Wkz3J
',
###             '38IDw6pCDg564mb6j2LwhbcMp3zFR2hW+Q==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'f6783bb228be72c870d50627144273e76cae5aaf51e356bbebe928f368df69dc'
### z: 'f6783bb228be72c870d50627144273e76cae5aaf51e356bbebe928f368df69dc'


### write message pattern: 'ss'
### write message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### noise encrypt
### noise encrypt
### key: '278ec8bb6d02a3386205b1c9ccf1027436886cb3e13e8ba48a6715d4e1e65ea2'
### key: '278ec8bb6d02a3386205b1c9ccf1027436886cb3e13e8ba48a6715d4e1e65ea2'
### iv: 'e1360f790416abd99a2e1c19'
### iv: 'e1360f790416abd99a2e1c19'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'd0003e4f3d269fedab1a1c19'
### iv_xor: 'd0003e4f3d269fedab1a1c19'
### aad: '6270e8903dee93bffa31b8479118da6ed7bd17654f2285bec68788935e4ef2b5'
### aad: '6270e8903dee93bffa31b8479118da6ed7bd17654f2285bec68788935e4ef2b5'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '4349d841f20a7eec'
### ciphertext: '4349d841f20a7eec'
### authtag: '6e29e30aa91ec52c61ed77ad24137d36'
### authtag: '6e29e30aa91ec52c61ed77ad24137d36'
### cipherinfo: '834a31363136393034343134506e29e30aa91ec52c61ed77ad24137d36484349d841f20a7eec'
### cipherinfo: '834a31363136393034343134506e29e30aa91ec52c61ed77ad24137d36484349d841f20a7eec'


### a_msg: '82582103407b04171e81337f272c82406655ffc302b869fe09a164f364afd2626588c9d75826834a31363136393034343134506e29e30aa91ec52c61ed77ad24137d36484349d841f20a7eec'
### a_msg: '82582103407b04171e81337f272c82406655ffc302b869fe09a164f364afd2626588c9d75826834a31363136393034343134506e29e30aa91ec52c61ed77ad24137d36484349d841f20a7eec'
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03407b04171e81337f272c82406655ffc302b869fe09a164f364afd2626588c9d7"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "ss"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Kpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","91ef04c4ba45f8a22797c5135e1f52c5e787f9638d7f9d360f022961a5d91d0b"),
                                h => pack("H*","85185b25a2d6478e67b915f29e5e85ada11b38c8031bb9ab155d1c7cc68c7f34"),
                                hasK => 1,
                                k => pack("H*","81bd73e5f7d5528eb9caf2c28cbd86d7b950b0687faedd4800b8c0656360581d"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","ce44093970c72366f2f9b107b8abd072b94f92542ce18cd3aed4d202ee705ea9"),
  },
  {
    hasK => 1,
    k => pack("H*","b5abe7668bfbcef1034fcda14d2d4fd3d83c390cbcff9b0be3b089c0eaf974fc"),
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03407b04171e81337f272c82406655ffc302b869fe09a164f364afd2626588c9d7"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "ss"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Kpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","91ef04c4ba45f8a22797c5135e1f52c5e787f9638d7f9d360f022961a5d91d0b"),
                                h => pack("H*","85185b25a2d6478e67b915f29e5e85ada11b38c8031bb9ab155d1c7cc68c7f34"),
                                hasK => 1,
                                k => pack("H*","81bd73e5f7d5528eb9caf2c28cbd86d7b950b0687faedd4800b8c0656360581d"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","ce44093970c72366f2f9b107b8abd072b94f92542ce18cd3aed4d202ee705ea9"),
  },
  {
    hasK => 1,
    k => pack("H*","b5abe7668bfbcef1034fcda14d2d4fd3d83c390cbcff9b0be3b089c0eaf974fc"),
  },
)


### init b_hs
### init b_hs
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "ss"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Kpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","bf69632863943204f11283fb6f35efb04f3b67aa6928feac950eac389be8dc59"),
                                h  => pack("H*","71bb1a14c377d8d909631cc607d441a916419f6a53d99e57ec3c948a230ef722"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "ss"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Kpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","bf69632863943204f11283fb6f35efb04f3b67aa6928feac950eac389be8dc59"),
                                h  => pack("H*","71bb1a14c377d8d909631cc607d441a916419f6a53d99e57ec3c948a230ef722"),
                              },
    who                    => "b",
  },
)


### b recv msg from a
### b recv msg from a


### read message pattern: 'psk'
### read message pattern: 'psk'


### read message pattern: 'e'
### read message pattern: 'e'


### read message pattern: 'es'
### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQHsEFx6BM38nLIJAZlX/wwK4af4J
',
###           'oWTzZK/SYmWIydeIk49Wkz3J38IDw6pCDg564mb6j2LwhbcMp3zFR2hW+Q==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQHsEFx6BM38nLIJAZlX/wwK4af4J
',
###           'oWTzZK/SYmWIydeIk49Wkz3J38IDw6pCDg564mb6j2LwhbcMp3zFR2hW+Q==
',
###           '-----END PUBLIC KEY-----
'
### z: 'f6783bb228be72c870d50627144273e76cae5aaf51e356bbebe928f368df69dc'
### z: 'f6783bb228be72c870d50627144273e76cae5aaf51e356bbebe928f368df69dc'


### read message pattern: 'ss'
### read message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### noise decrypt
### noise decrypt
### key: '278ec8bb6d02a3386205b1c9ccf1027436886cb3e13e8ba48a6715d4e1e65ea2'
### key: '278ec8bb6d02a3386205b1c9ccf1027436886cb3e13e8ba48a6715d4e1e65ea2'
### iv: 'e1360f790416abd99a2e1c19'
### iv: 'e1360f790416abd99a2e1c19'
### aad: '6270e8903dee93bffa31b8479118da6ed7bd17654f2285bec68788935e4ef2b5'
### aad: '6270e8903dee93bffa31b8479118da6ed7bd17654f2285bec68788935e4ef2b5'
### cipherinfo: '834a31363136393034343134506e29e30aa91ec52c61ed77ad24137d36484349d841f20a7eec'
### cipherinfo: '834a31363136393034343134506e29e30aa91ec52c61ed77ad24137d36484349d841f20a7eec'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'd0003e4f3d269fedab1a1c19'
### iv_xor: 'd0003e4f3d269fedab1a1c19'
### authtag: '6e29e30aa91ec52c61ed77ad24137d36'
### authtag: '6e29e30aa91ec52c61ed77ad24137d36'
### ciphertext: '4349d841f20a7eec'
### ciphertext: '4349d841f20a7eec'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'


### b_recv_a_msg: 'init.syn'
### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "ss"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Kpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","03407b04171e81337f272c82406655ffc302b869fe09a164f364afd2626588c9d7"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","91ef04c4ba45f8a22797c5135e1f52c5e787f9638d7f9d360f022961a5d91d0b"),
                                h => pack("H*","85185b25a2d6478e67b915f29e5e85ada11b38c8031bb9ab155d1c7cc68c7f34"),
                                hasK => 1,
                                k => pack("H*","81bd73e5f7d5528eb9caf2c28cbd86d7b950b0687faedd4800b8c0656360581d"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","ce44093970c72366f2f9b107b8abd072b94f92542ce18cd3aed4d202ee705ea9"),
  },
  {
    hasK => 1,
    k => pack("H*","b5abe7668bfbcef1034fcda14d2d4fd3d83c390cbcff9b0be3b089c0eaf974fc"),
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "ss"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Kpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","03407b04171e81337f272c82406655ffc302b869fe09a164f364afd2626588c9d7"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","91ef04c4ba45f8a22797c5135e1f52c5e787f9638d7f9d360f022961a5d91d0b"),
                                h => pack("H*","85185b25a2d6478e67b915f29e5e85ada11b38c8031bb9ab155d1c7cc68c7f34"),
                                hasK => 1,
                                k => pack("H*","81bd73e5f7d5528eb9caf2c28cbd86d7b950b0687faedd4800b8c0656360581d"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","ce44093970c72366f2f9b107b8abd072b94f92542ce18cd3aed4d202ee705ea9"),
  },
  {
    hasK => 1,
    k => pack("H*","b5abe7668bfbcef1034fcda14d2d4fd3d83c390cbcff9b0be3b089c0eaf974fc"),
  },
)


### a send comm msg to b
### a send comm msg to b


### noise encrypt
### noise encrypt
### key: '1e96d97a9acf7104d8ef260fb36ef78f07ba9b2f7a82b86449391551321d69cb'
### key: '1e96d97a9acf7104d8ef260fb36ef78f07ba9b2f7a82b86449391551321d69cb'
### iv: 'fb38d1ed562b1b14fcf77fea'
### iv: 'fb38d1ed562b1b14fcf77fea'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'ca0ee0db6f1b2f20cdc37fea'
### iv_xor: 'ca0ee0db6f1b2f20cdc37fea'
### aad: '85185b25a2d6478e67b915f29e5e85ada11b38c8031bb9ab155d1c7cc68c7f34'
### aad: '85185b25a2d6478e67b915f29e5e85ada11b38c8031bb9ab155d1c7cc68c7f34'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'd8051f95dce7eb27e24b28e876456006148957c45e02b6e3a9b2196019d58c9558c490ec0060799532eb7b05615b853d367fef'
### ciphertext: 'd8051f95dce7eb27e24b28e876456006148957c45e02b6e3a9b2196019d58c9558c490ec0060799532eb7b05615b853d367fef'
### authtag: '82bef084f52196aa19d6953300d41bc5'
### authtag: '82bef084f52196aa19d6953300d41bc5'
### cipherinfo: '834a313631363930343431345082bef084f52196aa19d6953300d41bc55833d8051f95dce7eb27e24b28e876456006148957c45e02b6e3a9b2196019d58c9558c490ec0060799532eb7b05615b853d367fef'
### cipherinfo: '834a313631363930343431345082bef084f52196aa19d6953300d41bc55833d8051f95dce7eb27e24b28e876456006148957c45e02b6e3a9b2196019d58c9558c490ec0060799532eb7b05615b853d367fef'


### b recv comm msg from a
### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '1e96d97a9acf7104d8ef260fb36ef78f07ba9b2f7a82b86449391551321d69cb'
### key: '1e96d97a9acf7104d8ef260fb36ef78f07ba9b2f7a82b86449391551321d69cb'
### iv: 'fb38d1ed562b1b14fcf77fea'
### iv: 'fb38d1ed562b1b14fcf77fea'
### aad: '85185b25a2d6478e67b915f29e5e85ada11b38c8031bb9ab155d1c7cc68c7f34'
### aad: '85185b25a2d6478e67b915f29e5e85ada11b38c8031bb9ab155d1c7cc68c7f34'
### cipherinfo: '834a313631363930343431345082bef084f52196aa19d6953300d41bc55833d8051f95dce7eb27e24b28e876456006148957c45e02b6e3a9b2196019d58c9558c490ec0060799532eb7b05615b853d367fef'
### cipherinfo: '834a313631363930343431345082bef084f52196aa19d6953300d41bc55833d8051f95dce7eb27e24b28e876456006148957c45e02b6e3a9b2196019d58c9558c490ec0060799532eb7b05615b853d367fef'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'ca0ee0db6f1b2f20cdc37fea'
### iv_xor: 'ca0ee0db6f1b2f20cdc37fea'
### authtag: '82bef084f52196aa19d6953300d41bc5'
### authtag: '82bef084f52196aa19d6953300d41bc5'
### ciphertext: 'd8051f95dce7eb27e24b28e876456006148957c45e02b6e3a9b2196019d58c9558c490ec0060799532eb7b05615b853d367fef'
### ciphertext: 'd8051f95dce7eb27e24b28e876456006148957c45e02b6e3a9b2196019d58c9558c490ec0060799532eb7b05615b853d367fef'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b send comm msg to a

### b send comm msg to a


### noise encrypt
### noise encrypt
### key: 'd520e0415180d90e845627ff3641349bd67a402c4b97c1f6d8f2765f839a70e4'
### key: 'd520e0415180d90e845627ff3641349bd67a402c4b97c1f6d8f2765f839a70e4'
### iv: 'aaaee32296cbc2fa827adbfd'
### iv: 'aaaee32296cbc2fa827adbfd'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '9b98d214affbf6ceb34edbfd'
### iv_xor: '9b98d214affbf6ceb34edbfd'
### aad: '85185b25a2d6478e67b915f29e5e85ada11b38c8031bb9ab155d1c7cc68c7f34'
### aad: '85185b25a2d6478e67b915f29e5e85ada11b38c8031bb9ab155d1c7cc68c7f34'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'c7e6977e544ce9ec6f9fe99268ae516b8b3dcb72d5a470feb731efd78eabad869b26a693c68d09131a38495f911a91'
### ciphertext: 'c7e6977e544ce9ec6f9fe99268ae516b8b3dcb72d5a470feb731efd78eabad869b26a693c68d09131a38495f911a91'
### authtag: 'a6d239d8a6ce636b9c0b6c40d191854a'
### authtag: 'a6d239d8a6ce636b9c0b6c40d191854a'
### cipherinfo: '834a3136313639303434313450a6d239d8a6ce636b9c0b6c40d191854a582fc7e6977e544ce9ec6f9fe99268ae516b8b3dcb72d5a470feb731efd78eabad869b26a693c68d09131a38495f911a91'
### cipherinfo: '834a3136313639303434313450a6d239d8a6ce636b9c0b6c40d191854a582fc7e6977e544ce9ec6f9fe99268ae516b8b3dcb72d5a470feb731efd78eabad869b26a693c68d09131a38495f911a91'


### a recv comm msg from b
### a recv comm msg from b


### noise decrypt
### noise decrypt
### key: 'd520e0415180d90e845627ff3641349bd67a402c4b97c1f6d8f2765f839a70e4'
### key: 'd520e0415180d90e845627ff3641349bd67a402c4b97c1f6d8f2765f839a70e4'
### iv: 'aaaee32296cbc2fa827adbfd'
### iv: 'aaaee32296cbc2fa827adbfd'
### aad: '85185b25a2d6478e67b915f29e5e85ada11b38c8031bb9ab155d1c7cc68c7f34'
### aad: '85185b25a2d6478e67b915f29e5e85ada11b38c8031bb9ab155d1c7cc68c7f34'
### cipherinfo: '834a3136313639303434313450a6d239d8a6ce636b9c0b6c40d191854a582fc7e6977e544ce9ec6f9fe99268ae516b8b3dcb72d5a470feb731efd78eabad869b26a693c68d09131a38495f911a91'
### cipherinfo: '834a3136313639303434313450a6d239d8a6ce636b9c0b6c40d191854a582fc7e6977e544ce9ec6f9fe99268ae516b8b3dcb72d5a470feb731efd78eabad869b26a693c68d09131a38495f911a91'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '9b98d214affbf6ceb34edbfd'
### iv_xor: '9b98d214affbf6ceb34edbfd'
### authtag: 'a6d239d8a6ce636b9c0b6c40d191854a'
### authtag: 'a6d239d8a6ce636b9c0b6c40d191854a'
### ciphertext: 'c7e6977e544ce9ec6f9fe99268ae516b8b3dcb72d5a470feb731efd78eabad869b26a693c68d09131a38495f911a91'
### ciphertext: 'c7e6977e544ce9ec6f9fe99268ae516b8b3dcb72d5a470feb731efd78eabad869b26a693c68d09131a38495f911a91'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'K',
###                               'test_psk',
###                               0
### -----------end test --------: 'K',
###                               'test_psk',
###                               0


### -----------start test --------: 'K',
###                                 'test_psk',
###                                 1
### -----------start test --------: 'K',
###                                 'test_psk',
###                                 1

### init a_hs

### init a_hs
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss", "psk"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Kpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","0f21ef89bfedddde2821d66eb9fb938bd632a5cb61bed6d42b3b5d00544d0932"),
                                h  => pack("H*","1d96ac3f0b5f6ff001856e2b403205726c7d160ba33ac76ba1adc13ae7ab64a6"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss", "psk"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Kpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","0f21ef89bfedddde2821d66eb9fb938bd632a5cb61bed6d42b3b5d00544d0932"),
                                h  => pack("H*","1d96ac3f0b5f6ff001856e2b403205726c7d160ba33ac76ba1adc13ae7ab64a6"),
                              },
    who                    => "a",
  },
)

### a send msg to b

### a send msg to b

### $a_msg_src: 'init.syn'

### $a_msg_src: 'init.syn'

### write message pattern: 'e'

### write message pattern: 'e'


### public compressed: '0264f87f35f5099776149827a1315f08d7d76109f40ac191bef866d1908a04bab2'
### public compressed: '0264f87f35f5099776149827a1315f08d7d76109f40ac191bef866d1908a04bab2'


### write message pattern: 'es'
### write message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPDh3GGM3WlV2jNkfLf/o5ruFmm8yVdrKxerA4Ax7rEroAoGCCqGSM49
',
###             'AwEHoUQDQgAEZPh/NfUJl3YUmCehMV8I19dhCfQKwZG++GbRkIoEurLspSqNO1fo
',
###             'djIfMZIQa5P7n/mfjc2Et0sQuCTLjWAXLg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPDh3GGM3WlV2jNkfLf/o5ruFmm8yVdrKxerA4Ax7rEroAoGCCqGSM49
',
###             'AwEHoUQDQgAEZPh/NfUJl3YUmCehMV8I19dhCfQKwZG++GbRkIoEurLspSqNO1fo
',
###             'djIfMZIQa5P7n/mfjc2Et0sQuCTLjWAXLg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '66eb3ae910d3aeb93be4088202ebb4755e9aa55127bc837405e9df55653f9366'
### z: '66eb3ae910d3aeb93be4088202ebb4755e9aa55127bc837405e9df55653f9366'

### write message pattern: 'ss'

### write message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### write message pattern: 'psk'
### write message pattern: 'psk'

### noise encrypt

### noise encrypt
### key: 'c562d3cb5d28e3e063ba1b93dd36496d261dd3e70ce6513376fd2c586d7d0271'
### key: 'c562d3cb5d28e3e063ba1b93dd36496d261dd3e70ce6513376fd2c586d7d0271'
### iv: '53cff83822c28aa840472856'
### iv: '53cff83822c28aa840472856'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '62f9c90e1bf2be9c71732856'
### iv_xor: '62f9c90e1bf2be9c71732856'
### aad: 'fde7b0a4d353de3dda45bfc1d3004d82e298d8767af724b2f0b07ebd317804c5'
### aad: 'fde7b0a4d353de3dda45bfc1d3004d82e298d8767af724b2f0b07ebd317804c5'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '23555830b42acb4e'
### ciphertext: '23555830b42acb4e'
### authtag: 'facec1c6d6021f801a655fba9e6330fb'
### authtag: 'facec1c6d6021f801a655fba9e6330fb'
### cipherinfo: '834a3136313639303434313450facec1c6d6021f801a655fba9e6330fb4823555830b42acb4e'
### cipherinfo: '834a3136313639303434313450facec1c6d6021f801a655fba9e6330fb4823555830b42acb4e'

### a_msg: '8258210264f87f35f5099776149827a1315f08d7d76109f40ac191bef866d1908a04bab25826834a3136313639303434313450facec1c6d6021f801a655fba9e6330fb4823555830b42acb4e'

### a_msg: '8258210264f87f35f5099776149827a1315f08d7d76109f40ac191bef866d1908a04bab25826834a3136313639303434313450facec1c6d6021f801a655fba9e6330fb4823555830b42acb4e'
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0264f87f35f5099776149827a1315f08d7d76109f40ac191bef866d1908a04bab2"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss", "psk"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Kpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","7c6d1891e64fee16ed2d3df8b8f32ca146b2b1e7e2953e1816e9b435c0f20b6e"),
                                h => pack("H*","e8938dc150abcbbe2709394308f7f6658bb62b0c81f8fd145e3670657a30f755"),
                                hasK => 1,
                                k => pack("H*","3243f82425849a2f3640617ebd02390f8f6facb14a138d55f7f75ff5770b79e4"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","53e553b074419f54e04d7a413e25ab11ecda2ef670b3f548b4de4a244fb29c93"),
  },
  {
    hasK => 1,
    k => pack("H*","ec6c9b6cd75212685e50117f9a4360c9242d2997ba818bf0cde70f966ed4cb43"),
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0264f87f35f5099776149827a1315f08d7d76109f40ac191bef866d1908a04bab2"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss", "psk"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Kpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","7c6d1891e64fee16ed2d3df8b8f32ca146b2b1e7e2953e1816e9b435c0f20b6e"),
                                h => pack("H*","e8938dc150abcbbe2709394308f7f6658bb62b0c81f8fd145e3670657a30f755"),
                                hasK => 1,
                                k => pack("H*","3243f82425849a2f3640617ebd02390f8f6facb14a138d55f7f75ff5770b79e4"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","53e553b074419f54e04d7a413e25ab11ecda2ef670b3f548b4de4a244fb29c93"),
  },
  {
    hasK => 1,
    k => pack("H*","ec6c9b6cd75212685e50117f9a4360c9242d2997ba818bf0cde70f966ed4cb43"),
  },
)


### init b_hs
### init b_hs
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss", "psk"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Kpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","0f21ef89bfedddde2821d66eb9fb938bd632a5cb61bed6d42b3b5d00544d0932"),
                                h  => pack("H*","1d96ac3f0b5f6ff001856e2b403205726c7d160ba33ac76ba1adc13ae7ab64a6"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss", "psk"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Kpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","0f21ef89bfedddde2821d66eb9fb938bd632a5cb61bed6d42b3b5d00544d0932"),
                                h  => pack("H*","1d96ac3f0b5f6ff001856e2b403205726c7d160ba33ac76ba1adc13ae7ab64a6"),
                              },
    who                    => "b",
  },
)


### b recv msg from a
### b recv msg from a


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEZPh/NfUJl3YUmCehMV8I19dhCfQK
',
###           'wZG++GbRkIoEurLspSqNO1fodjIfMZIQa5P7n/mfjc2Et0sQuCTLjWAXLg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEZPh/NfUJl3YUmCehMV8I19dhCfQK
',
###           'wZG++GbRkIoEurLspSqNO1fodjIfMZIQa5P7n/mfjc2Et0sQuCTLjWAXLg==
',
###           '-----END PUBLIC KEY-----
'
### z: '66eb3ae910d3aeb93be4088202ebb4755e9aa55127bc837405e9df55653f9366'
### z: '66eb3ae910d3aeb93be4088202ebb4755e9aa55127bc837405e9df55653f9366'


### read message pattern: 'ss'
### read message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### read message pattern: 'psk'
### read message pattern: 'psk'


### noise decrypt
### noise decrypt
### key: 'c562d3cb5d28e3e063ba1b93dd36496d261dd3e70ce6513376fd2c586d7d0271'
### key: 'c562d3cb5d28e3e063ba1b93dd36496d261dd3e70ce6513376fd2c586d7d0271'
### iv: '53cff83822c28aa840472856'
### iv: '53cff83822c28aa840472856'
### aad: 'fde7b0a4d353de3dda45bfc1d3004d82e298d8767af724b2f0b07ebd317804c5'
### aad: 'fde7b0a4d353de3dda45bfc1d3004d82e298d8767af724b2f0b07ebd317804c5'
### cipherinfo: '834a3136313639303434313450facec1c6d6021f801a655fba9e6330fb4823555830b42acb4e'
### cipherinfo: '834a3136313639303434313450facec1c6d6021f801a655fba9e6330fb4823555830b42acb4e'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '62f9c90e1bf2be9c71732856'
### iv_xor: '62f9c90e1bf2be9c71732856'
### authtag: 'facec1c6d6021f801a655fba9e6330fb'
### authtag: 'facec1c6d6021f801a655fba9e6330fb'
### ciphertext: '23555830b42acb4e'
### ciphertext: '23555830b42acb4e'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'

### b_recv_a_msg: 'init.syn'

### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss", "psk"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Kpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","0264f87f35f5099776149827a1315f08d7d76109f40ac191bef866d1908a04bab2"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","7c6d1891e64fee16ed2d3df8b8f32ca146b2b1e7e2953e1816e9b435c0f20b6e"),
                                h => pack("H*","e8938dc150abcbbe2709394308f7f6658bb62b0c81f8fd145e3670657a30f755"),
                                hasK => 1,
                                k => pack("H*","3243f82425849a2f3640617ebd02390f8f6facb14a138d55f7f75ff5770b79e4"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","53e553b074419f54e04d7a413e25ab11ecda2ef670b3f548b4de4a244fb29c93"),
  },
  {
    hasK => 1,
    k => pack("H*","ec6c9b6cd75212685e50117f9a4360c9242d2997ba818bf0cde70f966ed4cb43"),
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "K",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss", "psk"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Kpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","0264f87f35f5099776149827a1315f08d7d76109f40ac191bef866d1908a04bab2"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","7c6d1891e64fee16ed2d3df8b8f32ca146b2b1e7e2953e1816e9b435c0f20b6e"),
                                h => pack("H*","e8938dc150abcbbe2709394308f7f6658bb62b0c81f8fd145e3670657a30f755"),
                                hasK => 1,
                                k => pack("H*","3243f82425849a2f3640617ebd02390f8f6facb14a138d55f7f75ff5770b79e4"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","53e553b074419f54e04d7a413e25ab11ecda2ef670b3f548b4de4a244fb29c93"),
  },
  {
    hasK => 1,
    k => pack("H*","ec6c9b6cd75212685e50117f9a4360c9242d2997ba818bf0cde70f966ed4cb43"),
  },
)


### a send comm msg to b
### a send comm msg to b


### noise encrypt
### noise encrypt
### key: '0215b68c00f4bb8b5113a21bdb4c3cdb055e5dc02a94c7a9f69ac66e6a94cd1f'
### key: '0215b68c00f4bb8b5113a21bdb4c3cdb055e5dc02a94c7a9f69ac66e6a94cd1f'
### iv: 'c228819a49b50492f77b2460'
### iv: 'c228819a49b50492f77b2460'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'f31eb0ac708530a6c64f2460'
### iv_xor: 'f31eb0ac708530a6c64f2460'
### aad: 'e8938dc150abcbbe2709394308f7f6658bb62b0c81f8fd145e3670657a30f755'
### aad: 'e8938dc150abcbbe2709394308f7f6658bb62b0c81f8fd145e3670657a30f755'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '03ccb14e630a4def33463faf0ad63f286e2dceb1bf25f399a2439ce06ba4dda22b2b1f1a828b965ed8fc352fe6dc2809fc5bb7'
### ciphertext: '03ccb14e630a4def33463faf0ad63f286e2dceb1bf25f399a2439ce06ba4dda22b2b1f1a828b965ed8fc352fe6dc2809fc5bb7'
### authtag: '8d94ec4c95a1085f1bde0410965905a3'
### authtag: '8d94ec4c95a1085f1bde0410965905a3'
### cipherinfo: '834a31363136393034343134508d94ec4c95a1085f1bde0410965905a3583303ccb14e630a4def33463faf0ad63f286e2dceb1bf25f399a2439ce06ba4dda22b2b1f1a828b965ed8fc352fe6dc2809fc5bb7'
### cipherinfo: '834a31363136393034343134508d94ec4c95a1085f1bde0410965905a3583303ccb14e630a4def33463faf0ad63f286e2dceb1bf25f399a2439ce06ba4dda22b2b1f1a828b965ed8fc352fe6dc2809fc5bb7'


### b recv comm msg from a
### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: '0215b68c00f4bb8b5113a21bdb4c3cdb055e5dc02a94c7a9f69ac66e6a94cd1f'
### key: '0215b68c00f4bb8b5113a21bdb4c3cdb055e5dc02a94c7a9f69ac66e6a94cd1f'
### iv: 'c228819a49b50492f77b2460'
### iv: 'c228819a49b50492f77b2460'
### aad: 'e8938dc150abcbbe2709394308f7f6658bb62b0c81f8fd145e3670657a30f755'
### aad: 'e8938dc150abcbbe2709394308f7f6658bb62b0c81f8fd145e3670657a30f755'
### cipherinfo: '834a31363136393034343134508d94ec4c95a1085f1bde0410965905a3583303ccb14e630a4def33463faf0ad63f286e2dceb1bf25f399a2439ce06ba4dda22b2b1f1a828b965ed8fc352fe6dc2809fc5bb7'
### cipherinfo: '834a31363136393034343134508d94ec4c95a1085f1bde0410965905a3583303ccb14e630a4def33463faf0ad63f286e2dceb1bf25f399a2439ce06ba4dda22b2b1f1a828b965ed8fc352fe6dc2809fc5bb7'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'f31eb0ac708530a6c64f2460'
### iv_xor: 'f31eb0ac708530a6c64f2460'
### authtag: '8d94ec4c95a1085f1bde0410965905a3'
### authtag: '8d94ec4c95a1085f1bde0410965905a3'
### ciphertext: '03ccb14e630a4def33463faf0ad63f286e2dceb1bf25f399a2439ce06ba4dda22b2b1f1a828b965ed8fc352fe6dc2809fc5bb7'
### ciphertext: '03ccb14e630a4def33463faf0ad63f286e2dceb1bf25f399a2439ce06ba4dda22b2b1f1a828b965ed8fc352fe6dc2809fc5bb7'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b send comm msg to a

### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '7c3833f506d191b086b4d931a6ec7f4fbf84db572f85bb58d630d30c563363e7'
### key: '7c3833f506d191b086b4d931a6ec7f4fbf84db572f85bb58d630d30c563363e7'
### iv: 'b75bfe292a3252e9e0090cc7'
### iv: 'b75bfe292a3252e9e0090cc7'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '866dcf1f130266ddd13d0cc7'
### iv_xor: '866dcf1f130266ddd13d0cc7'
### aad: 'e8938dc150abcbbe2709394308f7f6658bb62b0c81f8fd145e3670657a30f755'
### aad: 'e8938dc150abcbbe2709394308f7f6658bb62b0c81f8fd145e3670657a30f755'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'ac8961740f022bc94a27f07b8408ce7fe64cf07850f2007184f4a63eecb7f0602dc865b027cdabbe7e38a4ab791739'
### ciphertext: 'ac8961740f022bc94a27f07b8408ce7fe64cf07850f2007184f4a63eecb7f0602dc865b027cdabbe7e38a4ab791739'
### authtag: '82d170e81a1322a283a53abd68fc26a6'
### authtag: '82d170e81a1322a283a53abd68fc26a6'
### cipherinfo: '834a313631363930343431345082d170e81a1322a283a53abd68fc26a6582fac8961740f022bc94a27f07b8408ce7fe64cf07850f2007184f4a63eecb7f0602dc865b027cdabbe7e38a4ab791739'
### cipherinfo: '834a313631363930343431345082d170e81a1322a283a53abd68fc26a6582fac8961740f022bc94a27f07b8408ce7fe64cf07850f2007184f4a63eecb7f0602dc865b027cdabbe7e38a4ab791739'

### a recv comm msg from b

### a recv comm msg from b


### noise decrypt
### noise decrypt
### key: '7c3833f506d191b086b4d931a6ec7f4fbf84db572f85bb58d630d30c563363e7'
### key: '7c3833f506d191b086b4d931a6ec7f4fbf84db572f85bb58d630d30c563363e7'
### iv: 'b75bfe292a3252e9e0090cc7'
### iv: 'b75bfe292a3252e9e0090cc7'
### aad: 'e8938dc150abcbbe2709394308f7f6658bb62b0c81f8fd145e3670657a30f755'
### aad: 'e8938dc150abcbbe2709394308f7f6658bb62b0c81f8fd145e3670657a30f755'
### cipherinfo: '834a313631363930343431345082d170e81a1322a283a53abd68fc26a6582fac8961740f022bc94a27f07b8408ce7fe64cf07850f2007184f4a63eecb7f0602dc865b027cdabbe7e38a4ab791739'
### cipherinfo: '834a313631363930343431345082d170e81a1322a283a53abd68fc26a6582fac8961740f022bc94a27f07b8408ce7fe64cf07850f2007184f4a63eecb7f0602dc865b027cdabbe7e38a4ab791739'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '866dcf1f130266ddd13d0cc7'
### iv_xor: '866dcf1f130266ddd13d0cc7'
### authtag: '82d170e81a1322a283a53abd68fc26a6'
### authtag: '82d170e81a1322a283a53abd68fc26a6'
### ciphertext: 'ac8961740f022bc94a27f07b8408ce7fe64cf07850f2007184f4a63eecb7f0602dc865b027cdabbe7e38a4ab791739'
### ciphertext: 'ac8961740f022bc94a27f07b8408ce7fe64cf07850f2007184f4a63eecb7f0602dc865b027cdabbe7e38a4ab791739'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'K',
###                               'test_psk',
###                               1

### -----------end test --------: 'K',
###                               'test_psk',
###                               1

### -----------start test --------: 'X',
###                                 undef,
###                                 undef

### -----------start test --------: 'X',
###                                 undef,
###                                 undef

### init a_hs

### init a_hs
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_X_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => "Noise_X_secp256r1_AESGCM_SHA256\0",
                                h  => pack("H*","97ed976cc796d80c34e2732a71ac1a71316639102a060ac9a2763296d579a19e"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_X_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => "Noise_X_secp256r1_AESGCM_SHA256\0",
                                h  => pack("H*","97ed976cc796d80c34e2732a71ac1a71316639102a060ac9a2763296d579a19e"),
                              },
    who                    => "a",
  },
)

### a send msg to b

### a send msg to b

### $a_msg_src: 'init.syn'

### $a_msg_src: 'init.syn'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '03d72d4aa2ef2746504e3bbc8999cd987fb856ccb0a31cea2044d529a773e5a47e'

### public compressed: '03d72d4aa2ef2746504e3bbc8999cd987fb856ccb0a31cea2044d529a773e5a47e'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIJKI77s3ave5TFSMYx6UCJH0pSzQazRYoSbBQBL9D6ndoAoGCCqGSM49
',
###             'AwEHoUQDQgAE1y1Kou8nRlBOO7yJmc2Yf7hWzLCjHOogRNUpp3PlpH6iefYrQ0cx
',
###             'tF1G0vgKnmqFfvaAY8lGstiS/A2wB2xaxw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIJKI77s3ave5TFSMYx6UCJH0pSzQazRYoSbBQBL9D6ndoAoGCCqGSM49
',
###             'AwEHoUQDQgAE1y1Kou8nRlBOO7yJmc2Yf7hWzLCjHOogRNUpp3PlpH6iefYrQ0cx
',
###             'tF1G0vgKnmqFfvaAY8lGstiS/A2wB2xaxw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '6267b95ef637d44c5c11c17e9f6d2b9a0243fd8492f38519ef18dbf67f0f51f5'
### z: '6267b95ef637d44c5c11c17e9f6d2b9a0243fd8492f38519ef18dbf67f0f51f5'


### write message pattern: 's'
### write message pattern: 's'


### noise encrypt
### noise encrypt
### key: 'ce62c4a85e5ceefb98669c54eb3e4c3bd4565f2344ded2585d766276f9449a96'
### key: 'ce62c4a85e5ceefb98669c54eb3e4c3bd4565f2344ded2585d766276f9449a96'
### iv: 'a8639e18042c0e4bb770a463'
### iv: 'a8639e18042c0e4bb770a463'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '9955af2e3d1c3a7f8644a463'
### iv_xor: '9955af2e3d1c3a7f8644a463'
### aad: '9d8edd80f1119bb258a6f4cab68c09f1e1d999807b0541d8730404cd67458944'
### aad: '9d8edd80f1119bb258a6f4cab68c09f1e1d999807b0541d8730404cd67458944'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: 'bceda6c02080bc267c26744a2447823e9e3a293c8d84cedbac70671f39dec5197ae49758b527c3f1'
### ciphertext: 'bceda6c02080bc267c26744a2447823e9e3a293c8d84cedbac70671f39dec5197ae49758b527c3f1'
### authtag: '1b77ed0f7dc727a88279911a79a212dd'
### authtag: '1b77ed0f7dc727a88279911a79a212dd'
### cipherinfo: '834a31363136393034343134501b77ed0f7dc727a88279911a79a212dd5828bceda6c02080bc267c26744a2447823e9e3a293c8d84cedbac70671f39dec5197ae49758b527c3f1'
### cipherinfo: '834a31363136393034343134501b77ed0f7dc727a88279911a79a212dd5828bceda6c02080bc267c26744a2447823e9e3a293c8d84cedbac70671f39dec5197ae49758b527c3f1'


### write message pattern: 'ss'
### write message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### noise encrypt

### noise encrypt
### key: '52bc2f9621fc87cef4edd94f5ea0d2d0c9642017e7f3a711c43b21ab16bcdcf4'
### key: '52bc2f9621fc87cef4edd94f5ea0d2d0c9642017e7f3a711c43b21ab16bcdcf4'
### iv: '08501f9e611f3059d47a1cd6'
### iv: '08501f9e611f3059d47a1cd6'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '39662ea8582f046de54e1cd6'
### iv_xor: '39662ea8582f046de54e1cd6'
### aad: 'da10945d7120db3ca841d97b9a4ca4b08da1386e0c0b941ab4192a977e2122f7'
### aad: 'da10945d7120db3ca841d97b9a4ca4b08da1386e0c0b941ab4192a977e2122f7'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '6a2646af767e9fbc'
### ciphertext: '6a2646af767e9fbc'
### authtag: 'ee8b69b9988609648c9731b69783f760'
### authtag: 'ee8b69b9988609648c9731b69783f760'
### cipherinfo: '834a3136313639303434313450ee8b69b9988609648c9731b69783f760486a2646af767e9fbc'
### cipherinfo: '834a3136313639303434313450ee8b69b9988609648c9731b69783f760486a2646af767e9fbc'


### a_msg: '83582103d72d4aa2ef2746504e3bbc8999cd987fb856ccb0a31cea2044d529a773e5a47e5847834a31363136393034343134501b77ed0f7dc727a88279911a79a212dd5828bceda6c02080bc267c26744a2447823e9e3a293c8d84cedbac70671f39dec5197ae49758b527c3f15826834a3136313639303434313450ee8b69b9988609648c9731b69783f760486a2646af767e9fbc'
### a_msg: '83582103d72d4aa2ef2746504e3bbc8999cd987fb856ccb0a31cea2044d529a773e5a47e5847834a31363136393034343134501b77ed0f7dc727a88279911a79a212dd5828bceda6c02080bc267c26744a2447823e9e3a293c8d84cedbac70671f39dec5197ae49758b527c3f15826834a3136313639303434313450ee8b69b9988609648c9731b69783f760486a2646af767e9fbc'
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03d72d4aa2ef2746504e3bbc8999cd987fb856ccb0a31cea2044d529a773e5a47e"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_X_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","fa8a3fbc25f3ec077ba82a37521c1c1a5bd39b44f0e3a947412ebb9ce7de2307"),
                                h => pack("H*","007050fd2f02250337a482a220a3dbc2334738a7485fa13adadd66b28f45a69b"),
                                hasK => 1,
                                k => pack("H*","95ee964ecc7d66aaa18b7d4b19674096820bbef8bf1cec0a59cd8ff88689c15a"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","4811c5b62efec354bc0d98f6b0ba9c218f422c2b5c21d35977c00c97f5192e58"),
  },
  {
    hasK => 1,
    k => pack("H*","e4834325570525f0cdf8c6a44461c55ca8a1b34c37956606760373f9e9f906f0"),
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03d72d4aa2ef2746504e3bbc8999cd987fb856ccb0a31cea2044d529a773e5a47e"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_X_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","fa8a3fbc25f3ec077ba82a37521c1c1a5bd39b44f0e3a947412ebb9ce7de2307"),
                                h => pack("H*","007050fd2f02250337a482a220a3dbc2334738a7485fa13adadd66b28f45a69b"),
                                hasK => 1,
                                k => pack("H*","95ee964ecc7d66aaa18b7d4b19674096820bbef8bf1cec0a59cd8ff88689c15a"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","4811c5b62efec354bc0d98f6b0ba9c218f422c2b5c21d35977c00c97f5192e58"),
  },
  {
    hasK => 1,
    k => pack("H*","e4834325570525f0cdf8c6a44461c55ca8a1b34c37956606760373f9e9f906f0"),
  },
)


### init b_hs
### init b_hs
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_X_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => "Noise_X_secp256r1_AESGCM_SHA256\0",
                                h  => pack("H*","97ed976cc796d80c34e2732a71ac1a71316639102a060ac9a2763296d579a19e"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_X_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => "Noise_X_secp256r1_AESGCM_SHA256\0",
                                h  => pack("H*","97ed976cc796d80c34e2732a71ac1a71316639102a060ac9a2763296d579a19e"),
                              },
    who                    => "b",
  },
)


### b recv msg from a
### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE1y1Kou8nRlBOO7yJmc2Yf7hWzLCj
',
###           'HOogRNUpp3PlpH6iefYrQ0cxtF1G0vgKnmqFfvaAY8lGstiS/A2wB2xaxw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE1y1Kou8nRlBOO7yJmc2Yf7hWzLCj
',
###           'HOogRNUpp3PlpH6iefYrQ0cxtF1G0vgKnmqFfvaAY8lGstiS/A2wB2xaxw==
',
###           '-----END PUBLIC KEY-----
'
### z: '6267b95ef637d44c5c11c17e9f6d2b9a0243fd8492f38519ef18dbf67f0f51f5'
### z: '6267b95ef637d44c5c11c17e9f6d2b9a0243fd8492f38519ef18dbf67f0f51f5'


### read message pattern: 's'
### read message pattern: 's'


### noise decrypt
### noise decrypt
### key: 'ce62c4a85e5ceefb98669c54eb3e4c3bd4565f2344ded2585d766276f9449a96'
### key: 'ce62c4a85e5ceefb98669c54eb3e4c3bd4565f2344ded2585d766276f9449a96'
### iv: 'a8639e18042c0e4bb770a463'
### iv: 'a8639e18042c0e4bb770a463'
### aad: '9d8edd80f1119bb258a6f4cab68c09f1e1d999807b0541d8730404cd67458944'
### aad: '9d8edd80f1119bb258a6f4cab68c09f1e1d999807b0541d8730404cd67458944'
### cipherinfo: '834a31363136393034343134501b77ed0f7dc727a88279911a79a212dd5828bceda6c02080bc267c26744a2447823e9e3a293c8d84cedbac70671f39dec5197ae49758b527c3f1'
### cipherinfo: '834a31363136393034343134501b77ed0f7dc727a88279911a79a212dd5828bceda6c02080bc267c26744a2447823e9e3a293c8d84cedbac70671f39dec5197ae49758b527c3f1'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '9955af2e3d1c3a7f8644a463'
### iv_xor: '9955af2e3d1c3a7f8644a463'
### authtag: '1b77ed0f7dc727a88279911a79a212dd'
### authtag: '1b77ed0f7dc727a88279911a79a212dd'
### ciphertext: 'bceda6c02080bc267c26744a2447823e9e3a293c8d84cedbac70671f39dec5197ae49758b527c3f1'
### ciphertext: 'bceda6c02080bc267c26744a2447823e9e3a293c8d84cedbac70671f39dec5197ae49758b527c3f1'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### read message pattern: 'ss'

### read message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### noise decrypt
### noise decrypt
### key: '52bc2f9621fc87cef4edd94f5ea0d2d0c9642017e7f3a711c43b21ab16bcdcf4'
### key: '52bc2f9621fc87cef4edd94f5ea0d2d0c9642017e7f3a711c43b21ab16bcdcf4'
### iv: '08501f9e611f3059d47a1cd6'
### iv: '08501f9e611f3059d47a1cd6'
### aad: 'da10945d7120db3ca841d97b9a4ca4b08da1386e0c0b941ab4192a977e2122f7'
### aad: 'da10945d7120db3ca841d97b9a4ca4b08da1386e0c0b941ab4192a977e2122f7'
### cipherinfo: '834a3136313639303434313450ee8b69b9988609648c9731b69783f760486a2646af767e9fbc'
### cipherinfo: '834a3136313639303434313450ee8b69b9988609648c9731b69783f760486a2646af767e9fbc'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '39662ea8582f046de54e1cd6'
### iv_xor: '39662ea8582f046de54e1cd6'
### authtag: 'ee8b69b9988609648c9731b69783f760'
### authtag: 'ee8b69b9988609648c9731b69783f760'
### ciphertext: '6a2646af767e9fbc'
### ciphertext: '6a2646af767e9fbc'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'

### b_recv_a_msg: 'init.syn'

### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_X_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","03d72d4aa2ef2746504e3bbc8999cd987fb856ccb0a31cea2044d529a773e5a47e"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","fa8a3fbc25f3ec077ba82a37521c1c1a5bd39b44f0e3a947412ebb9ce7de2307"),
                                h => pack("H*","007050fd2f02250337a482a220a3dbc2334738a7485fa13adadd66b28f45a69b"),
                                hasK => 1,
                                k => pack("H*","95ee964ecc7d66aaa18b7d4b19674096820bbef8bf1cec0a59cd8ff88689c15a"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","4811c5b62efec354bc0d98f6b0ba9c218f422c2b5c21d35977c00c97f5192e58"),
  },
  {
    hasK => 1,
    k => pack("H*","e4834325570525f0cdf8c6a44461c55ca8a1b34c37956606760373f9e9f906f0"),
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_X_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","03d72d4aa2ef2746504e3bbc8999cd987fb856ccb0a31cea2044d529a773e5a47e"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","fa8a3fbc25f3ec077ba82a37521c1c1a5bd39b44f0e3a947412ebb9ce7de2307"),
                                h => pack("H*","007050fd2f02250337a482a220a3dbc2334738a7485fa13adadd66b28f45a69b"),
                                hasK => 1,
                                k => pack("H*","95ee964ecc7d66aaa18b7d4b19674096820bbef8bf1cec0a59cd8ff88689c15a"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","4811c5b62efec354bc0d98f6b0ba9c218f422c2b5c21d35977c00c97f5192e58"),
  },
  {
    hasK => 1,
    k => pack("H*","e4834325570525f0cdf8c6a44461c55ca8a1b34c37956606760373f9e9f906f0"),
  },
)

### a send comm msg to b

### a send comm msg to b


### noise encrypt
### noise encrypt
### key: 'e67469feda4f641760ebae69e07d5219ccd6b18d30ec895c2ff8d3a7db2cf4ae'
### key: 'e67469feda4f641760ebae69e07d5219ccd6b18d30ec895c2ff8d3a7db2cf4ae'
### iv: '1b08004bd92ee4cd2a475c22'
### iv: '1b08004bd92ee4cd2a475c22'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '2a3e317de01ed0f91b735c22'
### iv_xor: '2a3e317de01ed0f91b735c22'
### aad: '007050fd2f02250337a482a220a3dbc2334738a7485fa13adadd66b28f45a69b'
### aad: '007050fd2f02250337a482a220a3dbc2334738a7485fa13adadd66b28f45a69b'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'b8783fda7c8dc606a1728a1cfc345eb68e3a3b339e636ce5164008c2dc483749103a473a7783d4e96678d012a323d534050a91'
### ciphertext: 'b8783fda7c8dc606a1728a1cfc345eb68e3a3b339e636ce5164008c2dc483749103a473a7783d4e96678d012a323d534050a91'
### authtag: '77c7471418590fbe2cbe10f2d75beb12'
### authtag: '77c7471418590fbe2cbe10f2d75beb12'
### cipherinfo: '834a313631363930343431345077c7471418590fbe2cbe10f2d75beb125833b8783fda7c8dc606a1728a1cfc345eb68e3a3b339e636ce5164008c2dc483749103a473a7783d4e96678d012a323d534050a91'
### cipherinfo: '834a313631363930343431345077c7471418590fbe2cbe10f2d75beb125833b8783fda7c8dc606a1728a1cfc345eb68e3a3b339e636ce5164008c2dc483749103a473a7783d4e96678d012a323d534050a91'


### b recv comm msg from a
### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: 'e67469feda4f641760ebae69e07d5219ccd6b18d30ec895c2ff8d3a7db2cf4ae'
### key: 'e67469feda4f641760ebae69e07d5219ccd6b18d30ec895c2ff8d3a7db2cf4ae'
### iv: '1b08004bd92ee4cd2a475c22'
### iv: '1b08004bd92ee4cd2a475c22'
### aad: '007050fd2f02250337a482a220a3dbc2334738a7485fa13adadd66b28f45a69b'
### aad: '007050fd2f02250337a482a220a3dbc2334738a7485fa13adadd66b28f45a69b'
### cipherinfo: '834a313631363930343431345077c7471418590fbe2cbe10f2d75beb125833b8783fda7c8dc606a1728a1cfc345eb68e3a3b339e636ce5164008c2dc483749103a473a7783d4e96678d012a323d534050a91'
### cipherinfo: '834a313631363930343431345077c7471418590fbe2cbe10f2d75beb125833b8783fda7c8dc606a1728a1cfc345eb68e3a3b339e636ce5164008c2dc483749103a473a7783d4e96678d012a323d534050a91'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '2a3e317de01ed0f91b735c22'
### iv_xor: '2a3e317de01ed0f91b735c22'
### authtag: '77c7471418590fbe2cbe10f2d75beb12'
### authtag: '77c7471418590fbe2cbe10f2d75beb12'
### ciphertext: 'b8783fda7c8dc606a1728a1cfc345eb68e3a3b339e636ce5164008c2dc483749103a473a7783d4e96678d012a323d534050a91'
### ciphertext: 'b8783fda7c8dc606a1728a1cfc345eb68e3a3b339e636ce5164008c2dc483749103a473a7783d4e96678d012a323d534050a91'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'


### b send comm msg to a
### b send comm msg to a


### noise encrypt
### noise encrypt
### key: '435fa0de5489843d7fafbd8795c4cb779f9e9a11d5b94ba4ea3c344f28900716'
### key: '435fa0de5489843d7fafbd8795c4cb779f9e9a11d5b94ba4ea3c344f28900716'
### iv: '40eab115088dc0896cfb5d14'
### iv: '40eab115088dc0896cfb5d14'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '71dc802331bdf4bd5dcf5d14'
### iv_xor: '71dc802331bdf4bd5dcf5d14'
### aad: '007050fd2f02250337a482a220a3dbc2334738a7485fa13adadd66b28f45a69b'
### aad: '007050fd2f02250337a482a220a3dbc2334738a7485fa13adadd66b28f45a69b'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '95e2b62dacbcec0236fa77dab4e3f6b1d0364ff83b28ff7cc154ab17bc1412c38cabc51033d6a4473ee96a160287e4'
### ciphertext: '95e2b62dacbcec0236fa77dab4e3f6b1d0364ff83b28ff7cc154ab17bc1412c38cabc51033d6a4473ee96a160287e4'
### authtag: '11bcdc024185aadaab95e7557c9679fb'
### authtag: '11bcdc024185aadaab95e7557c9679fb'
### cipherinfo: '834a313631363930343431345011bcdc024185aadaab95e7557c9679fb582f95e2b62dacbcec0236fa77dab4e3f6b1d0364ff83b28ff7cc154ab17bc1412c38cabc51033d6a4473ee96a160287e4'
### cipherinfo: '834a313631363930343431345011bcdc024185aadaab95e7557c9679fb582f95e2b62dacbcec0236fa77dab4e3f6b1d0364ff83b28ff7cc154ab17bc1412c38cabc51033d6a4473ee96a160287e4'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '435fa0de5489843d7fafbd8795c4cb779f9e9a11d5b94ba4ea3c344f28900716'
### key: '435fa0de5489843d7fafbd8795c4cb779f9e9a11d5b94ba4ea3c344f28900716'
### iv: '40eab115088dc0896cfb5d14'
### iv: '40eab115088dc0896cfb5d14'
### aad: '007050fd2f02250337a482a220a3dbc2334738a7485fa13adadd66b28f45a69b'
### aad: '007050fd2f02250337a482a220a3dbc2334738a7485fa13adadd66b28f45a69b'
### cipherinfo: '834a313631363930343431345011bcdc024185aadaab95e7557c9679fb582f95e2b62dacbcec0236fa77dab4e3f6b1d0364ff83b28ff7cc154ab17bc1412c38cabc51033d6a4473ee96a160287e4'
### cipherinfo: '834a313631363930343431345011bcdc024185aadaab95e7557c9679fb582f95e2b62dacbcec0236fa77dab4e3f6b1d0364ff83b28ff7cc154ab17bc1412c38cabc51033d6a4473ee96a160287e4'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '71dc802331bdf4bd5dcf5d14'
### iv_xor: '71dc802331bdf4bd5dcf5d14'
### authtag: '11bcdc024185aadaab95e7557c9679fb'
### authtag: '11bcdc024185aadaab95e7557c9679fb'
### ciphertext: '95e2b62dacbcec0236fa77dab4e3f6b1d0364ff83b28ff7cc154ab17bc1412c38cabc51033d6a4473ee96a160287e4'
### ciphertext: '95e2b62dacbcec0236fa77dab4e3f6b1d0364ff83b28ff7cc154ab17bc1412c38cabc51033d6a4473ee96a160287e4'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'X',
###                               undef,
###                               undef

### -----------end test --------: 'X',
###                               undef,
###                               undef


### -----------start test --------: 'X',
###                                 'test_psk',
###                                 0
### -----------start test --------: 'X',
###                                 'test_psk',
###                                 0

### init a_hs

### init a_hs
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "s", "ss"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Xpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","3a1a0be4945009096ea4863a3ef83645ad877df7c18dab66359e0da265be94c0"),
                                h  => pack("H*","74a3508b972aa7fd178316c8ec4e1ba4903a334509c80efe06bec048973661fb"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "s", "ss"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Xpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","3a1a0be4945009096ea4863a3ef83645ad877df7c18dab66359e0da265be94c0"),
                                h  => pack("H*","74a3508b972aa7fd178316c8ec4e1ba4903a334509c80efe06bec048973661fb"),
                              },
    who                    => "a",
  },
)

### a send msg to b

### a send msg to b

### $a_msg_src: 'init.syn'

### $a_msg_src: 'init.syn'

### write message pattern: 'psk'

### write message pattern: 'psk'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '039266b817e7ae703283d195cf01a7f65b1cf8d30e6385eea1c52618e762d82268'

### public compressed: '039266b817e7ae703283d195cf01a7f65b1cf8d30e6385eea1c52618e762d82268'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIIub/dZAWnA/8pPElTGVob7wOVfQ9uWrMif9vzILJXbooAoGCCqGSM49
',
###             'AwEHoUQDQgAEkma4F+eucDKD0ZXPAaf2Wxz40w5jhe6hxSYY52LYImjpuG7KsECN
',
###             'lKql9q4LU2Ie8xx7bVkU9ojcfIuQzWl+wQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIIub/dZAWnA/8pPElTGVob7wOVfQ9uWrMif9vzILJXbooAoGCCqGSM49
',
###             'AwEHoUQDQgAEkma4F+eucDKD0ZXPAaf2Wxz40w5jhe6hxSYY52LYImjpuG7KsECN
',
###             'lKql9q4LU2Ie8xx7bVkU9ojcfIuQzWl+wQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '37d1ebb0f811107d5796443974f5951aa365cdf42aea0d114ddd1024e331153b'
### z: '37d1ebb0f811107d5796443974f5951aa365cdf42aea0d114ddd1024e331153b'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: 'dacdc7b6014f9822f8cab395d1b2115ee19aeb2444374e97cda17b55f38ed833'
### key: 'dacdc7b6014f9822f8cab395d1b2115ee19aeb2444374e97cda17b55f38ed833'
### iv: 'c1591d1b8f605b990c7441fc'
### iv: 'c1591d1b8f605b990c7441fc'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'f06f2c2db6506fad3d4041fc'
### iv_xor: 'f06f2c2db6506fad3d4041fc'
### aad: 'c5ff067ebad532c55b8c7b8d5a9fac42bc275ea4df8dcb23bf713962752cb7ad'
### aad: 'c5ff067ebad532c55b8c7b8d5a9fac42bc275ea4df8dcb23bf713962752cb7ad'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: '9844a348169f9ed69e434630c21c30778de5fe293257c8ada0e52e45eff0799ad8f86afc81243cd6'
### ciphertext: '9844a348169f9ed69e434630c21c30778de5fe293257c8ada0e52e45eff0799ad8f86afc81243cd6'
### authtag: '2d66add22440430dc7cf0a7552835ac4'
### authtag: '2d66add22440430dc7cf0a7552835ac4'
### cipherinfo: '834a31363136393034343134502d66add22440430dc7cf0a7552835ac458289844a348169f9ed69e434630c21c30778de5fe293257c8ada0e52e45eff0799ad8f86afc81243cd6'
### cipherinfo: '834a31363136393034343134502d66add22440430dc7cf0a7552835ac458289844a348169f9ed69e434630c21c30778de5fe293257c8ada0e52e45eff0799ad8f86afc81243cd6'

### write message pattern: 'ss'

### write message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### noise encrypt

### noise encrypt
### key: '1d5926646d3fd38c8fc4ba867ad88fe6769f6787479998d2df1e32e34b7a550c'
### key: '1d5926646d3fd38c8fc4ba867ad88fe6769f6787479998d2df1e32e34b7a550c'
### iv: '517fc424a6570d740fcf992e'
### iv: '517fc424a6570d740fcf992e'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '6049f5129f6739403efb992e'
### iv_xor: '6049f5129f6739403efb992e'
### aad: '296454f4aa6db3283bf8a3750e819704e5f6547da08615759a44dd4b38d8a6fb'
### aad: '296454f4aa6db3283bf8a3750e819704e5f6547da08615759a44dd4b38d8a6fb'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: 'c036df26db4821f6'
### ciphertext: 'c036df26db4821f6'
### authtag: '84bdc0e9815c0a5454eeb248597d20cd'
### authtag: '84bdc0e9815c0a5454eeb248597d20cd'
### cipherinfo: '834a313631363930343431345084bdc0e9815c0a5454eeb248597d20cd48c036df26db4821f6'
### cipherinfo: '834a313631363930343431345084bdc0e9815c0a5454eeb248597d20cd48c036df26db4821f6'

### a_msg: '835821039266b817e7ae703283d195cf01a7f65b1cf8d30e6385eea1c52618e762d822685847834a31363136393034343134502d66add22440430dc7cf0a7552835ac458289844a348169f9ed69e434630c21c30778de5fe293257c8ada0e52e45eff0799ad8f86afc81243cd65826834a313631363930343431345084bdc0e9815c0a5454eeb248597d20cd48c036df26db4821f6'

### a_msg: '835821039266b817e7ae703283d195cf01a7f65b1cf8d30e6385eea1c52618e762d822685847834a31363136393034343134502d66add22440430dc7cf0a7552835ac458289844a348169f9ed69e434630c21c30778de5fe293257c8ada0e52e45eff0799ad8f86afc81243cd65826834a313631363930343431345084bdc0e9815c0a5454eeb248597d20cd48c036df26db4821f6'
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","039266b817e7ae703283d195cf01a7f65b1cf8d30e6385eea1c52618e762d82268"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "s", "ss"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Xpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","bb8ed6a031ef7a80b8d274e62e74750808d884816245cfe58781aeca80e05f8e"),
                                h => pack("H*","50f181b448b188cab5a42df26830a5da1b9b66abe18c9d17a6a8235b85813bde"),
                                hasK => 1,
                                k => pack("H*","8bd06c0f45d47642496e25d84d0f9c3121eb5b4289f940c08e5f1026cfcac764"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","e66ccc4e2ed4c1f651334308808ea82198d94982a23b0007b6becc20ef72af6b"),
  },
  {
    hasK => 1,
    k => pack("H*","9a8f7802ff9bb16969e43a8868db2ae772d8c7937f0829e52cce85fa5d654a17"),
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","039266b817e7ae703283d195cf01a7f65b1cf8d30e6385eea1c52618e762d82268"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "s", "ss"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Xpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","bb8ed6a031ef7a80b8d274e62e74750808d884816245cfe58781aeca80e05f8e"),
                                h => pack("H*","50f181b448b188cab5a42df26830a5da1b9b66abe18c9d17a6a8235b85813bde"),
                                hasK => 1,
                                k => pack("H*","8bd06c0f45d47642496e25d84d0f9c3121eb5b4289f940c08e5f1026cfcac764"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","e66ccc4e2ed4c1f651334308808ea82198d94982a23b0007b6becc20ef72af6b"),
  },
  {
    hasK => 1,
    k => pack("H*","9a8f7802ff9bb16969e43a8868db2ae772d8c7937f0829e52cce85fa5d654a17"),
  },
)

### init b_hs

### init b_hs
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "s", "ss"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Xpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","3a1a0be4945009096ea4863a3ef83645ad877df7c18dab66359e0da265be94c0"),
                                h  => pack("H*","74a3508b972aa7fd178316c8ec4e1ba4903a334509c80efe06bec048973661fb"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "s", "ss"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Xpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","3a1a0be4945009096ea4863a3ef83645ad877df7c18dab66359e0da265be94c0"),
                                h  => pack("H*","74a3508b972aa7fd178316c8ec4e1ba4903a334509c80efe06bec048973661fb"),
                              },
    who                    => "b",
  },
)


### b recv msg from a
### b recv msg from a

### read message pattern: 'psk'

### read message pattern: 'psk'

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEkma4F+eucDKD0ZXPAaf2Wxz40w5j
',
###           'he6hxSYY52LYImjpuG7KsECNlKql9q4LU2Ie8xx7bVkU9ojcfIuQzWl+wQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEkma4F+eucDKD0ZXPAaf2Wxz40w5j
',
###           'he6hxSYY52LYImjpuG7KsECNlKql9q4LU2Ie8xx7bVkU9ojcfIuQzWl+wQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '37d1ebb0f811107d5796443974f5951aa365cdf42aea0d114ddd1024e331153b'
### z: '37d1ebb0f811107d5796443974f5951aa365cdf42aea0d114ddd1024e331153b'

### read message pattern: 's'

### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: 'dacdc7b6014f9822f8cab395d1b2115ee19aeb2444374e97cda17b55f38ed833'
### key: 'dacdc7b6014f9822f8cab395d1b2115ee19aeb2444374e97cda17b55f38ed833'
### iv: 'c1591d1b8f605b990c7441fc'
### iv: 'c1591d1b8f605b990c7441fc'
### aad: 'c5ff067ebad532c55b8c7b8d5a9fac42bc275ea4df8dcb23bf713962752cb7ad'
### aad: 'c5ff067ebad532c55b8c7b8d5a9fac42bc275ea4df8dcb23bf713962752cb7ad'
### cipherinfo: '834a31363136393034343134502d66add22440430dc7cf0a7552835ac458289844a348169f9ed69e434630c21c30778de5fe293257c8ada0e52e45eff0799ad8f86afc81243cd6'
### cipherinfo: '834a31363136393034343134502d66add22440430dc7cf0a7552835ac458289844a348169f9ed69e434630c21c30778de5fe293257c8ada0e52e45eff0799ad8f86afc81243cd6'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'f06f2c2db6506fad3d4041fc'
### iv_xor: 'f06f2c2db6506fad3d4041fc'
### authtag: '2d66add22440430dc7cf0a7552835ac4'
### authtag: '2d66add22440430dc7cf0a7552835ac4'
### ciphertext: '9844a348169f9ed69e434630c21c30778de5fe293257c8ada0e52e45eff0799ad8f86afc81243cd6'
### ciphertext: '9844a348169f9ed69e434630c21c30778de5fe293257c8ada0e52e45eff0799ad8f86afc81243cd6'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### read message pattern: 'ss'

### read message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### noise decrypt

### noise decrypt
### key: '1d5926646d3fd38c8fc4ba867ad88fe6769f6787479998d2df1e32e34b7a550c'
### key: '1d5926646d3fd38c8fc4ba867ad88fe6769f6787479998d2df1e32e34b7a550c'
### iv: '517fc424a6570d740fcf992e'
### iv: '517fc424a6570d740fcf992e'
### aad: '296454f4aa6db3283bf8a3750e819704e5f6547da08615759a44dd4b38d8a6fb'
### aad: '296454f4aa6db3283bf8a3750e819704e5f6547da08615759a44dd4b38d8a6fb'
### cipherinfo: '834a313631363930343431345084bdc0e9815c0a5454eeb248597d20cd48c036df26db4821f6'
### cipherinfo: '834a313631363930343431345084bdc0e9815c0a5454eeb248597d20cd48c036df26db4821f6'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '6049f5129f6739403efb992e'
### iv_xor: '6049f5129f6739403efb992e'
### authtag: '84bdc0e9815c0a5454eeb248597d20cd'
### authtag: '84bdc0e9815c0a5454eeb248597d20cd'
### ciphertext: 'c036df26db4821f6'
### ciphertext: 'c036df26db4821f6'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'

### b_recv_a_msg: 'init.syn'

### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "s", "ss"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Xpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","039266b817e7ae703283d195cf01a7f65b1cf8d30e6385eea1c52618e762d82268"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","bb8ed6a031ef7a80b8d274e62e74750808d884816245cfe58781aeca80e05f8e"),
                                h => pack("H*","50f181b448b188cab5a42df26830a5da1b9b66abe18c9d17a6a8235b85813bde"),
                                hasK => 1,
                                k => pack("H*","8bd06c0f45d47642496e25d84d0f9c3121eb5b4289f940c08e5f1026cfcac764"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","e66ccc4e2ed4c1f651334308808ea82198d94982a23b0007b6becc20ef72af6b"),
  },
  {
    hasK => 1,
    k => pack("H*","9a8f7802ff9bb16969e43a8868db2ae772d8c7937f0829e52cce85fa5d654a17"),
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "s", "ss"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Xpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","039266b817e7ae703283d195cf01a7f65b1cf8d30e6385eea1c52618e762d82268"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","bb8ed6a031ef7a80b8d274e62e74750808d884816245cfe58781aeca80e05f8e"),
                                h => pack("H*","50f181b448b188cab5a42df26830a5da1b9b66abe18c9d17a6a8235b85813bde"),
                                hasK => 1,
                                k => pack("H*","8bd06c0f45d47642496e25d84d0f9c3121eb5b4289f940c08e5f1026cfcac764"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","e66ccc4e2ed4c1f651334308808ea82198d94982a23b0007b6becc20ef72af6b"),
  },
  {
    hasK => 1,
    k => pack("H*","9a8f7802ff9bb16969e43a8868db2ae772d8c7937f0829e52cce85fa5d654a17"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: 'f5311feb47d03189c6e2a42b750893d2596cc858d268ee537aaef8e3a0bcbf23'
### key: 'f5311feb47d03189c6e2a42b750893d2596cc858d268ee537aaef8e3a0bcbf23'
### iv: 'b38caba7691007f7628eb8ce'
### iv: 'b38caba7691007f7628eb8ce'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '82ba9a91502033c353bab8ce'
### iv_xor: '82ba9a91502033c353bab8ce'
### aad: '50f181b448b188cab5a42df26830a5da1b9b66abe18c9d17a6a8235b85813bde'
### aad: '50f181b448b188cab5a42df26830a5da1b9b66abe18c9d17a6a8235b85813bde'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '7d2a16eb1e1876dc44100a322962950f47832eeed97e3127cebc5a18956938f4bdb64359f21e4c56a3d128e423163782bb7762'
### ciphertext: '7d2a16eb1e1876dc44100a322962950f47832eeed97e3127cebc5a18956938f4bdb64359f21e4c56a3d128e423163782bb7762'
### authtag: '18d72fd60c4435891ce3f4affc572b2c'
### authtag: '18d72fd60c4435891ce3f4affc572b2c'
### cipherinfo: '834a313631363930343431345018d72fd60c4435891ce3f4affc572b2c58337d2a16eb1e1876dc44100a322962950f47832eeed97e3127cebc5a18956938f4bdb64359f21e4c56a3d128e423163782bb7762'
### cipherinfo: '834a313631363930343431345018d72fd60c4435891ce3f4affc572b2c58337d2a16eb1e1876dc44100a322962950f47832eeed97e3127cebc5a18956938f4bdb64359f21e4c56a3d128e423163782bb7762'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: 'f5311feb47d03189c6e2a42b750893d2596cc858d268ee537aaef8e3a0bcbf23'
### key: 'f5311feb47d03189c6e2a42b750893d2596cc858d268ee537aaef8e3a0bcbf23'
### iv: 'b38caba7691007f7628eb8ce'
### iv: 'b38caba7691007f7628eb8ce'
### aad: '50f181b448b188cab5a42df26830a5da1b9b66abe18c9d17a6a8235b85813bde'
### aad: '50f181b448b188cab5a42df26830a5da1b9b66abe18c9d17a6a8235b85813bde'
### cipherinfo: '834a313631363930343431345018d72fd60c4435891ce3f4affc572b2c58337d2a16eb1e1876dc44100a322962950f47832eeed97e3127cebc5a18956938f4bdb64359f21e4c56a3d128e423163782bb7762'
### cipherinfo: '834a313631363930343431345018d72fd60c4435891ce3f4affc572b2c58337d2a16eb1e1876dc44100a322962950f47832eeed97e3127cebc5a18956938f4bdb64359f21e4c56a3d128e423163782bb7762'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '82ba9a91502033c353bab8ce'
### iv_xor: '82ba9a91502033c353bab8ce'
### authtag: '18d72fd60c4435891ce3f4affc572b2c'
### authtag: '18d72fd60c4435891ce3f4affc572b2c'
### ciphertext: '7d2a16eb1e1876dc44100a322962950f47832eeed97e3127cebc5a18956938f4bdb64359f21e4c56a3d128e423163782bb7762'
### ciphertext: '7d2a16eb1e1876dc44100a322962950f47832eeed97e3127cebc5a18956938f4bdb64359f21e4c56a3d128e423163782bb7762'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b send comm msg to a

### b send comm msg to a

### noise encrypt

### noise encrypt
### key: 'd8802a9eb061d9c3e6676becad2116f91746ecd2d4f374373ba5994656fbeb69'
### key: 'd8802a9eb061d9c3e6676becad2116f91746ecd2d4f374373ba5994656fbeb69'
### iv: '9bc6c123297d0f81df0227de'
### iv: '9bc6c123297d0f81df0227de'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'aaf0f015104d3bb5ee3627de'
### iv_xor: 'aaf0f015104d3bb5ee3627de'
### aad: '50f181b448b188cab5a42df26830a5da1b9b66abe18c9d17a6a8235b85813bde'
### aad: '50f181b448b188cab5a42df26830a5da1b9b66abe18c9d17a6a8235b85813bde'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '8cf102b2ebf89cbf0f3f47aade2f20babe0cfa4bcbf58326be762936798a3a423b4f642eaf4844de9be4f2e8b6a3c8'
### ciphertext: '8cf102b2ebf89cbf0f3f47aade2f20babe0cfa4bcbf58326be762936798a3a423b4f642eaf4844de9be4f2e8b6a3c8'
### authtag: 'b7d50686e83395993712d1135b6c613d'
### authtag: 'b7d50686e83395993712d1135b6c613d'
### cipherinfo: '834a3136313639303434313450b7d50686e83395993712d1135b6c613d582f8cf102b2ebf89cbf0f3f47aade2f20babe0cfa4bcbf58326be762936798a3a423b4f642eaf4844de9be4f2e8b6a3c8'
### cipherinfo: '834a3136313639303434313450b7d50686e83395993712d1135b6c613d582f8cf102b2ebf89cbf0f3f47aade2f20babe0cfa4bcbf58326be762936798a3a423b4f642eaf4844de9be4f2e8b6a3c8'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: 'd8802a9eb061d9c3e6676becad2116f91746ecd2d4f374373ba5994656fbeb69'
### key: 'd8802a9eb061d9c3e6676becad2116f91746ecd2d4f374373ba5994656fbeb69'
### iv: '9bc6c123297d0f81df0227de'
### iv: '9bc6c123297d0f81df0227de'
### aad: '50f181b448b188cab5a42df26830a5da1b9b66abe18c9d17a6a8235b85813bde'
### aad: '50f181b448b188cab5a42df26830a5da1b9b66abe18c9d17a6a8235b85813bde'
### cipherinfo: '834a3136313639303434313450b7d50686e83395993712d1135b6c613d582f8cf102b2ebf89cbf0f3f47aade2f20babe0cfa4bcbf58326be762936798a3a423b4f642eaf4844de9be4f2e8b6a3c8'
### cipherinfo: '834a3136313639303434313450b7d50686e83395993712d1135b6c613d582f8cf102b2ebf89cbf0f3f47aade2f20babe0cfa4bcbf58326be762936798a3a423b4f642eaf4844de9be4f2e8b6a3c8'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'aaf0f015104d3bb5ee3627de'
### iv_xor: 'aaf0f015104d3bb5ee3627de'
### authtag: 'b7d50686e83395993712d1135b6c613d'
### authtag: 'b7d50686e83395993712d1135b6c613d'
### ciphertext: '8cf102b2ebf89cbf0f3f47aade2f20babe0cfa4bcbf58326be762936798a3a423b4f642eaf4844de9be4f2e8b6a3c8'
### ciphertext: '8cf102b2ebf89cbf0f3f47aade2f20babe0cfa4bcbf58326be762936798a3a423b4f642eaf4844de9be4f2e8b6a3c8'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'X',
###                               'test_psk',
###                               0

### -----------end test --------: 'X',
###                               'test_psk',
###                               0

### -----------start test --------: 'X',
###                                 'test_psk',
###                                 1

### -----------start test --------: 'X',
###                                 'test_psk',
###                                 1

### init a_hs

### init a_hs
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss", "psk"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Xpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","391de2f80f075602d4bcaf23f2eeedaabd417a7c5e976d0c392dd659334b7d67"),
                                h  => pack("H*","279b6cdf7a26ff16d42202ac420586465a003cc00e772c2d27b793375112861a"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss", "psk"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Xpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","391de2f80f075602d4bcaf23f2eeedaabd417a7c5e976d0c392dd659334b7d67"),
                                h  => pack("H*","279b6cdf7a26ff16d42202ac420586465a003cc00e772c2d27b793375112861a"),
                              },
    who                    => "a",
  },
)

### a send msg to b

### a send msg to b

### $a_msg_src: 'init.syn'

### $a_msg_src: 'init.syn'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '02087a2b50ef8fe3826eaf8daa13d31cb77e69c13cc2721157e69eb729190c6442'

### public compressed: '02087a2b50ef8fe3826eaf8daa13d31cb77e69c13cc2721157e69eb729190c6442'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEID/O6jH+L7tOefqLS/RhqfH7/vnkrwbSx8H9+VL6xfEFoAoGCCqGSM49
',
###             'AwEHoUQDQgAECHorUO+P44Jur42qE9Mct35pwTzCchFX5p63KRkMZEJ2GCOr3T89
',
###             '0qSuol6J+KmKTNDmr7jDZUYjks56ddaQjg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEID/O6jH+L7tOefqLS/RhqfH7/vnkrwbSx8H9+VL6xfEFoAoGCCqGSM49
',
###             'AwEHoUQDQgAECHorUO+P44Jur42qE9Mct35pwTzCchFX5p63KRkMZEJ2GCOr3T89
',
###             '0qSuol6J+KmKTNDmr7jDZUYjks56ddaQjg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'a7e495bc29bf528193ce7546ccaf1138ecd0a4ceea1b600333510cbaa9642c57'
### z: 'a7e495bc29bf528193ce7546ccaf1138ecd0a4ceea1b600333510cbaa9642c57'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '8c8ced3eac4f7ae5359c52e3a4e16283339175a137ce9d8de0645d2b35fe167b'
### key: '8c8ced3eac4f7ae5359c52e3a4e16283339175a137ce9d8de0645d2b35fe167b'
### iv: '65f113ff15749e457ae027b0'
### iv: '65f113ff15749e457ae027b0'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '54c722c92c44aa714bd427b0'
### iv_xor: '54c722c92c44aa714bd427b0'
### aad: '148919ef748777a3f70f46509721ab4da80bdf3ea38fc16ec50b822656e03913'
### aad: '148919ef748777a3f70f46509721ab4da80bdf3ea38fc16ec50b822656e03913'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: 'c463dfdc8182c053bec43c2609c740ffdffc97656227b00193510985df1b4bbd9f479323164fe13c'
### ciphertext: 'c463dfdc8182c053bec43c2609c740ffdffc97656227b00193510985df1b4bbd9f479323164fe13c'
### authtag: '2a8f32692a941c7b18bd0d34c7a2d165'
### authtag: '2a8f32692a941c7b18bd0d34c7a2d165'
### cipherinfo: '834a31363136393034343134502a8f32692a941c7b18bd0d34c7a2d1655828c463dfdc8182c053bec43c2609c740ffdffc97656227b00193510985df1b4bbd9f479323164fe13c'
### cipherinfo: '834a31363136393034343134502a8f32692a941c7b18bd0d34c7a2d1655828c463dfdc8182c053bec43c2609c740ffdffc97656227b00193510985df1b4bbd9f479323164fe13c'

### write message pattern: 'ss'

### write message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### write message pattern: 'psk'

### write message pattern: 'psk'

### noise encrypt

### noise encrypt
### key: '10928567d3527940574e4476ea7f86d13f2f9185a0be2218da8a9cb61a0a8330'
### key: '10928567d3527940574e4476ea7f86d13f2f9185a0be2218da8a9cb61a0a8330'
### iv: '4765b4610e496641aaf3b7c7'
### iv: '4765b4610e496641aaf3b7c7'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '76538557377952759bc7b7c7'
### iv_xor: '76538557377952759bc7b7c7'
### aad: 'aeb9eecb037820176a51173f3200b92221005a875a9d320ddda300bff3ead426'
### aad: 'aeb9eecb037820176a51173f3200b92221005a875a9d320ddda300bff3ead426'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: 'e1c37e57b08b91e4'
### ciphertext: 'e1c37e57b08b91e4'
### authtag: '9e7e059d3e3c90f2406eb0bc45f06e33'
### authtag: '9e7e059d3e3c90f2406eb0bc45f06e33'
### cipherinfo: '834a31363136393034343134509e7e059d3e3c90f2406eb0bc45f06e3348e1c37e57b08b91e4'
### cipherinfo: '834a31363136393034343134509e7e059d3e3c90f2406eb0bc45f06e3348e1c37e57b08b91e4'

### a_msg: '83582102087a2b50ef8fe3826eaf8daa13d31cb77e69c13cc2721157e69eb729190c64425847834a31363136393034343134502a8f32692a941c7b18bd0d34c7a2d1655828c463dfdc8182c053bec43c2609c740ffdffc97656227b00193510985df1b4bbd9f479323164fe13c5826834a31363136393034343134509e7e059d3e3c90f2406eb0bc45f06e3348e1c37e57b08b91e4'

### a_msg: '83582102087a2b50ef8fe3826eaf8daa13d31cb77e69c13cc2721157e69eb729190c64425847834a31363136393034343134502a8f32692a941c7b18bd0d34c7a2d1655828c463dfdc8182c053bec43c2609c740ffdffc97656227b00193510985df1b4bbd9f479323164fe13c5826834a31363136393034343134509e7e059d3e3c90f2406eb0bc45f06e3348e1c37e57b08b91e4'
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02087a2b50ef8fe3826eaf8daa13d31cb77e69c13cc2721157e69eb729190c6442"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss", "psk"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Xpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","72b9fdc2192751a781d34b07de88b8888be2672c456d15d40ce83d807e1c8fe6"),
                                h => pack("H*","a78ba77210a0af66323f3e2522fb713d64472cadfa67abf8fbd8f40590b0e078"),
                                hasK => 1,
                                k => pack("H*","02a32aad3594164c2393bd00e15b2ee548c50f79ed064b596ee8fb6ed7adff5a"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","431c80b59b1bf630b75ff64764235e13f82285f2def3ff524f309c7fe5e94a4a"),
  },
  {
    hasK => 1,
    k => pack("H*","91bf755e0c5e43475c4eb560d088214455cb70b1b145db67518c407ca8fee2ea"),
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02087a2b50ef8fe3826eaf8daa13d31cb77e69c13cc2721157e69eb729190c6442"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss", "psk"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Xpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","72b9fdc2192751a781d34b07de88b8888be2672c456d15d40ce83d807e1c8fe6"),
                                h => pack("H*","a78ba77210a0af66323f3e2522fb713d64472cadfa67abf8fbd8f40590b0e078"),
                                hasK => 1,
                                k => pack("H*","02a32aad3594164c2393bd00e15b2ee548c50f79ed064b596ee8fb6ed7adff5a"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","431c80b59b1bf630b75ff64764235e13f82285f2def3ff524f309c7fe5e94a4a"),
  },
  {
    hasK => 1,
    k => pack("H*","91bf755e0c5e43475c4eb560d088214455cb70b1b145db67518c407ca8fee2ea"),
  },
)

### init b_hs

### init b_hs
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss", "psk"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Xpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","391de2f80f075602d4bcaf23f2eeedaabd417a7c5e976d0c392dd659334b7d67"),
                                h  => pack("H*","279b6cdf7a26ff16d42202ac420586465a003cc00e772c2d27b793375112861a"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss", "psk"]],
    msg_id                 => 0,
    prologue               => "some_info",
    protocol_name          => "Noise_Xpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","391de2f80f075602d4bcaf23f2eeedaabd417a7c5e976d0c392dd659334b7d67"),
                                h  => pack("H*","279b6cdf7a26ff16d42202ac420586465a003cc00e772c2d27b793375112861a"),
                              },
    who                    => "b",
  },
)

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAECHorUO+P44Jur42qE9Mct35pwTzC
',
###           'chFX5p63KRkMZEJ2GCOr3T890qSuol6J+KmKTNDmr7jDZUYjks56ddaQjg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAECHorUO+P44Jur42qE9Mct35pwTzC
',
###           'chFX5p63KRkMZEJ2GCOr3T890qSuol6J+KmKTNDmr7jDZUYjks56ddaQjg==
',
###           '-----END PUBLIC KEY-----
'
### z: 'a7e495bc29bf528193ce7546ccaf1138ecd0a4ceea1b600333510cbaa9642c57'
### z: 'a7e495bc29bf528193ce7546ccaf1138ecd0a4ceea1b600333510cbaa9642c57'

### read message pattern: 's'

### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: '8c8ced3eac4f7ae5359c52e3a4e16283339175a137ce9d8de0645d2b35fe167b'
### key: '8c8ced3eac4f7ae5359c52e3a4e16283339175a137ce9d8de0645d2b35fe167b'
### iv: '65f113ff15749e457ae027b0'
### iv: '65f113ff15749e457ae027b0'
### aad: '148919ef748777a3f70f46509721ab4da80bdf3ea38fc16ec50b822656e03913'
### aad: '148919ef748777a3f70f46509721ab4da80bdf3ea38fc16ec50b822656e03913'
### cipherinfo: '834a31363136393034343134502a8f32692a941c7b18bd0d34c7a2d1655828c463dfdc8182c053bec43c2609c740ffdffc97656227b00193510985df1b4bbd9f479323164fe13c'
### cipherinfo: '834a31363136393034343134502a8f32692a941c7b18bd0d34c7a2d1655828c463dfdc8182c053bec43c2609c740ffdffc97656227b00193510985df1b4bbd9f479323164fe13c'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '54c722c92c44aa714bd427b0'
### iv_xor: '54c722c92c44aa714bd427b0'
### authtag: '2a8f32692a941c7b18bd0d34c7a2d165'
### authtag: '2a8f32692a941c7b18bd0d34c7a2d165'
### ciphertext: 'c463dfdc8182c053bec43c2609c740ffdffc97656227b00193510985df1b4bbd9f479323164fe13c'
### ciphertext: 'c463dfdc8182c053bec43c2609c740ffdffc97656227b00193510985df1b4bbd9f479323164fe13c'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### read message pattern: 'ss'

### read message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### read message pattern: 'psk'

### read message pattern: 'psk'

### noise decrypt

### noise decrypt
### key: '10928567d3527940574e4476ea7f86d13f2f9185a0be2218da8a9cb61a0a8330'
### key: '10928567d3527940574e4476ea7f86d13f2f9185a0be2218da8a9cb61a0a8330'
### iv: '4765b4610e496641aaf3b7c7'
### iv: '4765b4610e496641aaf3b7c7'
### aad: 'aeb9eecb037820176a51173f3200b92221005a875a9d320ddda300bff3ead426'
### aad: 'aeb9eecb037820176a51173f3200b92221005a875a9d320ddda300bff3ead426'
### cipherinfo: '834a31363136393034343134509e7e059d3e3c90f2406eb0bc45f06e3348e1c37e57b08b91e4'
### cipherinfo: '834a31363136393034343134509e7e059d3e3c90f2406eb0bc45f06e3348e1c37e57b08b91e4'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '76538557377952759bc7b7c7'
### iv_xor: '76538557377952759bc7b7c7'
### authtag: '9e7e059d3e3c90f2406eb0bc45f06e33'
### authtag: '9e7e059d3e3c90f2406eb0bc45f06e33'
### ciphertext: 'e1c37e57b08b91e4'
### ciphertext: 'e1c37e57b08b91e4'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'

### b_recv_a_msg: 'init.syn'

### b_recv_a_msg: 'init.syn'
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss", "psk"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Xpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","02087a2b50ef8fe3826eaf8daa13d31cb77e69c13cc2721157e69eb729190c6442"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","72b9fdc2192751a781d34b07de88b8888be2672c456d15d40ce83d807e1c8fe6"),
                                h => pack("H*","a78ba77210a0af66323f3e2522fb713d64472cadfa67abf8fbd8f40590b0e078"),
                                hasK => 1,
                                k => pack("H*","02a32aad3594164c2393bd00e15b2ee548c50f79ed064b596ee8fb6ed7adff5a"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","431c80b59b1bf630b75ff64764235e13f82285f2def3ff524f309c7fe5e94a4a"),
  },
  {
    hasK => 1,
    k => pack("H*","91bf755e0c5e43475c4eb560d088214455cb70b1b145db67518c407ca8fee2ea"),
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "X",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss", "psk"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_Xpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","02087a2b50ef8fe3826eaf8daa13d31cb77e69c13cc2721157e69eb729190c6442"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","72b9fdc2192751a781d34b07de88b8888be2672c456d15d40ce83d807e1c8fe6"),
                                h => pack("H*","a78ba77210a0af66323f3e2522fb713d64472cadfa67abf8fbd8f40590b0e078"),
                                hasK => 1,
                                k => pack("H*","02a32aad3594164c2393bd00e15b2ee548c50f79ed064b596ee8fb6ed7adff5a"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","431c80b59b1bf630b75ff64764235e13f82285f2def3ff524f309c7fe5e94a4a"),
  },
  {
    hasK => 1,
    k => pack("H*","91bf755e0c5e43475c4eb560d088214455cb70b1b145db67518c407ca8fee2ea"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '335de3dc786eec4fa9afc8156026d5318afb8fdab4bccdb94b747f09bf16150a'
### key: '335de3dc786eec4fa9afc8156026d5318afb8fdab4bccdb94b747f09bf16150a'
### iv: '7079dca074815a8e6b759949'
### iv: '7079dca074815a8e6b759949'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '414fed964db16eba5a419949'
### iv_xor: '414fed964db16eba5a419949'
### aad: 'a78ba77210a0af66323f3e2522fb713d64472cadfa67abf8fbd8f40590b0e078'
### aad: 'a78ba77210a0af66323f3e2522fb713d64472cadfa67abf8fbd8f40590b0e078'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'b6d624b415cd0498aa56a086767fa2005be435327e03cfb0b0416a06f6ea3a9c3e1323828f392d04a0a4e0c0c0e345c8204916'
### ciphertext: 'b6d624b415cd0498aa56a086767fa2005be435327e03cfb0b0416a06f6ea3a9c3e1323828f392d04a0a4e0c0c0e345c8204916'
### authtag: '204125a8aa3b8cea2572b0d083e4469a'
### authtag: '204125a8aa3b8cea2572b0d083e4469a'
### cipherinfo: '834a3136313639303434313450204125a8aa3b8cea2572b0d083e4469a5833b6d624b415cd0498aa56a086767fa2005be435327e03cfb0b0416a06f6ea3a9c3e1323828f392d04a0a4e0c0c0e345c8204916'
### cipherinfo: '834a3136313639303434313450204125a8aa3b8cea2572b0d083e4469a5833b6d624b415cd0498aa56a086767fa2005be435327e03cfb0b0416a06f6ea3a9c3e1323828f392d04a0a4e0c0c0e345c8204916'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '335de3dc786eec4fa9afc8156026d5318afb8fdab4bccdb94b747f09bf16150a'
### key: '335de3dc786eec4fa9afc8156026d5318afb8fdab4bccdb94b747f09bf16150a'
### iv: '7079dca074815a8e6b759949'
### iv: '7079dca074815a8e6b759949'
### aad: 'a78ba77210a0af66323f3e2522fb713d64472cadfa67abf8fbd8f40590b0e078'
### aad: 'a78ba77210a0af66323f3e2522fb713d64472cadfa67abf8fbd8f40590b0e078'
### cipherinfo: '834a3136313639303434313450204125a8aa3b8cea2572b0d083e4469a5833b6d624b415cd0498aa56a086767fa2005be435327e03cfb0b0416a06f6ea3a9c3e1323828f392d04a0a4e0c0c0e345c8204916'
### cipherinfo: '834a3136313639303434313450204125a8aa3b8cea2572b0d083e4469a5833b6d624b415cd0498aa56a086767fa2005be435327e03cfb0b0416a06f6ea3a9c3e1323828f392d04a0a4e0c0c0e345c8204916'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '414fed964db16eba5a419949'
### iv_xor: '414fed964db16eba5a419949'
### authtag: '204125a8aa3b8cea2572b0d083e4469a'
### authtag: '204125a8aa3b8cea2572b0d083e4469a'
### ciphertext: 'b6d624b415cd0498aa56a086767fa2005be435327e03cfb0b0416a06f6ea3a9c3e1323828f392d04a0a4e0c0c0e345c8204916'
### ciphertext: 'b6d624b415cd0498aa56a086767fa2005be435327e03cfb0b0416a06f6ea3a9c3e1323828f392d04a0a4e0c0c0e345c8204916'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b send comm msg to a

### b send comm msg to a


### noise encrypt
### noise encrypt
### key: 'a7d8cfbf39af4bd7b4bfc2c083e7977de77e4495b1333c539cfa7428784c3422'
### key: 'a7d8cfbf39af4bd7b4bfc2c083e7977de77e4495b1333c539cfa7428784c3422'
### iv: 'ddc18ae0a484323e026c3e59'
### iv: 'ddc18ae0a484323e026c3e59'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'ecf7bbd69db4060a33583e59'
### iv_xor: 'ecf7bbd69db4060a33583e59'
### aad: 'a78ba77210a0af66323f3e2522fb713d64472cadfa67abf8fbd8f40590b0e078'
### aad: 'a78ba77210a0af66323f3e2522fb713d64472cadfa67abf8fbd8f40590b0e078'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'e63873d5a2fbc9f8c632db40c011a40e976555d1604b958da95f90ca6faa8e5f0adb10caf2c57ebbe9880d90dc5b46'
### ciphertext: 'e63873d5a2fbc9f8c632db40c011a40e976555d1604b958da95f90ca6faa8e5f0adb10caf2c57ebbe9880d90dc5b46'
### authtag: '210376cecb371be322cd09dab785ab08'
### authtag: '210376cecb371be322cd09dab785ab08'
### cipherinfo: '834a3136313639303434313450210376cecb371be322cd09dab785ab08582fe63873d5a2fbc9f8c632db40c011a40e976555d1604b958da95f90ca6faa8e5f0adb10caf2c57ebbe9880d90dc5b46'
### cipherinfo: '834a3136313639303434313450210376cecb371be322cd09dab785ab08582fe63873d5a2fbc9f8c632db40c011a40e976555d1604b958da95f90ca6faa8e5f0adb10caf2c57ebbe9880d90dc5b46'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: 'a7d8cfbf39af4bd7b4bfc2c083e7977de77e4495b1333c539cfa7428784c3422'
### key: 'a7d8cfbf39af4bd7b4bfc2c083e7977de77e4495b1333c539cfa7428784c3422'
### iv: 'ddc18ae0a484323e026c3e59'
### iv: 'ddc18ae0a484323e026c3e59'
### aad: 'a78ba77210a0af66323f3e2522fb713d64472cadfa67abf8fbd8f40590b0e078'
### aad: 'a78ba77210a0af66323f3e2522fb713d64472cadfa67abf8fbd8f40590b0e078'
### cipherinfo: '834a3136313639303434313450210376cecb371be322cd09dab785ab08582fe63873d5a2fbc9f8c632db40c011a40e976555d1604b958da95f90ca6faa8e5f0adb10caf2c57ebbe9880d90dc5b46'
### cipherinfo: '834a3136313639303434313450210376cecb371be322cd09dab785ab08582fe63873d5a2fbc9f8c632db40c011a40e976555d1604b958da95f90ca6faa8e5f0adb10caf2c57ebbe9880d90dc5b46'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'ecf7bbd69db4060a33583e59'
### iv_xor: 'ecf7bbd69db4060a33583e59'
### authtag: '210376cecb371be322cd09dab785ab08'
### authtag: '210376cecb371be322cd09dab785ab08'
### ciphertext: 'e63873d5a2fbc9f8c632db40c011a40e976555d1604b958da95f90ca6faa8e5f0adb10caf2c57ebbe9880d90dc5b46'
### ciphertext: 'e63873d5a2fbc9f8c632db40c011a40e976555d1604b958da95f90ca6faa8e5f0adb10caf2c57ebbe9880d90dc5b46'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'X',
###                               'test_psk',
###                               1

### -----------end test --------: 'X',
###                               'test_psk',
###                               1

### -----------start test --------: 'NN',
###                                 undef,
###                                 undef

### -----------start test --------: 'NN',
###                                 undef,
###                                 undef


### a write message to b
### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NN",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NN_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => "Noise_NN_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","b4d7a57f37abfc0a885808bfe29388b34ef2356f4fe1ee7b9ae78c3c3f0dd686"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NN",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NN_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => "Noise_NN_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","b4d7a57f37abfc0a885808bfe29388b34ef2356f4fe1ee7b9ae78c3c3f0dd686"),
                            },
  who                    => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '02af14ded9ac215b1ae111be3bda95121ca6be3529a24e128d12e2d80addf5cfa1'

### public compressed: '02af14ded9ac215b1ae111be3bda95121ca6be3529a24e128d12e2d80addf5cfa1'
(
  "a_msg",
  pack("H*","82582102af14ded9ac215b1ae111be3bda95121ca6be3529a24e128d12e2d80addf5cfa148696e69742e73796e"),
)
(
  "a_msg",
  pack("H*","82582102af14ded9ac215b1ae111be3bda95121ca6be3529a24e128d12e2d80addf5cfa148696e69742e73796e"),
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02af14ded9ac215b1ae111be3bda95121ca6be3529a24e128d12e2d80addf5cfa1"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NN_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => "Noise_NN_secp256r1_AESGCM_SHA256",
                                h  => pack("H*","f80812c9f751b45952315ecff44eb5e2a6aef74ae5ccaf27c85dff31af4d80b0"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02af14ded9ac215b1ae111be3bda95121ca6be3529a24e128d12e2d80addf5cfa1"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NN_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => "Noise_NN_secp256r1_AESGCM_SHA256",
                                h  => pack("H*","f80812c9f751b45952315ecff44eb5e2a6aef74ae5ccaf27c85dff31af4d80b0"),
                              },
    who                    => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NN",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NN_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => "Noise_NN_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","b4d7a57f37abfc0a885808bfe29388b34ef2356f4fe1ee7b9ae78c3c3f0dd686"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NN",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NN_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => "Noise_NN_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","b4d7a57f37abfc0a885808bfe29388b34ef2356f4fe1ee7b9ae78c3c3f0dd686"),
                            },
  who                    => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NN_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","02af14ded9ac215b1ae111be3bda95121ca6be3529a24e128d12e2d80addf5cfa1"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => "Noise_NN_secp256r1_AESGCM_SHA256",
                                h  => pack("H*","f80812c9f751b45952315ecff44eb5e2a6aef74ae5ccaf27c85dff31af4d80b0"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NN_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","02af14ded9ac215b1ae111be3bda95121ca6be3529a24e128d12e2d80addf5cfa1"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => "Noise_NN_secp256r1_AESGCM_SHA256",
                                h  => pack("H*","f80812c9f751b45952315ecff44eb5e2a6aef74ae5ccaf27c85dff31af4d80b0"),
                              },
    who                    => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '02ba7f239fd4492b281deb6dd0fb379b5632ee6ab4705956617f8b6d42d9e7df7e'

### public compressed: '02ba7f239fd4492b281deb6dd0fb379b5632ee6ab4705956617f8b6d42d9e7df7e'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPiC7zvo0b1sV0DYU2Kt1ZToCJnH0LlU2sAPH//mi199oAoGCCqGSM49
',
###             'AwEHoUQDQgAEun8jn9RJKygd623Q+zebVjLuarRwWVZhf4ttQtnn334AykzqAiDf
',
###             'FZMZaGqDSlKrVWGiCU0HecbHxs/W5k8CLA==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPiC7zvo0b1sV0DYU2Kt1ZToCJnH0LlU2sAPH//mi199oAoGCCqGSM49
',
###             'AwEHoUQDQgAEun8jn9RJKygd623Q+zebVjLuarRwWVZhf4ttQtnn334AykzqAiDf
',
###             'FZMZaGqDSlKrVWGiCU0HecbHxs/W5k8CLA==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAErxTe2awhWxrhEb472pUSHKa+NSmi
',
###           'ThKNEuLYCt31z6H8kj0SHgBtNDQ+iwFYIU9rQhB0TAbTQ+T4XvszB/ying==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAErxTe2awhWxrhEb472pUSHKa+NSmi
',
###           'ThKNEuLYCt31z6H8kj0SHgBtNDQ+iwFYIU9rQhB0TAbTQ+T4XvszB/ying==
',
###           '-----END PUBLIC KEY-----
'
### z: 'b009a5f298d617a69fb36fbd7da6fcae71f7c17399b27f00f255d283389e8cb1'
### z: 'b009a5f298d617a69fb36fbd7da6fcae71f7c17399b27f00f255d283389e8cb1'

### noise encrypt

### noise encrypt
### key: '5bdecbb5feaf960ab840b040df23a1ebb6e6fb7421a37f184feace7284006392'
### key: '5bdecbb5feaf960ab840b040df23a1ebb6e6fb7421a37f184feace7284006392'
### iv: '6024b177e8eceda45a363a9d'
### iv: '6024b177e8eceda45a363a9d'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '51128041d1dcd9906b023a9d'
### iv_xor: '51128041d1dcd9906b023a9d'
### aad: '8c65b30c94d89088da912ee261127be6fd2c472e0ab677a07214ded2a1a99304'
### aad: '8c65b30c94d89088da912ee261127be6fd2c472e0ab677a07214ded2a1a99304'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '15ccd923ff37b864'
### ciphertext: '15ccd923ff37b864'
### authtag: '12c6f8f79561e77bc982536e1caaaf3b'
### authtag: '12c6f8f79561e77bc982536e1caaaf3b'
### cipherinfo: '834a313631363930343431345012c6f8f79561e77bc982536e1caaaf3b4815ccd923ff37b864'
### cipherinfo: '834a313631363930343431345012c6f8f79561e77bc982536e1caaaf3b4815ccd923ff37b864'

### b_msg: '82582102ba7f239fd4492b281deb6dd0fb379b5632ee6ab4705956617f8b6d42d9e7df7e5826834a313631363930343431345012c6f8f79561e77bc982536e1caaaf3b4815ccd923ff37b864'

### b_msg: '82582102ba7f239fd4492b281deb6dd0fb379b5632ee6ab4705956617f8b6d42d9e7df7e5826834a313631363930343431345012c6f8f79561e77bc982536e1caaaf3b4815ccd923ff37b864'
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02ba7f239fd4492b281deb6dd0fb379b5632ee6ab4705956617f8b6d42d9e7df7e"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NN_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","02af14ded9ac215b1ae111be3bda95121ca6be3529a24e128d12e2d80addf5cfa1"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","3506ed9cd3fe65f86d8d6084771891f78828db018a3115f93f71d366f91c2cb6"),
                                h => pack("H*","b88214f0bc35ad62efe040c3c66c31d1387202868b55e615c89b5e981a04e987"),
                                hasK => 1,
                                k => pack("H*","d04ba41224fc32c8b10a173ae648de12dd47721ffeccb929103ccfd0e84d5201"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","6f84b445e84b61075482680fdff9f16fc1473f777a1c0b94b637a35d937ec69a"),
  },
  {
    hasK => 1,
    k => pack("H*","e1cbb352c73ee7a6369c31b9ccaf2ed8e53353ce1e00ea019c3f3ecc1ca595d9"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02ba7f239fd4492b281deb6dd0fb379b5632ee6ab4705956617f8b6d42d9e7df7e"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NN_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","02af14ded9ac215b1ae111be3bda95121ca6be3529a24e128d12e2d80addf5cfa1"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","3506ed9cd3fe65f86d8d6084771891f78828db018a3115f93f71d366f91c2cb6"),
                                h => pack("H*","b88214f0bc35ad62efe040c3c66c31d1387202868b55e615c89b5e981a04e987"),
                                hasK => 1,
                                k => pack("H*","d04ba41224fc32c8b10a173ae648de12dd47721ffeccb929103ccfd0e84d5201"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","6f84b445e84b61075482680fdff9f16fc1473f777a1c0b94b637a35d937ec69a"),
  },
  {
    hasK => 1,
    k => pack("H*","e1cbb352c73ee7a6369c31b9ccaf2ed8e53353ce1e00ea019c3f3ecc1ca595d9"),
  },
)

### a read_message from b

### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIEEUBBKzXYxgR0sOnebJk/iFfouG7Mm/Gi/Yu012HJdPoAoGCCqGSM49
',
###             'AwEHoUQDQgAErxTe2awhWxrhEb472pUSHKa+NSmiThKNEuLYCt31z6H8kj0SHgBt
',
###             'NDQ+iwFYIU9rQhB0TAbTQ+T4XvszB/ying==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIEEUBBKzXYxgR0sOnebJk/iFfouG7Mm/Gi/Yu012HJdPoAoGCCqGSM49
',
###             'AwEHoUQDQgAErxTe2awhWxrhEb472pUSHKa+NSmiThKNEuLYCt31z6H8kj0SHgBt
',
###             'NDQ+iwFYIU9rQhB0TAbTQ+T4XvszB/ying==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEun8jn9RJKygd623Q+zebVjLuarRw
',
###           'WVZhf4ttQtnn334AykzqAiDfFZMZaGqDSlKrVWGiCU0HecbHxs/W5k8CLA==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEun8jn9RJKygd623Q+zebVjLuarRw
',
###           'WVZhf4ttQtnn334AykzqAiDfFZMZaGqDSlKrVWGiCU0HecbHxs/W5k8CLA==
',
###           '-----END PUBLIC KEY-----
'
### z: 'b009a5f298d617a69fb36fbd7da6fcae71f7c17399b27f00f255d283389e8cb1'
### z: 'b009a5f298d617a69fb36fbd7da6fcae71f7c17399b27f00f255d283389e8cb1'

### noise decrypt

### noise decrypt
### key: '5bdecbb5feaf960ab840b040df23a1ebb6e6fb7421a37f184feace7284006392'
### key: '5bdecbb5feaf960ab840b040df23a1ebb6e6fb7421a37f184feace7284006392'
### iv: '6024b177e8eceda45a363a9d'
### iv: '6024b177e8eceda45a363a9d'
### aad: '8c65b30c94d89088da912ee261127be6fd2c472e0ab677a07214ded2a1a99304'
### aad: '8c65b30c94d89088da912ee261127be6fd2c472e0ab677a07214ded2a1a99304'
### cipherinfo: '834a313631363930343431345012c6f8f79561e77bc982536e1caaaf3b4815ccd923ff37b864'
### cipherinfo: '834a313631363930343431345012c6f8f79561e77bc982536e1caaaf3b4815ccd923ff37b864'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '51128041d1dcd9906b023a9d'
### iv_xor: '51128041d1dcd9906b023a9d'
### authtag: '12c6f8f79561e77bc982536e1caaaf3b'
### authtag: '12c6f8f79561e77bc982536e1caaaf3b'
### ciphertext: '15ccd923ff37b864'
### ciphertext: '15ccd923ff37b864'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02af14ded9ac215b1ae111be3bda95121ca6be3529a24e128d12e2d80addf5cfa1"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NN_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","02ba7f239fd4492b281deb6dd0fb379b5632ee6ab4705956617f8b6d42d9e7df7e"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","3506ed9cd3fe65f86d8d6084771891f78828db018a3115f93f71d366f91c2cb6"),
                                h => pack("H*","b88214f0bc35ad62efe040c3c66c31d1387202868b55e615c89b5e981a04e987"),
                                hasK => 1,
                                k => pack("H*","d04ba41224fc32c8b10a173ae648de12dd47721ffeccb929103ccfd0e84d5201"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","6f84b445e84b61075482680fdff9f16fc1473f777a1c0b94b637a35d937ec69a"),
  },
  {
    hasK => 1,
    k => pack("H*","e1cbb352c73ee7a6369c31b9ccaf2ed8e53353ce1e00ea019c3f3ecc1ca595d9"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02af14ded9ac215b1ae111be3bda95121ca6be3529a24e128d12e2d80addf5cfa1"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NN_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","02ba7f239fd4492b281deb6dd0fb379b5632ee6ab4705956617f8b6d42d9e7df7e"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","3506ed9cd3fe65f86d8d6084771891f78828db018a3115f93f71d366f91c2cb6"),
                                h => pack("H*","b88214f0bc35ad62efe040c3c66c31d1387202868b55e615c89b5e981a04e987"),
                                hasK => 1,
                                k => pack("H*","d04ba41224fc32c8b10a173ae648de12dd47721ffeccb929103ccfd0e84d5201"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","6f84b445e84b61075482680fdff9f16fc1473f777a1c0b94b637a35d937ec69a"),
  },
  {
    hasK => 1,
    k => pack("H*","e1cbb352c73ee7a6369c31b9ccaf2ed8e53353ce1e00ea019c3f3ecc1ca595d9"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '7aa93da6dddfc18d0dd8930c560ab4d5696b036cc79f3e169a8a9dc475a04fce'
### key: '7aa93da6dddfc18d0dd8930c560ab4d5696b036cc79f3e169a8a9dc475a04fce'
### iv: '625fe9bd31450f7c366f89a1'
### iv: '625fe9bd31450f7c366f89a1'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '5369d88b08753b48075b89a1'
### iv_xor: '5369d88b08753b48075b89a1'
### aad: 'b88214f0bc35ad62efe040c3c66c31d1387202868b55e615c89b5e981a04e987'
### aad: 'b88214f0bc35ad62efe040c3c66c31d1387202868b55e615c89b5e981a04e987'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'da30b3e0f5c8e431c247f3f8895f4c8976dd958a6dc301463702365bab120c06d7ae526181a804d4b1e4985339dd1ab8205a43'
### ciphertext: 'da30b3e0f5c8e431c247f3f8895f4c8976dd958a6dc301463702365bab120c06d7ae526181a804d4b1e4985339dd1ab8205a43'
### authtag: 'a4f1f9553376cc969a3b33a1da86a62f'
### authtag: 'a4f1f9553376cc969a3b33a1da86a62f'
### cipherinfo: '834a3136313639303434313450a4f1f9553376cc969a3b33a1da86a62f5833da30b3e0f5c8e431c247f3f8895f4c8976dd958a6dc301463702365bab120c06d7ae526181a804d4b1e4985339dd1ab8205a43'
### cipherinfo: '834a3136313639303434313450a4f1f9553376cc969a3b33a1da86a62f5833da30b3e0f5c8e431c247f3f8895f4c8976dd958a6dc301463702365bab120c06d7ae526181a804d4b1e4985339dd1ab8205a43'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '7aa93da6dddfc18d0dd8930c560ab4d5696b036cc79f3e169a8a9dc475a04fce'
### key: '7aa93da6dddfc18d0dd8930c560ab4d5696b036cc79f3e169a8a9dc475a04fce'
### iv: '625fe9bd31450f7c366f89a1'
### iv: '625fe9bd31450f7c366f89a1'
### aad: 'b88214f0bc35ad62efe040c3c66c31d1387202868b55e615c89b5e981a04e987'
### aad: 'b88214f0bc35ad62efe040c3c66c31d1387202868b55e615c89b5e981a04e987'
### cipherinfo: '834a3136313639303434313450a4f1f9553376cc969a3b33a1da86a62f5833da30b3e0f5c8e431c247f3f8895f4c8976dd958a6dc301463702365bab120c06d7ae526181a804d4b1e4985339dd1ab8205a43'
### cipherinfo: '834a3136313639303434313450a4f1f9553376cc969a3b33a1da86a62f5833da30b3e0f5c8e431c247f3f8895f4c8976dd958a6dc301463702365bab120c06d7ae526181a804d4b1e4985339dd1ab8205a43'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '5369d88b08753b48075b89a1'
### iv_xor: '5369d88b08753b48075b89a1'
### authtag: 'a4f1f9553376cc969a3b33a1da86a62f'
### authtag: 'a4f1f9553376cc969a3b33a1da86a62f'
### ciphertext: 'da30b3e0f5c8e431c247f3f8895f4c8976dd958a6dc301463702365bab120c06d7ae526181a804d4b1e4985339dd1ab8205a43'
### ciphertext: 'da30b3e0f5c8e431c247f3f8895f4c8976dd958a6dc301463702365bab120c06d7ae526181a804d4b1e4985339dd1ab8205a43'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: 'f008aab2a8adebb12837e0565bcf48ebaea0ac47e7eeff3db209ce3dd363bd9b'
### key: 'f008aab2a8adebb12837e0565bcf48ebaea0ac47e7eeff3db209ce3dd363bd9b'
### iv: '5edb0de0600b9355503d6567'
### iv: '5edb0de0600b9355503d6567'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '6fed3cd6593ba76161096567'
### iv_xor: '6fed3cd6593ba76161096567'
### aad: 'b88214f0bc35ad62efe040c3c66c31d1387202868b55e615c89b5e981a04e987'
### aad: 'b88214f0bc35ad62efe040c3c66c31d1387202868b55e615c89b5e981a04e987'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '391b980ffcfa394bc90392770297b857581498e6bb20f8b514ece0b514ecadfc3f71415da7697e59bdacaba0573e2d'
### ciphertext: '391b980ffcfa394bc90392770297b857581498e6bb20f8b514ece0b514ecadfc3f71415da7697e59bdacaba0573e2d'
### authtag: '5698788adbeca23f8fe6a4466f986b82'
### authtag: '5698788adbeca23f8fe6a4466f986b82'
### cipherinfo: '834a31363136393034343134505698788adbeca23f8fe6a4466f986b82582f391b980ffcfa394bc90392770297b857581498e6bb20f8b514ece0b514ecadfc3f71415da7697e59bdacaba0573e2d'
### cipherinfo: '834a31363136393034343134505698788adbeca23f8fe6a4466f986b82582f391b980ffcfa394bc90392770297b857581498e6bb20f8b514ece0b514ecadfc3f71415da7697e59bdacaba0573e2d'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: 'f008aab2a8adebb12837e0565bcf48ebaea0ac47e7eeff3db209ce3dd363bd9b'
### key: 'f008aab2a8adebb12837e0565bcf48ebaea0ac47e7eeff3db209ce3dd363bd9b'
### iv: '5edb0de0600b9355503d6567'
### iv: '5edb0de0600b9355503d6567'
### aad: 'b88214f0bc35ad62efe040c3c66c31d1387202868b55e615c89b5e981a04e987'
### aad: 'b88214f0bc35ad62efe040c3c66c31d1387202868b55e615c89b5e981a04e987'
### cipherinfo: '834a31363136393034343134505698788adbeca23f8fe6a4466f986b82582f391b980ffcfa394bc90392770297b857581498e6bb20f8b514ece0b514ecadfc3f71415da7697e59bdacaba0573e2d'
### cipherinfo: '834a31363136393034343134505698788adbeca23f8fe6a4466f986b82582f391b980ffcfa394bc90392770297b857581498e6bb20f8b514ece0b514ecadfc3f71415da7697e59bdacaba0573e2d'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '6fed3cd6593ba76161096567'
### iv_xor: '6fed3cd6593ba76161096567'
### authtag: '5698788adbeca23f8fe6a4466f986b82'
### authtag: '5698788adbeca23f8fe6a4466f986b82'
### ciphertext: '391b980ffcfa394bc90392770297b857581498e6bb20f8b514ece0b514ecadfc3f71415da7697e59bdacaba0573e2d'
### ciphertext: '391b980ffcfa394bc90392770297b857581498e6bb20f8b514ece0b514ecadfc3f71415da7697e59bdacaba0573e2d'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'

### -----------end test --------: 'NN',
###                               undef,
###                               undef

### -----------end test --------: 'NN',
###                               undef,
###                               undef

### -----------start test --------: 'NN',
###                                 'test_psk',
###                                 0

### -----------start test --------: 'NN',
###                                 'test_psk',
###                                 0

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NN",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NNpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","0d27d2d1c578d75a6c17579b8dcf74e910ace2ee9e92247cbdce7991a1e05655"),
                              h  => pack("H*","19cc5936b038c10ed2dbc285bf8010a8cfac30f06f852fb43acebf50724c2af2"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NN",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NNpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","0d27d2d1c578d75a6c17579b8dcf74e910ace2ee9e92247cbdce7991a1e05655"),
                              h  => pack("H*","19cc5936b038c10ed2dbc285bf8010a8cfac30f06f852fb43acebf50724c2af2"),
                            },
  who                    => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'psk'

### write message pattern: 'psk'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '036cb6443083ea136fde697bd00f3618f2dffc55951cfc842a9a3ccec2976e16fc'

### public compressed: '036cb6443083ea136fde697bd00f3618f2dffc55951cfc842a9a3ccec2976e16fc'

### noise encrypt

### noise encrypt
### key: '4b6570a542e4f231416fb1bf4cef74e3d6efeb44cb3b0fa7723e73c317e38264'
### key: '4b6570a542e4f231416fb1bf4cef74e3d6efeb44cb3b0fa7723e73c317e38264'
### iv: 'f179b6dd20252036e7acb851'
### iv: 'f179b6dd20252036e7acb851'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'c04f87eb19151402d698b851'
### iv_xor: 'c04f87eb19151402d698b851'
### aad: 'ac7ee4da6aa2217b02020bdc05f5c3575293b52f0ff557b0232cc0ef6c3d3af2'
### aad: 'ac7ee4da6aa2217b02020bdc05f5c3575293b52f0ff557b0232cc0ef6c3d3af2'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '8400473a61ae29e5'
### ciphertext: '8400473a61ae29e5'
### authtag: '5cad66a272978410c6f04949fd7e0731'
### authtag: '5cad66a272978410c6f04949fd7e0731'
### cipherinfo: '834a31363136393034343134505cad66a272978410c6f04949fd7e0731488400473a61ae29e5'
### cipherinfo: '834a31363136393034343134505cad66a272978410c6f04949fd7e0731488400473a61ae29e5'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA2y2RDCD6hNv3ml70A82GPLf/FWVHPyEKpo8zsKXbhb8WCaDSjE2MTY5MDQ0MTRQXK1monKXhBDG8ElJ/X4HMUiEAEc6Ya4p5Q=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA2y2RDCD6hNv3ml70A82GPLf/FWVHPyEKpo8zsKXbhb8WCaDSjE2MTY5MDQ0MTRQXK1monKXhBDG8ElJ/X4HMUiEAEc6Ya4p5Q=="),
  );
}
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","036cb6443083ea136fde697bd00f3618f2dffc55951cfc842a9a3ccec2976e16fc"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NNpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","dc7941a31fe1fb07c50fc6fa82bbcc502a941de4ac8eafc41b99ef104c6f007e"),
                                h => pack("H*","c3b6dcdd99ba9b15ddd2de740af1feebecd0654946bf078d43c94f573c5955b3"),
                                hasK => 1,
                                k => pack("H*","df437c7c0a838adf730ba41c34ded86a5ce558366d0294817c092c84c694cdc0"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","036cb6443083ea136fde697bd00f3618f2dffc55951cfc842a9a3ccec2976e16fc"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NNpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","dc7941a31fe1fb07c50fc6fa82bbcc502a941de4ac8eafc41b99ef104c6f007e"),
                                h => pack("H*","c3b6dcdd99ba9b15ddd2de740af1feebecd0654946bf078d43c94f573c5955b3"),
                                hasK => 1,
                                k => pack("H*","df437c7c0a838adf730ba41c34ded86a5ce558366d0294817c092c84c694cdc0"),
                              },
    who                    => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NN",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NNpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","0d27d2d1c578d75a6c17579b8dcf74e910ace2ee9e92247cbdce7991a1e05655"),
                              h  => pack("H*","19cc5936b038c10ed2dbc285bf8010a8cfac30f06f852fb43acebf50724c2af2"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NN",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NNpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","0d27d2d1c578d75a6c17579b8dcf74e910ace2ee9e92247cbdce7991a1e05655"),
                              h  => pack("H*","19cc5936b038c10ed2dbc285bf8010a8cfac30f06f852fb43acebf50724c2af2"),
                            },
  who                    => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'psk'

### read message pattern: 'psk'

### read message pattern: 'e'

### read message pattern: 'e'

### noise decrypt

### noise decrypt
### key: '4b6570a542e4f231416fb1bf4cef74e3d6efeb44cb3b0fa7723e73c317e38264'
### key: '4b6570a542e4f231416fb1bf4cef74e3d6efeb44cb3b0fa7723e73c317e38264'
### iv: 'f179b6dd20252036e7acb851'
### iv: 'f179b6dd20252036e7acb851'
### aad: 'ac7ee4da6aa2217b02020bdc05f5c3575293b52f0ff557b0232cc0ef6c3d3af2'
### aad: 'ac7ee4da6aa2217b02020bdc05f5c3575293b52f0ff557b0232cc0ef6c3d3af2'
### cipherinfo: '834a31363136393034343134505cad66a272978410c6f04949fd7e0731488400473a61ae29e5'
### cipherinfo: '834a31363136393034343134505cad66a272978410c6f04949fd7e0731488400473a61ae29e5'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'c04f87eb19151402d698b851'
### iv_xor: 'c04f87eb19151402d698b851'
### authtag: '5cad66a272978410c6f04949fd7e0731'
### authtag: '5cad66a272978410c6f04949fd7e0731'
### ciphertext: '8400473a61ae29e5'
### ciphertext: '8400473a61ae29e5'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NNpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","036cb6443083ea136fde697bd00f3618f2dffc55951cfc842a9a3ccec2976e16fc"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","dc7941a31fe1fb07c50fc6fa82bbcc502a941de4ac8eafc41b99ef104c6f007e"),
                                h => pack("H*","c3b6dcdd99ba9b15ddd2de740af1feebecd0654946bf078d43c94f573c5955b3"),
                                hasK => 1,
                                k => pack("H*","df437c7c0a838adf730ba41c34ded86a5ce558366d0294817c092c84c694cdc0"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NNpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","036cb6443083ea136fde697bd00f3618f2dffc55951cfc842a9a3ccec2976e16fc"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","dc7941a31fe1fb07c50fc6fa82bbcc502a941de4ac8eafc41b99ef104c6f007e"),
                                h => pack("H*","c3b6dcdd99ba9b15ddd2de740af1feebecd0654946bf078d43c94f573c5955b3"),
                                hasK => 1,
                                k => pack("H*","df437c7c0a838adf730ba41c34ded86a5ce558366d0294817c092c84c694cdc0"),
                              },
    who                    => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '02f9df1dfa13d04ccd2774431d1a6f22faa2458d21d6d94e29b6bae1ee0860bacb'

### public compressed: '02f9df1dfa13d04ccd2774431d1a6f22faa2458d21d6d94e29b6bae1ee0860bacb'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIIWT8LmuogjWPDxch+ZM0AMfDK9QlsDvpRbfPF/HiSfZoAoGCCqGSM49
',
###             'AwEHoUQDQgAE+d8d+hPQTM0ndEMdGm8i+qJFjSHW2U4ptrrh7ghgusvOKQaxl6SD
',
###             'j3H81siMVqhF82P1w6oePdu0ky16NRVbHg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIIWT8LmuogjWPDxch+ZM0AMfDK9QlsDvpRbfPF/HiSfZoAoGCCqGSM49
',
###             'AwEHoUQDQgAE+d8d+hPQTM0ndEMdGm8i+qJFjSHW2U4ptrrh7ghgusvOKQaxl6SD
',
###             'j3H81siMVqhF82P1w6oePdu0ky16NRVbHg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEbLZEMIPqE2/eaXvQDzYY8t/8VZUc
',
###           '/IQqmjzOwpduFvxgJij5TFczjbZkm1iam8gmWBpTqTmgJkgQ5wKoW9VPrQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEbLZEMIPqE2/eaXvQDzYY8t/8VZUc
',
###           '/IQqmjzOwpduFvxgJij5TFczjbZkm1iam8gmWBpTqTmgJkgQ5wKoW9VPrQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '6ef7a7e7365427358a5c9749b2cba5e2c92505d9bb728d49275f768d51834c4f'
### z: '6ef7a7e7365427358a5c9749b2cba5e2c92505d9bb728d49275f768d51834c4f'

### noise encrypt

### noise encrypt
### key: 'ba540cffdc9ece9eb91077f8b1c730c3a4388e62e8a1c3127ba473ef2261e92e'
### key: 'ba540cffdc9ece9eb91077f8b1c730c3a4388e62e8a1c3127ba473ef2261e92e'
### iv: 'a2d5274bcfe10d44ab4939b9'
### iv: 'a2d5274bcfe10d44ab4939b9'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '93e3167df6d139709a7d39b9'
### iv_xor: '93e3167df6d139709a7d39b9'
### aad: 'a894e91deebebd12589acb3741e081ce22b083e3ef9b6919df1d0761ab760984'
### aad: 'a894e91deebebd12589acb3741e081ce22b083e3ef9b6919df1d0761ab760984'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: 'c57b155343451033'
### ciphertext: 'c57b155343451033'
### authtag: '1ce82f810aaa4101e6177f711f205fd3'
### authtag: '1ce82f810aaa4101e6177f711f205fd3'
### cipherinfo: '834a31363136393034343134501ce82f810aaa4101e6177f711f205fd348c57b155343451033'
### cipherinfo: '834a31363136393034343134501ce82f810aaa4101e6177f711f205fd348c57b155343451033'

### b_msg: '82582102f9df1dfa13d04ccd2774431d1a6f22faa2458d21d6d94e29b6bae1ee0860bacb5826834a31363136393034343134501ce82f810aaa4101e6177f711f205fd348c57b155343451033'

### b_msg: '82582102f9df1dfa13d04ccd2774431d1a6f22faa2458d21d6d94e29b6bae1ee0860bacb5826834a31363136393034343134501ce82f810aaa4101e6177f711f205fd348c57b155343451033'
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02f9df1dfa13d04ccd2774431d1a6f22faa2458d21d6d94e29b6bae1ee0860bacb"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NNpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","036cb6443083ea136fde697bd00f3618f2dffc55951cfc842a9a3ccec2976e16fc"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","2679cb602d0d9c2c1503e24ebd12f57294a78382877d042b551e17b1440b37d4"),
                                h => pack("H*","409f5cf289e1b6c0dac0a73b110964437964d0d0163da0f5ce3a5ed65ca5ce04"),
                                hasK => 1,
                                k => pack("H*","802f7ed01e973302e04a3b7b8720a2029698f8789e27920b3d54484a3ad3c1fa"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","470acd377336b554cfa91768a4cc16e6b18c97915e47db228c8101d66ded310c"),
  },
  {
    hasK => 1,
    k => pack("H*","6854bd5c2ed0b5337d633c46299292f2be43908c41f6f0498c071cd82d28e1fe"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02f9df1dfa13d04ccd2774431d1a6f22faa2458d21d6d94e29b6bae1ee0860bacb"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NNpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","036cb6443083ea136fde697bd00f3618f2dffc55951cfc842a9a3ccec2976e16fc"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","2679cb602d0d9c2c1503e24ebd12f57294a78382877d042b551e17b1440b37d4"),
                                h => pack("H*","409f5cf289e1b6c0dac0a73b110964437964d0d0163da0f5ce3a5ed65ca5ce04"),
                                hasK => 1,
                                k => pack("H*","802f7ed01e973302e04a3b7b8720a2029698f8789e27920b3d54484a3ad3c1fa"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","470acd377336b554cfa91768a4cc16e6b18c97915e47db228c8101d66ded310c"),
  },
  {
    hasK => 1,
    k => pack("H*","6854bd5c2ed0b5337d633c46299292f2be43908c41f6f0498c071cd82d28e1fe"),
  },
)

### a read_message from b

### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOq3bIMyTcHOxi3LYhtOjRnxc3BhW+djPsXf6axgaPYloAoGCCqGSM49
',
###             'AwEHoUQDQgAEbLZEMIPqE2/eaXvQDzYY8t/8VZUc/IQqmjzOwpduFvxgJij5TFcz
',
###             'jbZkm1iam8gmWBpTqTmgJkgQ5wKoW9VPrQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOq3bIMyTcHOxi3LYhtOjRnxc3BhW+djPsXf6axgaPYloAoGCCqGSM49
',
###             'AwEHoUQDQgAEbLZEMIPqE2/eaXvQDzYY8t/8VZUc/IQqmjzOwpduFvxgJij5TFcz
',
###             'jbZkm1iam8gmWBpTqTmgJkgQ5wKoW9VPrQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE+d8d+hPQTM0ndEMdGm8i+qJFjSHW
',
###           '2U4ptrrh7ghgusvOKQaxl6SDj3H81siMVqhF82P1w6oePdu0ky16NRVbHg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE+d8d+hPQTM0ndEMdGm8i+qJFjSHW
',
###           '2U4ptrrh7ghgusvOKQaxl6SDj3H81siMVqhF82P1w6oePdu0ky16NRVbHg==
',
###           '-----END PUBLIC KEY-----
'
### z: '6ef7a7e7365427358a5c9749b2cba5e2c92505d9bb728d49275f768d51834c4f'
### z: '6ef7a7e7365427358a5c9749b2cba5e2c92505d9bb728d49275f768d51834c4f'

### noise decrypt

### noise decrypt
### key: 'ba540cffdc9ece9eb91077f8b1c730c3a4388e62e8a1c3127ba473ef2261e92e'
### key: 'ba540cffdc9ece9eb91077f8b1c730c3a4388e62e8a1c3127ba473ef2261e92e'
### iv: 'a2d5274bcfe10d44ab4939b9'
### iv: 'a2d5274bcfe10d44ab4939b9'
### aad: 'a894e91deebebd12589acb3741e081ce22b083e3ef9b6919df1d0761ab760984'
### aad: 'a894e91deebebd12589acb3741e081ce22b083e3ef9b6919df1d0761ab760984'
### cipherinfo: '834a31363136393034343134501ce82f810aaa4101e6177f711f205fd348c57b155343451033'
### cipherinfo: '834a31363136393034343134501ce82f810aaa4101e6177f711f205fd348c57b155343451033'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '93e3167df6d139709a7d39b9'
### iv_xor: '93e3167df6d139709a7d39b9'
### authtag: '1ce82f810aaa4101e6177f711f205fd3'
### authtag: '1ce82f810aaa4101e6177f711f205fd3'
### ciphertext: 'c57b155343451033'
### ciphertext: 'c57b155343451033'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","036cb6443083ea136fde697bd00f3618f2dffc55951cfc842a9a3ccec2976e16fc"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NNpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","02f9df1dfa13d04ccd2774431d1a6f22faa2458d21d6d94e29b6bae1ee0860bacb"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","2679cb602d0d9c2c1503e24ebd12f57294a78382877d042b551e17b1440b37d4"),
                                h => pack("H*","409f5cf289e1b6c0dac0a73b110964437964d0d0163da0f5ce3a5ed65ca5ce04"),
                                hasK => 1,
                                k => pack("H*","802f7ed01e973302e04a3b7b8720a2029698f8789e27920b3d54484a3ad3c1fa"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","470acd377336b554cfa91768a4cc16e6b18c97915e47db228c8101d66ded310c"),
  },
  {
    hasK => 1,
    k => pack("H*","6854bd5c2ed0b5337d633c46299292f2be43908c41f6f0498c071cd82d28e1fe"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","036cb6443083ea136fde697bd00f3618f2dffc55951cfc842a9a3ccec2976e16fc"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NNpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","02f9df1dfa13d04ccd2774431d1a6f22faa2458d21d6d94e29b6bae1ee0860bacb"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","2679cb602d0d9c2c1503e24ebd12f57294a78382877d042b551e17b1440b37d4"),
                                h => pack("H*","409f5cf289e1b6c0dac0a73b110964437964d0d0163da0f5ce3a5ed65ca5ce04"),
                                hasK => 1,
                                k => pack("H*","802f7ed01e973302e04a3b7b8720a2029698f8789e27920b3d54484a3ad3c1fa"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","470acd377336b554cfa91768a4cc16e6b18c97915e47db228c8101d66ded310c"),
  },
  {
    hasK => 1,
    k => pack("H*","6854bd5c2ed0b5337d633c46299292f2be43908c41f6f0498c071cd82d28e1fe"),
  },
)


### a send comm msg to b
### a send comm msg to b


### noise encrypt
### noise encrypt
### key: '70126836533ba8ac79561986a19b40dff3a691011e018dba3ad5a96a999ed86a'
### key: '70126836533ba8ac79561986a19b40dff3a691011e018dba3ad5a96a999ed86a'
### iv: 'ee22c76173139544faa334e8'
### iv: 'ee22c76173139544faa334e8'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'df14f6574a23a170cb9734e8'
### iv_xor: 'df14f6574a23a170cb9734e8'
### aad: '409f5cf289e1b6c0dac0a73b110964437964d0d0163da0f5ce3a5ed65ca5ce04'
### aad: '409f5cf289e1b6c0dac0a73b110964437964d0d0163da0f5ce3a5ed65ca5ce04'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'f1a0e17b8c748da719db2997294d08a74926c5582141912303ffb9ded871f2322a913acc1c0850238a9baf86657fc8f4de1d22'
### ciphertext: 'f1a0e17b8c748da719db2997294d08a74926c5582141912303ffb9ded871f2322a913acc1c0850238a9baf86657fc8f4de1d22'
### authtag: 'ed9efb33bce368fe0c47737f6e087a79'
### authtag: 'ed9efb33bce368fe0c47737f6e087a79'
### cipherinfo: '834a3136313639303434313450ed9efb33bce368fe0c47737f6e087a795833f1a0e17b8c748da719db2997294d08a74926c5582141912303ffb9ded871f2322a913acc1c0850238a9baf86657fc8f4de1d22'
### cipherinfo: '834a3136313639303434313450ed9efb33bce368fe0c47737f6e087a795833f1a0e17b8c748da719db2997294d08a74926c5582141912303ffb9ded871f2322a913acc1c0850238a9baf86657fc8f4de1d22'


### b recv comm msg from a
### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: '70126836533ba8ac79561986a19b40dff3a691011e018dba3ad5a96a999ed86a'
### key: '70126836533ba8ac79561986a19b40dff3a691011e018dba3ad5a96a999ed86a'
### iv: 'ee22c76173139544faa334e8'
### iv: 'ee22c76173139544faa334e8'
### aad: '409f5cf289e1b6c0dac0a73b110964437964d0d0163da0f5ce3a5ed65ca5ce04'
### aad: '409f5cf289e1b6c0dac0a73b110964437964d0d0163da0f5ce3a5ed65ca5ce04'
### cipherinfo: '834a3136313639303434313450ed9efb33bce368fe0c47737f6e087a795833f1a0e17b8c748da719db2997294d08a74926c5582141912303ffb9ded871f2322a913acc1c0850238a9baf86657fc8f4de1d22'
### cipherinfo: '834a3136313639303434313450ed9efb33bce368fe0c47737f6e087a795833f1a0e17b8c748da719db2997294d08a74926c5582141912303ffb9ded871f2322a913acc1c0850238a9baf86657fc8f4de1d22'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'df14f6574a23a170cb9734e8'
### iv_xor: 'df14f6574a23a170cb9734e8'
### authtag: 'ed9efb33bce368fe0c47737f6e087a79'
### authtag: 'ed9efb33bce368fe0c47737f6e087a79'
### ciphertext: 'f1a0e17b8c748da719db2997294d08a74926c5582141912303ffb9ded871f2322a913acc1c0850238a9baf86657fc8f4de1d22'
### ciphertext: 'f1a0e17b8c748da719db2997294d08a74926c5582141912303ffb9ded871f2322a913acc1c0850238a9baf86657fc8f4de1d22'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a


### noise encrypt
### noise encrypt
### key: 'd41068f285632c7d76537a13e75e6060d4d15d62a3d24e6fdfb6d02f537d5cc6'
### key: 'd41068f285632c7d76537a13e75e6060d4d15d62a3d24e6fdfb6d02f537d5cc6'
### iv: 'f9e67ce01644d712b5a57952'
### iv: 'f9e67ce01644d712b5a57952'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'c8d04dd62f74e32684917952'
### iv_xor: 'c8d04dd62f74e32684917952'
### aad: '409f5cf289e1b6c0dac0a73b110964437964d0d0163da0f5ce3a5ed65ca5ce04'
### aad: '409f5cf289e1b6c0dac0a73b110964437964d0d0163da0f5ce3a5ed65ca5ce04'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'a1be82fab1786731c5bfc03ad943847fa9dca2a9d5b3ee3b49c3c20f435e771531e62b6cfa5f62659ca744d14a0e84'
### ciphertext: 'a1be82fab1786731c5bfc03ad943847fa9dca2a9d5b3ee3b49c3c20f435e771531e62b6cfa5f62659ca744d14a0e84'
### authtag: '3c4b1b0750e8cf4cfcdfbbb83b79b851'
### authtag: '3c4b1b0750e8cf4cfcdfbbb83b79b851'
### cipherinfo: '834a31363136393034343134503c4b1b0750e8cf4cfcdfbbb83b79b851582fa1be82fab1786731c5bfc03ad943847fa9dca2a9d5b3ee3b49c3c20f435e771531e62b6cfa5f62659ca744d14a0e84'
### cipherinfo: '834a31363136393034343134503c4b1b0750e8cf4cfcdfbbb83b79b851582fa1be82fab1786731c5bfc03ad943847fa9dca2a9d5b3ee3b49c3c20f435e771531e62b6cfa5f62659ca744d14a0e84'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: 'd41068f285632c7d76537a13e75e6060d4d15d62a3d24e6fdfb6d02f537d5cc6'
### key: 'd41068f285632c7d76537a13e75e6060d4d15d62a3d24e6fdfb6d02f537d5cc6'
### iv: 'f9e67ce01644d712b5a57952'
### iv: 'f9e67ce01644d712b5a57952'
### aad: '409f5cf289e1b6c0dac0a73b110964437964d0d0163da0f5ce3a5ed65ca5ce04'
### aad: '409f5cf289e1b6c0dac0a73b110964437964d0d0163da0f5ce3a5ed65ca5ce04'
### cipherinfo: '834a31363136393034343134503c4b1b0750e8cf4cfcdfbbb83b79b851582fa1be82fab1786731c5bfc03ad943847fa9dca2a9d5b3ee3b49c3c20f435e771531e62b6cfa5f62659ca744d14a0e84'
### cipherinfo: '834a31363136393034343134503c4b1b0750e8cf4cfcdfbbb83b79b851582fa1be82fab1786731c5bfc03ad943847fa9dca2a9d5b3ee3b49c3c20f435e771531e62b6cfa5f62659ca744d14a0e84'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'c8d04dd62f74e32684917952'
### iv_xor: 'c8d04dd62f74e32684917952'
### authtag: '3c4b1b0750e8cf4cfcdfbbb83b79b851'
### authtag: '3c4b1b0750e8cf4cfcdfbbb83b79b851'
### ciphertext: 'a1be82fab1786731c5bfc03ad943847fa9dca2a9d5b3ee3b49c3c20f435e771531e62b6cfa5f62659ca744d14a0e84'
### ciphertext: 'a1be82fab1786731c5bfc03ad943847fa9dca2a9d5b3ee3b49c3c20f435e771531e62b6cfa5f62659ca744d14a0e84'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'NN',
###                               'test_psk',
###                               0
### -----------end test --------: 'NN',
###                               'test_psk',
###                               0


### -----------start test --------: 'NN',
###                                 'test_psk',
###                                 1
### -----------start test --------: 'NN',
###                                 'test_psk',
###                                 1

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NN",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "psk"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NNpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","47090b38845a0d67cbb1b640692d4c76dac6740b73514aea75b9f23d74422b45"),
                              h  => pack("H*","a2d5b771d00c5e5cc1f14ef2c562ac705eb314c235eb67e7360accf9f770cebd"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NN",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "psk"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NNpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","47090b38845a0d67cbb1b640692d4c76dac6740b73514aea75b9f23d74422b45"),
                              h  => pack("H*","a2d5b771d00c5e5cc1f14ef2c562ac705eb314c235eb67e7360accf9f770cebd"),
                            },
  who                    => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '03b164d6b8f47bd4d187c314f0a2cdb41516181ac16b8bf419cfb8fc9556bb3ead'

### public compressed: '03b164d6b8f47bd4d187c314f0a2cdb41516181ac16b8bf419cfb8fc9556bb3ead'

### write message pattern: 'psk'

### write message pattern: 'psk'

### noise encrypt

### noise encrypt
### key: '6d5388d03718b1b826f379d0cda21dde44f0d19ffd5d2f7e3e65f6c17370d988'
### key: '6d5388d03718b1b826f379d0cda21dde44f0d19ffd5d2f7e3e65f6c17370d988'
### iv: '3aae8de0b2170a6bd987c9ee'
### iv: '3aae8de0b2170a6bd987c9ee'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '0b98bcd68b273e5fe8b3c9ee'
### iv_xor: '0b98bcd68b273e5fe8b3c9ee'
### aad: 'f125c3fcbe2a6e1fcb956fd237326365a76c08f1030aa94f315d00a0069b9cab'
### aad: 'f125c3fcbe2a6e1fcb956fd237326365a76c08f1030aa94f315d00a0069b9cab'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '6aad11c980a70c40'
### ciphertext: '6aad11c980a70c40'
### authtag: '65d50f33c819596bb1c7ed63d9ea714d'
### authtag: '65d50f33c819596bb1c7ed63d9ea714d'
### cipherinfo: '834a313631363930343431345065d50f33c819596bb1c7ed63d9ea714d486aad11c980a70c40'
### cipherinfo: '834a313631363930343431345065d50f33c819596bb1c7ed63d9ea714d486aad11c980a70c40'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA7Fk1rj0e9TRh8MU8KLNtBUWGBrBa4v0Gc+4/JVWuz6tWCaDSjE2MTY5MDQ0MTRQZdUPM8gZWWuxx+1j2epxTUhqrRHJgKcMQA=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA7Fk1rj0e9TRh8MU8KLNtBUWGBrBa4v0Gc+4/JVWuz6tWCaDSjE2MTY5MDQ0MTRQZdUPM8gZWWuxx+1j2epxTUhqrRHJgKcMQA=="),
  );
}
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03b164d6b8f47bd4d187c314f0a2cdb41516181ac16b8bf419cfb8fc9556bb3ead"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "psk"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NNpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","64b2c73cd76f1ad7feecb68de981eccd87fbcd628f3dfd7014ade045603beda4"),
                                h => pack("H*","3ff0c3f609cb02e5236e5dab1b2d9c08bdf284b13b7ad99b268c9fc59b7d174c"),
                                hasK => 1,
                                k => pack("H*","8b3106fc18b90eb124f5e026a6c85e5027aee7ee9799a182deabc95f477a6065"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03b164d6b8f47bd4d187c314f0a2cdb41516181ac16b8bf419cfb8fc9556bb3ead"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "psk"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NNpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","64b2c73cd76f1ad7feecb68de981eccd87fbcd628f3dfd7014ade045603beda4"),
                                h => pack("H*","3ff0c3f609cb02e5236e5dab1b2d9c08bdf284b13b7ad99b268c9fc59b7d174c"),
                                hasK => 1,
                                k => pack("H*","8b3106fc18b90eb124f5e026a6c85e5027aee7ee9799a182deabc95f477a6065"),
                              },
    who                    => "a",
  },
)


### b read message from a
### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NN",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "psk"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NNpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","47090b38845a0d67cbb1b640692d4c76dac6740b73514aea75b9f23d74422b45"),
                              h  => pack("H*","a2d5b771d00c5e5cc1f14ef2c562ac705eb314c235eb67e7360accf9f770cebd"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NN",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "psk"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NNpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","47090b38845a0d67cbb1b640692d4c76dac6740b73514aea75b9f23d74422b45"),
                              h  => pack("H*","a2d5b771d00c5e5cc1f14ef2c562ac705eb314c235eb67e7360accf9f770cebd"),
                            },
  who                    => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'psk'

### read message pattern: 'psk'

### noise decrypt

### noise decrypt
### key: '6d5388d03718b1b826f379d0cda21dde44f0d19ffd5d2f7e3e65f6c17370d988'
### key: '6d5388d03718b1b826f379d0cda21dde44f0d19ffd5d2f7e3e65f6c17370d988'
### iv: '3aae8de0b2170a6bd987c9ee'
### iv: '3aae8de0b2170a6bd987c9ee'
### aad: 'f125c3fcbe2a6e1fcb956fd237326365a76c08f1030aa94f315d00a0069b9cab'
### aad: 'f125c3fcbe2a6e1fcb956fd237326365a76c08f1030aa94f315d00a0069b9cab'
### cipherinfo: '834a313631363930343431345065d50f33c819596bb1c7ed63d9ea714d486aad11c980a70c40'
### cipherinfo: '834a313631363930343431345065d50f33c819596bb1c7ed63d9ea714d486aad11c980a70c40'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '0b98bcd68b273e5fe8b3c9ee'
### iv_xor: '0b98bcd68b273e5fe8b3c9ee'
### authtag: '65d50f33c819596bb1c7ed63d9ea714d'
### authtag: '65d50f33c819596bb1c7ed63d9ea714d'
### ciphertext: '6aad11c980a70c40'
### ciphertext: '6aad11c980a70c40'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "psk"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NNpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","03b164d6b8f47bd4d187c314f0a2cdb41516181ac16b8bf419cfb8fc9556bb3ead"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","64b2c73cd76f1ad7feecb68de981eccd87fbcd628f3dfd7014ade045603beda4"),
                                h => pack("H*","3ff0c3f609cb02e5236e5dab1b2d9c08bdf284b13b7ad99b268c9fc59b7d174c"),
                                hasK => 1,
                                k => pack("H*","8b3106fc18b90eb124f5e026a6c85e5027aee7ee9799a182deabc95f477a6065"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "psk"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NNpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","03b164d6b8f47bd4d187c314f0a2cdb41516181ac16b8bf419cfb8fc9556bb3ead"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","64b2c73cd76f1ad7feecb68de981eccd87fbcd628f3dfd7014ade045603beda4"),
                                h => pack("H*","3ff0c3f609cb02e5236e5dab1b2d9c08bdf284b13b7ad99b268c9fc59b7d174c"),
                                hasK => 1,
                                k => pack("H*","8b3106fc18b90eb124f5e026a6c85e5027aee7ee9799a182deabc95f477a6065"),
                              },
    who                    => "b",
  },
)


### b write_message to a
### b write_message to a
### b send msg to a
### b send msg to a


### write message pattern: 'e'
### write message pattern: 'e'

### public compressed: '028dcb6b49f7420cf6de3311f7c370bbf61d4882a87c73e4794af412daa72dcd96'

### public compressed: '028dcb6b49f7420cf6de3311f7c370bbf61d4882a87c73e4794af412daa72dcd96'


### write message pattern: 'ee'
### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIKn5NwU9TIAJONU6ctfyKNXnftmYv5f6dCqjgygKw0JXoAoGCCqGSM49
',
###             'AwEHoUQDQgAEjctrSfdCDPbeMxH3w3C79h1Igqh8c+R5SvQS2qctzZZL5nd3hCYZ
',
###             'bCqI0mak3QCKVaurMAusuD0GYpTlA9lTYg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIKn5NwU9TIAJONU6ctfyKNXnftmYv5f6dCqjgygKw0JXoAoGCCqGSM49
',
###             'AwEHoUQDQgAEjctrSfdCDPbeMxH3w3C79h1Igqh8c+R5SvQS2qctzZZL5nd3hCYZ
',
###             'bCqI0mak3QCKVaurMAusuD0GYpTlA9lTYg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEsWTWuPR71NGHwxTwos20FRYYGsFr
',
###           'i/QZz7j8lVa7Pq15k45oi1XecvOONHWUpX60yIzl/YW+3wHM4od3im/CKw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEsWTWuPR71NGHwxTwos20FRYYGsFr
',
###           'i/QZz7j8lVa7Pq15k45oi1XecvOONHWUpX60yIzl/YW+3wHM4od3im/CKw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'a5e2a81d76f411651a1bb0ec61ae95ade2f982ca86f7b0c2e249714f43324d62'
### z: 'a5e2a81d76f411651a1bb0ec61ae95ade2f982ca86f7b0c2e249714f43324d62'


### noise encrypt
### noise encrypt
### key: '1b441f7a6620620b4e28a8e1a8e2d18f5fac2482d80bc5689c45dc458b2cdb48'
### key: '1b441f7a6620620b4e28a8e1a8e2d18f5fac2482d80bc5689c45dc458b2cdb48'
### iv: '6552528982d656aa825f1acf'
### iv: '6552528982d656aa825f1acf'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '546463bfbbe6629eb36b1acf'
### iv_xor: '546463bfbbe6629eb36b1acf'
### aad: 'b2a25c0f4bfc13c73785b93c29bbc2bacd023142d028f4547a67cd01afc999e1'
### aad: 'b2a25c0f4bfc13c73785b93c29bbc2bacd023142d028f4547a67cd01afc999e1'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '0aee66f5dc9ea94e'
### ciphertext: '0aee66f5dc9ea94e'
### authtag: 'a14da04acf1e1606830dbdf6b4bbf523'
### authtag: 'a14da04acf1e1606830dbdf6b4bbf523'
### cipherinfo: '834a3136313639303434313450a14da04acf1e1606830dbdf6b4bbf523480aee66f5dc9ea94e'
### cipherinfo: '834a3136313639303434313450a14da04acf1e1606830dbdf6b4bbf523480aee66f5dc9ea94e'


### b_msg: '825821028dcb6b49f7420cf6de3311f7c370bbf61d4882a87c73e4794af412daa72dcd965826834a3136313639303434313450a14da04acf1e1606830dbdf6b4bbf523480aee66f5dc9ea94e'
### b_msg: '825821028dcb6b49f7420cf6de3311f7c370bbf61d4882a87c73e4794af412daa72dcd965826834a3136313639303434313450a14da04acf1e1606830dbdf6b4bbf523480aee66f5dc9ea94e'
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","028dcb6b49f7420cf6de3311f7c370bbf61d4882a87c73e4794af412daa72dcd96"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "psk"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NNpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","03b164d6b8f47bd4d187c314f0a2cdb41516181ac16b8bf419cfb8fc9556bb3ead"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","161728bdd14f8480b0343578790410e347dedbefefa420f078d992a68dc1e50e"),
                                h => pack("H*","dfb4007b888f5fba1d2326ca3957d9cba1ec3c9b00f7053eb35860762d658ce2"),
                                hasK => 1,
                                k => pack("H*","d5a9b7219e40668e92f51964f767bceee764f5503593826a89128f6af914600d"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","9d251d901465e0dad2cd47c025fb534ae4b372290b2d31fdf4a785997f5b760b"),
  },
  {
    hasK => 1,
    k => pack("H*","f80ea84c2882a5c3e5dedbbc47128259a7ddaa0b0407df5601f50df5297cf8d0"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","028dcb6b49f7420cf6de3311f7c370bbf61d4882a87c73e4794af412daa72dcd96"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "psk"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NNpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","03b164d6b8f47bd4d187c314f0a2cdb41516181ac16b8bf419cfb8fc9556bb3ead"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","161728bdd14f8480b0343578790410e347dedbefefa420f078d992a68dc1e50e"),
                                h => pack("H*","dfb4007b888f5fba1d2326ca3957d9cba1ec3c9b00f7053eb35860762d658ce2"),
                                hasK => 1,
                                k => pack("H*","d5a9b7219e40668e92f51964f767bceee764f5503593826a89128f6af914600d"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","9d251d901465e0dad2cd47c025fb534ae4b372290b2d31fdf4a785997f5b760b"),
  },
  {
    hasK => 1,
    k => pack("H*","f80ea84c2882a5c3e5dedbbc47128259a7ddaa0b0407df5601f50df5297cf8d0"),
  },
)


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIKjoWmFZwV0JPeLkJvb7gzsk3TrvHYRJFn/1GSMeqAGSoAoGCCqGSM49
',
###             'AwEHoUQDQgAEsWTWuPR71NGHwxTwos20FRYYGsFri/QZz7j8lVa7Pq15k45oi1Xe
',
###             'cvOONHWUpX60yIzl/YW+3wHM4od3im/CKw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIKjoWmFZwV0JPeLkJvb7gzsk3TrvHYRJFn/1GSMeqAGSoAoGCCqGSM49
',
###             'AwEHoUQDQgAEsWTWuPR71NGHwxTwos20FRYYGsFri/QZz7j8lVa7Pq15k45oi1Xe
',
###             'cvOONHWUpX60yIzl/YW+3wHM4od3im/CKw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEjctrSfdCDPbeMxH3w3C79h1Igqh8
',
###           'c+R5SvQS2qctzZZL5nd3hCYZbCqI0mak3QCKVaurMAusuD0GYpTlA9lTYg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEjctrSfdCDPbeMxH3w3C79h1Igqh8
',
###           'c+R5SvQS2qctzZZL5nd3hCYZbCqI0mak3QCKVaurMAusuD0GYpTlA9lTYg==
',
###           '-----END PUBLIC KEY-----
'
### z: 'a5e2a81d76f411651a1bb0ec61ae95ade2f982ca86f7b0c2e249714f43324d62'
### z: 'a5e2a81d76f411651a1bb0ec61ae95ade2f982ca86f7b0c2e249714f43324d62'


### noise decrypt
### noise decrypt
### key: '1b441f7a6620620b4e28a8e1a8e2d18f5fac2482d80bc5689c45dc458b2cdb48'
### key: '1b441f7a6620620b4e28a8e1a8e2d18f5fac2482d80bc5689c45dc458b2cdb48'
### iv: '6552528982d656aa825f1acf'
### iv: '6552528982d656aa825f1acf'
### aad: 'b2a25c0f4bfc13c73785b93c29bbc2bacd023142d028f4547a67cd01afc999e1'
### aad: 'b2a25c0f4bfc13c73785b93c29bbc2bacd023142d028f4547a67cd01afc999e1'
### cipherinfo: '834a3136313639303434313450a14da04acf1e1606830dbdf6b4bbf523480aee66f5dc9ea94e'
### cipherinfo: '834a3136313639303434313450a14da04acf1e1606830dbdf6b4bbf523480aee66f5dc9ea94e'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '546463bfbbe6629eb36b1acf'
### iv_xor: '546463bfbbe6629eb36b1acf'
### authtag: 'a14da04acf1e1606830dbdf6b4bbf523'
### authtag: 'a14da04acf1e1606830dbdf6b4bbf523'
### ciphertext: '0aee66f5dc9ea94e'
### ciphertext: '0aee66f5dc9ea94e'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03b164d6b8f47bd4d187c314f0a2cdb41516181ac16b8bf419cfb8fc9556bb3ead"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "psk"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NNpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","028dcb6b49f7420cf6de3311f7c370bbf61d4882a87c73e4794af412daa72dcd96"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","161728bdd14f8480b0343578790410e347dedbefefa420f078d992a68dc1e50e"),
                                h => pack("H*","dfb4007b888f5fba1d2326ca3957d9cba1ec3c9b00f7053eb35860762d658ce2"),
                                hasK => 1,
                                k => pack("H*","d5a9b7219e40668e92f51964f767bceee764f5503593826a89128f6af914600d"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","9d251d901465e0dad2cd47c025fb534ae4b372290b2d31fdf4a785997f5b760b"),
  },
  {
    hasK => 1,
    k => pack("H*","f80ea84c2882a5c3e5dedbbc47128259a7ddaa0b0407df5601f50df5297cf8d0"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03b164d6b8f47bd4d187c314f0a2cdb41516181ac16b8bf419cfb8fc9556bb3ead"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NN",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "psk"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NNpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","028dcb6b49f7420cf6de3311f7c370bbf61d4882a87c73e4794af412daa72dcd96"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","161728bdd14f8480b0343578790410e347dedbefefa420f078d992a68dc1e50e"),
                                h => pack("H*","dfb4007b888f5fba1d2326ca3957d9cba1ec3c9b00f7053eb35860762d658ce2"),
                                hasK => 1,
                                k => pack("H*","d5a9b7219e40668e92f51964f767bceee764f5503593826a89128f6af914600d"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","9d251d901465e0dad2cd47c025fb534ae4b372290b2d31fdf4a785997f5b760b"),
  },
  {
    hasK => 1,
    k => pack("H*","f80ea84c2882a5c3e5dedbbc47128259a7ddaa0b0407df5601f50df5297cf8d0"),
  },
)


### a send comm msg to b
### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '504379dc677d028e4a55eecfc2aade9817a099ff71cf6648c6c96f8abc5a2330'
### key: '504379dc677d028e4a55eecfc2aade9817a099ff71cf6648c6c96f8abc5a2330'
### iv: 'e6336672b5b5f6a8cf268155'
### iv: 'e6336672b5b5f6a8cf268155'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'd70557448c85c29cfe128155'
### iv_xor: 'd70557448c85c29cfe128155'
### aad: 'dfb4007b888f5fba1d2326ca3957d9cba1ec3c9b00f7053eb35860762d658ce2'
### aad: 'dfb4007b888f5fba1d2326ca3957d9cba1ec3c9b00f7053eb35860762d658ce2'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '1d3b42b98c50a6659dfec3e279ce88e002262fd2c47d3c5babac61acb712215f7f52c3bb5516914288da22d0d3100e5535c1d9'
### ciphertext: '1d3b42b98c50a6659dfec3e279ce88e002262fd2c47d3c5babac61acb712215f7f52c3bb5516914288da22d0d3100e5535c1d9'
### authtag: 'ed54862fa208eb89beb2c2b873a74745'
### authtag: 'ed54862fa208eb89beb2c2b873a74745'
### cipherinfo: '834a3136313639303434313450ed54862fa208eb89beb2c2b873a7474558331d3b42b98c50a6659dfec3e279ce88e002262fd2c47d3c5babac61acb712215f7f52c3bb5516914288da22d0d3100e5535c1d9'
### cipherinfo: '834a3136313639303434313450ed54862fa208eb89beb2c2b873a7474558331d3b42b98c50a6659dfec3e279ce88e002262fd2c47d3c5babac61acb712215f7f52c3bb5516914288da22d0d3100e5535c1d9'


### b recv comm msg from a
### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '504379dc677d028e4a55eecfc2aade9817a099ff71cf6648c6c96f8abc5a2330'
### key: '504379dc677d028e4a55eecfc2aade9817a099ff71cf6648c6c96f8abc5a2330'
### iv: 'e6336672b5b5f6a8cf268155'
### iv: 'e6336672b5b5f6a8cf268155'
### aad: 'dfb4007b888f5fba1d2326ca3957d9cba1ec3c9b00f7053eb35860762d658ce2'
### aad: 'dfb4007b888f5fba1d2326ca3957d9cba1ec3c9b00f7053eb35860762d658ce2'
### cipherinfo: '834a3136313639303434313450ed54862fa208eb89beb2c2b873a7474558331d3b42b98c50a6659dfec3e279ce88e002262fd2c47d3c5babac61acb712215f7f52c3bb5516914288da22d0d3100e5535c1d9'
### cipherinfo: '834a3136313639303434313450ed54862fa208eb89beb2c2b873a7474558331d3b42b98c50a6659dfec3e279ce88e002262fd2c47d3c5babac61acb712215f7f52c3bb5516914288da22d0d3100e5535c1d9'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'd70557448c85c29cfe128155'
### iv_xor: 'd70557448c85c29cfe128155'
### authtag: 'ed54862fa208eb89beb2c2b873a74745'
### authtag: 'ed54862fa208eb89beb2c2b873a74745'
### ciphertext: '1d3b42b98c50a6659dfec3e279ce88e002262fd2c47d3c5babac61acb712215f7f52c3bb5516914288da22d0d3100e5535c1d9'
### ciphertext: '1d3b42b98c50a6659dfec3e279ce88e002262fd2c47d3c5babac61acb712215f7f52c3bb5516914288da22d0d3100e5535c1d9'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '4cdcb223a4c2dd88fa910a79a0338b1f73dcaf21b7be15f1f0b6dde3f860d847'
### key: '4cdcb223a4c2dd88fa910a79a0338b1f73dcaf21b7be15f1f0b6dde3f860d847'
### iv: '8d7287eb646664c02136f80d'
### iv: '8d7287eb646664c02136f80d'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'bc44b6dd5d5650f41002f80d'
### iv_xor: 'bc44b6dd5d5650f41002f80d'
### aad: 'dfb4007b888f5fba1d2326ca3957d9cba1ec3c9b00f7053eb35860762d658ce2'
### aad: 'dfb4007b888f5fba1d2326ca3957d9cba1ec3c9b00f7053eb35860762d658ce2'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '8e7c6542248eadc7e39f6b612a936a71694863853999580557ce2ba490b1e56f90edf73ea02ac4b5c6f6d19b354fb6'
### ciphertext: '8e7c6542248eadc7e39f6b612a936a71694863853999580557ce2ba490b1e56f90edf73ea02ac4b5c6f6d19b354fb6'
### authtag: 'd805ca2bcc748490c98f5577381f9071'
### authtag: 'd805ca2bcc748490c98f5577381f9071'
### cipherinfo: '834a3136313639303434313450d805ca2bcc748490c98f5577381f9071582f8e7c6542248eadc7e39f6b612a936a71694863853999580557ce2ba490b1e56f90edf73ea02ac4b5c6f6d19b354fb6'
### cipherinfo: '834a3136313639303434313450d805ca2bcc748490c98f5577381f9071582f8e7c6542248eadc7e39f6b612a936a71694863853999580557ce2ba490b1e56f90edf73ea02ac4b5c6f6d19b354fb6'


### a recv comm msg from b
### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '4cdcb223a4c2dd88fa910a79a0338b1f73dcaf21b7be15f1f0b6dde3f860d847'
### key: '4cdcb223a4c2dd88fa910a79a0338b1f73dcaf21b7be15f1f0b6dde3f860d847'
### iv: '8d7287eb646664c02136f80d'
### iv: '8d7287eb646664c02136f80d'
### aad: 'dfb4007b888f5fba1d2326ca3957d9cba1ec3c9b00f7053eb35860762d658ce2'
### aad: 'dfb4007b888f5fba1d2326ca3957d9cba1ec3c9b00f7053eb35860762d658ce2'
### cipherinfo: '834a3136313639303434313450d805ca2bcc748490c98f5577381f9071582f8e7c6542248eadc7e39f6b612a936a71694863853999580557ce2ba490b1e56f90edf73ea02ac4b5c6f6d19b354fb6'
### cipherinfo: '834a3136313639303434313450d805ca2bcc748490c98f5577381f9071582f8e7c6542248eadc7e39f6b612a936a71694863853999580557ce2ba490b1e56f90edf73ea02ac4b5c6f6d19b354fb6'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'bc44b6dd5d5650f41002f80d'
### iv_xor: 'bc44b6dd5d5650f41002f80d'
### authtag: 'd805ca2bcc748490c98f5577381f9071'
### authtag: 'd805ca2bcc748490c98f5577381f9071'
### ciphertext: '8e7c6542248eadc7e39f6b612a936a71694863853999580557ce2ba490b1e56f90edf73ea02ac4b5c6f6d19b354fb6'
### ciphertext: '8e7c6542248eadc7e39f6b612a936a71694863853999580557ce2ba490b1e56f90edf73ea02ac4b5c6f6d19b354fb6'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'NN',
###                               'test_psk',
###                               1
### -----------end test --------: 'NN',
###                               'test_psk',
###                               1


### -----------start test --------: 'NK',
###                                 undef,
###                                 undef
### -----------start test --------: 'NK',
###                                 undef,
###                                 undef

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NK_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => "Noise_NK_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","2ae14458ce54aa7003e70975f58e8a41e2e7ce1fb61df64492c4a0d77ce4da98"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NK_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => "Noise_NK_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","2ae14458ce54aa7003e70975f58e8a41e2e7ce1fb61df64492c4a0d77ce4da98"),
                            },
  who                    => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '030cc22e30ca9af17ba0da5d1346d169cc5e8b2c27e793b0099b6eb3715a333cb2'

### public compressed: '030cc22e30ca9af17ba0da5d1346d169cc5e8b2c27e793b0099b6eb3715a333cb2'


### write message pattern: 'es'
### write message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBlnfSNCfSggbemD53s41ERgN8vE2JUrGH6xXzZySe82oAoGCCqGSM49
',
###             'AwEHoUQDQgAEDMIuMMqa8Xug2l0TRtFpzF6LLCfnk7AJm26zcVozPLLf2qe6a+/2
',
###             'U5P9JpsRmaGtDeXIBwE0ORVv3WcZg1G34Q==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBlnfSNCfSggbemD53s41ERgN8vE2JUrGH6xXzZySe82oAoGCCqGSM49
',
###             'AwEHoUQDQgAEDMIuMMqa8Xug2l0TRtFpzF6LLCfnk7AJm26zcVozPLLf2qe6a+/2
',
###             'U5P9JpsRmaGtDeXIBwE0ORVv3WcZg1G34Q==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '0ad51c4e93f99abdf2dc5f7f472b38366c19744bef9c8ae658c0f99a67563003'
### z: '0ad51c4e93f99abdf2dc5f7f472b38366c19744bef9c8ae658c0f99a67563003'


### noise encrypt
### noise encrypt
### key: 'dc1535ba8458442e901f1821729bddbf14ece9d6b01a31742faace855563c0cb'
### key: 'dc1535ba8458442e901f1821729bddbf14ece9d6b01a31742faace855563c0cb'
### iv: 'e06f26bcf9e22e74158300fc'
### iv: 'e06f26bcf9e22e74158300fc'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'd159178ac0d21a4024b700fc'
### iv_xor: 'd159178ac0d21a4024b700fc'
### aad: '491dc99e2ca6eeae2f44c24a38dcc7b15fc2fa9374c1d93f956ae57e19965a36'
### aad: '491dc99e2ca6eeae2f44c24a38dcc7b15fc2fa9374c1d93f956ae57e19965a36'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '98cdd4a8d13ba527'
### ciphertext: '98cdd4a8d13ba527'
### authtag: '755bcd3bdfb4ffd9c28c73e451740763'
### authtag: '755bcd3bdfb4ffd9c28c73e451740763'
### cipherinfo: '834a3136313639303434313450755bcd3bdfb4ffd9c28c73e4517407634898cdd4a8d13ba527'
### cipherinfo: '834a3136313639303434313450755bcd3bdfb4ffd9c28c73e4517407634898cdd4a8d13ba527'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAwzCLjDKmvF7oNpdE0bRacxeiywn55OwCZtus3FaMzyyWCaDSjE2MTY5MDQ0MTRQdVvNO9+0/9nCjHPkUXQHY0iYzdSo0TulJw=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAwzCLjDKmvF7oNpdE0bRacxeiywn55OwCZtus3FaMzyyWCaDSjE2MTY5MDQ0MTRQdVvNO9+0/9nCjHPkUXQHY0iYzdSo0TulJw=="),
  );
}
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","030cc22e30ca9af17ba0da5d1346d169cc5e8b2c27e793b0099b6eb3715a333cb2"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","790a243675ee40d26266ede73b5ee3fcdb3daeaa4dd475b4a6e1f2b085f4aeaf"),
                                h => pack("H*","3e9c54b50622433bde62e914f22c64147e6a6827dc099e346bd57f7e9df3bb5c"),
                                hasK => 1,
                                k => pack("H*","abb469bc249e2c3871b47be6d3ebe226f53c1c32164fb55c015e2f554cc198e4"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","030cc22e30ca9af17ba0da5d1346d169cc5e8b2c27e793b0099b6eb3715a333cb2"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","790a243675ee40d26266ede73b5ee3fcdb3daeaa4dd475b4a6e1f2b085f4aeaf"),
                                h => pack("H*","3e9c54b50622433bde62e914f22c64147e6a6827dc099e346bd57f7e9df3bb5c"),
                                hasK => 1,
                                k => pack("H*","abb469bc249e2c3871b47be6d3ebe226f53c1c32164fb55c015e2f554cc198e4"),
                              },
    who                    => "a",
  },
)


### b read message from a
### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NK_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => "Noise_NK_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","2ae14458ce54aa7003e70975f58e8a41e2e7ce1fb61df64492c4a0d77ce4da98"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NK_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => "Noise_NK_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","2ae14458ce54aa7003e70975f58e8a41e2e7ce1fb61df64492c4a0d77ce4da98"),
                            },
  who                    => "b",
}


### b recv msg from a
### b recv msg from a


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEDMIuMMqa8Xug2l0TRtFpzF6LLCfn
',
###           'k7AJm26zcVozPLLf2qe6a+/2U5P9JpsRmaGtDeXIBwE0ORVv3WcZg1G34Q==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEDMIuMMqa8Xug2l0TRtFpzF6LLCfn
',
###           'k7AJm26zcVozPLLf2qe6a+/2U5P9JpsRmaGtDeXIBwE0ORVv3WcZg1G34Q==
',
###           '-----END PUBLIC KEY-----
'
### z: '0ad51c4e93f99abdf2dc5f7f472b38366c19744bef9c8ae658c0f99a67563003'
### z: '0ad51c4e93f99abdf2dc5f7f472b38366c19744bef9c8ae658c0f99a67563003'


### noise decrypt
### noise decrypt
### key: 'dc1535ba8458442e901f1821729bddbf14ece9d6b01a31742faace855563c0cb'
### key: 'dc1535ba8458442e901f1821729bddbf14ece9d6b01a31742faace855563c0cb'
### iv: 'e06f26bcf9e22e74158300fc'
### iv: 'e06f26bcf9e22e74158300fc'
### aad: '491dc99e2ca6eeae2f44c24a38dcc7b15fc2fa9374c1d93f956ae57e19965a36'
### aad: '491dc99e2ca6eeae2f44c24a38dcc7b15fc2fa9374c1d93f956ae57e19965a36'
### cipherinfo: '834a3136313639303434313450755bcd3bdfb4ffd9c28c73e4517407634898cdd4a8d13ba527'
### cipherinfo: '834a3136313639303434313450755bcd3bdfb4ffd9c28c73e4517407634898cdd4a8d13ba527'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'd159178ac0d21a4024b700fc'
### iv_xor: 'd159178ac0d21a4024b700fc'
### authtag: '755bcd3bdfb4ffd9c28c73e451740763'
### authtag: '755bcd3bdfb4ffd9c28c73e451740763'
### ciphertext: '98cdd4a8d13ba527'
### ciphertext: '98cdd4a8d13ba527'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","030cc22e30ca9af17ba0da5d1346d169cc5e8b2c27e793b0099b6eb3715a333cb2"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","790a243675ee40d26266ede73b5ee3fcdb3daeaa4dd475b4a6e1f2b085f4aeaf"),
                                h => pack("H*","3e9c54b50622433bde62e914f22c64147e6a6827dc099e346bd57f7e9df3bb5c"),
                                hasK => 1,
                                k => pack("H*","abb469bc249e2c3871b47be6d3ebe226f53c1c32164fb55c015e2f554cc198e4"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","030cc22e30ca9af17ba0da5d1346d169cc5e8b2c27e793b0099b6eb3715a333cb2"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","790a243675ee40d26266ede73b5ee3fcdb3daeaa4dd475b4a6e1f2b085f4aeaf"),
                                h => pack("H*","3e9c54b50622433bde62e914f22c64147e6a6827dc099e346bd57f7e9df3bb5c"),
                                hasK => 1,
                                k => pack("H*","abb469bc249e2c3871b47be6d3ebe226f53c1c32164fb55c015e2f554cc198e4"),
                              },
    who                    => "b",
  },
)


### b write_message to a
### b write_message to a
### b send msg to a
### b send msg to a


### write message pattern: 'e'
### write message pattern: 'e'

### public compressed: '0310030cc4b4244fe57bafb5449a29cc0c1b554a697b08dd2278b2d7bda63e3598'

### public compressed: '0310030cc4b4244fe57bafb5449a29cc0c1b554a697b08dd2278b2d7bda63e3598'


### write message pattern: 'ee'
### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOQPjI3tvsVNZsoEOip3qp1F6Epfoz2gKygm2YBaxJCboAoGCCqGSM49
',
###             'AwEHoUQDQgAEEAMMxLQkT+V7r7VEminMDBtVSml7CN0ieLLXvaY+NZh/1EgvoFo2
',
###             'psFzkS/I9h1CgCFCp0x48JY4RmfgBCMdZQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOQPjI3tvsVNZsoEOip3qp1F6Epfoz2gKygm2YBaxJCboAoGCCqGSM49
',
###             'AwEHoUQDQgAEEAMMxLQkT+V7r7VEminMDBtVSml7CN0ieLLXvaY+NZh/1EgvoFo2
',
###             'psFzkS/I9h1CgCFCp0x48JY4RmfgBCMdZQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEDMIuMMqa8Xug2l0TRtFpzF6LLCfn
',
###           'k7AJm26zcVozPLLf2qe6a+/2U5P9JpsRmaGtDeXIBwE0ORVv3WcZg1G34Q==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEDMIuMMqa8Xug2l0TRtFpzF6LLCfn
',
###           'k7AJm26zcVozPLLf2qe6a+/2U5P9JpsRmaGtDeXIBwE0ORVv3WcZg1G34Q==
',
###           '-----END PUBLIC KEY-----
'
### z: '51a0c5b390537937c7d96ffbd392438d97a746e6a7363c4fce59c9332c0a0d43'
### z: '51a0c5b390537937c7d96ffbd392438d97a746e6a7363c4fce59c9332c0a0d43'

### noise encrypt

### noise encrypt
### key: '995ac2aa10fa5929de4691595d0cdb8033f3c1a7da625fee0f22bfab62c9b0c0'
### key: '995ac2aa10fa5929de4691595d0cdb8033f3c1a7da625fee0f22bfab62c9b0c0'
### iv: '21e5103dc857fe3809962fd1'
### iv: '21e5103dc857fe3809962fd1'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '10d3210bf167ca0c38a22fd1'
### iv_xor: '10d3210bf167ca0c38a22fd1'
### aad: '70193f797378d36d8cfc30909acb67745c710317ebcd936516847592f2d94783'
### aad: '70193f797378d36d8cfc30909acb67745c710317ebcd936516847592f2d94783'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '456b3049a20721b3'
### ciphertext: '456b3049a20721b3'
### authtag: 'a5b8026f53a9b5cb750b9c88530148ab'
### authtag: 'a5b8026f53a9b5cb750b9c88530148ab'
### cipherinfo: '834a3136313639303434313450a5b8026f53a9b5cb750b9c88530148ab48456b3049a20721b3'
### cipherinfo: '834a3136313639303434313450a5b8026f53a9b5cb750b9c88530148ab48456b3049a20721b3'


### b_msg: '8258210310030cc4b4244fe57bafb5449a29cc0c1b554a697b08dd2278b2d7bda63e35985826834a3136313639303434313450a5b8026f53a9b5cb750b9c88530148ab48456b3049a20721b3'
### b_msg: '8258210310030cc4b4244fe57bafb5449a29cc0c1b554a697b08dd2278b2d7bda63e35985826834a3136313639303434313450a5b8026f53a9b5cb750b9c88530148ab48456b3049a20721b3'
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0310030cc4b4244fe57bafb5449a29cc0c1b554a697b08dd2278b2d7bda63e3598"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","030cc22e30ca9af17ba0da5d1346d169cc5e8b2c27e793b0099b6eb3715a333cb2"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","a7f821e935cfcad9852db13eb164e434e6523e0652f788db4a51a274986370ef"),
                                h => pack("H*","91857ec57f0892bf7c116395f2f56d3c1ab89f1bbbb8af5ee2f682d0a05ee029"),
                                hasK => 1,
                                k => pack("H*","edbcd62f1bf3057f9a35f5b774defe7918416b3ffb77db300af159b7370f66fe"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","9604c6ad183d20dd5aa93da49ae095d4839cfcd84aa23ee4744fdd889ed31fdb"),
  },
  {
    hasK => 1,
    k => pack("H*","a4b75540cf9a1bd16aa6f7dfe6a4eb37e7cac01d6f9332c620d95d771f7e12f6"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0310030cc4b4244fe57bafb5449a29cc0c1b554a697b08dd2278b2d7bda63e3598"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","030cc22e30ca9af17ba0da5d1346d169cc5e8b2c27e793b0099b6eb3715a333cb2"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","a7f821e935cfcad9852db13eb164e434e6523e0652f788db4a51a274986370ef"),
                                h => pack("H*","91857ec57f0892bf7c116395f2f56d3c1ab89f1bbbb8af5ee2f682d0a05ee029"),
                                hasK => 1,
                                k => pack("H*","edbcd62f1bf3057f9a35f5b774defe7918416b3ffb77db300af159b7370f66fe"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","9604c6ad183d20dd5aa93da49ae095d4839cfcd84aa23ee4744fdd889ed31fdb"),
  },
  {
    hasK => 1,
    k => pack("H*","a4b75540cf9a1bd16aa6f7dfe6a4eb37e7cac01d6f9332c620d95d771f7e12f6"),
  },
)


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBlnfSNCfSggbemD53s41ERgN8vE2JUrGH6xXzZySe82oAoGCCqGSM49
',
###             'AwEHoUQDQgAEDMIuMMqa8Xug2l0TRtFpzF6LLCfnk7AJm26zcVozPLLf2qe6a+/2
',
###             'U5P9JpsRmaGtDeXIBwE0ORVv3WcZg1G34Q==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBlnfSNCfSggbemD53s41ERgN8vE2JUrGH6xXzZySe82oAoGCCqGSM49
',
###             'AwEHoUQDQgAEDMIuMMqa8Xug2l0TRtFpzF6LLCfnk7AJm26zcVozPLLf2qe6a+/2
',
###             'U5P9JpsRmaGtDeXIBwE0ORVv3WcZg1G34Q==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEEAMMxLQkT+V7r7VEminMDBtVSml7
',
###           'CN0ieLLXvaY+NZh/1EgvoFo2psFzkS/I9h1CgCFCp0x48JY4RmfgBCMdZQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEEAMMxLQkT+V7r7VEminMDBtVSml7
',
###           'CN0ieLLXvaY+NZh/1EgvoFo2psFzkS/I9h1CgCFCp0x48JY4RmfgBCMdZQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '51a0c5b390537937c7d96ffbd392438d97a746e6a7363c4fce59c9332c0a0d43'
### z: '51a0c5b390537937c7d96ffbd392438d97a746e6a7363c4fce59c9332c0a0d43'

### noise decrypt

### noise decrypt
### key: '995ac2aa10fa5929de4691595d0cdb8033f3c1a7da625fee0f22bfab62c9b0c0'
### key: '995ac2aa10fa5929de4691595d0cdb8033f3c1a7da625fee0f22bfab62c9b0c0'
### iv: '21e5103dc857fe3809962fd1'
### iv: '21e5103dc857fe3809962fd1'
### aad: '70193f797378d36d8cfc30909acb67745c710317ebcd936516847592f2d94783'
### aad: '70193f797378d36d8cfc30909acb67745c710317ebcd936516847592f2d94783'
### cipherinfo: '834a3136313639303434313450a5b8026f53a9b5cb750b9c88530148ab48456b3049a20721b3'
### cipherinfo: '834a3136313639303434313450a5b8026f53a9b5cb750b9c88530148ab48456b3049a20721b3'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '10d3210bf167ca0c38a22fd1'
### iv_xor: '10d3210bf167ca0c38a22fd1'
### authtag: 'a5b8026f53a9b5cb750b9c88530148ab'
### authtag: 'a5b8026f53a9b5cb750b9c88530148ab'
### ciphertext: '456b3049a20721b3'
### ciphertext: '456b3049a20721b3'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","030cc22e30ca9af17ba0da5d1346d169cc5e8b2c27e793b0099b6eb3715a333cb2"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","0310030cc4b4244fe57bafb5449a29cc0c1b554a697b08dd2278b2d7bda63e3598"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","a7f821e935cfcad9852db13eb164e434e6523e0652f788db4a51a274986370ef"),
                                h => pack("H*","91857ec57f0892bf7c116395f2f56d3c1ab89f1bbbb8af5ee2f682d0a05ee029"),
                                hasK => 1,
                                k => pack("H*","edbcd62f1bf3057f9a35f5b774defe7918416b3ffb77db300af159b7370f66fe"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","9604c6ad183d20dd5aa93da49ae095d4839cfcd84aa23ee4744fdd889ed31fdb"),
  },
  {
    hasK => 1,
    k => pack("H*","a4b75540cf9a1bd16aa6f7dfe6a4eb37e7cac01d6f9332c620d95d771f7e12f6"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","030cc22e30ca9af17ba0da5d1346d169cc5e8b2c27e793b0099b6eb3715a333cb2"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","0310030cc4b4244fe57bafb5449a29cc0c1b554a697b08dd2278b2d7bda63e3598"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","a7f821e935cfcad9852db13eb164e434e6523e0652f788db4a51a274986370ef"),
                                h => pack("H*","91857ec57f0892bf7c116395f2f56d3c1ab89f1bbbb8af5ee2f682d0a05ee029"),
                                hasK => 1,
                                k => pack("H*","edbcd62f1bf3057f9a35f5b774defe7918416b3ffb77db300af159b7370f66fe"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","9604c6ad183d20dd5aa93da49ae095d4839cfcd84aa23ee4744fdd889ed31fdb"),
  },
  {
    hasK => 1,
    k => pack("H*","a4b75540cf9a1bd16aa6f7dfe6a4eb37e7cac01d6f9332c620d95d771f7e12f6"),
  },
)


### a send comm msg to b
### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '6075a36b7bd25aa09f5ea8ee9cc4a4b827e6033195583cfd0d0964cb93552df6'
### key: '6075a36b7bd25aa09f5ea8ee9cc4a4b827e6033195583cfd0d0964cb93552df6'
### iv: '1fd4343b43da61104013d0f8'
### iv: '1fd4343b43da61104013d0f8'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '2ee2050d7aea55247127d0f8'
### iv_xor: '2ee2050d7aea55247127d0f8'
### aad: '91857ec57f0892bf7c116395f2f56d3c1ab89f1bbbb8af5ee2f682d0a05ee029'
### aad: '91857ec57f0892bf7c116395f2f56d3c1ab89f1bbbb8af5ee2f682d0a05ee029'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'f2a8d69fbf0b78e75b5b6ca4afde7d4ae83d2d6c72bf70fa59065b8f0e82153314566efc399cc4117f666600359aa20b194551'
### ciphertext: 'f2a8d69fbf0b78e75b5b6ca4afde7d4ae83d2d6c72bf70fa59065b8f0e82153314566efc399cc4117f666600359aa20b194551'
### authtag: '970afd743b02558aa4fe91d78c2190f9'
### authtag: '970afd743b02558aa4fe91d78c2190f9'
### cipherinfo: '834a3136313639303434313450970afd743b02558aa4fe91d78c2190f95833f2a8d69fbf0b78e75b5b6ca4afde7d4ae83d2d6c72bf70fa59065b8f0e82153314566efc399cc4117f666600359aa20b194551'
### cipherinfo: '834a3136313639303434313450970afd743b02558aa4fe91d78c2190f95833f2a8d69fbf0b78e75b5b6ca4afde7d4ae83d2d6c72bf70fa59065b8f0e82153314566efc399cc4117f666600359aa20b194551'


### b recv comm msg from a
### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: '6075a36b7bd25aa09f5ea8ee9cc4a4b827e6033195583cfd0d0964cb93552df6'
### key: '6075a36b7bd25aa09f5ea8ee9cc4a4b827e6033195583cfd0d0964cb93552df6'
### iv: '1fd4343b43da61104013d0f8'
### iv: '1fd4343b43da61104013d0f8'
### aad: '91857ec57f0892bf7c116395f2f56d3c1ab89f1bbbb8af5ee2f682d0a05ee029'
### aad: '91857ec57f0892bf7c116395f2f56d3c1ab89f1bbbb8af5ee2f682d0a05ee029'
### cipherinfo: '834a3136313639303434313450970afd743b02558aa4fe91d78c2190f95833f2a8d69fbf0b78e75b5b6ca4afde7d4ae83d2d6c72bf70fa59065b8f0e82153314566efc399cc4117f666600359aa20b194551'
### cipherinfo: '834a3136313639303434313450970afd743b02558aa4fe91d78c2190f95833f2a8d69fbf0b78e75b5b6ca4afde7d4ae83d2d6c72bf70fa59065b8f0e82153314566efc399cc4117f666600359aa20b194551'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '2ee2050d7aea55247127d0f8'
### iv_xor: '2ee2050d7aea55247127d0f8'
### authtag: '970afd743b02558aa4fe91d78c2190f9'
### authtag: '970afd743b02558aa4fe91d78c2190f9'
### ciphertext: 'f2a8d69fbf0b78e75b5b6ca4afde7d4ae83d2d6c72bf70fa59065b8f0e82153314566efc399cc4117f666600359aa20b194551'
### ciphertext: 'f2a8d69fbf0b78e75b5b6ca4afde7d4ae83d2d6c72bf70fa59065b8f0e82153314566efc399cc4117f666600359aa20b194551'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'


### b to a , plain_b.txt to trans_cipherinfo_b
### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '205b3451e39f74089f6ae38c52a191ebc2a4f924da811010c7032cfe17c3c0a7'
### key: '205b3451e39f74089f6ae38c52a191ebc2a4f924da811010c7032cfe17c3c0a7'
### iv: 'cf06453384babafc01b60d6f'
### iv: 'cf06453384babafc01b60d6f'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'fe307405bd8a8ec830820d6f'
### iv_xor: 'fe307405bd8a8ec830820d6f'
### aad: '91857ec57f0892bf7c116395f2f56d3c1ab89f1bbbb8af5ee2f682d0a05ee029'
### aad: '91857ec57f0892bf7c116395f2f56d3c1ab89f1bbbb8af5ee2f682d0a05ee029'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '508cb2d572f209bc3fdaaf89881641ce0ae521f19a4c5fe23feb110c6756faec73c50dea120765645a30b878f62edf'
### ciphertext: '508cb2d572f209bc3fdaaf89881641ce0ae521f19a4c5fe23feb110c6756faec73c50dea120765645a30b878f62edf'
### authtag: 'a850d3b9fab29153dd6a7c6d48265e84'
### authtag: 'a850d3b9fab29153dd6a7c6d48265e84'
### cipherinfo: '834a3136313639303434313450a850d3b9fab29153dd6a7c6d48265e84582f508cb2d572f209bc3fdaaf89881641ce0ae521f19a4c5fe23feb110c6756faec73c50dea120765645a30b878f62edf'
### cipherinfo: '834a3136313639303434313450a850d3b9fab29153dd6a7c6d48265e84582f508cb2d572f209bc3fdaaf89881641ce0ae521f19a4c5fe23feb110c6756faec73c50dea120765645a30b878f62edf'


### a recv comm msg from b
### a recv comm msg from b


### noise decrypt
### noise decrypt
### key: '205b3451e39f74089f6ae38c52a191ebc2a4f924da811010c7032cfe17c3c0a7'
### key: '205b3451e39f74089f6ae38c52a191ebc2a4f924da811010c7032cfe17c3c0a7'
### iv: 'cf06453384babafc01b60d6f'
### iv: 'cf06453384babafc01b60d6f'
### aad: '91857ec57f0892bf7c116395f2f56d3c1ab89f1bbbb8af5ee2f682d0a05ee029'
### aad: '91857ec57f0892bf7c116395f2f56d3c1ab89f1bbbb8af5ee2f682d0a05ee029'
### cipherinfo: '834a3136313639303434313450a850d3b9fab29153dd6a7c6d48265e84582f508cb2d572f209bc3fdaaf89881641ce0ae521f19a4c5fe23feb110c6756faec73c50dea120765645a30b878f62edf'
### cipherinfo: '834a3136313639303434313450a850d3b9fab29153dd6a7c6d48265e84582f508cb2d572f209bc3fdaaf89881641ce0ae521f19a4c5fe23feb110c6756faec73c50dea120765645a30b878f62edf'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'fe307405bd8a8ec830820d6f'
### iv_xor: 'fe307405bd8a8ec830820d6f'
### authtag: 'a850d3b9fab29153dd6a7c6d48265e84'
### authtag: 'a850d3b9fab29153dd6a7c6d48265e84'
### ciphertext: '508cb2d572f209bc3fdaaf89881641ce0ae521f19a4c5fe23feb110c6756faec73c50dea120765645a30b878f62edf'
### ciphertext: '508cb2d572f209bc3fdaaf89881641ce0ae521f19a4c5fe23feb110c6756faec73c50dea120765645a30b878f62edf'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'NK',
###                               undef,
###                               undef
### -----------end test --------: 'NK',
###                               undef,
###                               undef


### -----------start test --------: 'NK',
###                                 'test_psk',
###                                 0
### -----------start test --------: 'NK',
###                                 'test_psk',
###                                 0

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e", "es"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NKpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","c0592f5d4a982efb3e1cd18665b2400c94f8d56e693c7d21580bd369a43dabfb"),
                              h  => pack("H*","7ad22aead2a63388e37d15002c5d417e6702d15142a6d2d659a65c26b7e47120"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e", "es"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NKpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","c0592f5d4a982efb3e1cd18665b2400c94f8d56e693c7d21580bd369a43dabfb"),
                              h  => pack("H*","7ad22aead2a63388e37d15002c5d417e6702d15142a6d2d659a65c26b7e47120"),
                            },
  who                    => "a",
}

### a send msg to b

### a send msg to b


### write message pattern: 'psk'
### write message pattern: 'psk'


### write message pattern: 'e'
### write message pattern: 'e'

### public compressed: '02c137570e27057d4ac9faddbd0bb206051f6514201152ba9ca6e4a8362e557b89'

### public compressed: '02c137570e27057d4ac9faddbd0bb206051f6514201152ba9ca6e4a8362e557b89'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIAYSqssmw4q/KhLoKDxso2fLt8mgVUYyI6KsEr1e4AAfoAoGCCqGSM49
',
###             'AwEHoUQDQgAEwTdXDicFfUrJ+t29C7IGBR9lFCARUrqcpuSoNi5Ve4ny7rm8k1Ng
',
###             'X6IDMCrC0dRWuuKdhMBubUclqEqWTr1iwg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIAYSqssmw4q/KhLoKDxso2fLt8mgVUYyI6KsEr1e4AAfoAoGCCqGSM49
',
###             'AwEHoUQDQgAEwTdXDicFfUrJ+t29C7IGBR9lFCARUrqcpuSoNi5Ve4ny7rm8k1Ng
',
###             'X6IDMCrC0dRWuuKdhMBubUclqEqWTr1iwg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '42fdde40faff271dfc4be44690487919033fccd9ebeb30725a1797ac558221b0'
### z: '42fdde40faff271dfc4be44690487919033fccd9ebeb30725a1797ac558221b0'


### noise encrypt
### noise encrypt
### key: 'f50b31c9fff20193f9cfb1b46715a08a4bda865f1c8c01b6cd61fb265e20295e'
### key: 'f50b31c9fff20193f9cfb1b46715a08a4bda865f1c8c01b6cd61fb265e20295e'
### iv: '5c490994a242de84312b1e81'
### iv: '5c490994a242de84312b1e81'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '6d7f38a29b72eab0001f1e81'
### iv_xor: '6d7f38a29b72eab0001f1e81'
### aad: '7ad71e1a850317ec371850f15041ad2645551f9a2548bfad5617646ad9e2dc68'
### aad: '7ad71e1a850317ec371850f15041ad2645551f9a2548bfad5617646ad9e2dc68'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: 'a4e30da336545ddc'
### ciphertext: 'a4e30da336545ddc'
### authtag: 'c73d5067a1e19b10ec66355cd20b00d6'
### authtag: 'c73d5067a1e19b10ec66355cd20b00d6'
### cipherinfo: '834a3136313639303434313450c73d5067a1e19b10ec66355cd20b00d648a4e30da336545ddc'
### cipherinfo: '834a3136313639303434313450c73d5067a1e19b10ec66355cd20b00d648a4e30da336545ddc'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAsE3Vw4nBX1KyfrdvQuyBgUfZRQgEVK6nKbkqDYuVXuJWCaDSjE2MTY5MDQ0MTRQxz1QZ6HhmxDsZjVc0gsA1kik4w2jNlRd3A=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAsE3Vw4nBX1KyfrdvQuyBgUfZRQgEVK6nKbkqDYuVXuJWCaDSjE2MTY5MDQ0MTRQxz1QZ6HhmxDsZjVc0gsA1kik4w2jNlRd3A=="),
  );
}
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02c137570e27057d4ac9faddbd0bb206051f6514201152ba9ca6e4a8362e557b89"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","de761dbf3e18e320f6cac50fc7fe0a0483ffa4a380f141f1b1b87c8765243865"),
                                h => pack("H*","8d553dc3c33976859bdde503c1ca415913e12a83c13b6d91347ef669661de0c0"),
                                hasK => 1,
                                k => pack("H*","39b00feb80079d310bc5816e945046490a5ab618e536770fb93a4fe96a2ef4ea"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02c137570e27057d4ac9faddbd0bb206051f6514201152ba9ca6e4a8362e557b89"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","de761dbf3e18e320f6cac50fc7fe0a0483ffa4a380f141f1b1b87c8765243865"),
                                h => pack("H*","8d553dc3c33976859bdde503c1ca415913e12a83c13b6d91347ef669661de0c0"),
                                hasK => 1,
                                k => pack("H*","39b00feb80079d310bc5816e945046490a5ab618e536770fb93a4fe96a2ef4ea"),
                              },
    who                    => "a",
  },
)


### b read message from a
### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e", "es"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NKpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","c0592f5d4a982efb3e1cd18665b2400c94f8d56e693c7d21580bd369a43dabfb"),
                              h  => pack("H*","7ad22aead2a63388e37d15002c5d417e6702d15142a6d2d659a65c26b7e47120"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e", "es"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NKpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","c0592f5d4a982efb3e1cd18665b2400c94f8d56e693c7d21580bd369a43dabfb"),
                              h  => pack("H*","7ad22aead2a63388e37d15002c5d417e6702d15142a6d2d659a65c26b7e47120"),
                            },
  who                    => "b",
}


### b recv msg from a
### b recv msg from a


### read message pattern: 'psk'
### read message pattern: 'psk'


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEwTdXDicFfUrJ+t29C7IGBR9lFCAR
',
###           'UrqcpuSoNi5Ve4ny7rm8k1NgX6IDMCrC0dRWuuKdhMBubUclqEqWTr1iwg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEwTdXDicFfUrJ+t29C7IGBR9lFCAR
',
###           'UrqcpuSoNi5Ve4ny7rm8k1NgX6IDMCrC0dRWuuKdhMBubUclqEqWTr1iwg==
',
###           '-----END PUBLIC KEY-----
'
### z: '42fdde40faff271dfc4be44690487919033fccd9ebeb30725a1797ac558221b0'
### z: '42fdde40faff271dfc4be44690487919033fccd9ebeb30725a1797ac558221b0'

### noise decrypt

### noise decrypt
### key: 'f50b31c9fff20193f9cfb1b46715a08a4bda865f1c8c01b6cd61fb265e20295e'
### key: 'f50b31c9fff20193f9cfb1b46715a08a4bda865f1c8c01b6cd61fb265e20295e'
### iv: '5c490994a242de84312b1e81'
### iv: '5c490994a242de84312b1e81'
### aad: '7ad71e1a850317ec371850f15041ad2645551f9a2548bfad5617646ad9e2dc68'
### aad: '7ad71e1a850317ec371850f15041ad2645551f9a2548bfad5617646ad9e2dc68'
### cipherinfo: '834a3136313639303434313450c73d5067a1e19b10ec66355cd20b00d648a4e30da336545ddc'
### cipherinfo: '834a3136313639303434313450c73d5067a1e19b10ec66355cd20b00d648a4e30da336545ddc'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '6d7f38a29b72eab0001f1e81'
### iv_xor: '6d7f38a29b72eab0001f1e81'
### authtag: 'c73d5067a1e19b10ec66355cd20b00d6'
### authtag: 'c73d5067a1e19b10ec66355cd20b00d6'
### ciphertext: 'a4e30da336545ddc'
### ciphertext: 'a4e30da336545ddc'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","02c137570e27057d4ac9faddbd0bb206051f6514201152ba9ca6e4a8362e557b89"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","de761dbf3e18e320f6cac50fc7fe0a0483ffa4a380f141f1b1b87c8765243865"),
                                h => pack("H*","8d553dc3c33976859bdde503c1ca415913e12a83c13b6d91347ef669661de0c0"),
                                hasK => 1,
                                k => pack("H*","39b00feb80079d310bc5816e945046490a5ab618e536770fb93a4fe96a2ef4ea"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","02c137570e27057d4ac9faddbd0bb206051f6514201152ba9ca6e4a8362e557b89"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","de761dbf3e18e320f6cac50fc7fe0a0483ffa4a380f141f1b1b87c8765243865"),
                                h => pack("H*","8d553dc3c33976859bdde503c1ca415913e12a83c13b6d91347ef669661de0c0"),
                                hasK => 1,
                                k => pack("H*","39b00feb80079d310bc5816e945046490a5ab618e536770fb93a4fe96a2ef4ea"),
                              },
    who                    => "b",
  },
)


### b write_message to a
### b write_message to a
### b send msg to a
### b send msg to a


### write message pattern: 'e'
### write message pattern: 'e'

### public compressed: '03ab3c120803f5237d8588fb16abe78f6aebab9988579eebd2aeb8f6ead416e957'

### public compressed: '03ab3c120803f5237d8588fb16abe78f6aebab9988579eebd2aeb8f6ead416e957'


### write message pattern: 'ee'
### write message pattern: 'ee'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIN1IDfUjzo4MVbiNRMIJ1Ro8nlNkQNdskkpcObVTVOxkoAoGCCqGSM49
',
###             'AwEHoUQDQgAEqzwSCAP1I32FiPsWq+ePauurmYhXnuvSrrj26tQW6VfHnHg+0iBC
',
###             'HASGPX3gqEQgmJ1UHQ/5jQo5g8diMXz1fw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIN1IDfUjzo4MVbiNRMIJ1Ro8nlNkQNdskkpcObVTVOxkoAoGCCqGSM49
',
###             'AwEHoUQDQgAEqzwSCAP1I32FiPsWq+ePauurmYhXnuvSrrj26tQW6VfHnHg+0iBC
',
###             'HASGPX3gqEQgmJ1UHQ/5jQo5g8diMXz1fw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEwTdXDicFfUrJ+t29C7IGBR9lFCAR
',
###           'UrqcpuSoNi5Ve4ny7rm8k1NgX6IDMCrC0dRWuuKdhMBubUclqEqWTr1iwg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEwTdXDicFfUrJ+t29C7IGBR9lFCAR
',
###           'UrqcpuSoNi5Ve4ny7rm8k1NgX6IDMCrC0dRWuuKdhMBubUclqEqWTr1iwg==
',
###           '-----END PUBLIC KEY-----
'
### z: '2633354e319faa7a6468f9ce65f1dad8ea0eeb2850838e624c27c1810f4008bb'
### z: '2633354e319faa7a6468f9ce65f1dad8ea0eeb2850838e624c27c1810f4008bb'


### noise encrypt
### noise encrypt
### key: '38abd0639da7fbb2bfedbf64fed4f6dcf9cc9d9cc7a22737fc37573fb77d6ed7'
### key: '38abd0639da7fbb2bfedbf64fed4f6dcf9cc9d9cc7a22737fc37573fb77d6ed7'
### iv: '8208661b30242ccc7caf44dc'
### iv: '8208661b30242ccc7caf44dc'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'b33e572d091418f84d9b44dc'
### iv_xor: 'b33e572d091418f84d9b44dc'
### aad: 'f72c382222bc587e2d9c904baeb1c8a6a99c9c97aaed78aa85a9e8701c80352c'
### aad: 'f72c382222bc587e2d9c904baeb1c8a6a99c9c97aaed78aa85a9e8701c80352c'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: 'a59941b12c177465'
### ciphertext: 'a59941b12c177465'
### authtag: '58b8090fa8142b1d188bc0370fc95aee'
### authtag: '58b8090fa8142b1d188bc0370fc95aee'
### cipherinfo: '834a313631363930343431345058b8090fa8142b1d188bc0370fc95aee48a59941b12c177465'
### cipherinfo: '834a313631363930343431345058b8090fa8142b1d188bc0370fc95aee48a59941b12c177465'


### b_msg: '82582103ab3c120803f5237d8588fb16abe78f6aebab9988579eebd2aeb8f6ead416e9575826834a313631363930343431345058b8090fa8142b1d188bc0370fc95aee48a59941b12c177465'
### b_msg: '82582103ab3c120803f5237d8588fb16abe78f6aebab9988579eebd2aeb8f6ead416e9575826834a313631363930343431345058b8090fa8142b1d188bc0370fc95aee48a59941b12c177465'
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03ab3c120803f5237d8588fb16abe78f6aebab9988579eebd2aeb8f6ead416e957"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","02c137570e27057d4ac9faddbd0bb206051f6514201152ba9ca6e4a8362e557b89"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","6cabc1a95c019eaeefb7f94be666172e2e3146fbfc296cec554ff73a9a69bb66"),
                                h => pack("H*","51ea91ce72c02339509958ed9a43b048b3eb03a98c93e14c1518d692c63ccf5b"),
                                hasK => 1,
                                k => pack("H*","c8bc3a2dc97e41b58b0ee6b7bac1b018cc0119ab5d5fc0dbbb07aab89f9836ee"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","310e0983c4ea7721f9c5ca14cbf49aad51269cbac9491569d6c9dce0d04b6f90"),
  },
  {
    hasK => 1,
    k => pack("H*","662603fae80a31a8be25a7278594c44bd7eeeb414447d3b833466b21bb18ae45"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03ab3c120803f5237d8588fb16abe78f6aebab9988579eebd2aeb8f6ead416e957"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","02c137570e27057d4ac9faddbd0bb206051f6514201152ba9ca6e4a8362e557b89"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","6cabc1a95c019eaeefb7f94be666172e2e3146fbfc296cec554ff73a9a69bb66"),
                                h => pack("H*","51ea91ce72c02339509958ed9a43b048b3eb03a98c93e14c1518d692c63ccf5b"),
                                hasK => 1,
                                k => pack("H*","c8bc3a2dc97e41b58b0ee6b7bac1b018cc0119ab5d5fc0dbbb07aab89f9836ee"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","310e0983c4ea7721f9c5ca14cbf49aad51269cbac9491569d6c9dce0d04b6f90"),
  },
  {
    hasK => 1,
    k => pack("H*","662603fae80a31a8be25a7278594c44bd7eeeb414447d3b833466b21bb18ae45"),
  },
)

### a read_message from b

### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIAYSqssmw4q/KhLoKDxso2fLt8mgVUYyI6KsEr1e4AAfoAoGCCqGSM49
',
###             'AwEHoUQDQgAEwTdXDicFfUrJ+t29C7IGBR9lFCARUrqcpuSoNi5Ve4ny7rm8k1Ng
',
###             'X6IDMCrC0dRWuuKdhMBubUclqEqWTr1iwg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIAYSqssmw4q/KhLoKDxso2fLt8mgVUYyI6KsEr1e4AAfoAoGCCqGSM49
',
###             'AwEHoUQDQgAEwTdXDicFfUrJ+t29C7IGBR9lFCARUrqcpuSoNi5Ve4ny7rm8k1Ng
',
###             'X6IDMCrC0dRWuuKdhMBubUclqEqWTr1iwg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEqzwSCAP1I32FiPsWq+ePauurmYhX
',
###           'nuvSrrj26tQW6VfHnHg+0iBCHASGPX3gqEQgmJ1UHQ/5jQo5g8diMXz1fw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEqzwSCAP1I32FiPsWq+ePauurmYhX
',
###           'nuvSrrj26tQW6VfHnHg+0iBCHASGPX3gqEQgmJ1UHQ/5jQo5g8diMXz1fw==
',
###           '-----END PUBLIC KEY-----
'
### z: '2633354e319faa7a6468f9ce65f1dad8ea0eeb2850838e624c27c1810f4008bb'
### z: '2633354e319faa7a6468f9ce65f1dad8ea0eeb2850838e624c27c1810f4008bb'

### noise decrypt

### noise decrypt
### key: '38abd0639da7fbb2bfedbf64fed4f6dcf9cc9d9cc7a22737fc37573fb77d6ed7'
### key: '38abd0639da7fbb2bfedbf64fed4f6dcf9cc9d9cc7a22737fc37573fb77d6ed7'
### iv: '8208661b30242ccc7caf44dc'
### iv: '8208661b30242ccc7caf44dc'
### aad: 'f72c382222bc587e2d9c904baeb1c8a6a99c9c97aaed78aa85a9e8701c80352c'
### aad: 'f72c382222bc587e2d9c904baeb1c8a6a99c9c97aaed78aa85a9e8701c80352c'
### cipherinfo: '834a313631363930343431345058b8090fa8142b1d188bc0370fc95aee48a59941b12c177465'
### cipherinfo: '834a313631363930343431345058b8090fa8142b1d188bc0370fc95aee48a59941b12c177465'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'b33e572d091418f84d9b44dc'
### iv_xor: 'b33e572d091418f84d9b44dc'
### authtag: '58b8090fa8142b1d188bc0370fc95aee'
### authtag: '58b8090fa8142b1d188bc0370fc95aee'
### ciphertext: 'a59941b12c177465'
### ciphertext: 'a59941b12c177465'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02c137570e27057d4ac9faddbd0bb206051f6514201152ba9ca6e4a8362e557b89"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","03ab3c120803f5237d8588fb16abe78f6aebab9988579eebd2aeb8f6ead416e957"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","6cabc1a95c019eaeefb7f94be666172e2e3146fbfc296cec554ff73a9a69bb66"),
                                h => pack("H*","51ea91ce72c02339509958ed9a43b048b3eb03a98c93e14c1518d692c63ccf5b"),
                                hasK => 1,
                                k => pack("H*","c8bc3a2dc97e41b58b0ee6b7bac1b018cc0119ab5d5fc0dbbb07aab89f9836ee"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","310e0983c4ea7721f9c5ca14cbf49aad51269cbac9491569d6c9dce0d04b6f90"),
  },
  {
    hasK => 1,
    k => pack("H*","662603fae80a31a8be25a7278594c44bd7eeeb414447d3b833466b21bb18ae45"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02c137570e27057d4ac9faddbd0bb206051f6514201152ba9ca6e4a8362e557b89"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","03ab3c120803f5237d8588fb16abe78f6aebab9988579eebd2aeb8f6ead416e957"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","6cabc1a95c019eaeefb7f94be666172e2e3146fbfc296cec554ff73a9a69bb66"),
                                h => pack("H*","51ea91ce72c02339509958ed9a43b048b3eb03a98c93e14c1518d692c63ccf5b"),
                                hasK => 1,
                                k => pack("H*","c8bc3a2dc97e41b58b0ee6b7bac1b018cc0119ab5d5fc0dbbb07aab89f9836ee"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","310e0983c4ea7721f9c5ca14cbf49aad51269cbac9491569d6c9dce0d04b6f90"),
  },
  {
    hasK => 1,
    k => pack("H*","662603fae80a31a8be25a7278594c44bd7eeeb414447d3b833466b21bb18ae45"),
  },
)


### a send comm msg to b
### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '4f529b87a1dfb2e5eb894b8cdd776d8a5659dc56ed0e13aae99fd165f914a336'
### key: '4f529b87a1dfb2e5eb894b8cdd776d8a5659dc56ed0e13aae99fd165f914a336'
### iv: '6ec398551edaebac852b167c'
### iv: '6ec398551edaebac852b167c'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '5ff5a96327eadf98b41f167c'
### iv_xor: '5ff5a96327eadf98b41f167c'
### aad: '51ea91ce72c02339509958ed9a43b048b3eb03a98c93e14c1518d692c63ccf5b'
### aad: '51ea91ce72c02339509958ed9a43b048b3eb03a98c93e14c1518d692c63ccf5b'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'fc90a020f6a2f3a9df5758d25138799b5084a55e1fe9b205717b0d836e3501309fa7756e29b7816d55ff68405b35fbfc900999'
### ciphertext: 'fc90a020f6a2f3a9df5758d25138799b5084a55e1fe9b205717b0d836e3501309fa7756e29b7816d55ff68405b35fbfc900999'
### authtag: '2866bb1a6c205dadadcb43b67dc73a11'
### authtag: '2866bb1a6c205dadadcb43b67dc73a11'
### cipherinfo: '834a31363136393034343134502866bb1a6c205dadadcb43b67dc73a115833fc90a020f6a2f3a9df5758d25138799b5084a55e1fe9b205717b0d836e3501309fa7756e29b7816d55ff68405b35fbfc900999'
### cipherinfo: '834a31363136393034343134502866bb1a6c205dadadcb43b67dc73a115833fc90a020f6a2f3a9df5758d25138799b5084a55e1fe9b205717b0d836e3501309fa7756e29b7816d55ff68405b35fbfc900999'


### b recv comm msg from a
### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: '4f529b87a1dfb2e5eb894b8cdd776d8a5659dc56ed0e13aae99fd165f914a336'
### key: '4f529b87a1dfb2e5eb894b8cdd776d8a5659dc56ed0e13aae99fd165f914a336'
### iv: '6ec398551edaebac852b167c'
### iv: '6ec398551edaebac852b167c'
### aad: '51ea91ce72c02339509958ed9a43b048b3eb03a98c93e14c1518d692c63ccf5b'
### aad: '51ea91ce72c02339509958ed9a43b048b3eb03a98c93e14c1518d692c63ccf5b'
### cipherinfo: '834a31363136393034343134502866bb1a6c205dadadcb43b67dc73a115833fc90a020f6a2f3a9df5758d25138799b5084a55e1fe9b205717b0d836e3501309fa7756e29b7816d55ff68405b35fbfc900999'
### cipherinfo: '834a31363136393034343134502866bb1a6c205dadadcb43b67dc73a115833fc90a020f6a2f3a9df5758d25138799b5084a55e1fe9b205717b0d836e3501309fa7756e29b7816d55ff68405b35fbfc900999'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '5ff5a96327eadf98b41f167c'
### iv_xor: '5ff5a96327eadf98b41f167c'
### authtag: '2866bb1a6c205dadadcb43b67dc73a11'
### authtag: '2866bb1a6c205dadadcb43b67dc73a11'
### ciphertext: 'fc90a020f6a2f3a9df5758d25138799b5084a55e1fe9b205717b0d836e3501309fa7756e29b7816d55ff68405b35fbfc900999'
### ciphertext: 'fc90a020f6a2f3a9df5758d25138799b5084a55e1fe9b205717b0d836e3501309fa7756e29b7816d55ff68405b35fbfc900999'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'


### b to a , plain_b.txt to trans_cipherinfo_b
### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: 'd0da57ea31b9ebccf242f162746c6148327532411f085946519d1d70a4f5d176'
### key: 'd0da57ea31b9ebccf242f162746c6148327532411f085946519d1d70a4f5d176'
### iv: 'bcfd6b66f488c7ac240f637f'
### iv: 'bcfd6b66f488c7ac240f637f'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '8dcb5a50cdb8f398153b637f'
### iv_xor: '8dcb5a50cdb8f398153b637f'
### aad: '51ea91ce72c02339509958ed9a43b048b3eb03a98c93e14c1518d692c63ccf5b'
### aad: '51ea91ce72c02339509958ed9a43b048b3eb03a98c93e14c1518d692c63ccf5b'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '6b8b86d6241a67c7763482508a371a03321de8f1185580f8dfcdb7404b3cdbee9b47c418d34a67323e255bd0e95b41'
### ciphertext: '6b8b86d6241a67c7763482508a371a03321de8f1185580f8dfcdb7404b3cdbee9b47c418d34a67323e255bd0e95b41'
### authtag: 'fc6c15afb2edd55b00edc189de4087cf'
### authtag: 'fc6c15afb2edd55b00edc189de4087cf'
### cipherinfo: '834a3136313639303434313450fc6c15afb2edd55b00edc189de4087cf582f6b8b86d6241a67c7763482508a371a03321de8f1185580f8dfcdb7404b3cdbee9b47c418d34a67323e255bd0e95b41'
### cipherinfo: '834a3136313639303434313450fc6c15afb2edd55b00edc189de4087cf582f6b8b86d6241a67c7763482508a371a03321de8f1185580f8dfcdb7404b3cdbee9b47c418d34a67323e255bd0e95b41'


### a recv comm msg from b
### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: 'd0da57ea31b9ebccf242f162746c6148327532411f085946519d1d70a4f5d176'
### key: 'd0da57ea31b9ebccf242f162746c6148327532411f085946519d1d70a4f5d176'
### iv: 'bcfd6b66f488c7ac240f637f'
### iv: 'bcfd6b66f488c7ac240f637f'
### aad: '51ea91ce72c02339509958ed9a43b048b3eb03a98c93e14c1518d692c63ccf5b'
### aad: '51ea91ce72c02339509958ed9a43b048b3eb03a98c93e14c1518d692c63ccf5b'
### cipherinfo: '834a3136313639303434313450fc6c15afb2edd55b00edc189de4087cf582f6b8b86d6241a67c7763482508a371a03321de8f1185580f8dfcdb7404b3cdbee9b47c418d34a67323e255bd0e95b41'
### cipherinfo: '834a3136313639303434313450fc6c15afb2edd55b00edc189de4087cf582f6b8b86d6241a67c7763482508a371a03321de8f1185580f8dfcdb7404b3cdbee9b47c418d34a67323e255bd0e95b41'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '8dcb5a50cdb8f398153b637f'
### iv_xor: '8dcb5a50cdb8f398153b637f'
### authtag: 'fc6c15afb2edd55b00edc189de4087cf'
### authtag: 'fc6c15afb2edd55b00edc189de4087cf'
### ciphertext: '6b8b86d6241a67c7763482508a371a03321de8f1185580f8dfcdb7404b3cdbee9b47c418d34a67323e255bd0e95b41'
### ciphertext: '6b8b86d6241a67c7763482508a371a03321de8f1185580f8dfcdb7404b3cdbee9b47c418d34a67323e255bd0e95b41'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'NK',
###                               'test_psk',
###                               0
### -----------end test --------: 'NK',
###                               'test_psk',
###                               0


### -----------start test --------: 'NK',
###                                 'test_psk',
###                                 1
### -----------start test --------: 'NK',
###                                 'test_psk',
###                                 1

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "psk"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NKpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","b1f467d9560de53bb28a37f814f316823a4bdbe1fc7a6a0f9c4ca6885140f19f"),
                              h  => pack("H*","8504be8924028a71ef8f5f8a5f0b4a942a2893d05d47b18f88bb35854f7a43cf"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "psk"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NKpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","b1f467d9560de53bb28a37f814f316823a4bdbe1fc7a6a0f9c4ca6885140f19f"),
                              h  => pack("H*","8504be8924028a71ef8f5f8a5f0b4a942a2893d05d47b18f88bb35854f7a43cf"),
                            },
  who                    => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '02101cf11c3a1a235dba711d278ab89f2d4c8b3a045410d2039aecbdd5552cba62'

### public compressed: '02101cf11c3a1a235dba711d278ab89f2d4c8b3a045410d2039aecbdd5552cba62'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICil3flRvi80AlqLjLRvL2Px2cT1RTHII/Mzvu7J8WProAoGCCqGSM49
',
###             'AwEHoUQDQgAEEBzxHDoaI126cR0nirifLUyLOgRUENIDmuy91VUsumLniiltJwxr
',
###             'G65Hi9cvuA875Em3Xrl/9k3yssVsyHhMig==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICil3flRvi80AlqLjLRvL2Px2cT1RTHII/Mzvu7J8WProAoGCCqGSM49
',
###             'AwEHoUQDQgAEEBzxHDoaI126cR0nirifLUyLOgRUENIDmuy91VUsumLniiltJwxr
',
###             'G65Hi9cvuA875Em3Xrl/9k3yssVsyHhMig==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '344b0aa89f22c47bcf0d392b0c3a86f8a522030a8b1d6fc0419ad75f292ca7b0'
### z: '344b0aa89f22c47bcf0d392b0c3a86f8a522030a8b1d6fc0419ad75f292ca7b0'


### write message pattern: 'psk'
### write message pattern: 'psk'

### noise encrypt

### noise encrypt
### key: 'ab39e695484acf40bc9a83b311796ae4d078600ebaa6464918a3d6c1c92b97b3'
### key: 'ab39e695484acf40bc9a83b311796ae4d078600ebaa6464918a3d6c1c92b97b3'
### iv: '5e51a706d5fd574f9c565a41'
### iv: '5e51a706d5fd574f9c565a41'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '6f679630eccd637bad625a41'
### iv_xor: '6f679630eccd637bad625a41'
### aad: '36f5476e36635bf3a4f89b8dc4e76e00687434c33c1a27761e59ab697e958817'
### aad: '36f5476e36635bf3a4f89b8dc4e76e00687434c33c1a27761e59ab697e958817'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '55207deb4b5fb25e'
### ciphertext: '55207deb4b5fb25e'
### authtag: '7ac69bef24fdaded8d918a53ccb19903'
### authtag: '7ac69bef24fdaded8d918a53ccb19903'
### cipherinfo: '834a31363136393034343134507ac69bef24fdaded8d918a53ccb199034855207deb4b5fb25e'
### cipherinfo: '834a31363136393034343134507ac69bef24fdaded8d918a53ccb199034855207deb4b5fb25e'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAhAc8Rw6GiNdunEdJ4q4ny1MizoEVBDSA5rsvdVVLLpiWCaDSjE2MTY5MDQ0MTRQesab7yT9re2NkYpTzLGZA0hVIH3rS1+yXg=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAhAc8Rw6GiNdunEdJ4q4ny1MizoEVBDSA5rsvdVVLLpiWCaDSjE2MTY5MDQ0MTRQesab7yT9re2NkYpTzLGZA0hVIH3rS1+yXg=="),
  );
}
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02101cf11c3a1a235dba711d278ab89f2d4c8b3a045410d2039aecbdd5552cba62"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "psk"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","064620efced9ad825c81f17ced10b3a3adb9bbc47c93050c06c9b099ff70e4e5"),
                                h => pack("H*","8ed372327ff0c9b6a1fdc05af72f233f8612eb4d37ae57e4f9a72ea3a481cecb"),
                                hasK => 1,
                                k => pack("H*","f23030c76e1e69b58167f702994bee7a382eb0c53150df8853a1193c5b74bea4"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02101cf11c3a1a235dba711d278ab89f2d4c8b3a045410d2039aecbdd5552cba62"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "psk"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","064620efced9ad825c81f17ced10b3a3adb9bbc47c93050c06c9b099ff70e4e5"),
                                h => pack("H*","8ed372327ff0c9b6a1fdc05af72f233f8612eb4d37ae57e4f9a72ea3a481cecb"),
                                hasK => 1,
                                k => pack("H*","f23030c76e1e69b58167f702994bee7a382eb0c53150df8853a1193c5b74bea4"),
                              },
    who                    => "a",
  },
)


### b read message from a
### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "psk"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NKpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","b1f467d9560de53bb28a37f814f316823a4bdbe1fc7a6a0f9c4ca6885140f19f"),
                              h  => pack("H*","8504be8924028a71ef8f5f8a5f0b4a942a2893d05d47b18f88bb35854f7a43cf"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "NK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "psk"], ["e", "ee"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_NKpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","b1f467d9560de53bb28a37f814f316823a4bdbe1fc7a6a0f9c4ca6885140f19f"),
                              h  => pack("H*","8504be8924028a71ef8f5f8a5f0b4a942a2893d05d47b18f88bb35854f7a43cf"),
                            },
  who                    => "b",
}


### b recv msg from a
### b recv msg from a


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEEBzxHDoaI126cR0nirifLUyLOgRU
',
###           'ENIDmuy91VUsumLniiltJwxrG65Hi9cvuA875Em3Xrl/9k3yssVsyHhMig==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEEBzxHDoaI126cR0nirifLUyLOgRU
',
###           'ENIDmuy91VUsumLniiltJwxrG65Hi9cvuA875Em3Xrl/9k3yssVsyHhMig==
',
###           '-----END PUBLIC KEY-----
'
### z: '344b0aa89f22c47bcf0d392b0c3a86f8a522030a8b1d6fc0419ad75f292ca7b0'
### z: '344b0aa89f22c47bcf0d392b0c3a86f8a522030a8b1d6fc0419ad75f292ca7b0'

### read message pattern: 'psk'

### read message pattern: 'psk'

### noise decrypt

### noise decrypt
### key: 'ab39e695484acf40bc9a83b311796ae4d078600ebaa6464918a3d6c1c92b97b3'
### key: 'ab39e695484acf40bc9a83b311796ae4d078600ebaa6464918a3d6c1c92b97b3'
### iv: '5e51a706d5fd574f9c565a41'
### iv: '5e51a706d5fd574f9c565a41'
### aad: '36f5476e36635bf3a4f89b8dc4e76e00687434c33c1a27761e59ab697e958817'
### aad: '36f5476e36635bf3a4f89b8dc4e76e00687434c33c1a27761e59ab697e958817'
### cipherinfo: '834a31363136393034343134507ac69bef24fdaded8d918a53ccb199034855207deb4b5fb25e'
### cipherinfo: '834a31363136393034343134507ac69bef24fdaded8d918a53ccb199034855207deb4b5fb25e'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '6f679630eccd637bad625a41'
### iv_xor: '6f679630eccd637bad625a41'
### authtag: '7ac69bef24fdaded8d918a53ccb19903'
### authtag: '7ac69bef24fdaded8d918a53ccb19903'
### ciphertext: '55207deb4b5fb25e'
### ciphertext: '55207deb4b5fb25e'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "psk"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","02101cf11c3a1a235dba711d278ab89f2d4c8b3a045410d2039aecbdd5552cba62"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","064620efced9ad825c81f17ced10b3a3adb9bbc47c93050c06c9b099ff70e4e5"),
                                h => pack("H*","8ed372327ff0c9b6a1fdc05af72f233f8612eb4d37ae57e4f9a72ea3a481cecb"),
                                hasK => 1,
                                k => pack("H*","f23030c76e1e69b58167f702994bee7a382eb0c53150df8853a1193c5b74bea4"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "psk"], ["e", "ee"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_NKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","02101cf11c3a1a235dba711d278ab89f2d4c8b3a045410d2039aecbdd5552cba62"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","064620efced9ad825c81f17ced10b3a3adb9bbc47c93050c06c9b099ff70e4e5"),
                                h => pack("H*","8ed372327ff0c9b6a1fdc05af72f233f8612eb4d37ae57e4f9a72ea3a481cecb"),
                                hasK => 1,
                                k => pack("H*","f23030c76e1e69b58167f702994bee7a382eb0c53150df8853a1193c5b74bea4"),
                              },
    who                    => "b",
  },
)


### b write_message to a
### b write_message to a
### b send msg to a
### b send msg to a


### write message pattern: 'e'
### write message pattern: 'e'

### public compressed: '02efd82af90e11e1dfb1020e8d1b8160d797d3e1d8f7239ecfda63638990336077'

### public compressed: '02efd82af90e11e1dfb1020e8d1b8160d797d3e1d8f7239ecfda63638990336077'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDhAdLFyMmhCFvuwLcA+MmjmH6s1F98ZRYur5+b1BVxBoAoGCCqGSM49
',
###             'AwEHoUQDQgAE79gq+Q4R4d+xAg6NG4Fg15fT4dj3I57P2mNjiZAzYHcpJY74ik4y
',
###             '+mnNTFeh8OeZ2QUPqqv3S4FnnWUltDM3nA==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDhAdLFyMmhCFvuwLcA+MmjmH6s1F98ZRYur5+b1BVxBoAoGCCqGSM49
',
###             'AwEHoUQDQgAE79gq+Q4R4d+xAg6NG4Fg15fT4dj3I57P2mNjiZAzYHcpJY74ik4y
',
###             '+mnNTFeh8OeZ2QUPqqv3S4FnnWUltDM3nA==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEEBzxHDoaI126cR0nirifLUyLOgRU
',
###           'ENIDmuy91VUsumLniiltJwxrG65Hi9cvuA875Em3Xrl/9k3yssVsyHhMig==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEEBzxHDoaI126cR0nirifLUyLOgRU
',
###           'ENIDmuy91VUsumLniiltJwxrG65Hi9cvuA875Em3Xrl/9k3yssVsyHhMig==
',
###           '-----END PUBLIC KEY-----
'
### z: '2b4a8eccff87da82c3a8aa4672117d5d952ba4e580b4f5fb5576b340e063db6e'
### z: '2b4a8eccff87da82c3a8aa4672117d5d952ba4e580b4f5fb5576b340e063db6e'


### noise encrypt
### noise encrypt
### key: '1394b5d58b59f3ff5483cb1cb30086ab5c4429d18b966e416c83a093d559df8d'
### key: '1394b5d58b59f3ff5483cb1cb30086ab5c4429d18b966e416c83a093d559df8d'
### iv: 'a0bca13da400f84a7768a710'
### iv: 'a0bca13da400f84a7768a710'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '918a900b9d30cc7e465ca710'
### iv_xor: '918a900b9d30cc7e465ca710'
### aad: 'ea19479df30f6962337e3d24d8ccd862971bfb3fa3498ac5272fd45a21935ea5'
### aad: 'ea19479df30f6962337e3d24d8ccd862971bfb3fa3498ac5272fd45a21935ea5'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: 'd7e1af9d4cd623b8'
### ciphertext: 'd7e1af9d4cd623b8'
### authtag: '819f8dce391a3d4943251df796d95132'
### authtag: '819f8dce391a3d4943251df796d95132'
### cipherinfo: '834a3136313639303434313450819f8dce391a3d4943251df796d9513248d7e1af9d4cd623b8'
### cipherinfo: '834a3136313639303434313450819f8dce391a3d4943251df796d9513248d7e1af9d4cd623b8'


### b_msg: '82582102efd82af90e11e1dfb1020e8d1b8160d797d3e1d8f7239ecfda636389903360775826834a3136313639303434313450819f8dce391a3d4943251df796d9513248d7e1af9d4cd623b8'
### b_msg: '82582102efd82af90e11e1dfb1020e8d1b8160d797d3e1d8f7239ecfda636389903360775826834a3136313639303434313450819f8dce391a3d4943251df796d9513248d7e1af9d4cd623b8'
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02efd82af90e11e1dfb1020e8d1b8160d797d3e1d8f7239ecfda63638990336077"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "psk"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","02101cf11c3a1a235dba711d278ab89f2d4c8b3a045410d2039aecbdd5552cba62"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","c1b3f536b9c1c551fa72c450f4d25a6c3fd3badfafe63e3bb84756623644693a"),
                                h => pack("H*","098df1f430499c5ab50e65e0e0388db73dca08484b991dfb5968ac94111f4b80"),
                                hasK => 1,
                                k => pack("H*","044f4a706da8ecb6db3e0971a9185d5f48766f63615c6268c29ffd1e922b9c4e"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","c3ccce4d0127b9a9f8b70a239c67cf88906c0e2634cc145ebd11c7b486a03f88"),
  },
  {
    hasK => 1,
    k => pack("H*","cb84ffcecb59061e639090327e647382fbde99394e8aaa537c9a1c3c8be89d4e"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02efd82af90e11e1dfb1020e8d1b8160d797d3e1d8f7239ecfda63638990336077"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "psk"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","02101cf11c3a1a235dba711d278ab89f2d4c8b3a045410d2039aecbdd5552cba62"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","c1b3f536b9c1c551fa72c450f4d25a6c3fd3badfafe63e3bb84756623644693a"),
                                h => pack("H*","098df1f430499c5ab50e65e0e0388db73dca08484b991dfb5968ac94111f4b80"),
                                hasK => 1,
                                k => pack("H*","044f4a706da8ecb6db3e0971a9185d5f48766f63615c6268c29ffd1e922b9c4e"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","c3ccce4d0127b9a9f8b70a239c67cf88906c0e2634cc145ebd11c7b486a03f88"),
  },
  {
    hasK => 1,
    k => pack("H*","cb84ffcecb59061e639090327e647382fbde99394e8aaa537c9a1c3c8be89d4e"),
  },
)


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICil3flRvi80AlqLjLRvL2Px2cT1RTHII/Mzvu7J8WProAoGCCqGSM49
',
###             'AwEHoUQDQgAEEBzxHDoaI126cR0nirifLUyLOgRUENIDmuy91VUsumLniiltJwxr
',
###             'G65Hi9cvuA875Em3Xrl/9k3yssVsyHhMig==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICil3flRvi80AlqLjLRvL2Px2cT1RTHII/Mzvu7J8WProAoGCCqGSM49
',
###             'AwEHoUQDQgAEEBzxHDoaI126cR0nirifLUyLOgRUENIDmuy91VUsumLniiltJwxr
',
###             'G65Hi9cvuA875Em3Xrl/9k3yssVsyHhMig==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE79gq+Q4R4d+xAg6NG4Fg15fT4dj3
',
###           'I57P2mNjiZAzYHcpJY74ik4y+mnNTFeh8OeZ2QUPqqv3S4FnnWUltDM3nA==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE79gq+Q4R4d+xAg6NG4Fg15fT4dj3
',
###           'I57P2mNjiZAzYHcpJY74ik4y+mnNTFeh8OeZ2QUPqqv3S4FnnWUltDM3nA==
',
###           '-----END PUBLIC KEY-----
'
### z: '2b4a8eccff87da82c3a8aa4672117d5d952ba4e580b4f5fb5576b340e063db6e'
### z: '2b4a8eccff87da82c3a8aa4672117d5d952ba4e580b4f5fb5576b340e063db6e'


### noise decrypt
### noise decrypt
### key: '1394b5d58b59f3ff5483cb1cb30086ab5c4429d18b966e416c83a093d559df8d'
### key: '1394b5d58b59f3ff5483cb1cb30086ab5c4429d18b966e416c83a093d559df8d'
### iv: 'a0bca13da400f84a7768a710'
### iv: 'a0bca13da400f84a7768a710'
### aad: 'ea19479df30f6962337e3d24d8ccd862971bfb3fa3498ac5272fd45a21935ea5'
### aad: 'ea19479df30f6962337e3d24d8ccd862971bfb3fa3498ac5272fd45a21935ea5'
### cipherinfo: '834a3136313639303434313450819f8dce391a3d4943251df796d9513248d7e1af9d4cd623b8'
### cipherinfo: '834a3136313639303434313450819f8dce391a3d4943251df796d9513248d7e1af9d4cd623b8'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '918a900b9d30cc7e465ca710'
### iv_xor: '918a900b9d30cc7e465ca710'
### authtag: '819f8dce391a3d4943251df796d95132'
### authtag: '819f8dce391a3d4943251df796d95132'
### ciphertext: 'd7e1af9d4cd623b8'
### ciphertext: 'd7e1af9d4cd623b8'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02101cf11c3a1a235dba711d278ab89f2d4c8b3a045410d2039aecbdd5552cba62"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "psk"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","02efd82af90e11e1dfb1020e8d1b8160d797d3e1d8f7239ecfda63638990336077"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","c1b3f536b9c1c551fa72c450f4d25a6c3fd3badfafe63e3bb84756623644693a"),
                                h => pack("H*","098df1f430499c5ab50e65e0e0388db73dca08484b991dfb5968ac94111f4b80"),
                                hasK => 1,
                                k => pack("H*","044f4a706da8ecb6db3e0971a9185d5f48766f63615c6268c29ffd1e922b9c4e"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","c3ccce4d0127b9a9f8b70a239c67cf88906c0e2634cc145ebd11c7b486a03f88"),
  },
  {
    hasK => 1,
    k => pack("H*","cb84ffcecb59061e639090327e647382fbde99394e8aaa537c9a1c3c8be89d4e"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02101cf11c3a1a235dba711d278ab89f2d4c8b3a045410d2039aecbdd5552cba62"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "NK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "psk"], ["e", "ee"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_NKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","02efd82af90e11e1dfb1020e8d1b8160d797d3e1d8f7239ecfda63638990336077"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","c1b3f536b9c1c551fa72c450f4d25a6c3fd3badfafe63e3bb84756623644693a"),
                                h => pack("H*","098df1f430499c5ab50e65e0e0388db73dca08484b991dfb5968ac94111f4b80"),
                                hasK => 1,
                                k => pack("H*","044f4a706da8ecb6db3e0971a9185d5f48766f63615c6268c29ffd1e922b9c4e"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","c3ccce4d0127b9a9f8b70a239c67cf88906c0e2634cc145ebd11c7b486a03f88"),
  },
  {
    hasK => 1,
    k => pack("H*","cb84ffcecb59061e639090327e647382fbde99394e8aaa537c9a1c3c8be89d4e"),
  },
)


### a send comm msg to b
### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '649adacca00f9a8528dd71120f2c7c1abbca23b49231417f2af133fbe52fe72c'
### key: '649adacca00f9a8528dd71120f2c7c1abbca23b49231417f2af133fbe52fe72c'
### iv: '2d51a49214a508f8c5a4ad1c'
### iv: '2d51a49214a508f8c5a4ad1c'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '1c6795a42d953cccf490ad1c'
### iv_xor: '1c6795a42d953cccf490ad1c'
### aad: '098df1f430499c5ab50e65e0e0388db73dca08484b991dfb5968ac94111f4b80'
### aad: '098df1f430499c5ab50e65e0e0388db73dca08484b991dfb5968ac94111f4b80'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '8776cfdb4a572df91e56d0ba62eb33e1e8a597593512b1759a3dc0f69297f3cbe2286ed1f9b0f0bb9acd30a47b29a26631f99c'
### ciphertext: '8776cfdb4a572df91e56d0ba62eb33e1e8a597593512b1759a3dc0f69297f3cbe2286ed1f9b0f0bb9acd30a47b29a26631f99c'
### authtag: 'fa7f924b02239a7c8f9ba4e25901fd2b'
### authtag: 'fa7f924b02239a7c8f9ba4e25901fd2b'
### cipherinfo: '834a3136313639303434313450fa7f924b02239a7c8f9ba4e25901fd2b58338776cfdb4a572df91e56d0ba62eb33e1e8a597593512b1759a3dc0f69297f3cbe2286ed1f9b0f0bb9acd30a47b29a26631f99c'
### cipherinfo: '834a3136313639303434313450fa7f924b02239a7c8f9ba4e25901fd2b58338776cfdb4a572df91e56d0ba62eb33e1e8a597593512b1759a3dc0f69297f3cbe2286ed1f9b0f0bb9acd30a47b29a26631f99c'


### b recv comm msg from a
### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: '649adacca00f9a8528dd71120f2c7c1abbca23b49231417f2af133fbe52fe72c'
### key: '649adacca00f9a8528dd71120f2c7c1abbca23b49231417f2af133fbe52fe72c'
### iv: '2d51a49214a508f8c5a4ad1c'
### iv: '2d51a49214a508f8c5a4ad1c'
### aad: '098df1f430499c5ab50e65e0e0388db73dca08484b991dfb5968ac94111f4b80'
### aad: '098df1f430499c5ab50e65e0e0388db73dca08484b991dfb5968ac94111f4b80'
### cipherinfo: '834a3136313639303434313450fa7f924b02239a7c8f9ba4e25901fd2b58338776cfdb4a572df91e56d0ba62eb33e1e8a597593512b1759a3dc0f69297f3cbe2286ed1f9b0f0bb9acd30a47b29a26631f99c'
### cipherinfo: '834a3136313639303434313450fa7f924b02239a7c8f9ba4e25901fd2b58338776cfdb4a572df91e56d0ba62eb33e1e8a597593512b1759a3dc0f69297f3cbe2286ed1f9b0f0bb9acd30a47b29a26631f99c'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '1c6795a42d953cccf490ad1c'
### iv_xor: '1c6795a42d953cccf490ad1c'
### authtag: 'fa7f924b02239a7c8f9ba4e25901fd2b'
### authtag: 'fa7f924b02239a7c8f9ba4e25901fd2b'
### ciphertext: '8776cfdb4a572df91e56d0ba62eb33e1e8a597593512b1759a3dc0f69297f3cbe2286ed1f9b0f0bb9acd30a47b29a26631f99c'
### ciphertext: '8776cfdb4a572df91e56d0ba62eb33e1e8a597593512b1759a3dc0f69297f3cbe2286ed1f9b0f0bb9acd30a47b29a26631f99c'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'


### b to a , plain_b.txt to trans_cipherinfo_b
### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: 'e6eda0d9cf460668fa22afbee7c7e3c5e798165c069931320ff9b8d7a63b9d5b'
### key: 'e6eda0d9cf460668fa22afbee7c7e3c5e798165c069931320ff9b8d7a63b9d5b'
### iv: '0f6a2a46f9cf234017c03422'
### iv: '0f6a2a46f9cf234017c03422'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '3e5c1b70c0ff177426f43422'
### iv_xor: '3e5c1b70c0ff177426f43422'
### aad: '098df1f430499c5ab50e65e0e0388db73dca08484b991dfb5968ac94111f4b80'
### aad: '098df1f430499c5ab50e65e0e0388db73dca08484b991dfb5968ac94111f4b80'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '5ddfebf18c351713d742ae719a6dcf8e6674e9c231ca2c6df5665cc970757941c83ba213e408bb7504cd5860bcd8ba'
### ciphertext: '5ddfebf18c351713d742ae719a6dcf8e6674e9c231ca2c6df5665cc970757941c83ba213e408bb7504cd5860bcd8ba'
### authtag: '16694d44b3eaf392f0e002d1f4e40339'
### authtag: '16694d44b3eaf392f0e002d1f4e40339'
### cipherinfo: '834a313631363930343431345016694d44b3eaf392f0e002d1f4e40339582f5ddfebf18c351713d742ae719a6dcf8e6674e9c231ca2c6df5665cc970757941c83ba213e408bb7504cd5860bcd8ba'
### cipherinfo: '834a313631363930343431345016694d44b3eaf392f0e002d1f4e40339582f5ddfebf18c351713d742ae719a6dcf8e6674e9c231ca2c6df5665cc970757941c83ba213e408bb7504cd5860bcd8ba'


### a recv comm msg from b
### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: 'e6eda0d9cf460668fa22afbee7c7e3c5e798165c069931320ff9b8d7a63b9d5b'
### key: 'e6eda0d9cf460668fa22afbee7c7e3c5e798165c069931320ff9b8d7a63b9d5b'
### iv: '0f6a2a46f9cf234017c03422'
### iv: '0f6a2a46f9cf234017c03422'
### aad: '098df1f430499c5ab50e65e0e0388db73dca08484b991dfb5968ac94111f4b80'
### aad: '098df1f430499c5ab50e65e0e0388db73dca08484b991dfb5968ac94111f4b80'
### cipherinfo: '834a313631363930343431345016694d44b3eaf392f0e002d1f4e40339582f5ddfebf18c351713d742ae719a6dcf8e6674e9c231ca2c6df5665cc970757941c83ba213e408bb7504cd5860bcd8ba'
### cipherinfo: '834a313631363930343431345016694d44b3eaf392f0e002d1f4e40339582f5ddfebf18c351713d742ae719a6dcf8e6674e9c231ca2c6df5665cc970757941c83ba213e408bb7504cd5860bcd8ba'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '3e5c1b70c0ff177426f43422'
### iv_xor: '3e5c1b70c0ff177426f43422'
### authtag: '16694d44b3eaf392f0e002d1f4e40339'
### authtag: '16694d44b3eaf392f0e002d1f4e40339'
### ciphertext: '5ddfebf18c351713d742ae719a6dcf8e6674e9c231ca2c6df5665cc970757941c83ba213e408bb7504cd5860bcd8ba'
### ciphertext: '5ddfebf18c351713d742ae719a6dcf8e6674e9c231ca2c6df5665cc970757941c83ba213e408bb7504cd5860bcd8ba'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'NK',
###                               'test_psk',
###                               1
### -----------end test --------: 'NK',
###                               'test_psk',
###                               1


### -----------start test --------: 'KK',
###                                 undef,
###                                 undef
### -----------start test --------: 'KK',
###                                 undef,
###                                 undef

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "KK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "ss"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_KK_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => "Noise_KK_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","a0dde3d544fe77548e0931d67a5db8c142ed54fabf5b1f02a4cb7ceaa1d114cc"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "KK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "ss"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_KK_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => "Noise_KK_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","a0dde3d544fe77548e0931d67a5db8c142ed54fabf5b1f02a4cb7ceaa1d114cc"),
                            },
  who                    => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '035f551bb45d011b77c693431e4d1eaf5445cf586c47eaa18ab2f7a5df10dc576f'

### public compressed: '035f551bb45d011b77c693431e4d1eaf5445cf586c47eaa18ab2f7a5df10dc576f'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOW7nzp8uV1oYRPGc81g0ekavjMbhgokvswIapileYXWoAoGCCqGSM49
',
###             'AwEHoUQDQgAEX1UbtF0BG3fGk0MeTR6vVEXPWGxH6qGKsvel3xDcV28IYluLKFFo
',
###             '/p8LzeiYMIS8esFf2tsfBSMU9wohQh+K1Q==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOW7nzp8uV1oYRPGc81g0ekavjMbhgokvswIapileYXWoAoGCCqGSM49
',
###             'AwEHoUQDQgAEX1UbtF0BG3fGk0MeTR6vVEXPWGxH6qGKsvel3xDcV28IYluLKFFo
',
###             '/p8LzeiYMIS8esFf2tsfBSMU9wohQh+K1Q==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '0376ed83e9eb1fa7c3f61cfbdaaa46dadeabaed032f3189ead8155b46febc411'
### z: '0376ed83e9eb1fa7c3f61cfbdaaa46dadeabaed032f3189ead8155b46febc411'


### write message pattern: 'ss'
### write message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### noise encrypt

### noise encrypt
### key: '73220216413f95f1d50af704e416d5d1914ca6b16fc4b547c12c121a9735eb58'
### key: '73220216413f95f1d50af704e416d5d1914ca6b16fc4b547c12c121a9735eb58'
### iv: '336918f55212065e5206ea30'
### iv: '336918f55212065e5206ea30'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '025f29c36b22326a6332ea30'
### iv_xor: '025f29c36b22326a6332ea30'
### aad: '83079465ff54a39e549374002d66fed4f4e9c5b2dec9eaf3f8f9de501631cc86'
### aad: '83079465ff54a39e549374002d66fed4f4e9c5b2dec9eaf3f8f9de501631cc86'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '4b266dd1870cc215'
### ciphertext: '4b266dd1870cc215'
### authtag: '85b4b26dfc3deac5a75517322a9c37d8'
### authtag: '85b4b26dfc3deac5a75517322a9c37d8'
### cipherinfo: '834a313631363930343431345085b4b26dfc3deac5a75517322a9c37d8484b266dd1870cc215'
### cipherinfo: '834a313631363930343431345085b4b26dfc3deac5a75517322a9c37d8484b266dd1870cc215'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA19VG7RdARt3xpNDHk0er1RFz1hsR+qhirL3pd8Q3FdvWCaDSjE2MTY5MDQ0MTRQhbSybfw96sWnVRcyKpw32EhLJm3RhwzCFQ=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA19VG7RdARt3xpNDHk0er1RFz1hsR+qhirL3pd8Q3FdvWCaDSjE2MTY5MDQ0MTRQhbSybfw96sWnVRcyKpw32EhLJm3RhwzCFQ=="),
  );
}
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","035f551bb45d011b77c693431e4d1eaf5445cf586c47eaa18ab2f7a5df10dc576f"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_KK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","9286a4a585bd9727fbe938fbbdcc601f04e15101e85c9bad1bfef559e6a9d69c"),
                                h => pack("H*","ad13ed6c58451b7ded4226290fbd28259edf0ea8805ea6b9976d7b592303a604"),
                                hasK => 1,
                                k => pack("H*","25932b86b856eeba09b006a764627dd24d31b87a30f38dbaf2d030abd3052a69"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","035f551bb45d011b77c693431e4d1eaf5445cf586c47eaa18ab2f7a5df10dc576f"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_KK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","9286a4a585bd9727fbe938fbbdcc601f04e15101e85c9bad1bfef559e6a9d69c"),
                                h => pack("H*","ad13ed6c58451b7ded4226290fbd28259edf0ea8805ea6b9976d7b592303a604"),
                                hasK => 1,
                                k => pack("H*","25932b86b856eeba09b006a764627dd24d31b87a30f38dbaf2d030abd3052a69"),
                              },
    who                    => "a",
  },
)


### b read message from a
### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "KK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "ss"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_KK_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => "Noise_KK_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","a0dde3d544fe77548e0931d67a5db8c142ed54fabf5b1f02a4cb7ceaa1d114cc"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "KK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "ss"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_KK_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => "Noise_KK_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","a0dde3d544fe77548e0931d67a5db8c142ed54fabf5b1f02a4cb7ceaa1d114cc"),
                            },
  who                    => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEX1UbtF0BG3fGk0MeTR6vVEXPWGxH
',
###           '6qGKsvel3xDcV28IYluLKFFo/p8LzeiYMIS8esFf2tsfBSMU9wohQh+K1Q==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEX1UbtF0BG3fGk0MeTR6vVEXPWGxH
',
###           '6qGKsvel3xDcV28IYluLKFFo/p8LzeiYMIS8esFf2tsfBSMU9wohQh+K1Q==
',
###           '-----END PUBLIC KEY-----
'
### z: '0376ed83e9eb1fa7c3f61cfbdaaa46dadeabaed032f3189ead8155b46febc411'
### z: '0376ed83e9eb1fa7c3f61cfbdaaa46dadeabaed032f3189ead8155b46febc411'


### read message pattern: 'ss'
### read message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### noise decrypt

### noise decrypt
### key: '73220216413f95f1d50af704e416d5d1914ca6b16fc4b547c12c121a9735eb58'
### key: '73220216413f95f1d50af704e416d5d1914ca6b16fc4b547c12c121a9735eb58'
### iv: '336918f55212065e5206ea30'
### iv: '336918f55212065e5206ea30'
### aad: '83079465ff54a39e549374002d66fed4f4e9c5b2dec9eaf3f8f9de501631cc86'
### aad: '83079465ff54a39e549374002d66fed4f4e9c5b2dec9eaf3f8f9de501631cc86'
### cipherinfo: '834a313631363930343431345085b4b26dfc3deac5a75517322a9c37d8484b266dd1870cc215'
### cipherinfo: '834a313631363930343431345085b4b26dfc3deac5a75517322a9c37d8484b266dd1870cc215'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '025f29c36b22326a6332ea30'
### iv_xor: '025f29c36b22326a6332ea30'
### authtag: '85b4b26dfc3deac5a75517322a9c37d8'
### authtag: '85b4b26dfc3deac5a75517322a9c37d8'
### ciphertext: '4b266dd1870cc215'
### ciphertext: '4b266dd1870cc215'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_KK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","035f551bb45d011b77c693431e4d1eaf5445cf586c47eaa18ab2f7a5df10dc576f"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","9286a4a585bd9727fbe938fbbdcc601f04e15101e85c9bad1bfef559e6a9d69c"),
                                h => pack("H*","ad13ed6c58451b7ded4226290fbd28259edf0ea8805ea6b9976d7b592303a604"),
                                hasK => 1,
                                k => pack("H*","25932b86b856eeba09b006a764627dd24d31b87a30f38dbaf2d030abd3052a69"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_KK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","035f551bb45d011b77c693431e4d1eaf5445cf586c47eaa18ab2f7a5df10dc576f"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","9286a4a585bd9727fbe938fbbdcc601f04e15101e85c9bad1bfef559e6a9d69c"),
                                h => pack("H*","ad13ed6c58451b7ded4226290fbd28259edf0ea8805ea6b9976d7b592303a604"),
                                hasK => 1,
                                k => pack("H*","25932b86b856eeba09b006a764627dd24d31b87a30f38dbaf2d030abd3052a69"),
                              },
    who                    => "b",
  },
)


### b write_message to a
### b write_message to a
### b send msg to a
### b send msg to a


### write message pattern: 'e'
### write message pattern: 'e'

### public compressed: '038412f7276d9b49da5256984daf591eb14715ce49806f5b88708321a7d1ad99cc'

### public compressed: '038412f7276d9b49da5256984daf591eb14715ce49806f5b88708321a7d1ad99cc'


### write message pattern: 'ee'
### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMafC4zADq1rwBK9wDj1GeUEhf5QoiW/zenkSzSsZQhtoAoGCCqGSM49
',
###             'AwEHoUQDQgAEhBL3J22bSdpSVphNr1kesUcVzkmAb1uIcIMhp9GtmcwOU/2u/++R
',
###             'DfK896QX8cNGscbdJ1bKo9xcGUzYWu2+vQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMafC4zADq1rwBK9wDj1GeUEhf5QoiW/zenkSzSsZQhtoAoGCCqGSM49
',
###             'AwEHoUQDQgAEhBL3J22bSdpSVphNr1kesUcVzkmAb1uIcIMhp9GtmcwOU/2u/++R
',
###             'DfK896QX8cNGscbdJ1bKo9xcGUzYWu2+vQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEX1UbtF0BG3fGk0MeTR6vVEXPWGxH
',
###           '6qGKsvel3xDcV28IYluLKFFo/p8LzeiYMIS8esFf2tsfBSMU9wohQh+K1Q==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEX1UbtF0BG3fGk0MeTR6vVEXPWGxH
',
###           '6qGKsvel3xDcV28IYluLKFFo/p8LzeiYMIS8esFf2tsfBSMU9wohQh+K1Q==
',
###           '-----END PUBLIC KEY-----
'
### z: 'fe726ddad3de3d92d4276cd3751ae764e68d7c7bb4a8dabc3ded3beb3687945d'
### z: 'fe726ddad3de3d92d4276cd3751ae764e68d7c7bb4a8dabc3ded3beb3687945d'


### write message pattern: 'se'
### write message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMafC4zADq1rwBK9wDj1GeUEhf5QoiW/zenkSzSsZQhtoAoGCCqGSM49
',
###             'AwEHoUQDQgAEhBL3J22bSdpSVphNr1kesUcVzkmAb1uIcIMhp9GtmcwOU/2u/++R
',
###             'DfK896QX8cNGscbdJ1bKo9xcGUzYWu2+vQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMafC4zADq1rwBK9wDj1GeUEhf5QoiW/zenkSzSsZQhtoAoGCCqGSM49
',
###             'AwEHoUQDQgAEhBL3J22bSdpSVphNr1kesUcVzkmAb1uIcIMhp9GtmcwOU/2u/++R
',
###             'DfK896QX8cNGscbdJ1bKo9xcGUzYWu2+vQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '3d227ae51dff07093560b9e0e056a6117b83cafb1b2ce4d8fe5b923cc34a9917'
### z: '3d227ae51dff07093560b9e0e056a6117b83cafb1b2ce4d8fe5b923cc34a9917'


### noise encrypt
### noise encrypt
### key: '6f3368b711a3f649808b0035d80a2e81594bd3a34a6d02714fc858607176f3eb'
### key: '6f3368b711a3f649808b0035d80a2e81594bd3a34a6d02714fc858607176f3eb'
### iv: 'c6b26a25aa877681a53cd1a2'
### iv: 'c6b26a25aa877681a53cd1a2'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'f7845b1393b742b59408d1a2'
### iv_xor: 'f7845b1393b742b59408d1a2'
### aad: '266b5ce7d72f6fa57dbb3f2a121b3af4856a8ff30799a1baec4bb6d206c1486c'
### aad: '266b5ce7d72f6fa57dbb3f2a121b3af4856a8ff30799a1baec4bb6d206c1486c'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '184762416a34c664'
### ciphertext: '184762416a34c664'
### authtag: '3b706e65d9ee505bbde6b71d48eaec67'
### authtag: '3b706e65d9ee505bbde6b71d48eaec67'
### cipherinfo: '834a31363136393034343134503b706e65d9ee505bbde6b71d48eaec6748184762416a34c664'
### cipherinfo: '834a31363136393034343134503b706e65d9ee505bbde6b71d48eaec6748184762416a34c664'


### b_msg: '825821038412f7276d9b49da5256984daf591eb14715ce49806f5b88708321a7d1ad99cc5826834a31363136393034343134503b706e65d9ee505bbde6b71d48eaec6748184762416a34c664'
### b_msg: '825821038412f7276d9b49da5256984daf591eb14715ce49806f5b88708321a7d1ad99cc5826834a31363136393034343134503b706e65d9ee505bbde6b71d48eaec6748184762416a34c664'
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","038412f7276d9b49da5256984daf591eb14715ce49806f5b88708321a7d1ad99cc"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_KK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","035f551bb45d011b77c693431e4d1eaf5445cf586c47eaa18ab2f7a5df10dc576f"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","c94753e6959d99c40aaa85e143b7a99264743ab553b884ae931d28b214ad9932"),
                                h => pack("H*","5b81c648f48070835546683d5116b62be5aff181337c92511227fa502693cf9e"),
                                hasK => 1,
                                k => pack("H*","86c0054eb125953f7318dbfcbc79670f0c4291f488c3309da7b3f884bc54dd28"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","893773fdd6e40a9a1c39e58631c67b4720a962de23ac6653829cda6ec7c45bab"),
  },
  {
    hasK => 1,
    k => pack("H*","94732b7cd1ea2f15671a85ed5cc533a377fb16612a26b23748d4a7e3cd4b0cc2"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","038412f7276d9b49da5256984daf591eb14715ce49806f5b88708321a7d1ad99cc"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_KK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","035f551bb45d011b77c693431e4d1eaf5445cf586c47eaa18ab2f7a5df10dc576f"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","c94753e6959d99c40aaa85e143b7a99264743ab553b884ae931d28b214ad9932"),
                                h => pack("H*","5b81c648f48070835546683d5116b62be5aff181337c92511227fa502693cf9e"),
                                hasK => 1,
                                k => pack("H*","86c0054eb125953f7318dbfcbc79670f0c4291f488c3309da7b3f884bc54dd28"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","893773fdd6e40a9a1c39e58631c67b4720a962de23ac6653829cda6ec7c45bab"),
  },
  {
    hasK => 1,
    k => pack("H*","94732b7cd1ea2f15671a85ed5cc533a377fb16612a26b23748d4a7e3cd4b0cc2"),
  },
)


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOW7nzp8uV1oYRPGc81g0ekavjMbhgokvswIapileYXWoAoGCCqGSM49
',
###             'AwEHoUQDQgAEX1UbtF0BG3fGk0MeTR6vVEXPWGxH6qGKsvel3xDcV28IYluLKFFo
',
###             '/p8LzeiYMIS8esFf2tsfBSMU9wohQh+K1Q==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOW7nzp8uV1oYRPGc81g0ekavjMbhgokvswIapileYXWoAoGCCqGSM49
',
###             'AwEHoUQDQgAEX1UbtF0BG3fGk0MeTR6vVEXPWGxH6qGKsvel3xDcV28IYluLKFFo
',
###             '/p8LzeiYMIS8esFf2tsfBSMU9wohQh+K1Q==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhBL3J22bSdpSVphNr1kesUcVzkmA
',
###           'b1uIcIMhp9GtmcwOU/2u/++RDfK896QX8cNGscbdJ1bKo9xcGUzYWu2+vQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhBL3J22bSdpSVphNr1kesUcVzkmA
',
###           'b1uIcIMhp9GtmcwOU/2u/++RDfK896QX8cNGscbdJ1bKo9xcGUzYWu2+vQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'fe726ddad3de3d92d4276cd3751ae764e68d7c7bb4a8dabc3ded3beb3687945d'
### z: 'fe726ddad3de3d92d4276cd3751ae764e68d7c7bb4a8dabc3ded3beb3687945d'


### read message pattern: 'se'
### read message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhBL3J22bSdpSVphNr1kesUcVzkmA
',
###           'b1uIcIMhp9GtmcwOU/2u/++RDfK896QX8cNGscbdJ1bKo9xcGUzYWu2+vQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhBL3J22bSdpSVphNr1kesUcVzkmA
',
###           'b1uIcIMhp9GtmcwOU/2u/++RDfK896QX8cNGscbdJ1bKo9xcGUzYWu2+vQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '3d227ae51dff07093560b9e0e056a6117b83cafb1b2ce4d8fe5b923cc34a9917'
### z: '3d227ae51dff07093560b9e0e056a6117b83cafb1b2ce4d8fe5b923cc34a9917'


### noise decrypt
### noise decrypt
### key: '6f3368b711a3f649808b0035d80a2e81594bd3a34a6d02714fc858607176f3eb'
### key: '6f3368b711a3f649808b0035d80a2e81594bd3a34a6d02714fc858607176f3eb'
### iv: 'c6b26a25aa877681a53cd1a2'
### iv: 'c6b26a25aa877681a53cd1a2'
### aad: '266b5ce7d72f6fa57dbb3f2a121b3af4856a8ff30799a1baec4bb6d206c1486c'
### aad: '266b5ce7d72f6fa57dbb3f2a121b3af4856a8ff30799a1baec4bb6d206c1486c'
### cipherinfo: '834a31363136393034343134503b706e65d9ee505bbde6b71d48eaec6748184762416a34c664'
### cipherinfo: '834a31363136393034343134503b706e65d9ee505bbde6b71d48eaec6748184762416a34c664'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'f7845b1393b742b59408d1a2'
### iv_xor: 'f7845b1393b742b59408d1a2'
### authtag: '3b706e65d9ee505bbde6b71d48eaec67'
### authtag: '3b706e65d9ee505bbde6b71d48eaec67'
### ciphertext: '184762416a34c664'
### ciphertext: '184762416a34c664'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","035f551bb45d011b77c693431e4d1eaf5445cf586c47eaa18ab2f7a5df10dc576f"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_KK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","038412f7276d9b49da5256984daf591eb14715ce49806f5b88708321a7d1ad99cc"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","c94753e6959d99c40aaa85e143b7a99264743ab553b884ae931d28b214ad9932"),
                                h => pack("H*","5b81c648f48070835546683d5116b62be5aff181337c92511227fa502693cf9e"),
                                hasK => 1,
                                k => pack("H*","86c0054eb125953f7318dbfcbc79670f0c4291f488c3309da7b3f884bc54dd28"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","893773fdd6e40a9a1c39e58631c67b4720a962de23ac6653829cda6ec7c45bab"),
  },
  {
    hasK => 1,
    k => pack("H*","94732b7cd1ea2f15671a85ed5cc533a377fb16612a26b23748d4a7e3cd4b0cc2"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","035f551bb45d011b77c693431e4d1eaf5445cf586c47eaa18ab2f7a5df10dc576f"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_KK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","038412f7276d9b49da5256984daf591eb14715ce49806f5b88708321a7d1ad99cc"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","c94753e6959d99c40aaa85e143b7a99264743ab553b884ae931d28b214ad9932"),
                                h => pack("H*","5b81c648f48070835546683d5116b62be5aff181337c92511227fa502693cf9e"),
                                hasK => 1,
                                k => pack("H*","86c0054eb125953f7318dbfcbc79670f0c4291f488c3309da7b3f884bc54dd28"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","893773fdd6e40a9a1c39e58631c67b4720a962de23ac6653829cda6ec7c45bab"),
  },
  {
    hasK => 1,
    k => pack("H*","94732b7cd1ea2f15671a85ed5cc533a377fb16612a26b23748d4a7e3cd4b0cc2"),
  },
)


### a send comm msg to b
### a send comm msg to b

### noise encrypt

### noise encrypt
### key: 'ca2715e8dbbfa6df14740e84393044c7b2dac809779efe0610c9cf1812b9cf78'
### key: 'ca2715e8dbbfa6df14740e84393044c7b2dac809779efe0610c9cf1812b9cf78'
### iv: '114e5fa97e0317fbeb2683cb'
### iv: '114e5fa97e0317fbeb2683cb'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '20786e9f473323cfda1283cb'
### iv_xor: '20786e9f473323cfda1283cb'
### aad: '5b81c648f48070835546683d5116b62be5aff181337c92511227fa502693cf9e'
### aad: '5b81c648f48070835546683d5116b62be5aff181337c92511227fa502693cf9e'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '93fc2dc3040846b452ed3437e369884d349dd64e821e84dc1ed352a2d74845a728f5716e02a9c1517e7b8a1a2d133bfd5b4511'
### ciphertext: '93fc2dc3040846b452ed3437e369884d349dd64e821e84dc1ed352a2d74845a728f5716e02a9c1517e7b8a1a2d133bfd5b4511'
### authtag: '8312c27b0559968abc51c37d75c18ddf'
### authtag: '8312c27b0559968abc51c37d75c18ddf'
### cipherinfo: '834a31363136393034343134508312c27b0559968abc51c37d75c18ddf583393fc2dc3040846b452ed3437e369884d349dd64e821e84dc1ed352a2d74845a728f5716e02a9c1517e7b8a1a2d133bfd5b4511'
### cipherinfo: '834a31363136393034343134508312c27b0559968abc51c37d75c18ddf583393fc2dc3040846b452ed3437e369884d349dd64e821e84dc1ed352a2d74845a728f5716e02a9c1517e7b8a1a2d133bfd5b4511'


### b recv comm msg from a
### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: 'ca2715e8dbbfa6df14740e84393044c7b2dac809779efe0610c9cf1812b9cf78'
### key: 'ca2715e8dbbfa6df14740e84393044c7b2dac809779efe0610c9cf1812b9cf78'
### iv: '114e5fa97e0317fbeb2683cb'
### iv: '114e5fa97e0317fbeb2683cb'
### aad: '5b81c648f48070835546683d5116b62be5aff181337c92511227fa502693cf9e'
### aad: '5b81c648f48070835546683d5116b62be5aff181337c92511227fa502693cf9e'
### cipherinfo: '834a31363136393034343134508312c27b0559968abc51c37d75c18ddf583393fc2dc3040846b452ed3437e369884d349dd64e821e84dc1ed352a2d74845a728f5716e02a9c1517e7b8a1a2d133bfd5b4511'
### cipherinfo: '834a31363136393034343134508312c27b0559968abc51c37d75c18ddf583393fc2dc3040846b452ed3437e369884d349dd64e821e84dc1ed352a2d74845a728f5716e02a9c1517e7b8a1a2d133bfd5b4511'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '20786e9f473323cfda1283cb'
### iv_xor: '20786e9f473323cfda1283cb'
### authtag: '8312c27b0559968abc51c37d75c18ddf'
### authtag: '8312c27b0559968abc51c37d75c18ddf'
### ciphertext: '93fc2dc3040846b452ed3437e369884d349dd64e821e84dc1ed352a2d74845a728f5716e02a9c1517e7b8a1a2d133bfd5b4511'
### ciphertext: '93fc2dc3040846b452ed3437e369884d349dd64e821e84dc1ed352a2d74845a728f5716e02a9c1517e7b8a1a2d133bfd5b4511'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '7e1f52cd93af658ef9575eee42e3e4128d926efa06dc5d3b571125145f3f264a'
### key: '7e1f52cd93af658ef9575eee42e3e4128d926efa06dc5d3b571125145f3f264a'
### iv: '54f8072d585369ef39008a51'
### iv: '54f8072d585369ef39008a51'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '65ce361b61635ddb08348a51'
### iv_xor: '65ce361b61635ddb08348a51'
### aad: '5b81c648f48070835546683d5116b62be5aff181337c92511227fa502693cf9e'
### aad: '5b81c648f48070835546683d5116b62be5aff181337c92511227fa502693cf9e'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '81b4a683ed6e5efdb9e8afb7144578cca066be8823981d9696b32b72d5c20a26e8915920eb5af818eea5a7d752af4c'
### ciphertext: '81b4a683ed6e5efdb9e8afb7144578cca066be8823981d9696b32b72d5c20a26e8915920eb5af818eea5a7d752af4c'
### authtag: '52fc66e04f9b9cb2d667294c5b36979b'
### authtag: '52fc66e04f9b9cb2d667294c5b36979b'
### cipherinfo: '834a313631363930343431345052fc66e04f9b9cb2d667294c5b36979b582f81b4a683ed6e5efdb9e8afb7144578cca066be8823981d9696b32b72d5c20a26e8915920eb5af818eea5a7d752af4c'
### cipherinfo: '834a313631363930343431345052fc66e04f9b9cb2d667294c5b36979b582f81b4a683ed6e5efdb9e8afb7144578cca066be8823981d9696b32b72d5c20a26e8915920eb5af818eea5a7d752af4c'


### a recv comm msg from b
### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '7e1f52cd93af658ef9575eee42e3e4128d926efa06dc5d3b571125145f3f264a'
### key: '7e1f52cd93af658ef9575eee42e3e4128d926efa06dc5d3b571125145f3f264a'
### iv: '54f8072d585369ef39008a51'
### iv: '54f8072d585369ef39008a51'
### aad: '5b81c648f48070835546683d5116b62be5aff181337c92511227fa502693cf9e'
### aad: '5b81c648f48070835546683d5116b62be5aff181337c92511227fa502693cf9e'
### cipherinfo: '834a313631363930343431345052fc66e04f9b9cb2d667294c5b36979b582f81b4a683ed6e5efdb9e8afb7144578cca066be8823981d9696b32b72d5c20a26e8915920eb5af818eea5a7d752af4c'
### cipherinfo: '834a313631363930343431345052fc66e04f9b9cb2d667294c5b36979b582f81b4a683ed6e5efdb9e8afb7144578cca066be8823981d9696b32b72d5c20a26e8915920eb5af818eea5a7d752af4c'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '65ce361b61635ddb08348a51'
### iv_xor: '65ce361b61635ddb08348a51'
### authtag: '52fc66e04f9b9cb2d667294c5b36979b'
### authtag: '52fc66e04f9b9cb2d667294c5b36979b'
### ciphertext: '81b4a683ed6e5efdb9e8afb7144578cca066be8823981d9696b32b72d5c20a26e8915920eb5af818eea5a7d752af4c'
### ciphertext: '81b4a683ed6e5efdb9e8afb7144578cca066be8823981d9696b32b72d5c20a26e8915920eb5af818eea5a7d752af4c'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'KK',
###                               undef,
###                               undef
### -----------end test --------: 'KK',
###                               undef,
###                               undef


### -----------start test --------: 'KK',
###                                 'test_psk',
###                                 0
### -----------start test --------: 'KK',
###                                 'test_psk',
###                                 0

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "KK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_KKpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","5c3d78538a39678206fbb5f55bb695ea6cf89db633e3157b5b50105b99a0371b"),
                              h  => pack("H*","e2e31029fa82bd995a9e4948a1232f818484de714092e6a463b099476b4737b1"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "KK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_KKpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","5c3d78538a39678206fbb5f55bb695ea6cf89db633e3157b5b50105b99a0371b"),
                              h  => pack("H*","e2e31029fa82bd995a9e4948a1232f818484de714092e6a463b099476b4737b1"),
                            },
  who                    => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'psk'

### write message pattern: 'psk'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '030304759ab379336ae1ee6622c04a92656e241407a08ded765331fb30aa13fb65'

### public compressed: '030304759ab379336ae1ee6622c04a92656e241407a08ded765331fb30aa13fb65'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICg0LAfr7oQ0jEVYuIBFWH+U1M/XqXnUAn4iN9GAIizSoAoGCCqGSM49
',
###             'AwEHoUQDQgAEAwR1mrN5M2rh7mYiwEqSZW4kFAegje12UzH7MKoT+2WysmqrPvK8
',
###             'upXy5hdQPcz/MfhalHyesnWbHTGQFhYBuw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICg0LAfr7oQ0jEVYuIBFWH+U1M/XqXnUAn4iN9GAIizSoAoGCCqGSM49
',
###             'AwEHoUQDQgAEAwR1mrN5M2rh7mYiwEqSZW4kFAegje12UzH7MKoT+2WysmqrPvK8
',
###             'upXy5hdQPcz/MfhalHyesnWbHTGQFhYBuw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'f6362704c0cad7286e98c4dcea1553d5fcf0cdd5f23414ae660e6b3a652fb28b'
### z: 'f6362704c0cad7286e98c4dcea1553d5fcf0cdd5f23414ae660e6b3a652fb28b'


### write message pattern: 'ss'
### write message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### noise encrypt
### noise encrypt
### key: '5e2f432e1d91f0658b6a547339bb8c2fd56ed9611068aecdd8341bea196038df'
### key: '5e2f432e1d91f0658b6a547339bb8c2fd56ed9611068aecdd8341bea196038df'
### iv: '5d8c43da183cc7bf2c8f3d4e'
### iv: '5d8c43da183cc7bf2c8f3d4e'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '6cba72ec210cf38b1dbb3d4e'
### iv_xor: '6cba72ec210cf38b1dbb3d4e'
### aad: 'c4df6afac37f74e1ceaa0890da6bc34f2013709b7f9094f39ca45384cfab4847'
### aad: 'c4df6afac37f74e1ceaa0890da6bc34f2013709b7f9094f39ca45384cfab4847'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: 'fb765cfc4a2d62f7'
### ciphertext: 'fb765cfc4a2d62f7'
### authtag: 'bfbcb1f3a36f9645dba6a9d56f2c5694'
### authtag: 'bfbcb1f3a36f9645dba6a9d56f2c5694'
### cipherinfo: '834a3136313639303434313450bfbcb1f3a36f9645dba6a9d56f2c569448fb765cfc4a2d62f7'
### cipherinfo: '834a3136313639303434313450bfbcb1f3a36f9645dba6a9d56f2c569448fb765cfc4a2d62f7'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAwMEdZqzeTNq4e5mIsBKkmVuJBQHoI3tdlMx+zCqE/tlWCaDSjE2MTY5MDQ0MTRQv7yx86NvlkXbpqnVbyxWlEj7dlz8Si1i9w=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAwMEdZqzeTNq4e5mIsBKkmVuJBQHoI3tdlMx+zCqE/tlWCaDSjE2MTY5MDQ0MTRQv7yx86NvlkXbpqnVbyxWlEj7dlz8Si1i9w=="),
  );
}
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","030304759ab379336ae1ee6622c04a92656e241407a08ded765331fb30aa13fb65"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_KKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","52f8f973766f063f12799f1d80c818bdaa11454736f09c037c92285783a2c424"),
                                h => pack("H*","dc5e07ea245cd98ebe4fcd647ad5f212930095a858096bb010aa518a20512fe3"),
                                hasK => 1,
                                k => pack("H*","4bf19925a835ab72850a5b309fc11df35537db7d7428d69494f520384e6a1acb"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","030304759ab379336ae1ee6622c04a92656e241407a08ded765331fb30aa13fb65"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_KKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","52f8f973766f063f12799f1d80c818bdaa11454736f09c037c92285783a2c424"),
                                h => pack("H*","dc5e07ea245cd98ebe4fcd647ad5f212930095a858096bb010aa518a20512fe3"),
                                hasK => 1,
                                k => pack("H*","4bf19925a835ab72850a5b309fc11df35537db7d7428d69494f520384e6a1acb"),
                              },
    who                    => "a",
  },
)


### b read message from a
### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "KK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_KKpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","5c3d78538a39678206fbb5f55bb695ea6cf89db633e3157b5b50105b99a0371b"),
                              h  => pack("H*","e2e31029fa82bd995a9e4948a1232f818484de714092e6a463b099476b4737b1"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "KK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_KKpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","5c3d78538a39678206fbb5f55bb695ea6cf89db633e3157b5b50105b99a0371b"),
                              h  => pack("H*","e2e31029fa82bd995a9e4948a1232f818484de714092e6a463b099476b4737b1"),
                            },
  who                    => "b",
}


### b recv msg from a
### b recv msg from a


### read message pattern: 'psk'
### read message pattern: 'psk'


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEAwR1mrN5M2rh7mYiwEqSZW4kFAeg
',
###           'je12UzH7MKoT+2WysmqrPvK8upXy5hdQPcz/MfhalHyesnWbHTGQFhYBuw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEAwR1mrN5M2rh7mYiwEqSZW4kFAeg
',
###           'je12UzH7MKoT+2WysmqrPvK8upXy5hdQPcz/MfhalHyesnWbHTGQFhYBuw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'f6362704c0cad7286e98c4dcea1553d5fcf0cdd5f23414ae660e6b3a652fb28b'
### z: 'f6362704c0cad7286e98c4dcea1553d5fcf0cdd5f23414ae660e6b3a652fb28b'


### read message pattern: 'ss'
### read message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### noise decrypt

### noise decrypt
### key: '5e2f432e1d91f0658b6a547339bb8c2fd56ed9611068aecdd8341bea196038df'
### key: '5e2f432e1d91f0658b6a547339bb8c2fd56ed9611068aecdd8341bea196038df'
### iv: '5d8c43da183cc7bf2c8f3d4e'
### iv: '5d8c43da183cc7bf2c8f3d4e'
### aad: 'c4df6afac37f74e1ceaa0890da6bc34f2013709b7f9094f39ca45384cfab4847'
### aad: 'c4df6afac37f74e1ceaa0890da6bc34f2013709b7f9094f39ca45384cfab4847'
### cipherinfo: '834a3136313639303434313450bfbcb1f3a36f9645dba6a9d56f2c569448fb765cfc4a2d62f7'
### cipherinfo: '834a3136313639303434313450bfbcb1f3a36f9645dba6a9d56f2c569448fb765cfc4a2d62f7'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '6cba72ec210cf38b1dbb3d4e'
### iv_xor: '6cba72ec210cf38b1dbb3d4e'
### authtag: 'bfbcb1f3a36f9645dba6a9d56f2c5694'
### authtag: 'bfbcb1f3a36f9645dba6a9d56f2c5694'
### ciphertext: 'fb765cfc4a2d62f7'
### ciphertext: 'fb765cfc4a2d62f7'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_KKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","030304759ab379336ae1ee6622c04a92656e241407a08ded765331fb30aa13fb65"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","52f8f973766f063f12799f1d80c818bdaa11454736f09c037c92285783a2c424"),
                                h => pack("H*","dc5e07ea245cd98ebe4fcd647ad5f212930095a858096bb010aa518a20512fe3"),
                                hasK => 1,
                                k => pack("H*","4bf19925a835ab72850a5b309fc11df35537db7d7428d69494f520384e6a1acb"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_KKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","030304759ab379336ae1ee6622c04a92656e241407a08ded765331fb30aa13fb65"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","52f8f973766f063f12799f1d80c818bdaa11454736f09c037c92285783a2c424"),
                                h => pack("H*","dc5e07ea245cd98ebe4fcd647ad5f212930095a858096bb010aa518a20512fe3"),
                                hasK => 1,
                                k => pack("H*","4bf19925a835ab72850a5b309fc11df35537db7d7428d69494f520384e6a1acb"),
                              },
    who                    => "b",
  },
)


### b write_message to a
### b write_message to a
### b send msg to a
### b send msg to a


### write message pattern: 'e'
### write message pattern: 'e'


### public compressed: '02b660e9899875248fb247099df8f6b53e6bc894788bde7f7d7a699d842fc641d4'
### public compressed: '02b660e9899875248fb247099df8f6b53e6bc894788bde7f7d7a699d842fc641d4'

### write message pattern: 'ee'

### write message pattern: 'ee'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOoOqO3K9JjXwVOAen7HD6TC30xc2CaRHtx6o6R5Stm+oAoGCCqGSM49
',
###             'AwEHoUQDQgAEtmDpiZh1JI+yRwmd+Pa1PmvIlHiL3n99emmdhC/GQdRoYQRmEyji
',
###             'nFTMXM4I7oGAC7xQpNRgHwbednDYDT7jvg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOoOqO3K9JjXwVOAen7HD6TC30xc2CaRHtx6o6R5Stm+oAoGCCqGSM49
',
###             'AwEHoUQDQgAEtmDpiZh1JI+yRwmd+Pa1PmvIlHiL3n99emmdhC/GQdRoYQRmEyji
',
###             'nFTMXM4I7oGAC7xQpNRgHwbednDYDT7jvg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEAwR1mrN5M2rh7mYiwEqSZW4kFAeg
',
###           'je12UzH7MKoT+2WysmqrPvK8upXy5hdQPcz/MfhalHyesnWbHTGQFhYBuw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEAwR1mrN5M2rh7mYiwEqSZW4kFAeg
',
###           'je12UzH7MKoT+2WysmqrPvK8upXy5hdQPcz/MfhalHyesnWbHTGQFhYBuw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'dfe459bf37a2f7bc6303f445cbcb847267d5d1453abd8a715fb3da88da6425c9'
### z: 'dfe459bf37a2f7bc6303f445cbcb847267d5d1453abd8a715fb3da88da6425c9'


### write message pattern: 'se'
### write message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOoOqO3K9JjXwVOAen7HD6TC30xc2CaRHtx6o6R5Stm+oAoGCCqGSM49
',
###             'AwEHoUQDQgAEtmDpiZh1JI+yRwmd+Pa1PmvIlHiL3n99emmdhC/GQdRoYQRmEyji
',
###             'nFTMXM4I7oGAC7xQpNRgHwbednDYDT7jvg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOoOqO3K9JjXwVOAen7HD6TC30xc2CaRHtx6o6R5Stm+oAoGCCqGSM49
',
###             'AwEHoUQDQgAEtmDpiZh1JI+yRwmd+Pa1PmvIlHiL3n99emmdhC/GQdRoYQRmEyji
',
###             'nFTMXM4I7oGAC7xQpNRgHwbednDYDT7jvg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '2c8b9b425c7e5ca0c999765873761b2b33094dfd44547f22a2669cb6cdf79d86'
### z: '2c8b9b425c7e5ca0c999765873761b2b33094dfd44547f22a2669cb6cdf79d86'

### noise encrypt

### noise encrypt
### key: '8f4ea857054baf13dc6f8e741479b74eafc747af148fe6cff196118aefce3ab7'
### key: '8f4ea857054baf13dc6f8e741479b74eafc747af148fe6cff196118aefce3ab7'
### iv: '7ba8b14b75dd9eaeb4f188eb'
### iv: '7ba8b14b75dd9eaeb4f188eb'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '4a9e807d4cedaa9a85c588eb'
### iv_xor: '4a9e807d4cedaa9a85c588eb'
### aad: '8db2c1fbbb673c7a8911cfe5bccdb2cbaf50474c02993662044c5100f79c8f5b'
### aad: '8db2c1fbbb673c7a8911cfe5bccdb2cbaf50474c02993662044c5100f79c8f5b'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '7bf524e452c6343c'
### ciphertext: '7bf524e452c6343c'
### authtag: 'b88ff86819d52386238bcfd98befc458'
### authtag: 'b88ff86819d52386238bcfd98befc458'
### cipherinfo: '834a3136313639303434313450b88ff86819d52386238bcfd98befc458487bf524e452c6343c'
### cipherinfo: '834a3136313639303434313450b88ff86819d52386238bcfd98befc458487bf524e452c6343c'


### b_msg: '82582102b660e9899875248fb247099df8f6b53e6bc894788bde7f7d7a699d842fc641d45826834a3136313639303434313450b88ff86819d52386238bcfd98befc458487bf524e452c6343c'
### b_msg: '82582102b660e9899875248fb247099df8f6b53e6bc894788bde7f7d7a699d842fc641d45826834a3136313639303434313450b88ff86819d52386238bcfd98befc458487bf524e452c6343c'
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02b660e9899875248fb247099df8f6b53e6bc894788bde7f7d7a699d842fc641d4"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_KKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","030304759ab379336ae1ee6622c04a92656e241407a08ded765331fb30aa13fb65"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","1b8e5bcb746234fe8b3ec0dd7787c348a2295dbc80dd0ccb418852ebe9fcb924"),
                                h => pack("H*","bdafb61a7f4427954a5577638879ecb46699914ac9680312b6cd1344a904de0e"),
                                hasK => 1,
                                k => pack("H*","434d0dfad2e240294297ecced00e8e3ba2debc0edd2ffdf25a3f1dfeef7c8739"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","47d9c8021f814b0ccc8386e9a0e365dee2f7d1124d5c36e75282191ca3bb8c6b"),
  },
  {
    hasK => 1,
    k => pack("H*","4dcf22b8fdb86da40bf1825fe5f7d1abc21256e6557550fbe8630731a08a7b07"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02b660e9899875248fb247099df8f6b53e6bc894788bde7f7d7a699d842fc641d4"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_KKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","030304759ab379336ae1ee6622c04a92656e241407a08ded765331fb30aa13fb65"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","1b8e5bcb746234fe8b3ec0dd7787c348a2295dbc80dd0ccb418852ebe9fcb924"),
                                h => pack("H*","bdafb61a7f4427954a5577638879ecb46699914ac9680312b6cd1344a904de0e"),
                                hasK => 1,
                                k => pack("H*","434d0dfad2e240294297ecced00e8e3ba2debc0edd2ffdf25a3f1dfeef7c8739"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","47d9c8021f814b0ccc8386e9a0e365dee2f7d1124d5c36e75282191ca3bb8c6b"),
  },
  {
    hasK => 1,
    k => pack("H*","4dcf22b8fdb86da40bf1825fe5f7d1abc21256e6557550fbe8630731a08a7b07"),
  },
)


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICg0LAfr7oQ0jEVYuIBFWH+U1M/XqXnUAn4iN9GAIizSoAoGCCqGSM49
',
###             'AwEHoUQDQgAEAwR1mrN5M2rh7mYiwEqSZW4kFAegje12UzH7MKoT+2WysmqrPvK8
',
###             'upXy5hdQPcz/MfhalHyesnWbHTGQFhYBuw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICg0LAfr7oQ0jEVYuIBFWH+U1M/XqXnUAn4iN9GAIizSoAoGCCqGSM49
',
###             'AwEHoUQDQgAEAwR1mrN5M2rh7mYiwEqSZW4kFAegje12UzH7MKoT+2WysmqrPvK8
',
###             'upXy5hdQPcz/MfhalHyesnWbHTGQFhYBuw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEtmDpiZh1JI+yRwmd+Pa1PmvIlHiL
',
###           '3n99emmdhC/GQdRoYQRmEyjinFTMXM4I7oGAC7xQpNRgHwbednDYDT7jvg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEtmDpiZh1JI+yRwmd+Pa1PmvIlHiL
',
###           '3n99emmdhC/GQdRoYQRmEyjinFTMXM4I7oGAC7xQpNRgHwbednDYDT7jvg==
',
###           '-----END PUBLIC KEY-----
'
### z: 'dfe459bf37a2f7bc6303f445cbcb847267d5d1453abd8a715fb3da88da6425c9'
### z: 'dfe459bf37a2f7bc6303f445cbcb847267d5d1453abd8a715fb3da88da6425c9'


### read message pattern: 'se'
### read message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEtmDpiZh1JI+yRwmd+Pa1PmvIlHiL
',
###           '3n99emmdhC/GQdRoYQRmEyjinFTMXM4I7oGAC7xQpNRgHwbednDYDT7jvg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEtmDpiZh1JI+yRwmd+Pa1PmvIlHiL
',
###           '3n99emmdhC/GQdRoYQRmEyjinFTMXM4I7oGAC7xQpNRgHwbednDYDT7jvg==
',
###           '-----END PUBLIC KEY-----
'
### z: '2c8b9b425c7e5ca0c999765873761b2b33094dfd44547f22a2669cb6cdf79d86'
### z: '2c8b9b425c7e5ca0c999765873761b2b33094dfd44547f22a2669cb6cdf79d86'


### noise decrypt
### noise decrypt
### key: '8f4ea857054baf13dc6f8e741479b74eafc747af148fe6cff196118aefce3ab7'
### key: '8f4ea857054baf13dc6f8e741479b74eafc747af148fe6cff196118aefce3ab7'
### iv: '7ba8b14b75dd9eaeb4f188eb'
### iv: '7ba8b14b75dd9eaeb4f188eb'
### aad: '8db2c1fbbb673c7a8911cfe5bccdb2cbaf50474c02993662044c5100f79c8f5b'
### aad: '8db2c1fbbb673c7a8911cfe5bccdb2cbaf50474c02993662044c5100f79c8f5b'
### cipherinfo: '834a3136313639303434313450b88ff86819d52386238bcfd98befc458487bf524e452c6343c'
### cipherinfo: '834a3136313639303434313450b88ff86819d52386238bcfd98befc458487bf524e452c6343c'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '4a9e807d4cedaa9a85c588eb'
### iv_xor: '4a9e807d4cedaa9a85c588eb'
### authtag: 'b88ff86819d52386238bcfd98befc458'
### authtag: 'b88ff86819d52386238bcfd98befc458'
### ciphertext: '7bf524e452c6343c'
### ciphertext: '7bf524e452c6343c'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","030304759ab379336ae1ee6622c04a92656e241407a08ded765331fb30aa13fb65"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_KKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","02b660e9899875248fb247099df8f6b53e6bc894788bde7f7d7a699d842fc641d4"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","1b8e5bcb746234fe8b3ec0dd7787c348a2295dbc80dd0ccb418852ebe9fcb924"),
                                h => pack("H*","bdafb61a7f4427954a5577638879ecb46699914ac9680312b6cd1344a904de0e"),
                                hasK => 1,
                                k => pack("H*","434d0dfad2e240294297ecced00e8e3ba2debc0edd2ffdf25a3f1dfeef7c8739"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","47d9c8021f814b0ccc8386e9a0e365dee2f7d1124d5c36e75282191ca3bb8c6b"),
  },
  {
    hasK => 1,
    k => pack("H*","4dcf22b8fdb86da40bf1825fe5f7d1abc21256e6557550fbe8630731a08a7b07"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","030304759ab379336ae1ee6622c04a92656e241407a08ded765331fb30aa13fb65"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "ss"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_KKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","02b660e9899875248fb247099df8f6b53e6bc894788bde7f7d7a699d842fc641d4"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","1b8e5bcb746234fe8b3ec0dd7787c348a2295dbc80dd0ccb418852ebe9fcb924"),
                                h => pack("H*","bdafb61a7f4427954a5577638879ecb46699914ac9680312b6cd1344a904de0e"),
                                hasK => 1,
                                k => pack("H*","434d0dfad2e240294297ecced00e8e3ba2debc0edd2ffdf25a3f1dfeef7c8739"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","47d9c8021f814b0ccc8386e9a0e365dee2f7d1124d5c36e75282191ca3bb8c6b"),
  },
  {
    hasK => 1,
    k => pack("H*","4dcf22b8fdb86da40bf1825fe5f7d1abc21256e6557550fbe8630731a08a7b07"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: 'e0beb55a172a6725b140f7adff8f6f7fdce0c5e795fe8f99f453dcf1720427bd'
### key: 'e0beb55a172a6725b140f7adff8f6f7fdce0c5e795fe8f99f453dcf1720427bd'
### iv: 'c024b853c6bf7a50c9a2c3eb'
### iv: 'c024b853c6bf7a50c9a2c3eb'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'f1128965ff8f4e64f896c3eb'
### iv_xor: 'f1128965ff8f4e64f896c3eb'
### aad: 'bdafb61a7f4427954a5577638879ecb46699914ac9680312b6cd1344a904de0e'
### aad: 'bdafb61a7f4427954a5577638879ecb46699914ac9680312b6cd1344a904de0e'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '42f9c4ed120d85a51f65e2ffa2a6fc23542286e558feb34e383b2ef1b6b9cbd11256c984465121298f9a1a0a30e1fea820fafd'
### ciphertext: '42f9c4ed120d85a51f65e2ffa2a6fc23542286e558feb34e383b2ef1b6b9cbd11256c984465121298f9a1a0a30e1fea820fafd'
### authtag: '18feadb71e169831a73ecfa24ddb2310'
### authtag: '18feadb71e169831a73ecfa24ddb2310'
### cipherinfo: '834a313631363930343431345018feadb71e169831a73ecfa24ddb2310583342f9c4ed120d85a51f65e2ffa2a6fc23542286e558feb34e383b2ef1b6b9cbd11256c984465121298f9a1a0a30e1fea820fafd'
### cipherinfo: '834a313631363930343431345018feadb71e169831a73ecfa24ddb2310583342f9c4ed120d85a51f65e2ffa2a6fc23542286e558feb34e383b2ef1b6b9cbd11256c984465121298f9a1a0a30e1fea820fafd'


### b recv comm msg from a
### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: 'e0beb55a172a6725b140f7adff8f6f7fdce0c5e795fe8f99f453dcf1720427bd'
### key: 'e0beb55a172a6725b140f7adff8f6f7fdce0c5e795fe8f99f453dcf1720427bd'
### iv: 'c024b853c6bf7a50c9a2c3eb'
### iv: 'c024b853c6bf7a50c9a2c3eb'
### aad: 'bdafb61a7f4427954a5577638879ecb46699914ac9680312b6cd1344a904de0e'
### aad: 'bdafb61a7f4427954a5577638879ecb46699914ac9680312b6cd1344a904de0e'
### cipherinfo: '834a313631363930343431345018feadb71e169831a73ecfa24ddb2310583342f9c4ed120d85a51f65e2ffa2a6fc23542286e558feb34e383b2ef1b6b9cbd11256c984465121298f9a1a0a30e1fea820fafd'
### cipherinfo: '834a313631363930343431345018feadb71e169831a73ecfa24ddb2310583342f9c4ed120d85a51f65e2ffa2a6fc23542286e558feb34e383b2ef1b6b9cbd11256c984465121298f9a1a0a30e1fea820fafd'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'f1128965ff8f4e64f896c3eb'
### iv_xor: 'f1128965ff8f4e64f896c3eb'
### authtag: '18feadb71e169831a73ecfa24ddb2310'
### authtag: '18feadb71e169831a73ecfa24ddb2310'
### ciphertext: '42f9c4ed120d85a51f65e2ffa2a6fc23542286e558feb34e383b2ef1b6b9cbd11256c984465121298f9a1a0a30e1fea820fafd'
### ciphertext: '42f9c4ed120d85a51f65e2ffa2a6fc23542286e558feb34e383b2ef1b6b9cbd11256c984465121298f9a1a0a30e1fea820fafd'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'


### b to a , plain_b.txt to trans_cipherinfo_b
### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: 'f63f2ab7c28f444a76cf4f24b6df3a458c925c8a2dbd0fe2e5a8d60067410f0a'
### key: 'f63f2ab7c28f444a76cf4f24b6df3a458c925c8a2dbd0fe2e5a8d60067410f0a'
### iv: '30c077a5273369ce90608d5d'
### iv: '30c077a5273369ce90608d5d'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '01f646931e035dfaa1548d5d'
### iv_xor: '01f646931e035dfaa1548d5d'
### aad: 'bdafb61a7f4427954a5577638879ecb46699914ac9680312b6cd1344a904de0e'
### aad: 'bdafb61a7f4427954a5577638879ecb46699914ac9680312b6cd1344a904de0e'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'ef25c3be69b3ee2de3596793ce68de872201abd29bacd7c1fa3b7e175eb31f8b59ae36570436d4408f39e884040da8'
### ciphertext: 'ef25c3be69b3ee2de3596793ce68de872201abd29bacd7c1fa3b7e175eb31f8b59ae36570436d4408f39e884040da8'
### authtag: 'ecd0376e4ec596afa58524eec56c158c'
### authtag: 'ecd0376e4ec596afa58524eec56c158c'
### cipherinfo: '834a3136313639303434313450ecd0376e4ec596afa58524eec56c158c582fef25c3be69b3ee2de3596793ce68de872201abd29bacd7c1fa3b7e175eb31f8b59ae36570436d4408f39e884040da8'
### cipherinfo: '834a3136313639303434313450ecd0376e4ec596afa58524eec56c158c582fef25c3be69b3ee2de3596793ce68de872201abd29bacd7c1fa3b7e175eb31f8b59ae36570436d4408f39e884040da8'


### a recv comm msg from b
### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: 'f63f2ab7c28f444a76cf4f24b6df3a458c925c8a2dbd0fe2e5a8d60067410f0a'
### key: 'f63f2ab7c28f444a76cf4f24b6df3a458c925c8a2dbd0fe2e5a8d60067410f0a'
### iv: '30c077a5273369ce90608d5d'
### iv: '30c077a5273369ce90608d5d'
### aad: 'bdafb61a7f4427954a5577638879ecb46699914ac9680312b6cd1344a904de0e'
### aad: 'bdafb61a7f4427954a5577638879ecb46699914ac9680312b6cd1344a904de0e'
### cipherinfo: '834a3136313639303434313450ecd0376e4ec596afa58524eec56c158c582fef25c3be69b3ee2de3596793ce68de872201abd29bacd7c1fa3b7e175eb31f8b59ae36570436d4408f39e884040da8'
### cipherinfo: '834a3136313639303434313450ecd0376e4ec596afa58524eec56c158c582fef25c3be69b3ee2de3596793ce68de872201abd29bacd7c1fa3b7e175eb31f8b59ae36570436d4408f39e884040da8'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '01f646931e035dfaa1548d5d'
### iv_xor: '01f646931e035dfaa1548d5d'
### authtag: 'ecd0376e4ec596afa58524eec56c158c'
### authtag: 'ecd0376e4ec596afa58524eec56c158c'
### ciphertext: 'ef25c3be69b3ee2de3596793ce68de872201abd29bacd7c1fa3b7e175eb31f8b59ae36570436d4408f39e884040da8'
### ciphertext: 'ef25c3be69b3ee2de3596793ce68de872201abd29bacd7c1fa3b7e175eb31f8b59ae36570436d4408f39e884040da8'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'KK',
###                               'test_psk',
###                               0
### -----------end test --------: 'KK',
###                               'test_psk',
###                               0


### -----------start test --------: 'KK',
###                                 'test_psk',
###                                 1
### -----------start test --------: 'KK',
###                                 'test_psk',
###                                 1

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "KK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_KKpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","775e5a71d142a55fd073e16ac4b66bdb0d5ebeccc6ca2c46b292522866ff1744"),
                              h  => pack("H*","41a14466d3a4f5f098063039dc37102551d6c53e481025d75e0f99e62af4a1e3"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "KK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_KKpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","775e5a71d142a55fd073e16ac4b66bdb0d5ebeccc6ca2c46b292522866ff1744"),
                              h  => pack("H*","41a14466d3a4f5f098063039dc37102551d6c53e481025d75e0f99e62af4a1e3"),
                            },
  who                    => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '03615ba4478131677a7e37ef077823ad5b4ed538bedd1f6fc67726220dab8e15f4'

### public compressed: '03615ba4478131677a7e37ef077823ad5b4ed538bedd1f6fc67726220dab8e15f4'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICCqaoNLkd47JTAuIIwJwaZ2azRCxvvyaTYjYVPKrU0RoAoGCCqGSM49
',
###             'AwEHoUQDQgAEYVukR4ExZ3p+N+8HeCOtW07VOL7dH2/GdyYiDauOFfSDGS6XsvWF
',
###             'jzfbHyrCbTLpx658xWp7T9S3mEa+pHv4+Q==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICCqaoNLkd47JTAuIIwJwaZ2azRCxvvyaTYjYVPKrU0RoAoGCCqGSM49
',
###             'AwEHoUQDQgAEYVukR4ExZ3p+N+8HeCOtW07VOL7dH2/GdyYiDauOFfSDGS6XsvWF
',
###             'jzfbHyrCbTLpx658xWp7T9S3mEa+pHv4+Q==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '3e34e1254d10ff0013f96ff50dc0c0e173442e760c74296d72c0a378d71760d6'
### z: '3e34e1254d10ff0013f96ff50dc0c0e173442e760c74296d72c0a378d71760d6'


### write message pattern: 'ss'
### write message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### write message pattern: 'psk'
### write message pattern: 'psk'

### noise encrypt

### noise encrypt
### key: 'd0cff3093288bcc87aca23fcfbab50dd58c59d9c14accc6c2dfefbc61647c8fc'
### key: 'd0cff3093288bcc87aca23fcfbab50dd58c59d9c14accc6c2dfefbc61647c8fc'
### iv: 'd4c8cb3104d081c4e04c7b15'
### iv: 'd4c8cb3104d081c4e04c7b15'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'e5fefa073de0b5f0d1787b15'
### iv_xor: 'e5fefa073de0b5f0d1787b15'
### aad: '64e9ae7e5d15b61e4bec855964b79482bfdc9c42a96a4b74f3d8cbdad270de1a'
### aad: '64e9ae7e5d15b61e4bec855964b79482bfdc9c42a96a4b74f3d8cbdad270de1a'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '01b694030cad7140'
### ciphertext: '01b694030cad7140'
### authtag: 'c85a5be8cee94ec1603d16976feb2708'
### authtag: 'c85a5be8cee94ec1603d16976feb2708'
### cipherinfo: '834a3136313639303434313450c85a5be8cee94ec1603d16976feb27084801b694030cad7140'
### cipherinfo: '834a3136313639303434313450c85a5be8cee94ec1603d16976feb27084801b694030cad7140'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA2FbpEeBMWd6fjfvB3gjrVtO1Ti+3R9vxncmIg2rjhX0WCaDSjE2MTY5MDQ0MTRQyFpb6M7pTsFgPRaXb+snCEgBtpQDDK1xQA=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghA2FbpEeBMWd6fjfvB3gjrVtO1Ti+3R9vxncmIg2rjhX0WCaDSjE2MTY5MDQ0MTRQyFpb6M7pTsFgPRaXb+snCEgBtpQDDK1xQA=="),
  );
}
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03615ba4478131677a7e37ef077823ad5b4ed538bedd1f6fc67726220dab8e15f4"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_KKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","f79c7c6aa290b94cc76e5a1298fa6008f6d2d849b73c91c1b0866a0908017feb"),
                                h => pack("H*","79122c562d03ace003073982a6743d6d1b96340659ad0626531d8855b172df0d"),
                                hasK => 1,
                                k => pack("H*","d70b8ec00d5773d0cbf68a6aa5a29fff03cb7c6316d73787fc105eea55c3831d"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03615ba4478131677a7e37ef077823ad5b4ed538bedd1f6fc67726220dab8e15f4"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_KKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","f79c7c6aa290b94cc76e5a1298fa6008f6d2d849b73c91c1b0866a0908017feb"),
                                h => pack("H*","79122c562d03ace003073982a6743d6d1b96340659ad0626531d8855b172df0d"),
                                hasK => 1,
                                k => pack("H*","d70b8ec00d5773d0cbf68a6aa5a29fff03cb7c6316d73787fc105eea55c3831d"),
                              },
    who                    => "a",
  },
)


### b read message from a
### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "KK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_KKpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","775e5a71d142a55fd073e16ac4b66bdb0d5ebeccc6ca2c46b292522866ff1744"),
                              h  => pack("H*","41a14466d3a4f5f098063039dc37102551d6c53e481025d75e0f99e62af4a1e3"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "KK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_KKpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","775e5a71d142a55fd073e16ac4b66bdb0d5ebeccc6ca2c46b292522866ff1744"),
                              h  => pack("H*","41a14466d3a4f5f098063039dc37102551d6c53e481025d75e0f99e62af4a1e3"),
                            },
  who                    => "b",
}


### b recv msg from a
### b recv msg from a


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEYVukR4ExZ3p+N+8HeCOtW07VOL7d
',
###           'H2/GdyYiDauOFfSDGS6XsvWFjzfbHyrCbTLpx658xWp7T9S3mEa+pHv4+Q==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEYVukR4ExZ3p+N+8HeCOtW07VOL7d
',
###           'H2/GdyYiDauOFfSDGS6XsvWFjzfbHyrCbTLpx658xWp7T9S3mEa+pHv4+Q==
',
###           '-----END PUBLIC KEY-----
'
### z: '3e34e1254d10ff0013f96ff50dc0c0e173442e760c74296d72c0a378d71760d6'
### z: '3e34e1254d10ff0013f96ff50dc0c0e173442e760c74296d72c0a378d71760d6'


### read message pattern: 'ss'
### read message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### read message pattern: 'psk'
### read message pattern: 'psk'


### noise decrypt
### noise decrypt
### key: 'd0cff3093288bcc87aca23fcfbab50dd58c59d9c14accc6c2dfefbc61647c8fc'
### key: 'd0cff3093288bcc87aca23fcfbab50dd58c59d9c14accc6c2dfefbc61647c8fc'
### iv: 'd4c8cb3104d081c4e04c7b15'
### iv: 'd4c8cb3104d081c4e04c7b15'
### aad: '64e9ae7e5d15b61e4bec855964b79482bfdc9c42a96a4b74f3d8cbdad270de1a'
### aad: '64e9ae7e5d15b61e4bec855964b79482bfdc9c42a96a4b74f3d8cbdad270de1a'
### cipherinfo: '834a3136313639303434313450c85a5be8cee94ec1603d16976feb27084801b694030cad7140'
### cipherinfo: '834a3136313639303434313450c85a5be8cee94ec1603d16976feb27084801b694030cad7140'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'e5fefa073de0b5f0d1787b15'
### iv_xor: 'e5fefa073de0b5f0d1787b15'
### authtag: 'c85a5be8cee94ec1603d16976feb2708'
### authtag: 'c85a5be8cee94ec1603d16976feb2708'
### ciphertext: '01b694030cad7140'
### ciphertext: '01b694030cad7140'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_KKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","03615ba4478131677a7e37ef077823ad5b4ed538bedd1f6fc67726220dab8e15f4"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","f79c7c6aa290b94cc76e5a1298fa6008f6d2d849b73c91c1b0866a0908017feb"),
                                h => pack("H*","79122c562d03ace003073982a6743d6d1b96340659ad0626531d8855b172df0d"),
                                hasK => 1,
                                k => pack("H*","d70b8ec00d5773d0cbf68a6aa5a29fff03cb7c6316d73787fc105eea55c3831d"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_KKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","03615ba4478131677a7e37ef077823ad5b4ed538bedd1f6fc67726220dab8e15f4"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","f79c7c6aa290b94cc76e5a1298fa6008f6d2d849b73c91c1b0866a0908017feb"),
                                h => pack("H*","79122c562d03ace003073982a6743d6d1b96340659ad0626531d8855b172df0d"),
                                hasK => 1,
                                k => pack("H*","d70b8ec00d5773d0cbf68a6aa5a29fff03cb7c6316d73787fc105eea55c3831d"),
                              },
    who                    => "b",
  },
)


### b write_message to a
### b write_message to a
### b send msg to a
### b send msg to a


### write message pattern: 'e'
### write message pattern: 'e'

### public compressed: '03ecedcfb400151e3c4879588c602680ee60e8565b3bdb41d86fc864b5ed3819c5'

### public compressed: '03ecedcfb400151e3c4879588c602680ee60e8565b3bdb41d86fc864b5ed3819c5'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIH1W9seZWFRTn/OTaYzBoBcirqb/HCwYLA07zT15zkyXoAoGCCqGSM49
',
###             'AwEHoUQDQgAE7O3PtAAVHjxIeViMYCaA7mDoVls720HYb8hkte04GcWUDSyzr22F
',
###             'kBL47hlUNQmX2nWr2RT+krWLS63Sek9wWQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIH1W9seZWFRTn/OTaYzBoBcirqb/HCwYLA07zT15zkyXoAoGCCqGSM49
',
###             'AwEHoUQDQgAE7O3PtAAVHjxIeViMYCaA7mDoVls720HYb8hkte04GcWUDSyzr22F
',
###             'kBL47hlUNQmX2nWr2RT+krWLS63Sek9wWQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEYVukR4ExZ3p+N+8HeCOtW07VOL7d
',
###           'H2/GdyYiDauOFfSDGS6XsvWFjzfbHyrCbTLpx658xWp7T9S3mEa+pHv4+Q==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEYVukR4ExZ3p+N+8HeCOtW07VOL7d
',
###           'H2/GdyYiDauOFfSDGS6XsvWFjzfbHyrCbTLpx658xWp7T9S3mEa+pHv4+Q==
',
###           '-----END PUBLIC KEY-----
'
### z: '1399d36e7f40e73702823cead9575724962f7d16e724fc2767bdc9342cc7f9be'
### z: '1399d36e7f40e73702823cead9575724962f7d16e724fc2767bdc9342cc7f9be'

### write message pattern: 'se'

### write message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIH1W9seZWFRTn/OTaYzBoBcirqb/HCwYLA07zT15zkyXoAoGCCqGSM49
',
###             'AwEHoUQDQgAE7O3PtAAVHjxIeViMYCaA7mDoVls720HYb8hkte04GcWUDSyzr22F
',
###             'kBL47hlUNQmX2nWr2RT+krWLS63Sek9wWQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIH1W9seZWFRTn/OTaYzBoBcirqb/HCwYLA07zT15zkyXoAoGCCqGSM49
',
###             'AwEHoUQDQgAE7O3PtAAVHjxIeViMYCaA7mDoVls720HYb8hkte04GcWUDSyzr22F
',
###             'kBL47hlUNQmX2nWr2RT+krWLS63Sek9wWQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '3c239152121f1dbca19985c2bccc3680199329947c5a4a669aa97f8baa41e06d'
### z: '3c239152121f1dbca19985c2bccc3680199329947c5a4a669aa97f8baa41e06d'

### noise encrypt

### noise encrypt
### key: '1399a7216ccd6ce7322a7ee41fa3f9c8707ab1131650c97a1cada14ed07411ae'
### key: '1399a7216ccd6ce7322a7ee41fa3f9c8707ab1131650c97a1cada14ed07411ae'
### iv: '7741ab34b11580af94323780'
### iv: '7741ab34b11580af94323780'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '46779a028825b49ba5063780'
### iv_xor: '46779a028825b49ba5063780'
### aad: '79b8dec38f3e9cba3de3de5523e77a280ecef083d0a7b3a8026269cf72535e9c'
### aad: '79b8dec38f3e9cba3de3de5523e77a280ecef083d0a7b3a8026269cf72535e9c'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '71d09cad43c39c07'
### ciphertext: '71d09cad43c39c07'
### authtag: '1cb467077a8ed630060bfd2d31024fb8'
### authtag: '1cb467077a8ed630060bfd2d31024fb8'
### cipherinfo: '834a31363136393034343134501cb467077a8ed630060bfd2d31024fb84871d09cad43c39c07'
### cipherinfo: '834a31363136393034343134501cb467077a8ed630060bfd2d31024fb84871d09cad43c39c07'


### b_msg: '82582103ecedcfb400151e3c4879588c602680ee60e8565b3bdb41d86fc864b5ed3819c55826834a31363136393034343134501cb467077a8ed630060bfd2d31024fb84871d09cad43c39c07'
### b_msg: '82582103ecedcfb400151e3c4879588c602680ee60e8565b3bdb41d86fc864b5ed3819c55826834a31363136393034343134501cb467077a8ed630060bfd2d31024fb84871d09cad43c39c07'
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03ecedcfb400151e3c4879588c602680ee60e8565b3bdb41d86fc864b5ed3819c5"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_KKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","03615ba4478131677a7e37ef077823ad5b4ed538bedd1f6fc67726220dab8e15f4"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","6349b5e2d4f6f072cc87da628466efd82c0942554b1067187e34bbb5d017e1a7"),
                                h => pack("H*","501884a86954c4143357a7f75fc333b8323b82a8e4bb6a0a7039c4913dc709f6"),
                                hasK => 1,
                                k => pack("H*","28aefa6306ffe67f5ccd6b523b8cd7a9182f6fbde3a42974d38746bcbd48854c"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","3654d7787295c9fe065f9cecd8e7de320c5595bc1008fa069236e9be3cd3c9a4"),
  },
  {
    hasK => 1,
    k => pack("H*","4f5fee7df51542d0422e6f54ad4dc2787f5f54222248bac734d846edc47047ee"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03ecedcfb400151e3c4879588c602680ee60e8565b3bdb41d86fc864b5ed3819c5"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_KKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","03615ba4478131677a7e37ef077823ad5b4ed538bedd1f6fc67726220dab8e15f4"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","6349b5e2d4f6f072cc87da628466efd82c0942554b1067187e34bbb5d017e1a7"),
                                h => pack("H*","501884a86954c4143357a7f75fc333b8323b82a8e4bb6a0a7039c4913dc709f6"),
                                hasK => 1,
                                k => pack("H*","28aefa6306ffe67f5ccd6b523b8cd7a9182f6fbde3a42974d38746bcbd48854c"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","3654d7787295c9fe065f9cecd8e7de320c5595bc1008fa069236e9be3cd3c9a4"),
  },
  {
    hasK => 1,
    k => pack("H*","4f5fee7df51542d0422e6f54ad4dc2787f5f54222248bac734d846edc47047ee"),
  },
)


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICCqaoNLkd47JTAuIIwJwaZ2azRCxvvyaTYjYVPKrU0RoAoGCCqGSM49
',
###             'AwEHoUQDQgAEYVukR4ExZ3p+N+8HeCOtW07VOL7dH2/GdyYiDauOFfSDGS6XsvWF
',
###             'jzfbHyrCbTLpx658xWp7T9S3mEa+pHv4+Q==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICCqaoNLkd47JTAuIIwJwaZ2azRCxvvyaTYjYVPKrU0RoAoGCCqGSM49
',
###             'AwEHoUQDQgAEYVukR4ExZ3p+N+8HeCOtW07VOL7dH2/GdyYiDauOFfSDGS6XsvWF
',
###             'jzfbHyrCbTLpx658xWp7T9S3mEa+pHv4+Q==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE7O3PtAAVHjxIeViMYCaA7mDoVls7
',
###           '20HYb8hkte04GcWUDSyzr22FkBL47hlUNQmX2nWr2RT+krWLS63Sek9wWQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE7O3PtAAVHjxIeViMYCaA7mDoVls7
',
###           '20HYb8hkte04GcWUDSyzr22FkBL47hlUNQmX2nWr2RT+krWLS63Sek9wWQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '1399d36e7f40e73702823cead9575724962f7d16e724fc2767bdc9342cc7f9be'
### z: '1399d36e7f40e73702823cead9575724962f7d16e724fc2767bdc9342cc7f9be'


### read message pattern: 'se'
### read message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE7O3PtAAVHjxIeViMYCaA7mDoVls7
',
###           '20HYb8hkte04GcWUDSyzr22FkBL47hlUNQmX2nWr2RT+krWLS63Sek9wWQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE7O3PtAAVHjxIeViMYCaA7mDoVls7
',
###           '20HYb8hkte04GcWUDSyzr22FkBL47hlUNQmX2nWr2RT+krWLS63Sek9wWQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '3c239152121f1dbca19985c2bccc3680199329947c5a4a669aa97f8baa41e06d'
### z: '3c239152121f1dbca19985c2bccc3680199329947c5a4a669aa97f8baa41e06d'

### noise decrypt

### noise decrypt
### key: '1399a7216ccd6ce7322a7ee41fa3f9c8707ab1131650c97a1cada14ed07411ae'
### key: '1399a7216ccd6ce7322a7ee41fa3f9c8707ab1131650c97a1cada14ed07411ae'
### iv: '7741ab34b11580af94323780'
### iv: '7741ab34b11580af94323780'
### aad: '79b8dec38f3e9cba3de3de5523e77a280ecef083d0a7b3a8026269cf72535e9c'
### aad: '79b8dec38f3e9cba3de3de5523e77a280ecef083d0a7b3a8026269cf72535e9c'
### cipherinfo: '834a31363136393034343134501cb467077a8ed630060bfd2d31024fb84871d09cad43c39c07'
### cipherinfo: '834a31363136393034343134501cb467077a8ed630060bfd2d31024fb84871d09cad43c39c07'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '46779a028825b49ba5063780'
### iv_xor: '46779a028825b49ba5063780'
### authtag: '1cb467077a8ed630060bfd2d31024fb8'
### authtag: '1cb467077a8ed630060bfd2d31024fb8'
### ciphertext: '71d09cad43c39c07'
### ciphertext: '71d09cad43c39c07'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03615ba4478131677a7e37ef077823ad5b4ed538bedd1f6fc67726220dab8e15f4"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_KKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","03ecedcfb400151e3c4879588c602680ee60e8565b3bdb41d86fc864b5ed3819c5"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","6349b5e2d4f6f072cc87da628466efd82c0942554b1067187e34bbb5d017e1a7"),
                                h => pack("H*","501884a86954c4143357a7f75fc333b8323b82a8e4bb6a0a7039c4913dc709f6"),
                                hasK => 1,
                                k => pack("H*","28aefa6306ffe67f5ccd6b523b8cd7a9182f6fbde3a42974d38746bcbd48854c"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","3654d7787295c9fe065f9cecd8e7de320c5595bc1008fa069236e9be3cd3c9a4"),
  },
  {
    hasK => 1,
    k => pack("H*","4f5fee7df51542d0422e6f54ad4dc2787f5f54222248bac734d846edc47047ee"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03615ba4478131677a7e37ef077823ad5b4ed538bedd1f6fc67726220dab8e15f4"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "KK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "ss", "psk"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_KKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","03ecedcfb400151e3c4879588c602680ee60e8565b3bdb41d86fc864b5ed3819c5"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","6349b5e2d4f6f072cc87da628466efd82c0942554b1067187e34bbb5d017e1a7"),
                                h => pack("H*","501884a86954c4143357a7f75fc333b8323b82a8e4bb6a0a7039c4913dc709f6"),
                                hasK => 1,
                                k => pack("H*","28aefa6306ffe67f5ccd6b523b8cd7a9182f6fbde3a42974d38746bcbd48854c"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","3654d7787295c9fe065f9cecd8e7de320c5595bc1008fa069236e9be3cd3c9a4"),
  },
  {
    hasK => 1,
    k => pack("H*","4f5fee7df51542d0422e6f54ad4dc2787f5f54222248bac734d846edc47047ee"),
  },
)


### a send comm msg to b
### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '8d4ec8fe7c2db2b16eb1abccb7ad8aaa093ad1e7474521addf3ccb6fae17786f'
### key: '8d4ec8fe7c2db2b16eb1abccb7ad8aaa093ad1e7474521addf3ccb6fae17786f'
### iv: '6534c4d0284b64ec526afbba'
### iv: '6534c4d0284b64ec526afbba'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '5402f5e6117b50d8635efbba'
### iv_xor: '5402f5e6117b50d8635efbba'
### aad: '501884a86954c4143357a7f75fc333b8323b82a8e4bb6a0a7039c4913dc709f6'
### aad: '501884a86954c4143357a7f75fc333b8323b82a8e4bb6a0a7039c4913dc709f6'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'f497e4903e9e51ad82d895af284adc4a675287cb90c688acef0251cc7be9c6d2fd14e87fb98a9db49dd3b0e57d30e492db75e7'
### ciphertext: 'f497e4903e9e51ad82d895af284adc4a675287cb90c688acef0251cc7be9c6d2fd14e87fb98a9db49dd3b0e57d30e492db75e7'
### authtag: '9b24dfc5e4575121a55e2d0ad038b04c'
### authtag: '9b24dfc5e4575121a55e2d0ad038b04c'
### cipherinfo: '834a31363136393034343134509b24dfc5e4575121a55e2d0ad038b04c5833f497e4903e9e51ad82d895af284adc4a675287cb90c688acef0251cc7be9c6d2fd14e87fb98a9db49dd3b0e57d30e492db75e7'
### cipherinfo: '834a31363136393034343134509b24dfc5e4575121a55e2d0ad038b04c5833f497e4903e9e51ad82d895af284adc4a675287cb90c688acef0251cc7be9c6d2fd14e87fb98a9db49dd3b0e57d30e492db75e7'


### b recv comm msg from a
### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '8d4ec8fe7c2db2b16eb1abccb7ad8aaa093ad1e7474521addf3ccb6fae17786f'
### key: '8d4ec8fe7c2db2b16eb1abccb7ad8aaa093ad1e7474521addf3ccb6fae17786f'
### iv: '6534c4d0284b64ec526afbba'
### iv: '6534c4d0284b64ec526afbba'
### aad: '501884a86954c4143357a7f75fc333b8323b82a8e4bb6a0a7039c4913dc709f6'
### aad: '501884a86954c4143357a7f75fc333b8323b82a8e4bb6a0a7039c4913dc709f6'
### cipherinfo: '834a31363136393034343134509b24dfc5e4575121a55e2d0ad038b04c5833f497e4903e9e51ad82d895af284adc4a675287cb90c688acef0251cc7be9c6d2fd14e87fb98a9db49dd3b0e57d30e492db75e7'
### cipherinfo: '834a31363136393034343134509b24dfc5e4575121a55e2d0ad038b04c5833f497e4903e9e51ad82d895af284adc4a675287cb90c688acef0251cc7be9c6d2fd14e87fb98a9db49dd3b0e57d30e492db75e7'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '5402f5e6117b50d8635efbba'
### iv_xor: '5402f5e6117b50d8635efbba'
### authtag: '9b24dfc5e4575121a55e2d0ad038b04c'
### authtag: '9b24dfc5e4575121a55e2d0ad038b04c'
### ciphertext: 'f497e4903e9e51ad82d895af284adc4a675287cb90c688acef0251cc7be9c6d2fd14e87fb98a9db49dd3b0e57d30e492db75e7'
### ciphertext: 'f497e4903e9e51ad82d895af284adc4a675287cb90c688acef0251cc7be9c6d2fd14e87fb98a9db49dd3b0e57d30e492db75e7'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: 'ea2e5fe092c401836eeeaf64c05c4126c4822828834b20a3c6bc28a60c2b8e5e'
### key: 'ea2e5fe092c401836eeeaf64c05c4126c4822828834b20a3c6bc28a60c2b8e5e'
### iv: 'f7e10107009272630701d43b'
### iv: 'f7e10107009272630701d43b'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'c6d7303139a246573635d43b'
### iv_xor: 'c6d7303139a246573635d43b'
### aad: '501884a86954c4143357a7f75fc333b8323b82a8e4bb6a0a7039c4913dc709f6'
### aad: '501884a86954c4143357a7f75fc333b8323b82a8e4bb6a0a7039c4913dc709f6'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'd22fce2a8487e04690c44125c1b8415ee84a472d921fe6e3a87de214f6e4dac55ec94a6733773f17195506b956689b'
### ciphertext: 'd22fce2a8487e04690c44125c1b8415ee84a472d921fe6e3a87de214f6e4dac55ec94a6733773f17195506b956689b'
### authtag: '1b80b4d2ba6ff16e06dc8ce757bcf4e0'
### authtag: '1b80b4d2ba6ff16e06dc8ce757bcf4e0'
### cipherinfo: '834a31363136393034343134501b80b4d2ba6ff16e06dc8ce757bcf4e0582fd22fce2a8487e04690c44125c1b8415ee84a472d921fe6e3a87de214f6e4dac55ec94a6733773f17195506b956689b'
### cipherinfo: '834a31363136393034343134501b80b4d2ba6ff16e06dc8ce757bcf4e0582fd22fce2a8487e04690c44125c1b8415ee84a472d921fe6e3a87de214f6e4dac55ec94a6733773f17195506b956689b'


### a recv comm msg from b
### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: 'ea2e5fe092c401836eeeaf64c05c4126c4822828834b20a3c6bc28a60c2b8e5e'
### key: 'ea2e5fe092c401836eeeaf64c05c4126c4822828834b20a3c6bc28a60c2b8e5e'
### iv: 'f7e10107009272630701d43b'
### iv: 'f7e10107009272630701d43b'
### aad: '501884a86954c4143357a7f75fc333b8323b82a8e4bb6a0a7039c4913dc709f6'
### aad: '501884a86954c4143357a7f75fc333b8323b82a8e4bb6a0a7039c4913dc709f6'
### cipherinfo: '834a31363136393034343134501b80b4d2ba6ff16e06dc8ce757bcf4e0582fd22fce2a8487e04690c44125c1b8415ee84a472d921fe6e3a87de214f6e4dac55ec94a6733773f17195506b956689b'
### cipherinfo: '834a31363136393034343134501b80b4d2ba6ff16e06dc8ce757bcf4e0582fd22fce2a8487e04690c44125c1b8415ee84a472d921fe6e3a87de214f6e4dac55ec94a6733773f17195506b956689b'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'c6d7303139a246573635d43b'
### iv_xor: 'c6d7303139a246573635d43b'
### authtag: '1b80b4d2ba6ff16e06dc8ce757bcf4e0'
### authtag: '1b80b4d2ba6ff16e06dc8ce757bcf4e0'
### ciphertext: 'd22fce2a8487e04690c44125c1b8415ee84a472d921fe6e3a87de214f6e4dac55ec94a6733773f17195506b956689b'
### ciphertext: 'd22fce2a8487e04690c44125c1b8415ee84a472d921fe6e3a87de214f6e4dac55ec94a6733773f17195506b956689b'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'KK',
###                               'test_psk',
###                               1
### -----------end test --------: 'KK',
###                               'test_psk',
###                               1


### -----------start test --------: 'IK',
###                                 undef,
###                                 undef
### -----------start test --------: 'IK',
###                                 undef,
###                                 undef

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IK_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => "Noise_IK_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","5d67d84f26812693c811d4d6cc2681c5b62f7599e6a8d06f7811136a425fbdc1"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IK_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => "Noise_IK_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","5d67d84f26812693c811d4d6cc2681c5b62f7599e6a8d06f7811136a425fbdc1"),
                            },
  who                    => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '02764ed5bd9bc5b8aa9899c1b470c19669553479a2866084e6ea36aef6d39f9dae'

### public compressed: '02764ed5bd9bc5b8aa9899c1b470c19669553479a2866084e6ea36aef6d39f9dae'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMx3fwTZWJAsPHKa5sRIniw8oUJGo3s+9VjFXJftjO2foAoGCCqGSM49
',
###             'AwEHoUQDQgAEdk7VvZvFuKqYmcG0cMGWaVU0eaKGYITm6jau9tOfna6FVZkAjrrd
',
###             'fEMKjY3G3egN9nwhQbBSawEGK0DcleMZnA==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMx3fwTZWJAsPHKa5sRIniw8oUJGo3s+9VjFXJftjO2foAoGCCqGSM49
',
###             'AwEHoUQDQgAEdk7VvZvFuKqYmcG0cMGWaVU0eaKGYITm6jau9tOfna6FVZkAjrrd
',
###             'fEMKjY3G3egN9nwhQbBSawEGK0DcleMZnA==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '7b404dcb3d3b34eb18bde0934c017a45c007a4cc5d28b62ebbf874937a0e0bcf'
### z: '7b404dcb3d3b34eb18bde0934c017a45c007a4cc5d28b62ebbf874937a0e0bcf'


### write message pattern: 's'
### write message pattern: 's'


### noise encrypt
### noise encrypt
### key: '825ca46beafd07fdf87443c65ac497f31e212e1a782e0e1be549f2328798bf99'
### key: '825ca46beafd07fdf87443c65ac497f31e212e1a782e0e1be549f2328798bf99'
### iv: 'ebaa5d015937ce98e14df061'
### iv: 'ebaa5d015937ce98e14df061'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'da9c6c376007faacd079f061'
### iv_xor: 'da9c6c376007faacd079f061'
### aad: 'b8e4897a0736c94ae126e0f96972f29a40e675fc50c5eae2e541ac075d45f3fb'
### aad: 'b8e4897a0736c94ae126e0f96972f29a40e675fc50c5eae2e541ac075d45f3fb'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: '5d535d66cc06d81ab8711deae65e6e40b9caa7b98d3bcf239079e7a94aa354857fd4863d6a467265'
### ciphertext: '5d535d66cc06d81ab8711deae65e6e40b9caa7b98d3bcf239079e7a94aa354857fd4863d6a467265'
### authtag: '215fd47f7baf4a2d4301c3525b78f1b4'
### authtag: '215fd47f7baf4a2d4301c3525b78f1b4'
### cipherinfo: '834a3136313639303434313450215fd47f7baf4a2d4301c3525b78f1b458285d535d66cc06d81ab8711deae65e6e40b9caa7b98d3bcf239079e7a94aa354857fd4863d6a467265'
### cipherinfo: '834a3136313639303434313450215fd47f7baf4a2d4301c3525b78f1b458285d535d66cc06d81ab8711deae65e6e40b9caa7b98d3bcf239079e7a94aa354857fd4863d6a467265'


### write message pattern: 'ss'
### write message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### noise encrypt
### noise encrypt
### key: 'd3af0828a66f59f755c8d39a5272287140e8379b88a5493b3fb13e81271c3987'
### key: 'd3af0828a66f59f755c8d39a5272287140e8379b88a5493b3fb13e81271c3987'
### iv: '900fc51c59ad69bdad73fdf3'
### iv: '900fc51c59ad69bdad73fdf3'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'a139f42a609d5d899c47fdf3'
### iv_xor: 'a139f42a609d5d899c47fdf3'
### aad: 'a80eaf39719a2922325518812154d388c61975cb52b2179026a0141a959f8a48'
### aad: 'a80eaf39719a2922325518812154d388c61975cb52b2179026a0141a959f8a48'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: 'b792a61b995aa8ba'
### ciphertext: 'b792a61b995aa8ba'
### authtag: '0606ca56c539654255df5633cc010ac8'
### authtag: '0606ca56c539654255df5633cc010ac8'
### cipherinfo: '834a31363136393034343134500606ca56c539654255df5633cc010ac848b792a61b995aa8ba'
### cipherinfo: '834a31363136393034343134500606ca56c539654255df5633cc010ac848b792a61b995aa8ba'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghAnZO1b2bxbiqmJnBtHDBlmlVNHmihmCE5uo2rvbTn52uWEeDSjE2MTY5MDQ0MTRQIV/Uf3uvSi1DAcNSW3jxtFgoXVNdZswG2Bq4cR3q5l5uQLnKp7mNO88jkHnnqUqjVIV/1IY9akZyZVgmg0oxNjE2OTA0NDE0UAYGylbFOWVCVd9WM8wBCshIt5KmG5laqLo="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghAnZO1b2bxbiqmJnBtHDBlmlVNHmihmCE5uo2rvbTn52uWEeDSjE2MTY5MDQ0MTRQIV/Uf3uvSi1DAcNSW3jxtFgoXVNdZswG2Bq4cR3q5l5uQLnKp7mNO88jkHnnqUqjVIV/1IY9akZyZVgmg0oxNjE2OTA0NDE0UAYGylbFOWVCVd9WM8wBCshIt5KmG5laqLo="),
  );
}
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02764ed5bd9bc5b8aa9899c1b470c19669553479a2866084e6ea36aef6d39f9dae"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","9afca86ce339fff2d35b59bc9d2c759bd2d251a212feffb8075491da76d1ebc7"),
                                h => pack("H*","25d9c4e5b6b4511eea05c58e653cbb0de70adf276b5ed008df575656504caffa"),
                                hasK => 1,
                                k => pack("H*","17a976b067f798e6e189cb9e4b023332bea8c47235d3dc22b056e642854822af"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02764ed5bd9bc5b8aa9899c1b470c19669553479a2866084e6ea36aef6d39f9dae"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","9afca86ce339fff2d35b59bc9d2c759bd2d251a212feffb8075491da76d1ebc7"),
                                h => pack("H*","25d9c4e5b6b4511eea05c58e653cbb0de70adf276b5ed008df575656504caffa"),
                                hasK => 1,
                                k => pack("H*","17a976b067f798e6e189cb9e4b023332bea8c47235d3dc22b056e642854822af"),
                              },
    who                    => "a",
  },
)


### b read message from a
### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IK_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => "Noise_IK_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","5d67d84f26812693c811d4d6cc2681c5b62f7599e6a8d06f7811136a425fbdc1"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IK_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => "Noise_IK_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","5d67d84f26812693c811d4d6cc2681c5b62f7599e6a8d06f7811136a425fbdc1"),
                            },
  who                    => "b",
}


### b recv msg from a
### b recv msg from a


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEdk7VvZvFuKqYmcG0cMGWaVU0eaKG
',
###           'YITm6jau9tOfna6FVZkAjrrdfEMKjY3G3egN9nwhQbBSawEGK0DcleMZnA==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEdk7VvZvFuKqYmcG0cMGWaVU0eaKG
',
###           'YITm6jau9tOfna6FVZkAjrrdfEMKjY3G3egN9nwhQbBSawEGK0DcleMZnA==
',
###           '-----END PUBLIC KEY-----
'
### z: '7b404dcb3d3b34eb18bde0934c017a45c007a4cc5d28b62ebbf874937a0e0bcf'
### z: '7b404dcb3d3b34eb18bde0934c017a45c007a4cc5d28b62ebbf874937a0e0bcf'


### read message pattern: 's'
### read message pattern: 's'


### noise decrypt
### noise decrypt
### key: '825ca46beafd07fdf87443c65ac497f31e212e1a782e0e1be549f2328798bf99'
### key: '825ca46beafd07fdf87443c65ac497f31e212e1a782e0e1be549f2328798bf99'
### iv: 'ebaa5d015937ce98e14df061'
### iv: 'ebaa5d015937ce98e14df061'
### aad: 'b8e4897a0736c94ae126e0f96972f29a40e675fc50c5eae2e541ac075d45f3fb'
### aad: 'b8e4897a0736c94ae126e0f96972f29a40e675fc50c5eae2e541ac075d45f3fb'
### cipherinfo: '834a3136313639303434313450215fd47f7baf4a2d4301c3525b78f1b458285d535d66cc06d81ab8711deae65e6e40b9caa7b98d3bcf239079e7a94aa354857fd4863d6a467265'
### cipherinfo: '834a3136313639303434313450215fd47f7baf4a2d4301c3525b78f1b458285d535d66cc06d81ab8711deae65e6e40b9caa7b98d3bcf239079e7a94aa354857fd4863d6a467265'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'da9c6c376007faacd079f061'
### iv_xor: 'da9c6c376007faacd079f061'
### authtag: '215fd47f7baf4a2d4301c3525b78f1b4'
### authtag: '215fd47f7baf4a2d4301c3525b78f1b4'
### ciphertext: '5d535d66cc06d81ab8711deae65e6e40b9caa7b98d3bcf239079e7a94aa354857fd4863d6a467265'
### ciphertext: '5d535d66cc06d81ab8711deae65e6e40b9caa7b98d3bcf239079e7a94aa354857fd4863d6a467265'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'


### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'


### read message pattern: 'ss'
### read message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### noise decrypt
### noise decrypt
### key: 'd3af0828a66f59f755c8d39a5272287140e8379b88a5493b3fb13e81271c3987'
### key: 'd3af0828a66f59f755c8d39a5272287140e8379b88a5493b3fb13e81271c3987'
### iv: '900fc51c59ad69bdad73fdf3'
### iv: '900fc51c59ad69bdad73fdf3'
### aad: 'a80eaf39719a2922325518812154d388c61975cb52b2179026a0141a959f8a48'
### aad: 'a80eaf39719a2922325518812154d388c61975cb52b2179026a0141a959f8a48'
### cipherinfo: '834a31363136393034343134500606ca56c539654255df5633cc010ac848b792a61b995aa8ba'
### cipherinfo: '834a31363136393034343134500606ca56c539654255df5633cc010ac848b792a61b995aa8ba'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'a139f42a609d5d899c47fdf3'
### iv_xor: 'a139f42a609d5d899c47fdf3'
### authtag: '0606ca56c539654255df5633cc010ac8'
### authtag: '0606ca56c539654255df5633cc010ac8'
### ciphertext: 'b792a61b995aa8ba'
### ciphertext: 'b792a61b995aa8ba'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","02764ed5bd9bc5b8aa9899c1b470c19669553479a2866084e6ea36aef6d39f9dae"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","9afca86ce339fff2d35b59bc9d2c759bd2d251a212feffb8075491da76d1ebc7"),
                                h => pack("H*","25d9c4e5b6b4511eea05c58e653cbb0de70adf276b5ed008df575656504caffa"),
                                hasK => 1,
                                k => pack("H*","17a976b067f798e6e189cb9e4b023332bea8c47235d3dc22b056e642854822af"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","02764ed5bd9bc5b8aa9899c1b470c19669553479a2866084e6ea36aef6d39f9dae"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","9afca86ce339fff2d35b59bc9d2c759bd2d251a212feffb8075491da76d1ebc7"),
                                h => pack("H*","25d9c4e5b6b4511eea05c58e653cbb0de70adf276b5ed008df575656504caffa"),
                                hasK => 1,
                                k => pack("H*","17a976b067f798e6e189cb9e4b023332bea8c47235d3dc22b056e642854822af"),
                              },
    who                    => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '0385c405aaf7bffa54a2773f88199c7c7df7d65c95a3a1a6e9e7b1882fcf262cee'

### public compressed: '0385c405aaf7bffa54a2773f88199c7c7df7d65c95a3a1a6e9e7b1882fcf262cee'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEII6Fd7SB9tWd8hR+th4n3QEvvtz6WwcHWQAaFIxB1HBEoAoGCCqGSM49
',
###             'AwEHoUQDQgAEhcQFqve/+lSidz+IGZx8fffWXJWjoabp57GIL88mLO5sebJwZTv1
',
###             'zMvLeFyu4U4YWqnKLRcI/A8Qcf3v/dGbQQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEII6Fd7SB9tWd8hR+th4n3QEvvtz6WwcHWQAaFIxB1HBEoAoGCCqGSM49
',
###             'AwEHoUQDQgAEhcQFqve/+lSidz+IGZx8fffWXJWjoabp57GIL88mLO5sebJwZTv1
',
###             'zMvLeFyu4U4YWqnKLRcI/A8Qcf3v/dGbQQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEdk7VvZvFuKqYmcG0cMGWaVU0eaKG
',
###           'YITm6jau9tOfna6FVZkAjrrdfEMKjY3G3egN9nwhQbBSawEGK0DcleMZnA==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEdk7VvZvFuKqYmcG0cMGWaVU0eaKG
',
###           'YITm6jau9tOfna6FVZkAjrrdfEMKjY3G3egN9nwhQbBSawEGK0DcleMZnA==
',
###           '-----END PUBLIC KEY-----
'
### z: 'be5d9631013ee60e2fdb48e94dcadac4cab6a150a858fdcffdf94be46fb23e6d'
### z: 'be5d9631013ee60e2fdb48e94dcadac4cab6a150a858fdcffdf94be46fb23e6d'


### write message pattern: 'se'
### write message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEII6Fd7SB9tWd8hR+th4n3QEvvtz6WwcHWQAaFIxB1HBEoAoGCCqGSM49
',
###             'AwEHoUQDQgAEhcQFqve/+lSidz+IGZx8fffWXJWjoabp57GIL88mLO5sebJwZTv1
',
###             'zMvLeFyu4U4YWqnKLRcI/A8Qcf3v/dGbQQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEII6Fd7SB9tWd8hR+th4n3QEvvtz6WwcHWQAaFIxB1HBEoAoGCCqGSM49
',
###             'AwEHoUQDQgAEhcQFqve/+lSidz+IGZx8fffWXJWjoabp57GIL88mLO5sebJwZTv1
',
###             'zMvLeFyu4U4YWqnKLRcI/A8Qcf3v/dGbQQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '8fdb77887037f0519a42ab18069cffcc33b41e197400188d0fa69d2525bdffad'
### z: '8fdb77887037f0519a42ab18069cffcc33b41e197400188d0fa69d2525bdffad'

### noise encrypt

### noise encrypt
### key: '4fc6a8cc119f4796ef3ec634b0d063ea7cc15b23fbc9ef297527e044601ecd19'
### key: '4fc6a8cc119f4796ef3ec634b0d063ea7cc15b23fbc9ef297527e044601ecd19'
### iv: '6d063887cf061d468eeba1b0'
### iv: '6d063887cf061d468eeba1b0'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '5c3009b1f6362972bfdfa1b0'
### iv_xor: '5c3009b1f6362972bfdfa1b0'
### aad: '83f904b2b90793df224ce75021e7c573c28b0085e61be70c84787f4b1b749305'
### aad: '83f904b2b90793df224ce75021e7c573c28b0085e61be70c84787f4b1b749305'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '8d96ef1ef77d30fb'
### ciphertext: '8d96ef1ef77d30fb'
### authtag: '9095609ae2a0ac71a4abc3a8d4214641'
### authtag: '9095609ae2a0ac71a4abc3a8d4214641'
### cipherinfo: '834a31363136393034343134509095609ae2a0ac71a4abc3a8d4214641488d96ef1ef77d30fb'
### cipherinfo: '834a31363136393034343134509095609ae2a0ac71a4abc3a8d4214641488d96ef1ef77d30fb'


### b_msg: '8258210385c405aaf7bffa54a2773f88199c7c7df7d65c95a3a1a6e9e7b1882fcf262cee5826834a31363136393034343134509095609ae2a0ac71a4abc3a8d4214641488d96ef1ef77d30fb'
### b_msg: '8258210385c405aaf7bffa54a2773f88199c7c7df7d65c95a3a1a6e9e7b1882fcf262cee5826834a31363136393034343134509095609ae2a0ac71a4abc3a8d4214641488d96ef1ef77d30fb'
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0385c405aaf7bffa54a2773f88199c7c7df7d65c95a3a1a6e9e7b1882fcf262cee"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","02764ed5bd9bc5b8aa9899c1b470c19669553479a2866084e6ea36aef6d39f9dae"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","2929940322e1b6d0a57e6b8d21b4275f882bfc2cef73fba8a6733d48296b75f6"),
                                h => pack("H*","3d45c7a27bbeab5b685615a15c4c6a1827a76c616f18fdb0b272b2294442f77f"),
                                hasK => 1,
                                k => pack("H*","6436bb15464356389a7693474fb9a02f2115deb50f5515783220aa5ff893dbab"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","2af2e697f756c056bf29ef1af7b26f753c3abfe6850e299d3eaabe706bdd58de"),
  },
  {
    hasK => 1,
    k => pack("H*","d74d8d7555950da79ef84d6df91c1546bba5fff7735253f68b7dcef0ebefc364"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0385c405aaf7bffa54a2773f88199c7c7df7d65c95a3a1a6e9e7b1882fcf262cee"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","02764ed5bd9bc5b8aa9899c1b470c19669553479a2866084e6ea36aef6d39f9dae"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","2929940322e1b6d0a57e6b8d21b4275f882bfc2cef73fba8a6733d48296b75f6"),
                                h => pack("H*","3d45c7a27bbeab5b685615a15c4c6a1827a76c616f18fdb0b272b2294442f77f"),
                                hasK => 1,
                                k => pack("H*","6436bb15464356389a7693474fb9a02f2115deb50f5515783220aa5ff893dbab"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","2af2e697f756c056bf29ef1af7b26f753c3abfe6850e299d3eaabe706bdd58de"),
  },
  {
    hasK => 1,
    k => pack("H*","d74d8d7555950da79ef84d6df91c1546bba5fff7735253f68b7dcef0ebefc364"),
  },
)


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMx3fwTZWJAsPHKa5sRIniw8oUJGo3s+9VjFXJftjO2foAoGCCqGSM49
',
###             'AwEHoUQDQgAEdk7VvZvFuKqYmcG0cMGWaVU0eaKGYITm6jau9tOfna6FVZkAjrrd
',
###             'fEMKjY3G3egN9nwhQbBSawEGK0DcleMZnA==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMx3fwTZWJAsPHKa5sRIniw8oUJGo3s+9VjFXJftjO2foAoGCCqGSM49
',
###             'AwEHoUQDQgAEdk7VvZvFuKqYmcG0cMGWaVU0eaKGYITm6jau9tOfna6FVZkAjrrd
',
###             'fEMKjY3G3egN9nwhQbBSawEGK0DcleMZnA==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhcQFqve/+lSidz+IGZx8fffWXJWj
',
###           'oabp57GIL88mLO5sebJwZTv1zMvLeFyu4U4YWqnKLRcI/A8Qcf3v/dGbQQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhcQFqve/+lSidz+IGZx8fffWXJWj
',
###           'oabp57GIL88mLO5sebJwZTv1zMvLeFyu4U4YWqnKLRcI/A8Qcf3v/dGbQQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'be5d9631013ee60e2fdb48e94dcadac4cab6a150a858fdcffdf94be46fb23e6d'
### z: 'be5d9631013ee60e2fdb48e94dcadac4cab6a150a858fdcffdf94be46fb23e6d'


### read message pattern: 'se'
### read message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhcQFqve/+lSidz+IGZx8fffWXJWj
',
###           'oabp57GIL88mLO5sebJwZTv1zMvLeFyu4U4YWqnKLRcI/A8Qcf3v/dGbQQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhcQFqve/+lSidz+IGZx8fffWXJWj
',
###           'oabp57GIL88mLO5sebJwZTv1zMvLeFyu4U4YWqnKLRcI/A8Qcf3v/dGbQQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '8fdb77887037f0519a42ab18069cffcc33b41e197400188d0fa69d2525bdffad'
### z: '8fdb77887037f0519a42ab18069cffcc33b41e197400188d0fa69d2525bdffad'


### noise decrypt
### noise decrypt
### key: '4fc6a8cc119f4796ef3ec634b0d063ea7cc15b23fbc9ef297527e044601ecd19'
### key: '4fc6a8cc119f4796ef3ec634b0d063ea7cc15b23fbc9ef297527e044601ecd19'
### iv: '6d063887cf061d468eeba1b0'
### iv: '6d063887cf061d468eeba1b0'
### aad: '83f904b2b90793df224ce75021e7c573c28b0085e61be70c84787f4b1b749305'
### aad: '83f904b2b90793df224ce75021e7c573c28b0085e61be70c84787f4b1b749305'
### cipherinfo: '834a31363136393034343134509095609ae2a0ac71a4abc3a8d4214641488d96ef1ef77d30fb'
### cipherinfo: '834a31363136393034343134509095609ae2a0ac71a4abc3a8d4214641488d96ef1ef77d30fb'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '5c3009b1f6362972bfdfa1b0'
### iv_xor: '5c3009b1f6362972bfdfa1b0'
### authtag: '9095609ae2a0ac71a4abc3a8d4214641'
### authtag: '9095609ae2a0ac71a4abc3a8d4214641'
### ciphertext: '8d96ef1ef77d30fb'
### ciphertext: '8d96ef1ef77d30fb'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02764ed5bd9bc5b8aa9899c1b470c19669553479a2866084e6ea36aef6d39f9dae"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","0385c405aaf7bffa54a2773f88199c7c7df7d65c95a3a1a6e9e7b1882fcf262cee"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","2929940322e1b6d0a57e6b8d21b4275f882bfc2cef73fba8a6733d48296b75f6"),
                                h => pack("H*","3d45c7a27bbeab5b685615a15c4c6a1827a76c616f18fdb0b272b2294442f77f"),
                                hasK => 1,
                                k => pack("H*","6436bb15464356389a7693474fb9a02f2115deb50f5515783220aa5ff893dbab"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","2af2e697f756c056bf29ef1af7b26f753c3abfe6850e299d3eaabe706bdd58de"),
  },
  {
    hasK => 1,
    k => pack("H*","d74d8d7555950da79ef84d6df91c1546bba5fff7735253f68b7dcef0ebefc364"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02764ed5bd9bc5b8aa9899c1b470c19669553479a2866084e6ea36aef6d39f9dae"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IK_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","0385c405aaf7bffa54a2773f88199c7c7df7d65c95a3a1a6e9e7b1882fcf262cee"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","2929940322e1b6d0a57e6b8d21b4275f882bfc2cef73fba8a6733d48296b75f6"),
                                h => pack("H*","3d45c7a27bbeab5b685615a15c4c6a1827a76c616f18fdb0b272b2294442f77f"),
                                hasK => 1,
                                k => pack("H*","6436bb15464356389a7693474fb9a02f2115deb50f5515783220aa5ff893dbab"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","2af2e697f756c056bf29ef1af7b26f753c3abfe6850e299d3eaabe706bdd58de"),
  },
  {
    hasK => 1,
    k => pack("H*","d74d8d7555950da79ef84d6df91c1546bba5fff7735253f68b7dcef0ebefc364"),
  },
)


### a send comm msg to b
### a send comm msg to b

### noise encrypt

### noise encrypt
### key: 'bba4f1ab48b1ac5efa765ed0a105b68533280f8d7295a854962d122765a431bb'
### key: 'bba4f1ab48b1ac5efa765ed0a105b68533280f8d7295a854962d122765a431bb'
### iv: '2a74c95707655f94be346f7f'
### iv: '2a74c95707655f94be346f7f'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '1b42f8613e556ba08f006f7f'
### iv_xor: '1b42f8613e556ba08f006f7f'
### aad: '3d45c7a27bbeab5b685615a15c4c6a1827a76c616f18fdb0b272b2294442f77f'
### aad: '3d45c7a27bbeab5b685615a15c4c6a1827a76c616f18fdb0b272b2294442f77f'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '652ba23076ef6aca13d8262b261ed920d40d4b5b5ec161d652f06e9f399e435b4438626c9522c0be4c9f9b8ee832db0e100fdc'
### ciphertext: '652ba23076ef6aca13d8262b261ed920d40d4b5b5ec161d652f06e9f399e435b4438626c9522c0be4c9f9b8ee832db0e100fdc'
### authtag: '78d794b66a75b38963f0b4bcbeb4bc2c'
### authtag: '78d794b66a75b38963f0b4bcbeb4bc2c'
### cipherinfo: '834a313631363930343431345078d794b66a75b38963f0b4bcbeb4bc2c5833652ba23076ef6aca13d8262b261ed920d40d4b5b5ec161d652f06e9f399e435b4438626c9522c0be4c9f9b8ee832db0e100fdc'
### cipherinfo: '834a313631363930343431345078d794b66a75b38963f0b4bcbeb4bc2c5833652ba23076ef6aca13d8262b261ed920d40d4b5b5ec161d652f06e9f399e435b4438626c9522c0be4c9f9b8ee832db0e100fdc'

### b recv comm msg from a

### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: 'bba4f1ab48b1ac5efa765ed0a105b68533280f8d7295a854962d122765a431bb'
### key: 'bba4f1ab48b1ac5efa765ed0a105b68533280f8d7295a854962d122765a431bb'
### iv: '2a74c95707655f94be346f7f'
### iv: '2a74c95707655f94be346f7f'
### aad: '3d45c7a27bbeab5b685615a15c4c6a1827a76c616f18fdb0b272b2294442f77f'
### aad: '3d45c7a27bbeab5b685615a15c4c6a1827a76c616f18fdb0b272b2294442f77f'
### cipherinfo: '834a313631363930343431345078d794b66a75b38963f0b4bcbeb4bc2c5833652ba23076ef6aca13d8262b261ed920d40d4b5b5ec161d652f06e9f399e435b4438626c9522c0be4c9f9b8ee832db0e100fdc'
### cipherinfo: '834a313631363930343431345078d794b66a75b38963f0b4bcbeb4bc2c5833652ba23076ef6aca13d8262b261ed920d40d4b5b5ec161d652f06e9f399e435b4438626c9522c0be4c9f9b8ee832db0e100fdc'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '1b42f8613e556ba08f006f7f'
### iv_xor: '1b42f8613e556ba08f006f7f'
### authtag: '78d794b66a75b38963f0b4bcbeb4bc2c'
### authtag: '78d794b66a75b38963f0b4bcbeb4bc2c'
### ciphertext: '652ba23076ef6aca13d8262b261ed920d40d4b5b5ec161d652f06e9f399e435b4438626c9522c0be4c9f9b8ee832db0e100fdc'
### ciphertext: '652ba23076ef6aca13d8262b261ed920d40d4b5b5ec161d652f06e9f399e435b4438626c9522c0be4c9f9b8ee832db0e100fdc'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: 'f747e7823b11ef2089734c168fdfb7ee59ffb8b620d28163385db628eeaea106'
### key: 'f747e7823b11ef2089734c168fdfb7ee59ffb8b620d28163385db628eeaea106'
### iv: '0030b83a070f77f31388a6f0'
### iv: '0030b83a070f77f31388a6f0'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '3106890c3e3f43c722bca6f0'
### iv_xor: '3106890c3e3f43c722bca6f0'
### aad: '3d45c7a27bbeab5b685615a15c4c6a1827a76c616f18fdb0b272b2294442f77f'
### aad: '3d45c7a27bbeab5b685615a15c4c6a1827a76c616f18fdb0b272b2294442f77f'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '5b56141e778405671786b76a24ba14b120fcf997d5313ce5e41420027f897f06c76034a0aa8960892c0ea24e77aced'
### ciphertext: '5b56141e778405671786b76a24ba14b120fcf997d5313ce5e41420027f897f06c76034a0aa8960892c0ea24e77aced'
### authtag: '6a86948b0afe054730b8ec37aa29ebf9'
### authtag: '6a86948b0afe054730b8ec37aa29ebf9'
### cipherinfo: '834a31363136393034343134506a86948b0afe054730b8ec37aa29ebf9582f5b56141e778405671786b76a24ba14b120fcf997d5313ce5e41420027f897f06c76034a0aa8960892c0ea24e77aced'
### cipherinfo: '834a31363136393034343134506a86948b0afe054730b8ec37aa29ebf9582f5b56141e778405671786b76a24ba14b120fcf997d5313ce5e41420027f897f06c76034a0aa8960892c0ea24e77aced'


### a recv comm msg from b
### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: 'f747e7823b11ef2089734c168fdfb7ee59ffb8b620d28163385db628eeaea106'
### key: 'f747e7823b11ef2089734c168fdfb7ee59ffb8b620d28163385db628eeaea106'
### iv: '0030b83a070f77f31388a6f0'
### iv: '0030b83a070f77f31388a6f0'
### aad: '3d45c7a27bbeab5b685615a15c4c6a1827a76c616f18fdb0b272b2294442f77f'
### aad: '3d45c7a27bbeab5b685615a15c4c6a1827a76c616f18fdb0b272b2294442f77f'
### cipherinfo: '834a31363136393034343134506a86948b0afe054730b8ec37aa29ebf9582f5b56141e778405671786b76a24ba14b120fcf997d5313ce5e41420027f897f06c76034a0aa8960892c0ea24e77aced'
### cipherinfo: '834a31363136393034343134506a86948b0afe054730b8ec37aa29ebf9582f5b56141e778405671786b76a24ba14b120fcf997d5313ce5e41420027f897f06c76034a0aa8960892c0ea24e77aced'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '3106890c3e3f43c722bca6f0'
### iv_xor: '3106890c3e3f43c722bca6f0'
### authtag: '6a86948b0afe054730b8ec37aa29ebf9'
### authtag: '6a86948b0afe054730b8ec37aa29ebf9'
### ciphertext: '5b56141e778405671786b76a24ba14b120fcf997d5313ce5e41420027f897f06c76034a0aa8960892c0ea24e77aced'
### ciphertext: '5b56141e778405671786b76a24ba14b120fcf997d5313ce5e41420027f897f06c76034a0aa8960892c0ea24e77aced'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'IK',
###                               undef,
###                               undef
### -----------end test --------: 'IK',
###                               undef,
###                               undef


### -----------start test --------: 'IK',
###                                 'test_psk',
###                                 0
### -----------start test --------: 'IK',
###                                 'test_psk',
###                                 0

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IKpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","b53a056c93f9f6b23deea03a295a7cd8f5bb453fd2fb0275ad34d78d2b277951"),
                              h  => pack("H*","2e346b9b945d1240dbd82b6f7c83dd27d20be86ca3a5553f76d84fceccb63a8f"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IKpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","b53a056c93f9f6b23deea03a295a7cd8f5bb453fd2fb0275ad34d78d2b277951"),
                              h  => pack("H*","2e346b9b945d1240dbd82b6f7c83dd27d20be86ca3a5553f76d84fceccb63a8f"),
                            },
  who                    => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'psk'

### write message pattern: 'psk'


### write message pattern: 'e'
### write message pattern: 'e'

### public compressed: '02184c30261541a1d1e3a923cd8c77636c7de4cab9ac0a76d4b16c16201860bdb7'

### public compressed: '02184c30261541a1d1e3a923cd8c77636c7de4cab9ac0a76d4b16c16201860bdb7'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMp+2kSTanCm9BqGIbtvL6Br0UgWwkQQx7Fz8TIT207uoAoGCCqGSM49
',
###             'AwEHoUQDQgAEGEwwJhVBodHjqSPNjHdjbH3kyrmsCnbUsWwWIBhgvbcM8StE4GFi
',
###             'cZ0kHHYolCBzZAJDff/qAiyxHz7xDbZzWg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMp+2kSTanCm9BqGIbtvL6Br0UgWwkQQx7Fz8TIT207uoAoGCCqGSM49
',
###             'AwEHoUQDQgAEGEwwJhVBodHjqSPNjHdjbH3kyrmsCnbUsWwWIBhgvbcM8StE4GFi
',
###             'cZ0kHHYolCBzZAJDff/qAiyxHz7xDbZzWg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'a6f43312f2e1eb9543eee48963f6e30ecd05daa26ce3c711ac1ca6bf45aaec23'
### z: 'a6f43312f2e1eb9543eee48963f6e30ecd05daa26ce3c711ac1ca6bf45aaec23'


### write message pattern: 's'
### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '6aab729ca1e36ad26253631514298aead8fc7c001499729a71fca1cafe7ec054'
### key: '6aab729ca1e36ad26253631514298aead8fc7c001499729a71fca1cafe7ec054'
### iv: 'afbc6c61d1c0afa4cfdfa178'
### iv: 'afbc6c61d1c0afa4cfdfa178'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '9e8a5d57e8f09b90feeba178'
### iv_xor: '9e8a5d57e8f09b90feeba178'
### aad: '7740155ba90d798ac874189795cf0896d5e1ca31d218e25216cf538fc46e3ff2'
### aad: '7740155ba90d798ac874189795cf0896d5e1ca31d218e25216cf538fc46e3ff2'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: 'f2b5b3f849b34c3325b578808dd24ec839388a8c88f8eb9a42c336fafbf0746d2c15831b0f670bb9'
### ciphertext: 'f2b5b3f849b34c3325b578808dd24ec839388a8c88f8eb9a42c336fafbf0746d2c15831b0f670bb9'
### authtag: '6769a74f719903bd6213568a3a1bafbf'
### authtag: '6769a74f719903bd6213568a3a1bafbf'
### cipherinfo: '834a31363136393034343134506769a74f719903bd6213568a3a1bafbf5828f2b5b3f849b34c3325b578808dd24ec839388a8c88f8eb9a42c336fafbf0746d2c15831b0f670bb9'
### cipherinfo: '834a31363136393034343134506769a74f719903bd6213568a3a1bafbf5828f2b5b3f849b34c3325b578808dd24ec839388a8c88f8eb9a42c336fafbf0746d2c15831b0f670bb9'


### write message pattern: 'ss'
### write message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### noise encrypt
### noise encrypt
### key: '641fca6f03a5a633b02b703940840acd1e13110765047497460fbcf449f3ae43'
### key: '641fca6f03a5a633b02b703940840acd1e13110765047497460fbcf449f3ae43'
### iv: '49e0bd591eedbc03ca846b99'
### iv: '49e0bd591eedbc03ca846b99'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '78d68c6f27dd8837fbb06b99'
### iv_xor: '78d68c6f27dd8837fbb06b99'
### aad: '57e01d70d381f634be4648934a23a99cc5efb7413d4ec732e75ac4d850bd3ac8'
### aad: '57e01d70d381f634be4648934a23a99cc5efb7413d4ec732e75ac4d850bd3ac8'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '4edfc38df5659f27'
### ciphertext: '4edfc38df5659f27'
### authtag: 'ecc54b69cd8f60b1435751b69cb84589'
### authtag: 'ecc54b69cd8f60b1435751b69cb84589'
### cipherinfo: '834a3136313639303434313450ecc54b69cd8f60b1435751b69cb84589484edfc38df5659f27'
### cipherinfo: '834a3136313639303434313450ecc54b69cd8f60b1435751b69cb84589484edfc38df5659f27'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghAhhMMCYVQaHR46kjzYx3Y2x95Mq5rAp21LFsFiAYYL23WEeDSjE2MTY5MDQ0MTRQZ2mnT3GZA71iE1aKOhuvv1go8rWz+EmzTDMltXiAjdJOyDk4ioyI+OuaQsM2+vvwdG0sFYMbD2cLuVgmg0oxNjE2OTA0NDE0UOzFS2nNj2CxQ1dRtpy4RYlITt/DjfVlnyc="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghAhhMMCYVQaHR46kjzYx3Y2x95Mq5rAp21LFsFiAYYL23WEeDSjE2MTY5MDQ0MTRQZ2mnT3GZA71iE1aKOhuvv1go8rWz+EmzTDMltXiAjdJOyDk4ioyI+OuaQsM2+vvwdG0sFYMbD2cLuVgmg0oxNjE2OTA0NDE0UOzFS2nNj2CxQ1dRtpy4RYlITt/DjfVlnyc="),
  );
}
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02184c30261541a1d1e3a923cd8c77636c7de4cab9ac0a76d4b16c16201860bdb7"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","e333d3526286344605ba7bd3c37044c555c053a05215fd0edd57f427a4be6e82"),
                                h => pack("H*","a0ee3c301b83f4d4033579a70f28317a90a39f4fc9b4ac59369877c245eddcca"),
                                hasK => 1,
                                k => pack("H*","a18a28b93ebd71acf9627cb5acf7f7ac8d5ddef71ae9539d84a62fbcbe7d6519"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02184c30261541a1d1e3a923cd8c77636c7de4cab9ac0a76d4b16c16201860bdb7"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","e333d3526286344605ba7bd3c37044c555c053a05215fd0edd57f427a4be6e82"),
                                h => pack("H*","a0ee3c301b83f4d4033579a70f28317a90a39f4fc9b4ac59369877c245eddcca"),
                                hasK => 1,
                                k => pack("H*","a18a28b93ebd71acf9627cb5acf7f7ac8d5ddef71ae9539d84a62fbcbe7d6519"),
                              },
    who                    => "a",
  },
)


### b read message from a
### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IKpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","b53a056c93f9f6b23deea03a295a7cd8f5bb453fd2fb0275ad34d78d2b277951"),
                              h  => pack("H*","2e346b9b945d1240dbd82b6f7c83dd27d20be86ca3a5553f76d84fceccb63a8f"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IKpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","b53a056c93f9f6b23deea03a295a7cd8f5bb453fd2fb0275ad34d78d2b277951"),
                              h  => pack("H*","2e346b9b945d1240dbd82b6f7c83dd27d20be86ca3a5553f76d84fceccb63a8f"),
                            },
  who                    => "b",
}

### b recv msg from a

### b recv msg from a


### read message pattern: 'psk'
### read message pattern: 'psk'

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEGEwwJhVBodHjqSPNjHdjbH3kyrms
',
###           'CnbUsWwWIBhgvbcM8StE4GFicZ0kHHYolCBzZAJDff/qAiyxHz7xDbZzWg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEGEwwJhVBodHjqSPNjHdjbH3kyrms
',
###           'CnbUsWwWIBhgvbcM8StE4GFicZ0kHHYolCBzZAJDff/qAiyxHz7xDbZzWg==
',
###           '-----END PUBLIC KEY-----
'
### z: 'a6f43312f2e1eb9543eee48963f6e30ecd05daa26ce3c711ac1ca6bf45aaec23'
### z: 'a6f43312f2e1eb9543eee48963f6e30ecd05daa26ce3c711ac1ca6bf45aaec23'


### read message pattern: 's'
### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: '6aab729ca1e36ad26253631514298aead8fc7c001499729a71fca1cafe7ec054'
### key: '6aab729ca1e36ad26253631514298aead8fc7c001499729a71fca1cafe7ec054'
### iv: 'afbc6c61d1c0afa4cfdfa178'
### iv: 'afbc6c61d1c0afa4cfdfa178'
### aad: '7740155ba90d798ac874189795cf0896d5e1ca31d218e25216cf538fc46e3ff2'
### aad: '7740155ba90d798ac874189795cf0896d5e1ca31d218e25216cf538fc46e3ff2'
### cipherinfo: '834a31363136393034343134506769a74f719903bd6213568a3a1bafbf5828f2b5b3f849b34c3325b578808dd24ec839388a8c88f8eb9a42c336fafbf0746d2c15831b0f670bb9'
### cipherinfo: '834a31363136393034343134506769a74f719903bd6213568a3a1bafbf5828f2b5b3f849b34c3325b578808dd24ec839388a8c88f8eb9a42c336fafbf0746d2c15831b0f670bb9'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '9e8a5d57e8f09b90feeba178'
### iv_xor: '9e8a5d57e8f09b90feeba178'
### authtag: '6769a74f719903bd6213568a3a1bafbf'
### authtag: '6769a74f719903bd6213568a3a1bafbf'
### ciphertext: 'f2b5b3f849b34c3325b578808dd24ec839388a8c88f8eb9a42c336fafbf0746d2c15831b0f670bb9'
### ciphertext: 'f2b5b3f849b34c3325b578808dd24ec839388a8c88f8eb9a42c336fafbf0746d2c15831b0f670bb9'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'


### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### read message pattern: 'ss'

### read message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'

### noise decrypt

### noise decrypt
### key: '641fca6f03a5a633b02b703940840acd1e13110765047497460fbcf449f3ae43'
### key: '641fca6f03a5a633b02b703940840acd1e13110765047497460fbcf449f3ae43'
### iv: '49e0bd591eedbc03ca846b99'
### iv: '49e0bd591eedbc03ca846b99'
### aad: '57e01d70d381f634be4648934a23a99cc5efb7413d4ec732e75ac4d850bd3ac8'
### aad: '57e01d70d381f634be4648934a23a99cc5efb7413d4ec732e75ac4d850bd3ac8'
### cipherinfo: '834a3136313639303434313450ecc54b69cd8f60b1435751b69cb84589484edfc38df5659f27'
### cipherinfo: '834a3136313639303434313450ecc54b69cd8f60b1435751b69cb84589484edfc38df5659f27'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '78d68c6f27dd8837fbb06b99'
### iv_xor: '78d68c6f27dd8837fbb06b99'
### authtag: 'ecc54b69cd8f60b1435751b69cb84589'
### authtag: 'ecc54b69cd8f60b1435751b69cb84589'
### ciphertext: '4edfc38df5659f27'
### ciphertext: '4edfc38df5659f27'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","02184c30261541a1d1e3a923cd8c77636c7de4cab9ac0a76d4b16c16201860bdb7"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","e333d3526286344605ba7bd3c37044c555c053a05215fd0edd57f427a4be6e82"),
                                h => pack("H*","a0ee3c301b83f4d4033579a70f28317a90a39f4fc9b4ac59369877c245eddcca"),
                                hasK => 1,
                                k => pack("H*","a18a28b93ebd71acf9627cb5acf7f7ac8d5ddef71ae9539d84a62fbcbe7d6519"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","02184c30261541a1d1e3a923cd8c77636c7de4cab9ac0a76d4b16c16201860bdb7"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","e333d3526286344605ba7bd3c37044c555c053a05215fd0edd57f427a4be6e82"),
                                h => pack("H*","a0ee3c301b83f4d4033579a70f28317a90a39f4fc9b4ac59369877c245eddcca"),
                                hasK => 1,
                                k => pack("H*","a18a28b93ebd71acf9627cb5acf7f7ac8d5ddef71ae9539d84a62fbcbe7d6519"),
                              },
    who                    => "b",
  },
)


### b write_message to a
### b write_message to a
### b send msg to a
### b send msg to a


### write message pattern: 'e'
### write message pattern: 'e'


### public compressed: '029ba3bee94087bb72eec905e47eafd69e983ea3eba76dfbb0d7919f77f4e5609d'
### public compressed: '029ba3bee94087bb72eec905e47eafd69e983ea3eba76dfbb0d7919f77f4e5609d'


### write message pattern: 'ee'
### write message pattern: 'ee'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIEse1vGyHChHtsJ7E+Cu6RZlwiBsrFGsJY7XBd3BMuadoAoGCCqGSM49
',
###             'AwEHoUQDQgAEm6O+6UCHu3LuyQXkfq/Wnpg+o+unbfuw15Gfd/TlYJ0WaO0PogBE
',
###             'qTXpPTuEkF8QCxEeKVQmG7qdgk9hxMMChA==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIEse1vGyHChHtsJ7E+Cu6RZlwiBsrFGsJY7XBd3BMuadoAoGCCqGSM49
',
###             'AwEHoUQDQgAEm6O+6UCHu3LuyQXkfq/Wnpg+o+unbfuw15Gfd/TlYJ0WaO0PogBE
',
###             'qTXpPTuEkF8QCxEeKVQmG7qdgk9hxMMChA==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEGEwwJhVBodHjqSPNjHdjbH3kyrms
',
###           'CnbUsWwWIBhgvbcM8StE4GFicZ0kHHYolCBzZAJDff/qAiyxHz7xDbZzWg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEGEwwJhVBodHjqSPNjHdjbH3kyrms
',
###           'CnbUsWwWIBhgvbcM8StE4GFicZ0kHHYolCBzZAJDff/qAiyxHz7xDbZzWg==
',
###           '-----END PUBLIC KEY-----
'
### z: '79524fd4bbb403de1339b20a58fd213709820c25190ff8f7eaefa05511047782'
### z: '79524fd4bbb403de1339b20a58fd213709820c25190ff8f7eaefa05511047782'


### write message pattern: 'se'
### write message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIEse1vGyHChHtsJ7E+Cu6RZlwiBsrFGsJY7XBd3BMuadoAoGCCqGSM49
',
###             'AwEHoUQDQgAEm6O+6UCHu3LuyQXkfq/Wnpg+o+unbfuw15Gfd/TlYJ0WaO0PogBE
',
###             'qTXpPTuEkF8QCxEeKVQmG7qdgk9hxMMChA==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIEse1vGyHChHtsJ7E+Cu6RZlwiBsrFGsJY7XBd3BMuadoAoGCCqGSM49
',
###             'AwEHoUQDQgAEm6O+6UCHu3LuyQXkfq/Wnpg+o+unbfuw15Gfd/TlYJ0WaO0PogBE
',
###             'qTXpPTuEkF8QCxEeKVQmG7qdgk9hxMMChA==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '5737baeae21e41e3f75946921812850f586eb42ae6bb7d9cc01c2ff1e77350e0'
### z: '5737baeae21e41e3f75946921812850f586eb42ae6bb7d9cc01c2ff1e77350e0'


### noise encrypt
### noise encrypt
### key: '4f5d3d512a8e621717500314698fced13862ba10404bda69188aeecd468fe1e7'
### key: '4f5d3d512a8e621717500314698fced13862ba10404bda69188aeecd468fe1e7'
### iv: '6a50621aa027685dd313be2d'
### iv: '6a50621aa027685dd313be2d'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '5b66532c99175c69e227be2d'
### iv_xor: '5b66532c99175c69e227be2d'
### aad: 'b2826d91fb491416a2d58e59c01adedc93ef3e2abc7d8c87b3653e24e35c4ea6'
### aad: 'b2826d91fb491416a2d58e59c01adedc93ef3e2abc7d8c87b3653e24e35c4ea6'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '6040df3b0fcfc579'
### ciphertext: '6040df3b0fcfc579'
### authtag: 'b6236561665edf478346158805e3023f'
### authtag: 'b6236561665edf478346158805e3023f'
### cipherinfo: '834a3136313639303434313450b6236561665edf478346158805e3023f486040df3b0fcfc579'
### cipherinfo: '834a3136313639303434313450b6236561665edf478346158805e3023f486040df3b0fcfc579'


### b_msg: '825821029ba3bee94087bb72eec905e47eafd69e983ea3eba76dfbb0d7919f77f4e5609d5826834a3136313639303434313450b6236561665edf478346158805e3023f486040df3b0fcfc579'
### b_msg: '825821029ba3bee94087bb72eec905e47eafd69e983ea3eba76dfbb0d7919f77f4e5609d5826834a3136313639303434313450b6236561665edf478346158805e3023f486040df3b0fcfc579'
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","029ba3bee94087bb72eec905e47eafd69e983ea3eba76dfbb0d7919f77f4e5609d"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","02184c30261541a1d1e3a923cd8c77636c7de4cab9ac0a76d4b16c16201860bdb7"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","5cdf0acaea927a1e7aaa5b920f14e613f40c7d00fbd8f72317cf8591cb095e4a"),
                                h => pack("H*","6a0a26052fe6e080b5bdde32a4acdfba392adf02c5afc37001ecc1150a442458"),
                                hasK => 1,
                                k => pack("H*","69eac3ba8b4bfd836b73ba7ebf92f9764f243b3443e9b685abd00173863789d6"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","21f7880992b126af85d16874ec6c1cc40a9e4c241432ac7d891a5a986614d988"),
  },
  {
    hasK => 1,
    k => pack("H*","ae0075dd35e9cb9bbc12e23f5c0caf02f4de2f2bf90a1c930a79034c53b2852c"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","029ba3bee94087bb72eec905e47eafd69e983ea3eba76dfbb0d7919f77f4e5609d"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","02184c30261541a1d1e3a923cd8c77636c7de4cab9ac0a76d4b16c16201860bdb7"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","5cdf0acaea927a1e7aaa5b920f14e613f40c7d00fbd8f72317cf8591cb095e4a"),
                                h => pack("H*","6a0a26052fe6e080b5bdde32a4acdfba392adf02c5afc37001ecc1150a442458"),
                                hasK => 1,
                                k => pack("H*","69eac3ba8b4bfd836b73ba7ebf92f9764f243b3443e9b685abd00173863789d6"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","21f7880992b126af85d16874ec6c1cc40a9e4c241432ac7d891a5a986614d988"),
  },
  {
    hasK => 1,
    k => pack("H*","ae0075dd35e9cb9bbc12e23f5c0caf02f4de2f2bf90a1c930a79034c53b2852c"),
  },
)


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMp+2kSTanCm9BqGIbtvL6Br0UgWwkQQx7Fz8TIT207uoAoGCCqGSM49
',
###             'AwEHoUQDQgAEGEwwJhVBodHjqSPNjHdjbH3kyrmsCnbUsWwWIBhgvbcM8StE4GFi
',
###             'cZ0kHHYolCBzZAJDff/qAiyxHz7xDbZzWg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIMp+2kSTanCm9BqGIbtvL6Br0UgWwkQQx7Fz8TIT207uoAoGCCqGSM49
',
###             'AwEHoUQDQgAEGEwwJhVBodHjqSPNjHdjbH3kyrmsCnbUsWwWIBhgvbcM8StE4GFi
',
###             'cZ0kHHYolCBzZAJDff/qAiyxHz7xDbZzWg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEm6O+6UCHu3LuyQXkfq/Wnpg+o+un
',
###           'bfuw15Gfd/TlYJ0WaO0PogBEqTXpPTuEkF8QCxEeKVQmG7qdgk9hxMMChA==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEm6O+6UCHu3LuyQXkfq/Wnpg+o+un
',
###           'bfuw15Gfd/TlYJ0WaO0PogBEqTXpPTuEkF8QCxEeKVQmG7qdgk9hxMMChA==
',
###           '-----END PUBLIC KEY-----
'
### z: '79524fd4bbb403de1339b20a58fd213709820c25190ff8f7eaefa05511047782'
### z: '79524fd4bbb403de1339b20a58fd213709820c25190ff8f7eaefa05511047782'


### read message pattern: 'se'
### read message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEm6O+6UCHu3LuyQXkfq/Wnpg+o+un
',
###           'bfuw15Gfd/TlYJ0WaO0PogBEqTXpPTuEkF8QCxEeKVQmG7qdgk9hxMMChA==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEm6O+6UCHu3LuyQXkfq/Wnpg+o+un
',
###           'bfuw15Gfd/TlYJ0WaO0PogBEqTXpPTuEkF8QCxEeKVQmG7qdgk9hxMMChA==
',
###           '-----END PUBLIC KEY-----
'
### z: '5737baeae21e41e3f75946921812850f586eb42ae6bb7d9cc01c2ff1e77350e0'
### z: '5737baeae21e41e3f75946921812850f586eb42ae6bb7d9cc01c2ff1e77350e0'


### noise decrypt
### noise decrypt
### key: '4f5d3d512a8e621717500314698fced13862ba10404bda69188aeecd468fe1e7'
### key: '4f5d3d512a8e621717500314698fced13862ba10404bda69188aeecd468fe1e7'
### iv: '6a50621aa027685dd313be2d'
### iv: '6a50621aa027685dd313be2d'
### aad: 'b2826d91fb491416a2d58e59c01adedc93ef3e2abc7d8c87b3653e24e35c4ea6'
### aad: 'b2826d91fb491416a2d58e59c01adedc93ef3e2abc7d8c87b3653e24e35c4ea6'
### cipherinfo: '834a3136313639303434313450b6236561665edf478346158805e3023f486040df3b0fcfc579'
### cipherinfo: '834a3136313639303434313450b6236561665edf478346158805e3023f486040df3b0fcfc579'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '5b66532c99175c69e227be2d'
### iv_xor: '5b66532c99175c69e227be2d'
### authtag: 'b6236561665edf478346158805e3023f'
### authtag: 'b6236561665edf478346158805e3023f'
### ciphertext: '6040df3b0fcfc579'
### ciphertext: '6040df3b0fcfc579'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02184c30261541a1d1e3a923cd8c77636c7de4cab9ac0a76d4b16c16201860bdb7"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","029ba3bee94087bb72eec905e47eafd69e983ea3eba76dfbb0d7919f77f4e5609d"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","5cdf0acaea927a1e7aaa5b920f14e613f40c7d00fbd8f72317cf8591cb095e4a"),
                                h => pack("H*","6a0a26052fe6e080b5bdde32a4acdfba392adf02c5afc37001ecc1150a442458"),
                                hasK => 1,
                                k => pack("H*","69eac3ba8b4bfd836b73ba7ebf92f9764f243b3443e9b685abd00173863789d6"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","21f7880992b126af85d16874ec6c1cc40a9e4c241432ac7d891a5a986614d988"),
  },
  {
    hasK => 1,
    k => pack("H*","ae0075dd35e9cb9bbc12e23f5c0caf02f4de2f2bf90a1c930a79034c53b2852c"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02184c30261541a1d1e3a923cd8c77636c7de4cab9ac0a76d4b16c16201860bdb7"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "es", "s", "ss"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IKpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","029ba3bee94087bb72eec905e47eafd69e983ea3eba76dfbb0d7919f77f4e5609d"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","5cdf0acaea927a1e7aaa5b920f14e613f40c7d00fbd8f72317cf8591cb095e4a"),
                                h => pack("H*","6a0a26052fe6e080b5bdde32a4acdfba392adf02c5afc37001ecc1150a442458"),
                                hasK => 1,
                                k => pack("H*","69eac3ba8b4bfd836b73ba7ebf92f9764f243b3443e9b685abd00173863789d6"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","21f7880992b126af85d16874ec6c1cc40a9e4c241432ac7d891a5a986614d988"),
  },
  {
    hasK => 1,
    k => pack("H*","ae0075dd35e9cb9bbc12e23f5c0caf02f4de2f2bf90a1c930a79034c53b2852c"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '6cf471efd4a76da7e462dd93b1c40a065c53b267eb529a9141f3bdffa7087813'
### key: '6cf471efd4a76da7e462dd93b1c40a065c53b267eb529a9141f3bdffa7087813'
### iv: '4a8a990016980c7aea0f36a9'
### iv: '4a8a990016980c7aea0f36a9'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '7bbca8362fa8384edb3b36a9'
### iv_xor: '7bbca8362fa8384edb3b36a9'
### aad: '6a0a26052fe6e080b5bdde32a4acdfba392adf02c5afc37001ecc1150a442458'
### aad: '6a0a26052fe6e080b5bdde32a4acdfba392adf02c5afc37001ecc1150a442458'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '5666bee16c129119e77521092a91b8fcba4da32fa3b25452b6b7fbda595a2fceb276da6529dccc24c4e827629e8baf9b32d9f1'
### ciphertext: '5666bee16c129119e77521092a91b8fcba4da32fa3b25452b6b7fbda595a2fceb276da6529dccc24c4e827629e8baf9b32d9f1'
### authtag: 'ddc573796d0eb274a70099bf6eae94cf'
### authtag: 'ddc573796d0eb274a70099bf6eae94cf'
### cipherinfo: '834a3136313639303434313450ddc573796d0eb274a70099bf6eae94cf58335666bee16c129119e77521092a91b8fcba4da32fa3b25452b6b7fbda595a2fceb276da6529dccc24c4e827629e8baf9b32d9f1'
### cipherinfo: '834a3136313639303434313450ddc573796d0eb274a70099bf6eae94cf58335666bee16c129119e77521092a91b8fcba4da32fa3b25452b6b7fbda595a2fceb276da6529dccc24c4e827629e8baf9b32d9f1'


### b recv comm msg from a
### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '6cf471efd4a76da7e462dd93b1c40a065c53b267eb529a9141f3bdffa7087813'
### key: '6cf471efd4a76da7e462dd93b1c40a065c53b267eb529a9141f3bdffa7087813'
### iv: '4a8a990016980c7aea0f36a9'
### iv: '4a8a990016980c7aea0f36a9'
### aad: '6a0a26052fe6e080b5bdde32a4acdfba392adf02c5afc37001ecc1150a442458'
### aad: '6a0a26052fe6e080b5bdde32a4acdfba392adf02c5afc37001ecc1150a442458'
### cipherinfo: '834a3136313639303434313450ddc573796d0eb274a70099bf6eae94cf58335666bee16c129119e77521092a91b8fcba4da32fa3b25452b6b7fbda595a2fceb276da6529dccc24c4e827629e8baf9b32d9f1'
### cipherinfo: '834a3136313639303434313450ddc573796d0eb274a70099bf6eae94cf58335666bee16c129119e77521092a91b8fcba4da32fa3b25452b6b7fbda595a2fceb276da6529dccc24c4e827629e8baf9b32d9f1'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '7bbca8362fa8384edb3b36a9'
### iv_xor: '7bbca8362fa8384edb3b36a9'
### authtag: 'ddc573796d0eb274a70099bf6eae94cf'
### authtag: 'ddc573796d0eb274a70099bf6eae94cf'
### ciphertext: '5666bee16c129119e77521092a91b8fcba4da32fa3b25452b6b7fbda595a2fceb276da6529dccc24c4e827629e8baf9b32d9f1'
### ciphertext: '5666bee16c129119e77521092a91b8fcba4da32fa3b25452b6b7fbda595a2fceb276da6529dccc24c4e827629e8baf9b32d9f1'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'


### b to a , plain_b.txt to trans_cipherinfo_b
### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '1d5ee224ac197fea2946317c0669550ea5b7b5ef6bc2940e88d12f12971f4412'
### key: '1d5ee224ac197fea2946317c0669550ea5b7b5ef6bc2940e88d12f12971f4412'
### iv: 'e6d8e62c277c96191af3cfcd'
### iv: 'e6d8e62c277c96191af3cfcd'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'd7eed71a1e4ca22d2bc7cfcd'
### iv_xor: 'd7eed71a1e4ca22d2bc7cfcd'
### aad: '6a0a26052fe6e080b5bdde32a4acdfba392adf02c5afc37001ecc1150a442458'
### aad: '6a0a26052fe6e080b5bdde32a4acdfba392adf02c5afc37001ecc1150a442458'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '8b9dd458184049bf8fff1e35cf909551fd60b03b46e7eea31c018454019333f26c56e0eed206a5151183c5447aa7a4'
### ciphertext: '8b9dd458184049bf8fff1e35cf909551fd60b03b46e7eea31c018454019333f26c56e0eed206a5151183c5447aa7a4'
### authtag: '8ee1d6b4b74d5cf3f9e3728b27cc622d'
### authtag: '8ee1d6b4b74d5cf3f9e3728b27cc622d'
### cipherinfo: '834a31363136393034343134508ee1d6b4b74d5cf3f9e3728b27cc622d582f8b9dd458184049bf8fff1e35cf909551fd60b03b46e7eea31c018454019333f26c56e0eed206a5151183c5447aa7a4'
### cipherinfo: '834a31363136393034343134508ee1d6b4b74d5cf3f9e3728b27cc622d582f8b9dd458184049bf8fff1e35cf909551fd60b03b46e7eea31c018454019333f26c56e0eed206a5151183c5447aa7a4'


### a recv comm msg from b
### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '1d5ee224ac197fea2946317c0669550ea5b7b5ef6bc2940e88d12f12971f4412'
### key: '1d5ee224ac197fea2946317c0669550ea5b7b5ef6bc2940e88d12f12971f4412'
### iv: 'e6d8e62c277c96191af3cfcd'
### iv: 'e6d8e62c277c96191af3cfcd'
### aad: '6a0a26052fe6e080b5bdde32a4acdfba392adf02c5afc37001ecc1150a442458'
### aad: '6a0a26052fe6e080b5bdde32a4acdfba392adf02c5afc37001ecc1150a442458'
### cipherinfo: '834a31363136393034343134508ee1d6b4b74d5cf3f9e3728b27cc622d582f8b9dd458184049bf8fff1e35cf909551fd60b03b46e7eea31c018454019333f26c56e0eed206a5151183c5447aa7a4'
### cipherinfo: '834a31363136393034343134508ee1d6b4b74d5cf3f9e3728b27cc622d582f8b9dd458184049bf8fff1e35cf909551fd60b03b46e7eea31c018454019333f26c56e0eed206a5151183c5447aa7a4'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'd7eed71a1e4ca22d2bc7cfcd'
### iv_xor: 'd7eed71a1e4ca22d2bc7cfcd'
### authtag: '8ee1d6b4b74d5cf3f9e3728b27cc622d'
### authtag: '8ee1d6b4b74d5cf3f9e3728b27cc622d'
### ciphertext: '8b9dd458184049bf8fff1e35cf909551fd60b03b46e7eea31c018454019333f26c56e0eed206a5151183c5447aa7a4'
### ciphertext: '8b9dd458184049bf8fff1e35cf909551fd60b03b46e7eea31c018454019333f26c56e0eed206a5151183c5447aa7a4'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'IK',
###                               'test_psk',
###                               0
### -----------end test --------: 'IK',
###                               'test_psk',
###                               0


### -----------start test --------: 'IK',
###                                 'test_psk',
###                                 1
### -----------start test --------: 'IK',
###                                 'test_psk',
###                                 1

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IKpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","dfe802542cbba7cd505ab5ff533607f16c13c22bcd668861535c5c90fe0d28ce"),
                              h  => pack("H*","5729b083c87dd5a3ea643d1f66ad9eba7ff0933bc94f7c5996dc1dc8e8222297"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IKpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","dfe802542cbba7cd505ab5ff533607f16c13c22bcd668861535c5c90fe0d28ce"),
                              h  => pack("H*","5729b083c87dd5a3ea643d1f66ad9eba7ff0933bc94f7c5996dc1dc8e8222297"),
                            },
  who                    => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '0206cccdc93b68e86e8faa1fd086d627cf1a8268483b3b5a597b6cfc2de75982b9'

### public compressed: '0206cccdc93b68e86e8faa1fd086d627cf1a8268483b3b5a597b6cfc2de75982b9'

### write message pattern: 'es'

### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBq7nTIxH2ClPiLjPyJHnb4AyQMpjkAyOkBO19DnbX3GoAoGCCqGSM49
',
###             'AwEHoUQDQgAEBszNyTto6G6Pqh/QhtYnzxqCaEg7O1pZe2z8LedZgrnlsYtjK6O+
',
###             'Wa50OwNfstRNPdK3F83PLWCVsC3OcEG4wA==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBq7nTIxH2ClPiLjPyJHnb4AyQMpjkAyOkBO19DnbX3GoAoGCCqGSM49
',
###             'AwEHoUQDQgAEBszNyTto6G6Pqh/QhtYnzxqCaEg7O1pZe2z8LedZgrnlsYtjK6O+
',
###             'Wa50OwNfstRNPdK3F83PLWCVsC3OcEG4wA==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '74ef368392dc1e41a2a838b20aa69faaab3905ce67bb9bf4c1a018c111e41c75'
### z: '74ef368392dc1e41a2a838b20aa69faaab3905ce67bb9bf4c1a018c111e41c75'


### write message pattern: 's'
### write message pattern: 's'


### noise encrypt
### noise encrypt
### key: '34a0a1cec722a0386cf9454470e3f7816a3b714fa0c929b136d3ef368f087b05'
### key: '34a0a1cec722a0386cf9454470e3f7816a3b714fa0c929b136d3ef368f087b05'
### iv: '16fab60c6781e3369bf23707'
### iv: '16fab60c6781e3369bf23707'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '27cc873a5eb1d702aac63707'
### iv_xor: '27cc873a5eb1d702aac63707'
### aad: 'a0c63adb3ae8186d363bf11011997c15fd8f4720bdbd5f92107563b67067bcff'
### aad: 'a0c63adb3ae8186d363bf11011997c15fd8f4720bdbd5f92107563b67067bcff'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: 'c31330f3f53cfbc04b988d8c5c141f4e494fe93b5a2d8adfe8ce4cbd62f7adb53bd8433894e5a2ce'
### ciphertext: 'c31330f3f53cfbc04b988d8c5c141f4e494fe93b5a2d8adfe8ce4cbd62f7adb53bd8433894e5a2ce'
### authtag: 'e1a18f430422ecc7c21bedf998e85e27'
### authtag: 'e1a18f430422ecc7c21bedf998e85e27'
### cipherinfo: '834a3136313639303434313450e1a18f430422ecc7c21bedf998e85e275828c31330f3f53cfbc04b988d8c5c141f4e494fe93b5a2d8adfe8ce4cbd62f7adb53bd8433894e5a2ce'
### cipherinfo: '834a3136313639303434313450e1a18f430422ecc7c21bedf998e85e275828c31330f3f53cfbc04b988d8c5c141f4e494fe93b5a2d8adfe8ce4cbd62f7adb53bd8433894e5a2ce'


### write message pattern: 'ss'
### write message pattern: 'ss'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### write message pattern: 'psk'
### write message pattern: 'psk'


### noise encrypt
### noise encrypt
### key: '7a4e603ac1ba1307a6fea4f00d54e521d588551e7553489f57784e75c1afc4b8'
### key: '7a4e603ac1ba1307a6fea4f00d54e521d588551e7553489f57784e75c1afc4b8'
### iv: '5335ee1937d80e5252c78bd7'
### iv: '5335ee1937d80e5252c78bd7'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '6203df2f0ee83a6663f38bd7'
### iv_xor: '6203df2f0ee83a6663f38bd7'
### aad: 'a9eaefb250054d0f1971d468c21bcd66122987889ed0f414585feb3bae3e4493'
### aad: 'a9eaefb250054d0f1971d468c21bcd66122987889ed0f414585feb3bae3e4493'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '79e97b0804a40e39'
### ciphertext: '79e97b0804a40e39'
### authtag: 'd25462d3bf325f3ee480ec4d7463c6ae'
### authtag: 'd25462d3bf325f3ee480ec4d7463c6ae'
### cipherinfo: '834a3136313639303434313450d25462d3bf325f3ee480ec4d7463c6ae4879e97b0804a40e39'
### cipherinfo: '834a3136313639303434313450d25462d3bf325f3ee480ec4d7463c6ae4879e97b0804a40e39'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghAgbMzck7aOhuj6of0IbWJ88agmhIOztaWXts/C3nWYK5WEeDSjE2MTY5MDQ0MTRQ4aGPQwQi7MfCG+35mOheJ1gowxMw8/U8+8BLmI2MXBQfTklP6TtaLYrf6M5MvWL3rbU72EM4lOWizlgmg0oxNjE2OTA0NDE0UNJUYtO/Ml8+5IDsTXRjxq5Ieel7CASkDjk="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghAgbMzck7aOhuj6of0IbWJ88agmhIOztaWXts/C3nWYK5WEeDSjE2MTY5MDQ0MTRQ4aGPQwQi7MfCG+35mOheJ1gowxMw8/U8+8BLmI2MXBQfTklP6TtaLYrf6M5MvWL3rbU72EM4lOWizlgmg0oxNjE2OTA0NDE0UNJUYtO/Ml8+5IDsTXRjxq5Ieel7CASkDjk="),
  );
}
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0206cccdc93b68e86e8faa1fd086d627cf1a8268483b3b5a597b6cfc2de75982b9"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","12d90a516c5ae6330f7745d9983d5378b5b5be3f836eb43fef609d302b91cdfb"),
                                h => pack("H*","bace9e81024d0ba994f9f6fe8431300d4770fff945326870967ffadd8cf855bd"),
                                hasK => 1,
                                k => pack("H*","61f1624ab208416e6dbc314c2fe02a61ad4b4c4bddd1b50849f0945835d36eb5"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0206cccdc93b68e86e8faa1fd086d627cf1a8268483b3b5a597b6cfc2de75982b9"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","12d90a516c5ae6330f7745d9983d5378b5b5be3f836eb43fef609d302b91cdfb"),
                                h => pack("H*","bace9e81024d0ba994f9f6fe8431300d4770fff945326870967ffadd8cf855bd"),
                                hasK => 1,
                                k => pack("H*","61f1624ab208416e6dbc314c2fe02a61ad4b4c4bddd1b50849f0945835d36eb5"),
                              },
    who                    => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IKpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","dfe802542cbba7cd505ab5ff533607f16c13c22bcd668861535c5c90fe0d28ce"),
                              h  => pack("H*","5729b083c87dd5a3ea643d1f66ad9eba7ff0933bc94f7c5996dc1dc8e8222297"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IK",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IKpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","dfe802542cbba7cd505ab5ff533607f16c13c22bcd668861535c5c90fe0d28ce"),
                              h  => pack("H*","5729b083c87dd5a3ea643d1f66ad9eba7ff0933bc94f7c5996dc1dc8e8222297"),
                            },
  who                    => "b",
}


### b recv msg from a
### b recv msg from a


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEBszNyTto6G6Pqh/QhtYnzxqCaEg7
',
###           'O1pZe2z8LedZgrnlsYtjK6O+Wa50OwNfstRNPdK3F83PLWCVsC3OcEG4wA==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEBszNyTto6G6Pqh/QhtYnzxqCaEg7
',
###           'O1pZe2z8LedZgrnlsYtjK6O+Wa50OwNfstRNPdK3F83PLWCVsC3OcEG4wA==
',
###           '-----END PUBLIC KEY-----
'
### z: '74ef368392dc1e41a2a838b20aa69faaab3905ce67bb9bf4c1a018c111e41c75'
### z: '74ef368392dc1e41a2a838b20aa69faaab3905ce67bb9bf4c1a018c111e41c75'


### read message pattern: 's'
### read message pattern: 's'


### noise decrypt
### noise decrypt
### key: '34a0a1cec722a0386cf9454470e3f7816a3b714fa0c929b136d3ef368f087b05'
### key: '34a0a1cec722a0386cf9454470e3f7816a3b714fa0c929b136d3ef368f087b05'
### iv: '16fab60c6781e3369bf23707'
### iv: '16fab60c6781e3369bf23707'
### aad: 'a0c63adb3ae8186d363bf11011997c15fd8f4720bdbd5f92107563b67067bcff'
### aad: 'a0c63adb3ae8186d363bf11011997c15fd8f4720bdbd5f92107563b67067bcff'
### cipherinfo: '834a3136313639303434313450e1a18f430422ecc7c21bedf998e85e275828c31330f3f53cfbc04b988d8c5c141f4e494fe93b5a2d8adfe8ce4cbd62f7adb53bd8433894e5a2ce'
### cipherinfo: '834a3136313639303434313450e1a18f430422ecc7c21bedf998e85e275828c31330f3f53cfbc04b988d8c5c141f4e494fe93b5a2d8adfe8ce4cbd62f7adb53bd8433894e5a2ce'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '27cc873a5eb1d702aac63707'
### iv_xor: '27cc873a5eb1d702aac63707'
### authtag: 'e1a18f430422ecc7c21bedf998e85e27'
### authtag: 'e1a18f430422ecc7c21bedf998e85e27'
### ciphertext: 'c31330f3f53cfbc04b988d8c5c141f4e494fe93b5a2d8adfe8ce4cbd62f7adb53bd8433894e5a2ce'
### ciphertext: 'c31330f3f53cfbc04b988d8c5c141f4e494fe93b5a2d8adfe8ce4cbd62f7adb53bd8433894e5a2ce'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'


### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### read message pattern: 'ss'

### read message pattern: 'ss'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'
### z: '20a530c4e5d89fcc70a0244bc08c86ca64a631ce7dd752da9634fb9c5dab2ecf'


### read message pattern: 'psk'
### read message pattern: 'psk'


### noise decrypt
### noise decrypt
### key: '7a4e603ac1ba1307a6fea4f00d54e521d588551e7553489f57784e75c1afc4b8'
### key: '7a4e603ac1ba1307a6fea4f00d54e521d588551e7553489f57784e75c1afc4b8'
### iv: '5335ee1937d80e5252c78bd7'
### iv: '5335ee1937d80e5252c78bd7'
### aad: 'a9eaefb250054d0f1971d468c21bcd66122987889ed0f414585feb3bae3e4493'
### aad: 'a9eaefb250054d0f1971d468c21bcd66122987889ed0f414585feb3bae3e4493'
### cipherinfo: '834a3136313639303434313450d25462d3bf325f3ee480ec4d7463c6ae4879e97b0804a40e39'
### cipherinfo: '834a3136313639303434313450d25462d3bf325f3ee480ec4d7463c6ae4879e97b0804a40e39'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '6203df2f0ee83a6663f38bd7'
### iv_xor: '6203df2f0ee83a6663f38bd7'
### authtag: 'd25462d3bf325f3ee480ec4d7463c6ae'
### authtag: 'd25462d3bf325f3ee480ec4d7463c6ae'
### ciphertext: '79e97b0804a40e39'
### ciphertext: '79e97b0804a40e39'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","0206cccdc93b68e86e8faa1fd086d627cf1a8268483b3b5a597b6cfc2de75982b9"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","12d90a516c5ae6330f7745d9983d5378b5b5be3f836eb43fef609d302b91cdfb"),
                                h => pack("H*","bace9e81024d0ba994f9f6fe8431300d4770fff945326870967ffadd8cf855bd"),
                                hasK => 1,
                                k => pack("H*","61f1624ab208416e6dbc314c2fe02a61ad4b4c4bddd1b50849f0945835d36eb5"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","0206cccdc93b68e86e8faa1fd086d627cf1a8268483b3b5a597b6cfc2de75982b9"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","12d90a516c5ae6330f7745d9983d5378b5b5be3f836eb43fef609d302b91cdfb"),
                                h => pack("H*","bace9e81024d0ba994f9f6fe8431300d4770fff945326870967ffadd8cf855bd"),
                                hasK => 1,
                                k => pack("H*","61f1624ab208416e6dbc314c2fe02a61ad4b4c4bddd1b50849f0945835d36eb5"),
                              },
    who                    => "b",
  },
)


### b write_message to a
### b write_message to a
### b send msg to a
### b send msg to a


### write message pattern: 'e'
### write message pattern: 'e'

### public compressed: '03e198f42e75afc55b8e4d9d131ad62d76feba5eefdd4bc6c68002dee5d91dca79'

### public compressed: '03e198f42e75afc55b8e4d9d131ad62d76feba5eefdd4bc6c68002dee5d91dca79'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIK07WEx9/Y2BHWAp54pGCC7DIWYh0URpCqF5uGdo7cvRoAoGCCqGSM49
',
###             'AwEHoUQDQgAE4Zj0LnWvxVuOTZ0TGtYtdv66Xu/dS8bGgALe5dkdynmJc4n7CHtH
',
###             'bMb18Q3XdRgT7PmIemde7kdSxmCP/6NodQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIK07WEx9/Y2BHWAp54pGCC7DIWYh0URpCqF5uGdo7cvRoAoGCCqGSM49
',
###             'AwEHoUQDQgAE4Zj0LnWvxVuOTZ0TGtYtdv66Xu/dS8bGgALe5dkdynmJc4n7CHtH
',
###             'bMb18Q3XdRgT7PmIemde7kdSxmCP/6NodQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEBszNyTto6G6Pqh/QhtYnzxqCaEg7
',
###           'O1pZe2z8LedZgrnlsYtjK6O+Wa50OwNfstRNPdK3F83PLWCVsC3OcEG4wA==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEBszNyTto6G6Pqh/QhtYnzxqCaEg7
',
###           'O1pZe2z8LedZgrnlsYtjK6O+Wa50OwNfstRNPdK3F83PLWCVsC3OcEG4wA==
',
###           '-----END PUBLIC KEY-----
'
### z: '696026c8a6b0556581382f0183ab265ff730c6a13e0e30158b1afc6afb1d5553'
### z: '696026c8a6b0556581382f0183ab265ff730c6a13e0e30158b1afc6afb1d5553'

### write message pattern: 'se'

### write message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIK07WEx9/Y2BHWAp54pGCC7DIWYh0URpCqF5uGdo7cvRoAoGCCqGSM49
',
###             'AwEHoUQDQgAE4Zj0LnWvxVuOTZ0TGtYtdv66Xu/dS8bGgALe5dkdynmJc4n7CHtH
',
###             'bMb18Q3XdRgT7PmIemde7kdSxmCP/6NodQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIK07WEx9/Y2BHWAp54pGCC7DIWYh0URpCqF5uGdo7cvRoAoGCCqGSM49
',
###             'AwEHoUQDQgAE4Zj0LnWvxVuOTZ0TGtYtdv66Xu/dS8bGgALe5dkdynmJc4n7CHtH
',
###             'bMb18Q3XdRgT7PmIemde7kdSxmCP/6NodQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '718f0bbc1f5b227b04686b6595d375abd06a22fdde7c1d12b0dc188581c2be96'
### z: '718f0bbc1f5b227b04686b6595d375abd06a22fdde7c1d12b0dc188581c2be96'


### noise encrypt
### noise encrypt
### key: '4c118bfc56e7b4d981fe0c13771a9c14c1028114352b32f0d98fe2ab462994a7'
### key: '4c118bfc56e7b4d981fe0c13771a9c14c1028114352b32f0d98fe2ab462994a7'
### iv: 'ca006b700d66d20c4f386617'
### iv: 'ca006b700d66d20c4f386617'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'fb365a463456e6387e0c6617'
### iv_xor: 'fb365a463456e6387e0c6617'
### aad: '0e5cbaf91e2410a2f72c8fb32b2c29e754005a7fbb36c66d625213f357cc6c7a'
### aad: '0e5cbaf91e2410a2f72c8fb32b2c29e754005a7fbb36c66d625213f357cc6c7a'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '7c0a2001dc9369fa'
### ciphertext: '7c0a2001dc9369fa'
### authtag: 'b0bfbdf7dae3a6a03b79529f8e555fd4'
### authtag: 'b0bfbdf7dae3a6a03b79529f8e555fd4'
### cipherinfo: '834a3136313639303434313450b0bfbdf7dae3a6a03b79529f8e555fd4487c0a2001dc9369fa'
### cipherinfo: '834a3136313639303434313450b0bfbdf7dae3a6a03b79529f8e555fd4487c0a2001dc9369fa'


### b_msg: '82582103e198f42e75afc55b8e4d9d131ad62d76feba5eefdd4bc6c68002dee5d91dca795826834a3136313639303434313450b0bfbdf7dae3a6a03b79529f8e555fd4487c0a2001dc9369fa'
### b_msg: '82582103e198f42e75afc55b8e4d9d131ad62d76feba5eefdd4bc6c68002dee5d91dca795826834a3136313639303434313450b0bfbdf7dae3a6a03b79529f8e555fd4487c0a2001dc9369fa'
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03e198f42e75afc55b8e4d9d131ad62d76feba5eefdd4bc6c68002dee5d91dca79"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","0206cccdc93b68e86e8faa1fd086d627cf1a8268483b3b5a597b6cfc2de75982b9"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","52218862e9e2ef1029baeb748f602f8e82424de89862d0be11d2f783b061b92b"),
                                h => pack("H*","cca6893e5b30c4420298f775627e7b215f5f262213ce6c73991af9ef18f8a4d2"),
                                hasK => 1,
                                k => pack("H*","c780d8d8070a87ae8928d8db13bcb2e0a5b1e76905905747a05ce006496b9868"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","6e420fd520726d33a1893bfec6341e2c0262be07a847acfebe043f3a0476c813"),
  },
  {
    hasK => 1,
    k => pack("H*","f7b4857796824703f4785d62e9a97ff92a63bffa6f36f1e59ce58c1bf7bdab59"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03e198f42e75afc55b8e4d9d131ad62d76feba5eefdd4bc6c68002dee5d91dca79"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","0206cccdc93b68e86e8faa1fd086d627cf1a8268483b3b5a597b6cfc2de75982b9"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","52218862e9e2ef1029baeb748f602f8e82424de89862d0be11d2f783b061b92b"),
                                h => pack("H*","cca6893e5b30c4420298f775627e7b215f5f262213ce6c73991af9ef18f8a4d2"),
                                hasK => 1,
                                k => pack("H*","c780d8d8070a87ae8928d8db13bcb2e0a5b1e76905905747a05ce006496b9868"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","6e420fd520726d33a1893bfec6341e2c0262be07a847acfebe043f3a0476c813"),
  },
  {
    hasK => 1,
    k => pack("H*","f7b4857796824703f4785d62e9a97ff92a63bffa6f36f1e59ce58c1bf7bdab59"),
  },
)


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBq7nTIxH2ClPiLjPyJHnb4AyQMpjkAyOkBO19DnbX3GoAoGCCqGSM49
',
###             'AwEHoUQDQgAEBszNyTto6G6Pqh/QhtYnzxqCaEg7O1pZe2z8LedZgrnlsYtjK6O+
',
###             'Wa50OwNfstRNPdK3F83PLWCVsC3OcEG4wA==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBq7nTIxH2ClPiLjPyJHnb4AyQMpjkAyOkBO19DnbX3GoAoGCCqGSM49
',
###             'AwEHoUQDQgAEBszNyTto6G6Pqh/QhtYnzxqCaEg7O1pZe2z8LedZgrnlsYtjK6O+
',
###             'Wa50OwNfstRNPdK3F83PLWCVsC3OcEG4wA==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE4Zj0LnWvxVuOTZ0TGtYtdv66Xu/d
',
###           'S8bGgALe5dkdynmJc4n7CHtHbMb18Q3XdRgT7PmIemde7kdSxmCP/6NodQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE4Zj0LnWvxVuOTZ0TGtYtdv66Xu/d
',
###           'S8bGgALe5dkdynmJc4n7CHtHbMb18Q3XdRgT7PmIemde7kdSxmCP/6NodQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '696026c8a6b0556581382f0183ab265ff730c6a13e0e30158b1afc6afb1d5553'
### z: '696026c8a6b0556581382f0183ab265ff730c6a13e0e30158b1afc6afb1d5553'


### read message pattern: 'se'
### read message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE4Zj0LnWvxVuOTZ0TGtYtdv66Xu/d
',
###           'S8bGgALe5dkdynmJc4n7CHtHbMb18Q3XdRgT7PmIemde7kdSxmCP/6NodQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE4Zj0LnWvxVuOTZ0TGtYtdv66Xu/d
',
###           'S8bGgALe5dkdynmJc4n7CHtHbMb18Q3XdRgT7PmIemde7kdSxmCP/6NodQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '718f0bbc1f5b227b04686b6595d375abd06a22fdde7c1d12b0dc188581c2be96'
### z: '718f0bbc1f5b227b04686b6595d375abd06a22fdde7c1d12b0dc188581c2be96'


### noise decrypt
### noise decrypt
### key: '4c118bfc56e7b4d981fe0c13771a9c14c1028114352b32f0d98fe2ab462994a7'
### key: '4c118bfc56e7b4d981fe0c13771a9c14c1028114352b32f0d98fe2ab462994a7'
### iv: 'ca006b700d66d20c4f386617'
### iv: 'ca006b700d66d20c4f386617'
### aad: '0e5cbaf91e2410a2f72c8fb32b2c29e754005a7fbb36c66d625213f357cc6c7a'
### aad: '0e5cbaf91e2410a2f72c8fb32b2c29e754005a7fbb36c66d625213f357cc6c7a'
### cipherinfo: '834a3136313639303434313450b0bfbdf7dae3a6a03b79529f8e555fd4487c0a2001dc9369fa'
### cipherinfo: '834a3136313639303434313450b0bfbdf7dae3a6a03b79529f8e555fd4487c0a2001dc9369fa'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'fb365a463456e6387e0c6617'
### iv_xor: 'fb365a463456e6387e0c6617'
### authtag: 'b0bfbdf7dae3a6a03b79529f8e555fd4'
### authtag: 'b0bfbdf7dae3a6a03b79529f8e555fd4'
### ciphertext: '7c0a2001dc9369fa'
### ciphertext: '7c0a2001dc9369fa'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0206cccdc93b68e86e8faa1fd086d627cf1a8268483b3b5a597b6cfc2de75982b9"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","03e198f42e75afc55b8e4d9d131ad62d76feba5eefdd4bc6c68002dee5d91dca79"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","52218862e9e2ef1029baeb748f602f8e82424de89862d0be11d2f783b061b92b"),
                                h => pack("H*","cca6893e5b30c4420298f775627e7b215f5f262213ce6c73991af9ef18f8a4d2"),
                                hasK => 1,
                                k => pack("H*","c780d8d8070a87ae8928d8db13bcb2e0a5b1e76905905747a05ce006496b9868"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","6e420fd520726d33a1893bfec6341e2c0262be07a847acfebe043f3a0476c813"),
  },
  {
    hasK => 1,
    k => pack("H*","f7b4857796824703f4785d62e9a97ff92a63bffa6f36f1e59ce58c1bf7bdab59"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0206cccdc93b68e86e8faa1fd086d627cf1a8268483b3b5a597b6cfc2de75982b9"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IK",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "es", "s", "ss", "psk"], ["e", "ee", "se"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IKpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","03e198f42e75afc55b8e4d9d131ad62d76feba5eefdd4bc6c68002dee5d91dca79"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","52218862e9e2ef1029baeb748f602f8e82424de89862d0be11d2f783b061b92b"),
                                h => pack("H*","cca6893e5b30c4420298f775627e7b215f5f262213ce6c73991af9ef18f8a4d2"),
                                hasK => 1,
                                k => pack("H*","c780d8d8070a87ae8928d8db13bcb2e0a5b1e76905905747a05ce006496b9868"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","6e420fd520726d33a1893bfec6341e2c0262be07a847acfebe043f3a0476c813"),
  },
  {
    hasK => 1,
    k => pack("H*","f7b4857796824703f4785d62e9a97ff92a63bffa6f36f1e59ce58c1bf7bdab59"),
  },
)


### a send comm msg to b
### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '981c3816851fc087643b3e9499d28a06539d0fb756afaa80bdc4831f50710244'
### key: '981c3816851fc087643b3e9499d28a06539d0fb756afaa80bdc4831f50710244'
### iv: '883f8496799391a86581d59b'
### iv: '883f8496799391a86581d59b'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'b909b5a040a3a59c54b5d59b'
### iv_xor: 'b909b5a040a3a59c54b5d59b'
### aad: 'cca6893e5b30c4420298f775627e7b215f5f262213ce6c73991af9ef18f8a4d2'
### aad: 'cca6893e5b30c4420298f775627e7b215f5f262213ce6c73991af9ef18f8a4d2'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'eeb4463b83353ba24060f111cea233986f67eb1556b4e5669c9ef7a9aec670cefb4f7daa01392e72317d8feb42f5bef6a8768a'
### ciphertext: 'eeb4463b83353ba24060f111cea233986f67eb1556b4e5669c9ef7a9aec670cefb4f7daa01392e72317d8feb42f5bef6a8768a'
### authtag: '818ca245e20b65b15a8f01b495992c0f'
### authtag: '818ca245e20b65b15a8f01b495992c0f'
### cipherinfo: '834a3136313639303434313450818ca245e20b65b15a8f01b495992c0f5833eeb4463b83353ba24060f111cea233986f67eb1556b4e5669c9ef7a9aec670cefb4f7daa01392e72317d8feb42f5bef6a8768a'
### cipherinfo: '834a3136313639303434313450818ca245e20b65b15a8f01b495992c0f5833eeb4463b83353ba24060f111cea233986f67eb1556b4e5669c9ef7a9aec670cefb4f7daa01392e72317d8feb42f5bef6a8768a'


### b recv comm msg from a
### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '981c3816851fc087643b3e9499d28a06539d0fb756afaa80bdc4831f50710244'
### key: '981c3816851fc087643b3e9499d28a06539d0fb756afaa80bdc4831f50710244'
### iv: '883f8496799391a86581d59b'
### iv: '883f8496799391a86581d59b'
### aad: 'cca6893e5b30c4420298f775627e7b215f5f262213ce6c73991af9ef18f8a4d2'
### aad: 'cca6893e5b30c4420298f775627e7b215f5f262213ce6c73991af9ef18f8a4d2'
### cipherinfo: '834a3136313639303434313450818ca245e20b65b15a8f01b495992c0f5833eeb4463b83353ba24060f111cea233986f67eb1556b4e5669c9ef7a9aec670cefb4f7daa01392e72317d8feb42f5bef6a8768a'
### cipherinfo: '834a3136313639303434313450818ca245e20b65b15a8f01b495992c0f5833eeb4463b83353ba24060f111cea233986f67eb1556b4e5669c9ef7a9aec670cefb4f7daa01392e72317d8feb42f5bef6a8768a'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'b909b5a040a3a59c54b5d59b'
### iv_xor: 'b909b5a040a3a59c54b5d59b'
### authtag: '818ca245e20b65b15a8f01b495992c0f'
### authtag: '818ca245e20b65b15a8f01b495992c0f'
### ciphertext: 'eeb4463b83353ba24060f111cea233986f67eb1556b4e5669c9ef7a9aec670cefb4f7daa01392e72317d8feb42f5bef6a8768a'
### ciphertext: 'eeb4463b83353ba24060f111cea233986f67eb1556b4e5669c9ef7a9aec670cefb4f7daa01392e72317d8feb42f5bef6a8768a'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '73ac5b880c937aafe588c15745f1cec1c96f0615681844f4ef715565dc68c62e'
### key: '73ac5b880c937aafe588c15745f1cec1c96f0615681844f4ef715565dc68c62e'
### iv: 'db141758d774ab07a91ed94e'
### iv: 'db141758d774ab07a91ed94e'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'ea22266eee449f33982ad94e'
### iv_xor: 'ea22266eee449f33982ad94e'
### aad: 'cca6893e5b30c4420298f775627e7b215f5f262213ce6c73991af9ef18f8a4d2'
### aad: 'cca6893e5b30c4420298f775627e7b215f5f262213ce6c73991af9ef18f8a4d2'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '24aea650994750a8ec69839cf0d308c0507652930cb1a91275a7cb341ffad6c6ab00fdaa251295af8eeaa7b16150f6'
### ciphertext: '24aea650994750a8ec69839cf0d308c0507652930cb1a91275a7cb341ffad6c6ab00fdaa251295af8eeaa7b16150f6'
### authtag: '4b4072ec9c85faa739bf4ecb3a863585'
### authtag: '4b4072ec9c85faa739bf4ecb3a863585'
### cipherinfo: '834a31363136393034343134504b4072ec9c85faa739bf4ecb3a863585582f24aea650994750a8ec69839cf0d308c0507652930cb1a91275a7cb341ffad6c6ab00fdaa251295af8eeaa7b16150f6'
### cipherinfo: '834a31363136393034343134504b4072ec9c85faa739bf4ecb3a863585582f24aea650994750a8ec69839cf0d308c0507652930cb1a91275a7cb341ffad6c6ab00fdaa251295af8eeaa7b16150f6'


### a recv comm msg from b
### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '73ac5b880c937aafe588c15745f1cec1c96f0615681844f4ef715565dc68c62e'
### key: '73ac5b880c937aafe588c15745f1cec1c96f0615681844f4ef715565dc68c62e'
### iv: 'db141758d774ab07a91ed94e'
### iv: 'db141758d774ab07a91ed94e'
### aad: 'cca6893e5b30c4420298f775627e7b215f5f262213ce6c73991af9ef18f8a4d2'
### aad: 'cca6893e5b30c4420298f775627e7b215f5f262213ce6c73991af9ef18f8a4d2'
### cipherinfo: '834a31363136393034343134504b4072ec9c85faa739bf4ecb3a863585582f24aea650994750a8ec69839cf0d308c0507652930cb1a91275a7cb341ffad6c6ab00fdaa251295af8eeaa7b16150f6'
### cipherinfo: '834a31363136393034343134504b4072ec9c85faa739bf4ecb3a863585582f24aea650994750a8ec69839cf0d308c0507652930cb1a91275a7cb341ffad6c6ab00fdaa251295af8eeaa7b16150f6'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'ea22266eee449f33982ad94e'
### iv_xor: 'ea22266eee449f33982ad94e'
### authtag: '4b4072ec9c85faa739bf4ecb3a863585'
### authtag: '4b4072ec9c85faa739bf4ecb3a863585'
### ciphertext: '24aea650994750a8ec69839cf0d308c0507652930cb1a91275a7cb341ffad6c6ab00fdaa251295af8eeaa7b16150f6'
### ciphertext: '24aea650994750a8ec69839cf0d308c0507652930cb1a91275a7cb341ffad6c6ab00fdaa251295af8eeaa7b16150f6'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'IK',
###                               'test_psk',
###                               1
### -----------end test --------: 'IK',
###                               'test_psk',
###                               1


### -----------start test --------: 'IX',
###                                 undef,
###                                 undef
### -----------start test --------: 'IX',
###                                 undef,
###                                 undef

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "s"], ["e", "ee", "se", "s", "es"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IX_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => "Noise_IX_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","88bca2960e537af9b5ef8e38a466a9071624f7b0300661f8a4a58b5ab980c2e9"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "s"], ["e", "ee", "se", "s", "es"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IX_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => "Noise_IX_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","88bca2960e537af9b5ef8e38a466a9071624f7b0300661f8a4a58b5ab980c2e9"),
                            },
  who                    => "a",
}


### a send msg to b
### a send msg to b


### write message pattern: 'e'
### write message pattern: 'e'

### public compressed: '0329333a7c7841e5b3083200daaa45bad7d29294076a2b4e9166159bc87489c9b3'

### public compressed: '0329333a7c7841e5b3083200daaa45bad7d29294076a2b4e9166159bc87489c9b3'

### write message pattern: 's'

### write message pattern: 's'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghAykzOnx4QeWzCDIA2qpFutfSkpQHaitOkWYVm8h0icmzWCiCQ3Jhd1ghA1eeJc8MbZeCuaL2GlYJRTiZOvH3mXi1MxV2F9Ki6t8gSGluaXQuc3lu"),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghAykzOnx4QeWzCDIA2qpFutfSkpQHaitOkWYVm8h0icmzWCiCQ3Jhd1ghA1eeJc8MbZeCuaL2GlYJRTiZOvH3mXi1MxV2F9Ki6t8gSGluaXQuc3lu"),
  );
}
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0329333a7c7841e5b3083200daaa45bad7d29294076a2b4e9166159bc87489c9b3"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IX_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => "Noise_IX_secp256r1_AESGCM_SHA256",
                                h  => pack("H*","ff8e65e28f586e96059561794d5dea850319296437c187965d6840c2359c6f04"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0329333a7c7841e5b3083200daaa45bad7d29294076a2b4e9166159bc87489c9b3"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IX_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => "Noise_IX_secp256r1_AESGCM_SHA256",
                                h  => pack("H*","ff8e65e28f586e96059561794d5dea850319296437c187965d6840c2359c6f04"),
                              },
    who                    => "a",
  },
)

### b read message from a

### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "s"], ["e", "ee", "se", "s", "es"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IX_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => "Noise_IX_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","88bca2960e537af9b5ef8e38a466a9071624f7b0300661f8a4a58b5ab980c2e9"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "s"], ["e", "ee", "se", "s", "es"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IX_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => "Noise_IX_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","88bca2960e537af9b5ef8e38a466a9071624f7b0300661f8a4a58b5ab980c2e9"),
                            },
  who                    => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 's'

### read message pattern: 's'


### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IX_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","0329333a7c7841e5b3083200daaa45bad7d29294076a2b4e9166159bc87489c9b3"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => "Noise_IX_secp256r1_AESGCM_SHA256",
                                h  => pack("H*","ff8e65e28f586e96059561794d5dea850319296437c187965d6840c2359c6f04"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IX_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","0329333a7c7841e5b3083200daaa45bad7d29294076a2b4e9166159bc87489c9b3"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => "Noise_IX_secp256r1_AESGCM_SHA256",
                                h  => pack("H*","ff8e65e28f586e96059561794d5dea850319296437c187965d6840c2359c6f04"),
                              },
    who                    => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '0233c43005023705cef4e762834b5f81337a1f5cd20a562b83bb7a773ec8dc075e'

### public compressed: '0233c43005023705cef4e762834b5f81337a1f5cd20a562b83bb7a773ec8dc075e'

### write message pattern: 'ee'

### write message pattern: 'ee'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDn5bGx1NdXJIWINTJiBhf6bURVZwTZfi8qq2SEsIVmdoAoGCCqGSM49
',
###             'AwEHoUQDQgAEM8QwBQI3Bc7052KDS1+BM3ofXNIKViuDu3p3PsjcB16un35z2B55
',
###             'Hy5QiVmT2KcyvAFUyD40ickESfAd4T0CJA==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDn5bGx1NdXJIWINTJiBhf6bURVZwTZfi8qq2SEsIVmdoAoGCCqGSM49
',
###             'AwEHoUQDQgAEM8QwBQI3Bc7052KDS1+BM3ofXNIKViuDu3p3PsjcB16un35z2B55
',
###             'Hy5QiVmT2KcyvAFUyD40ickESfAd4T0CJA==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEKTM6fHhB5bMIMgDaqkW619KSlAdq
',
###           'K06RZhWbyHSJybPcltPVLSbanR89ES+3d8TZ7EVWroVztXEfwhFQq0VuwQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEKTM6fHhB5bMIMgDaqkW619KSlAdq
',
###           'K06RZhWbyHSJybPcltPVLSbanR89ES+3d8TZ7EVWroVztXEfwhFQq0VuwQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '876f4d73b96f804eed4f3e7156d4aab59a4c2a22edb3ffbee759792cab939738'
### z: '876f4d73b96f804eed4f3e7156d4aab59a4c2a22edb3ffbee759792cab939738'


### write message pattern: 'se'
### write message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDn5bGx1NdXJIWINTJiBhf6bURVZwTZfi8qq2SEsIVmdoAoGCCqGSM49
',
###             'AwEHoUQDQgAEM8QwBQI3Bc7052KDS1+BM3ofXNIKViuDu3p3PsjcB16un35z2B55
',
###             'Hy5QiVmT2KcyvAFUyD40ickESfAd4T0CJA==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIDn5bGx1NdXJIWINTJiBhf6bURVZwTZfi8qq2SEsIVmdoAoGCCqGSM49
',
###             'AwEHoUQDQgAEM8QwBQI3Bc7052KDS1+BM3ofXNIKViuDu3p3PsjcB16un35z2B55
',
###             'Hy5QiVmT2KcyvAFUyD40ickESfAd4T0CJA==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '3e2f97624d893b08b86e6e0dade8b2993eacaccf9e23b676eb8b20a7d47a93ca'
### z: '3e2f97624d893b08b86e6e0dade8b2993eacaccf9e23b676eb8b20a7d47a93ca'


### write message pattern: 's'
### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '9f87b6bf2094b08b35a3f86511761d1f858790c85459bf2e9cb0c075da5cf40c'
### key: '9f87b6bf2094b08b35a3f86511761d1f858790c85459bf2e9cb0c075da5cf40c'
### iv: 'f3f6366bdfc31347c28aa4aa'
### iv: 'f3f6366bdfc31347c28aa4aa'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'c2c0075de6f32773f3bea4aa'
### iv_xor: 'c2c0075de6f32773f3bea4aa'
### aad: '840d84a5711650ddfc2fa7910c821453e6735b032edc9de01be4ce9b9576ca17'
### aad: '840d84a5711650ddfc2fa7910c821453e6735b032edc9de01be4ce9b9576ca17'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### ciphertext: 'bb87ad9e5c2c58f828d2dbbf8a41cac61049b50a41cc5b529af818592b79d965bf710eb995f59761'
### ciphertext: 'bb87ad9e5c2c58f828d2dbbf8a41cac61049b50a41cc5b529af818592b79d965bf710eb995f59761'
### authtag: '7cbb9b3e8b80e7250790d72d16ae6e9e'
### authtag: '7cbb9b3e8b80e7250790d72d16ae6e9e'
### cipherinfo: '834a31363136393034343134507cbb9b3e8b80e7250790d72d16ae6e9e5828bb87ad9e5c2c58f828d2dbbf8a41cac61049b50a41cc5b529af818592b79d965bf710eb995f59761'
### cipherinfo: '834a31363136393034343134507cbb9b3e8b80e7250790d72d16ae6e9e5828bb87ad9e5c2c58f828d2dbbf8a41cac61049b50a41cc5b529af818592b79d965bf710eb995f59761'


### write message pattern: 'es'
### write message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEKTM6fHhB5bMIMgDaqkW619KSlAdq
',
###           'K06RZhWbyHSJybPcltPVLSbanR89ES+3d8TZ7EVWroVztXEfwhFQq0VuwQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEKTM6fHhB5bMIMgDaqkW619KSlAdq
',
###           'K06RZhWbyHSJybPcltPVLSbanR89ES+3d8TZ7EVWroVztXEfwhFQq0VuwQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '3df832a89d7fdd1903fee93f68557c7ba0b9b05c62d0dbb28f664b8e388624a7'
### z: '3df832a89d7fdd1903fee93f68557c7ba0b9b05c62d0dbb28f664b8e388624a7'


### noise encrypt
### noise encrypt
### key: 'e99ac34cd16986d92f173ae014c1a6767c2258bd88e16ccebd0c550f41fda1e9'
### key: 'e99ac34cd16986d92f173ae014c1a6767c2258bd88e16ccebd0c550f41fda1e9'
### iv: '5280708a4e72556e9664ea06'
### iv: '5280708a4e72556e9664ea06'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '63b641bc7742615aa750ea06'
### iv_xor: '63b641bc7742615aa750ea06'
### aad: 'd3c5329cdec28e415fee0122879f540492626829c42c77c0f9110106417fdfd7'
### aad: 'd3c5329cdec28e415fee0122879f540492626829c42c77c0f9110106417fdfd7'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: 'f212ccc817ad1ccb'
### ciphertext: 'f212ccc817ad1ccb'
### authtag: '0bc487228c568e0be9c0a4132a4c2381'
### authtag: '0bc487228c568e0be9c0a4132a4c2381'
### cipherinfo: '834a31363136393034343134500bc487228c568e0be9c0a4132a4c238148f212ccc817ad1ccb'
### cipherinfo: '834a31363136393034343134500bc487228c568e0be9c0a4132a4c238148f212ccc817ad1ccb'


### b_msg: '8358210233c43005023705cef4e762834b5f81337a1f5cd20a562b83bb7a773ec8dc075e5847834a31363136393034343134507cbb9b3e8b80e7250790d72d16ae6e9e5828bb87ad9e5c2c58f828d2dbbf8a41cac61049b50a41cc5b529af818592b79d965bf710eb995f597615826834a31363136393034343134500bc487228c568e0be9c0a4132a4c238148f212ccc817ad1ccb'
### b_msg: '8358210233c43005023705cef4e762834b5f81337a1f5cd20a562b83bb7a773ec8dc075e5847834a31363136393034343134507cbb9b3e8b80e7250790d72d16ae6e9e5828bb87ad9e5c2c58f828d2dbbf8a41cac61049b50a41cc5b529af818592b79d965bf710eb995f597615826834a31363136393034343134500bc487228c568e0be9c0a4132a4c238148f212ccc817ad1ccb'
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0233c43005023705cef4e762834b5f81337a1f5cd20a562b83bb7a773ec8dc075e"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IX_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","0329333a7c7841e5b3083200daaa45bad7d29294076a2b4e9166159bc87489c9b3"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","feac846d1936529dcad5cff26f332721ab6d7a253a91cde0a60c41940ad240d1"),
                                h => pack("H*","80e8aebada72eb48457f187add81276d8f823d10688740acdfaa1d8e3f753cf3"),
                                hasK => 1,
                                k => pack("H*","32672f8c350680aef66fcdf801337487632c93d89210a12ae94f5352925437ac"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","1d48b9cbc75690451b2fc57afd015d6cfd399bac62c7b70c30a144173d0df40d"),
  },
  {
    hasK => 1,
    k => pack("H*","b1a7caa602b942af2b62098d6ae5ba911d3917f0f85d05f9689add1ca98775f5"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0233c43005023705cef4e762834b5f81337a1f5cd20a562b83bb7a773ec8dc075e"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IX_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","0329333a7c7841e5b3083200daaa45bad7d29294076a2b4e9166159bc87489c9b3"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","feac846d1936529dcad5cff26f332721ab6d7a253a91cde0a60c41940ad240d1"),
                                h => pack("H*","80e8aebada72eb48457f187add81276d8f823d10688740acdfaa1d8e3f753cf3"),
                                hasK => 1,
                                k => pack("H*","32672f8c350680aef66fcdf801337487632c93d89210a12ae94f5352925437ac"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","1d48b9cbc75690451b2fc57afd015d6cfd399bac62c7b70c30a144173d0df40d"),
  },
  {
    hasK => 1,
    k => pack("H*","b1a7caa602b942af2b62098d6ae5ba911d3917f0f85d05f9689add1ca98775f5"),
  },
)


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPNq9V8z69lMZM4uoA7hENRongyBx1XrKmNOEcN6IRk2oAoGCCqGSM49
',
###             'AwEHoUQDQgAEKTM6fHhB5bMIMgDaqkW619KSlAdqK06RZhWbyHSJybPcltPVLSba
',
###             'nR89ES+3d8TZ7EVWroVztXEfwhFQq0VuwQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPNq9V8z69lMZM4uoA7hENRongyBx1XrKmNOEcN6IRk2oAoGCCqGSM49
',
###             'AwEHoUQDQgAEKTM6fHhB5bMIMgDaqkW619KSlAdqK06RZhWbyHSJybPcltPVLSba
',
###             'nR89ES+3d8TZ7EVWroVztXEfwhFQq0VuwQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEM8QwBQI3Bc7052KDS1+BM3ofXNIK
',
###           'ViuDu3p3PsjcB16un35z2B55Hy5QiVmT2KcyvAFUyD40ickESfAd4T0CJA==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEM8QwBQI3Bc7052KDS1+BM3ofXNIK
',
###           'ViuDu3p3PsjcB16un35z2B55Hy5QiVmT2KcyvAFUyD40ickESfAd4T0CJA==
',
###           '-----END PUBLIC KEY-----
'
### z: '876f4d73b96f804eed4f3e7156d4aab59a4c2a22edb3ffbee759792cab939738'
### z: '876f4d73b96f804eed4f3e7156d4aab59a4c2a22edb3ffbee759792cab939738'


### read message pattern: 'se'
### read message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEM8QwBQI3Bc7052KDS1+BM3ofXNIK
',
###           'ViuDu3p3PsjcB16un35z2B55Hy5QiVmT2KcyvAFUyD40ickESfAd4T0CJA==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEM8QwBQI3Bc7052KDS1+BM3ofXNIK
',
###           'ViuDu3p3PsjcB16un35z2B55Hy5QiVmT2KcyvAFUyD40ickESfAd4T0CJA==
',
###           '-----END PUBLIC KEY-----
'
### z: '3e2f97624d893b08b86e6e0dade8b2993eacaccf9e23b676eb8b20a7d47a93ca'
### z: '3e2f97624d893b08b86e6e0dade8b2993eacaccf9e23b676eb8b20a7d47a93ca'


### read message pattern: 's'
### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: '9f87b6bf2094b08b35a3f86511761d1f858790c85459bf2e9cb0c075da5cf40c'
### key: '9f87b6bf2094b08b35a3f86511761d1f858790c85459bf2e9cb0c075da5cf40c'
### iv: 'f3f6366bdfc31347c28aa4aa'
### iv: 'f3f6366bdfc31347c28aa4aa'
### aad: '840d84a5711650ddfc2fa7910c821453e6735b032edc9de01be4ce9b9576ca17'
### aad: '840d84a5711650ddfc2fa7910c821453e6735b032edc9de01be4ce9b9576ca17'
### cipherinfo: '834a31363136393034343134507cbb9b3e8b80e7250790d72d16ae6e9e5828bb87ad9e5c2c58f828d2dbbf8a41cac61049b50a41cc5b529af818592b79d965bf710eb995f59761'
### cipherinfo: '834a31363136393034343134507cbb9b3e8b80e7250790d72d16ae6e9e5828bb87ad9e5c2c58f828d2dbbf8a41cac61049b50a41cc5b529af818592b79d965bf710eb995f59761'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'c2c0075de6f32773f3bea4aa'
### iv_xor: 'c2c0075de6f32773f3bea4aa'
### authtag: '7cbb9b3e8b80e7250790d72d16ae6e9e'
### authtag: '7cbb9b3e8b80e7250790d72d16ae6e9e'
### ciphertext: 'bb87ad9e5c2c58f828d2dbbf8a41cac61049b50a41cc5b529af818592b79d965bf710eb995f59761'
### ciphertext: 'bb87ad9e5c2c58f828d2dbbf8a41cac61049b50a41cc5b529af818592b79d965bf710eb995f59761'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'


### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPNq9V8z69lMZM4uoA7hENRongyBx1XrKmNOEcN6IRk2oAoGCCqGSM49
',
###             'AwEHoUQDQgAEKTM6fHhB5bMIMgDaqkW619KSlAdqK06RZhWbyHSJybPcltPVLSba
',
###             'nR89ES+3d8TZ7EVWroVztXEfwhFQq0VuwQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPNq9V8z69lMZM4uoA7hENRongyBx1XrKmNOEcN6IRk2oAoGCCqGSM49
',
###             'AwEHoUQDQgAEKTM6fHhB5bMIMgDaqkW619KSlAdqK06RZhWbyHSJybPcltPVLSba
',
###             'nR89ES+3d8TZ7EVWroVztXEfwhFQq0VuwQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '3df832a89d7fdd1903fee93f68557c7ba0b9b05c62d0dbb28f664b8e388624a7'
### z: '3df832a89d7fdd1903fee93f68557c7ba0b9b05c62d0dbb28f664b8e388624a7'

### noise decrypt

### noise decrypt
### key: 'e99ac34cd16986d92f173ae014c1a6767c2258bd88e16ccebd0c550f41fda1e9'
### key: 'e99ac34cd16986d92f173ae014c1a6767c2258bd88e16ccebd0c550f41fda1e9'
### iv: '5280708a4e72556e9664ea06'
### iv: '5280708a4e72556e9664ea06'
### aad: 'd3c5329cdec28e415fee0122879f540492626829c42c77c0f9110106417fdfd7'
### aad: 'd3c5329cdec28e415fee0122879f540492626829c42c77c0f9110106417fdfd7'
### cipherinfo: '834a31363136393034343134500bc487228c568e0be9c0a4132a4c238148f212ccc817ad1ccb'
### cipherinfo: '834a31363136393034343134500bc487228c568e0be9c0a4132a4c238148f212ccc817ad1ccb'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '63b641bc7742615aa750ea06'
### iv_xor: '63b641bc7742615aa750ea06'
### authtag: '0bc487228c568e0be9c0a4132a4c2381'
### authtag: '0bc487228c568e0be9c0a4132a4c2381'
### ciphertext: 'f212ccc817ad1ccb'
### ciphertext: 'f212ccc817ad1ccb'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0329333a7c7841e5b3083200daaa45bad7d29294076a2b4e9166159bc87489c9b3"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IX_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","0233c43005023705cef4e762834b5f81337a1f5cd20a562b83bb7a773ec8dc075e"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs                     => {
                                pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                              },
    rs_pub                 => "a_rs_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","feac846d1936529dcad5cff26f332721ab6d7a253a91cde0a60c41940ad240d1"),
                                h => pack("H*","80e8aebada72eb48457f187add81276d8f823d10688740acdfaa1d8e3f753cf3"),
                                hasK => 1,
                                k => pack("H*","32672f8c350680aef66fcdf801337487632c93d89210a12ae94f5352925437ac"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","1d48b9cbc75690451b2fc57afd015d6cfd399bac62c7b70c30a144173d0df40d"),
  },
  {
    hasK => 1,
    k => pack("H*","b1a7caa602b942af2b62098d6ae5ba911d3917f0f85d05f9689add1ca98775f5"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0329333a7c7841e5b3083200daaa45bad7d29294076a2b4e9166159bc87489c9b3"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IX_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","0233c43005023705cef4e762834b5f81337a1f5cd20a562b83bb7a773ec8dc075e"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs                     => {
                                pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                              },
    rs_pub                 => "a_rs_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","feac846d1936529dcad5cff26f332721ab6d7a253a91cde0a60c41940ad240d1"),
                                h => pack("H*","80e8aebada72eb48457f187add81276d8f823d10688740acdfaa1d8e3f753cf3"),
                                hasK => 1,
                                k => pack("H*","32672f8c350680aef66fcdf801337487632c93d89210a12ae94f5352925437ac"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","1d48b9cbc75690451b2fc57afd015d6cfd399bac62c7b70c30a144173d0df40d"),
  },
  {
    hasK => 1,
    k => pack("H*","b1a7caa602b942af2b62098d6ae5ba911d3917f0f85d05f9689add1ca98775f5"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '6c4aff9a0184da7a9edec709f5b43f9e28bda62e9a29896cef792f24a96afc55'
### key: '6c4aff9a0184da7a9edec709f5b43f9e28bda62e9a29896cef792f24a96afc55'
### iv: '5736ef422dfc371d931b07b7'
### iv: '5736ef422dfc371d931b07b7'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '6600de7414cc0329a22f07b7'
### iv_xor: '6600de7414cc0329a22f07b7'
### aad: '80e8aebada72eb48457f187add81276d8f823d10688740acdfaa1d8e3f753cf3'
### aad: '80e8aebada72eb48457f187add81276d8f823d10688740acdfaa1d8e3f753cf3'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '11eb3845ba61f230b29084a88035f17a7094ac78dd93b3589b6c96d9cff15b15c4e6aad0c1e3eadf6b4e88064e2b8d0bd47232'
### ciphertext: '11eb3845ba61f230b29084a88035f17a7094ac78dd93b3589b6c96d9cff15b15c4e6aad0c1e3eadf6b4e88064e2b8d0bd47232'
### authtag: 'de032292906ec9e70cbee732271d5020'
### authtag: 'de032292906ec9e70cbee732271d5020'
### cipherinfo: '834a3136313639303434313450de032292906ec9e70cbee732271d5020583311eb3845ba61f230b29084a88035f17a7094ac78dd93b3589b6c96d9cff15b15c4e6aad0c1e3eadf6b4e88064e2b8d0bd47232'
### cipherinfo: '834a3136313639303434313450de032292906ec9e70cbee732271d5020583311eb3845ba61f230b29084a88035f17a7094ac78dd93b3589b6c96d9cff15b15c4e6aad0c1e3eadf6b4e88064e2b8d0bd47232'


### b recv comm msg from a
### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '6c4aff9a0184da7a9edec709f5b43f9e28bda62e9a29896cef792f24a96afc55'
### key: '6c4aff9a0184da7a9edec709f5b43f9e28bda62e9a29896cef792f24a96afc55'
### iv: '5736ef422dfc371d931b07b7'
### iv: '5736ef422dfc371d931b07b7'
### aad: '80e8aebada72eb48457f187add81276d8f823d10688740acdfaa1d8e3f753cf3'
### aad: '80e8aebada72eb48457f187add81276d8f823d10688740acdfaa1d8e3f753cf3'
### cipherinfo: '834a3136313639303434313450de032292906ec9e70cbee732271d5020583311eb3845ba61f230b29084a88035f17a7094ac78dd93b3589b6c96d9cff15b15c4e6aad0c1e3eadf6b4e88064e2b8d0bd47232'
### cipherinfo: '834a3136313639303434313450de032292906ec9e70cbee732271d5020583311eb3845ba61f230b29084a88035f17a7094ac78dd93b3589b6c96d9cff15b15c4e6aad0c1e3eadf6b4e88064e2b8d0bd47232'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '6600de7414cc0329a22f07b7'
### iv_xor: '6600de7414cc0329a22f07b7'
### authtag: 'de032292906ec9e70cbee732271d5020'
### authtag: 'de032292906ec9e70cbee732271d5020'
### ciphertext: '11eb3845ba61f230b29084a88035f17a7094ac78dd93b3589b6c96d9cff15b15c4e6aad0c1e3eadf6b4e88064e2b8d0bd47232'
### ciphertext: '11eb3845ba61f230b29084a88035f17a7094ac78dd93b3589b6c96d9cff15b15c4e6aad0c1e3eadf6b4e88064e2b8d0bd47232'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'


### b to a , plain_b.txt to trans_cipherinfo_b
### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '6de9cad5f41eeb6c94caf26231cb392cb60e6819032295b2f0338f0935b667e4'
### key: '6de9cad5f41eeb6c94caf26231cb392cb60e6819032295b2f0338f0935b667e4'
### iv: '95210a2bbfd4e4d3468b4526'
### iv: '95210a2bbfd4e4d3468b4526'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'a4173b1d86e4d0e777bf4526'
### iv_xor: 'a4173b1d86e4d0e777bf4526'
### aad: '80e8aebada72eb48457f187add81276d8f823d10688740acdfaa1d8e3f753cf3'
### aad: '80e8aebada72eb48457f187add81276d8f823d10688740acdfaa1d8e3f753cf3'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'a172d7527d3e4cf2fe500ca23e52a702f9c0fbebaa6b4c850654f26f90e71294dfdc98518391bf61b538e71a672e65'
### ciphertext: 'a172d7527d3e4cf2fe500ca23e52a702f9c0fbebaa6b4c850654f26f90e71294dfdc98518391bf61b538e71a672e65'
### authtag: '68f7598f6d4355c2a6f43f3d2587ac02'
### authtag: '68f7598f6d4355c2a6f43f3d2587ac02'
### cipherinfo: '834a313631363930343431345068f7598f6d4355c2a6f43f3d2587ac02582fa172d7527d3e4cf2fe500ca23e52a702f9c0fbebaa6b4c850654f26f90e71294dfdc98518391bf61b538e71a672e65'
### cipherinfo: '834a313631363930343431345068f7598f6d4355c2a6f43f3d2587ac02582fa172d7527d3e4cf2fe500ca23e52a702f9c0fbebaa6b4c850654f26f90e71294dfdc98518391bf61b538e71a672e65'


### a recv comm msg from b
### a recv comm msg from b


### noise decrypt
### noise decrypt
### key: '6de9cad5f41eeb6c94caf26231cb392cb60e6819032295b2f0338f0935b667e4'
### key: '6de9cad5f41eeb6c94caf26231cb392cb60e6819032295b2f0338f0935b667e4'
### iv: '95210a2bbfd4e4d3468b4526'
### iv: '95210a2bbfd4e4d3468b4526'
### aad: '80e8aebada72eb48457f187add81276d8f823d10688740acdfaa1d8e3f753cf3'
### aad: '80e8aebada72eb48457f187add81276d8f823d10688740acdfaa1d8e3f753cf3'
### cipherinfo: '834a313631363930343431345068f7598f6d4355c2a6f43f3d2587ac02582fa172d7527d3e4cf2fe500ca23e52a702f9c0fbebaa6b4c850654f26f90e71294dfdc98518391bf61b538e71a672e65'
### cipherinfo: '834a313631363930343431345068f7598f6d4355c2a6f43f3d2587ac02582fa172d7527d3e4cf2fe500ca23e52a702f9c0fbebaa6b4c850654f26f90e71294dfdc98518391bf61b538e71a672e65'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'a4173b1d86e4d0e777bf4526'
### iv_xor: 'a4173b1d86e4d0e777bf4526'
### authtag: '68f7598f6d4355c2a6f43f3d2587ac02'
### authtag: '68f7598f6d4355c2a6f43f3d2587ac02'
### ciphertext: 'a172d7527d3e4cf2fe500ca23e52a702f9c0fbebaa6b4c850654f26f90e71294dfdc98518391bf61b538e71a672e65'
### ciphertext: 'a172d7527d3e4cf2fe500ca23e52a702f9c0fbebaa6b4c850654f26f90e71294dfdc98518391bf61b538e71a672e65'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'IX',
###                               undef,
###                               undef
### -----------end test --------: 'IX',
###                               undef,
###                               undef


### -----------start test --------: 'IX',
###                                 'test_psk',
###                                 0
### -----------start test --------: 'IX',
###                                 'test_psk',
###                                 0

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IXpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","853d47396ff004d26261481964cf4e602863a265e6c8eeffc45d8be8a19fd450"),
                              h  => pack("H*","7f40b20e674ae0d816f97c5a0efbbea3b45d322388c165134cc7472fc995c949"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IXpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","853d47396ff004d26261481964cf4e602863a265e6c8eeffc45d8be8a19fd450"),
                              h  => pack("H*","7f40b20e674ae0d816f97c5a0efbbea3b45d322388c165134cc7472fc995c949"),
                            },
  who                    => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'psk'

### write message pattern: 'psk'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '038acd626f498640477490c0919cdfb968880e5e561aec83268585a83df2672e70'

### public compressed: '038acd626f498640477490c0919cdfb968880e5e561aec83268585a83df2672e70'


### write message pattern: 's'
### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '1f01bf1d3e67b1dc63087afb1faecc0ffddefd5b7b2922f56e5e1767d96e135a'
### key: '1f01bf1d3e67b1dc63087afb1faecc0ffddefd5b7b2922f56e5e1767d96e135a'
### iv: 'f220e1db131088b7216f35e0'
### iv: 'f220e1db131088b7216f35e0'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'c316d0ed2a20bc83105b35e0'
### iv_xor: 'c316d0ed2a20bc83105b35e0'
### aad: '7cde31475adfa39dc49039ed7aa427f2042903db8c2f3877ba565e7ef53a92a9'
### aad: '7cde31475adfa39dc49039ed7aa427f2042903db8c2f3877ba565e7ef53a92a9'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: 'b6adfe1c90a47dbfe71ccd99290d94cfd31409abe0ef23f3496fdc3c0128d1e20dd956e701c30cbc'
### ciphertext: 'b6adfe1c90a47dbfe71ccd99290d94cfd31409abe0ef23f3496fdc3c0128d1e20dd956e701c30cbc'
### authtag: '902bed7cbd7d69e3803414f7f3f76c14'
### authtag: '902bed7cbd7d69e3803414f7f3f76c14'
### cipherinfo: '834a3136313639303434313450902bed7cbd7d69e3803414f7f3f76c145828b6adfe1c90a47dbfe71ccd99290d94cfd31409abe0ef23f3496fdc3c0128d1e20dd956e701c30cbc'
### cipherinfo: '834a3136313639303434313450902bed7cbd7d69e3803414f7f3f76c145828b6adfe1c90a47dbfe71ccd99290d94cfd31409abe0ef23f3496fdc3c0128d1e20dd956e701c30cbc'


### noise encrypt
### noise encrypt
### key: '1f01bf1d3e67b1dc63087afb1faecc0ffddefd5b7b2922f56e5e1767d96e135a'
### key: '1f01bf1d3e67b1dc63087afb1faecc0ffddefd5b7b2922f56e5e1767d96e135a'
### iv: 'f220e1db131088b7216f35e0'
### iv: 'f220e1db131088b7216f35e0'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'c316d0ed2a20bc83105b35e0'
### iv_xor: 'c316d0ed2a20bc83105b35e0'
### aad: '3b4401373f772f349fcf23637a7e4a29a6ee2579edf16c2f5b28c1884f2995a0'
### aad: '3b4401373f772f349fcf23637a7e4a29a6ee2579edf16c2f5b28c1884f2995a0'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '5d80e509c98f25d2'
### ciphertext: '5d80e509c98f25d2'
### authtag: '982e451fc562710c7a38d2d82c2d2019'
### authtag: '982e451fc562710c7a38d2d82c2d2019'
### cipherinfo: '834a3136313639303434313450982e451fc562710c7a38d2d82c2d2019485d80e509c98f25d2'
### cipherinfo: '834a3136313639303434313450982e451fc562710c7a38d2d82c2d2019485d80e509c98f25d2'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghA4rNYm9JhkBHdJDAkZzfuWiIDl5WGuyDJoWFqD3yZy5wWEeDSjE2MTY5MDQ0MTRQkCvtfL19aeOANBT38/dsFFgotq3+HJCkfb/nHM2ZKQ2Uz9MUCavg7yPzSW/cPAEo0eIN2VbnAcMMvFgmg0oxNjE2OTA0NDE0UJguRR/FYnEMejjS2CwtIBlIXYDlCcmPJdI="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghA4rNYm9JhkBHdJDAkZzfuWiIDl5WGuyDJoWFqD3yZy5wWEeDSjE2MTY5MDQ0MTRQkCvtfL19aeOANBT38/dsFFgotq3+HJCkfb/nHM2ZKQ2Uz9MUCavg7yPzSW/cPAEo0eIN2VbnAcMMvFgmg0oxNjE2OTA0NDE0UJguRR/FYnEMejjS2CwtIBlIXYDlCcmPJdI="),
  );
}
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","038acd626f498640477490c0919cdfb968880e5e561aec83268585a83df2672e70"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IXpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","bb8175cfc522a402a035469d0cc7b3dc1ad0f304ea43ff1279049c1ce047d0b9"),
                                h => pack("H*","2733276ace2d02a572941cceeacebe4eb9aeb6b6fe387c54d70054b52cca19b7"),
                                hasK => 1,
                                k => pack("H*","9658b1029c166ac275451fd46de31936fed69233e1a15b5bf8bb9db8a7c2f636"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","038acd626f498640477490c0919cdfb968880e5e561aec83268585a83df2672e70"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IXpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","bb8175cfc522a402a035469d0cc7b3dc1ad0f304ea43ff1279049c1ce047d0b9"),
                                h => pack("H*","2733276ace2d02a572941cceeacebe4eb9aeb6b6fe387c54d70054b52cca19b7"),
                                hasK => 1,
                                k => pack("H*","9658b1029c166ac275451fd46de31936fed69233e1a15b5bf8bb9db8a7c2f636"),
                              },
    who                    => "a",
  },
)


### b read message from a
### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IXpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","853d47396ff004d26261481964cf4e602863a265e6c8eeffc45d8be8a19fd450"),
                              h  => pack("H*","7f40b20e674ae0d816f97c5a0efbbea3b45d322388c165134cc7472fc995c949"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IXpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","853d47396ff004d26261481964cf4e602863a265e6c8eeffc45d8be8a19fd450"),
                              h  => pack("H*","7f40b20e674ae0d816f97c5a0efbbea3b45d322388c165134cc7472fc995c949"),
                            },
  who                    => "b",
}


### b recv msg from a
### b recv msg from a

### read message pattern: 'psk'

### read message pattern: 'psk'


### read message pattern: 'e'
### read message pattern: 'e'


### read message pattern: 's'
### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: '1f01bf1d3e67b1dc63087afb1faecc0ffddefd5b7b2922f56e5e1767d96e135a'
### key: '1f01bf1d3e67b1dc63087afb1faecc0ffddefd5b7b2922f56e5e1767d96e135a'
### iv: 'f220e1db131088b7216f35e0'
### iv: 'f220e1db131088b7216f35e0'
### aad: '7cde31475adfa39dc49039ed7aa427f2042903db8c2f3877ba565e7ef53a92a9'
### aad: '7cde31475adfa39dc49039ed7aa427f2042903db8c2f3877ba565e7ef53a92a9'
### cipherinfo: '834a3136313639303434313450902bed7cbd7d69e3803414f7f3f76c145828b6adfe1c90a47dbfe71ccd99290d94cfd31409abe0ef23f3496fdc3c0128d1e20dd956e701c30cbc'
### cipherinfo: '834a3136313639303434313450902bed7cbd7d69e3803414f7f3f76c145828b6adfe1c90a47dbfe71ccd99290d94cfd31409abe0ef23f3496fdc3c0128d1e20dd956e701c30cbc'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'c316d0ed2a20bc83105b35e0'
### iv_xor: 'c316d0ed2a20bc83105b35e0'
### authtag: '902bed7cbd7d69e3803414f7f3f76c14'
### authtag: '902bed7cbd7d69e3803414f7f3f76c14'
### ciphertext: 'b6adfe1c90a47dbfe71ccd99290d94cfd31409abe0ef23f3496fdc3c0128d1e20dd956e701c30cbc'
### ciphertext: 'b6adfe1c90a47dbfe71ccd99290d94cfd31409abe0ef23f3496fdc3c0128d1e20dd956e701c30cbc'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'


### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### noise decrypt

### noise decrypt
### key: '1f01bf1d3e67b1dc63087afb1faecc0ffddefd5b7b2922f56e5e1767d96e135a'
### key: '1f01bf1d3e67b1dc63087afb1faecc0ffddefd5b7b2922f56e5e1767d96e135a'
### iv: 'f220e1db131088b7216f35e0'
### iv: 'f220e1db131088b7216f35e0'
### aad: '3b4401373f772f349fcf23637a7e4a29a6ee2579edf16c2f5b28c1884f2995a0'
### aad: '3b4401373f772f349fcf23637a7e4a29a6ee2579edf16c2f5b28c1884f2995a0'
### cipherinfo: '834a3136313639303434313450982e451fc562710c7a38d2d82c2d2019485d80e509c98f25d2'
### cipherinfo: '834a3136313639303434313450982e451fc562710c7a38d2d82c2d2019485d80e509c98f25d2'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'c316d0ed2a20bc83105b35e0'
### iv_xor: 'c316d0ed2a20bc83105b35e0'
### authtag: '982e451fc562710c7a38d2d82c2d2019'
### authtag: '982e451fc562710c7a38d2d82c2d2019'
### ciphertext: '5d80e509c98f25d2'
### ciphertext: '5d80e509c98f25d2'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IXpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","038acd626f498640477490c0919cdfb968880e5e561aec83268585a83df2672e70"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","bb8175cfc522a402a035469d0cc7b3dc1ad0f304ea43ff1279049c1ce047d0b9"),
                                h => pack("H*","2733276ace2d02a572941cceeacebe4eb9aeb6b6fe387c54d70054b52cca19b7"),
                                hasK => 1,
                                k => pack("H*","9658b1029c166ac275451fd46de31936fed69233e1a15b5bf8bb9db8a7c2f636"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IXpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","038acd626f498640477490c0919cdfb968880e5e561aec83268585a83df2672e70"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","bb8175cfc522a402a035469d0cc7b3dc1ad0f304ea43ff1279049c1ce047d0b9"),
                                h => pack("H*","2733276ace2d02a572941cceeacebe4eb9aeb6b6fe387c54d70054b52cca19b7"),
                                hasK => 1,
                                k => pack("H*","9658b1029c166ac275451fd46de31936fed69233e1a15b5bf8bb9db8a7c2f636"),
                              },
    who                    => "b",
  },
)


### b write_message to a
### b write_message to a
### b send msg to a
### b send msg to a


### write message pattern: 'e'
### write message pattern: 'e'

### public compressed: '0370c658c0b0bd0c01b6db9d69c4ab7c8af03a086d58893cca8418a48ebc95357b'

### public compressed: '0370c658c0b0bd0c01b6db9d69c4ab7c8af03a086d58893cca8418a48ebc95357b'


### write message pattern: 'ee'
### write message pattern: 'ee'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIF1PgbfQ2zWWpy+KdS1vPaVeN2bfta7s9UQYQCkPi1iqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEcMZYwLC9DAG2251pxKt8ivA6CG1YiTzKhBikjryVNXtNLJTaMYCM
',
###             'Evi+H6fcgbyivaNtH8M6hy2JGMv/7Hv9CQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIF1PgbfQ2zWWpy+KdS1vPaVeN2bfta7s9UQYQCkPi1iqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEcMZYwLC9DAG2251pxKt8ivA6CG1YiTzKhBikjryVNXtNLJTaMYCM
',
###             'Evi+H6fcgbyivaNtH8M6hy2JGMv/7Hv9CQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEis1ib0mGQEd0kMCRnN+5aIgOXlYa
',
###           '7IMmhYWoPfJnLnATHYhvSteQw261rpoLIX5h90zW3hKBSiLoAmmJTGJCNw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEis1ib0mGQEd0kMCRnN+5aIgOXlYa
',
###           '7IMmhYWoPfJnLnATHYhvSteQw261rpoLIX5h90zW3hKBSiLoAmmJTGJCNw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'edfae50c04e51d6d797ea0aa8e6e933e676800e67f115495fea47784c0f05187'
### z: 'edfae50c04e51d6d797ea0aa8e6e933e676800e67f115495fea47784c0f05187'


### write message pattern: 'se'
### write message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIF1PgbfQ2zWWpy+KdS1vPaVeN2bfta7s9UQYQCkPi1iqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEcMZYwLC9DAG2251pxKt8ivA6CG1YiTzKhBikjryVNXtNLJTaMYCM
',
###             'Evi+H6fcgbyivaNtH8M6hy2JGMv/7Hv9CQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIF1PgbfQ2zWWpy+KdS1vPaVeN2bfta7s9UQYQCkPi1iqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEcMZYwLC9DAG2251pxKt8ivA6CG1YiTzKhBikjryVNXtNLJTaMYCM
',
###             'Evi+H6fcgbyivaNtH8M6hy2JGMv/7Hv9CQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '548d5b17f15bae9cc11ccf2c90c67b58e0f89ebc5cdce2fe905314c346b0513d'
### z: '548d5b17f15bae9cc11ccf2c90c67b58e0f89ebc5cdce2fe905314c346b0513d'


### write message pattern: 's'
### write message pattern: 's'


### noise encrypt
### noise encrypt
### key: '1ec77a3f5ef7be6aab73b5eac8a0f9daf32b3d98c059fc8c314888a33e877caf'
### key: '1ec77a3f5ef7be6aab73b5eac8a0f9daf32b3d98c059fc8c314888a33e877caf'
### iv: '7920b97e607809da84f15c6d'
### iv: '7920b97e607809da84f15c6d'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '4816884859483deeb5c55c6d'
### iv_xor: '4816884859483deeb5c55c6d'
### aad: '937f8baf6fafdade97de2fb63858281adf9b16b5bfe1a0f0c5a63f89a2384bb7'
### aad: '937f8baf6fafdade97de2fb63858281adf9b16b5bfe1a0f0c5a63f89a2384bb7'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### ciphertext: 'f20e7d211d4ed808678fefb7ef580ee4b2363105796b6715d291257494a6c11b269cd509119179ef'
### ciphertext: 'f20e7d211d4ed808678fefb7ef580ee4b2363105796b6715d291257494a6c11b269cd509119179ef'
### authtag: '2322af6076cbdce93b059b6854686b84'
### authtag: '2322af6076cbdce93b059b6854686b84'
### cipherinfo: '834a31363136393034343134502322af6076cbdce93b059b6854686b845828f20e7d211d4ed808678fefb7ef580ee4b2363105796b6715d291257494a6c11b269cd509119179ef'
### cipherinfo: '834a31363136393034343134502322af6076cbdce93b059b6854686b845828f20e7d211d4ed808678fefb7ef580ee4b2363105796b6715d291257494a6c11b269cd509119179ef'


### write message pattern: 'es'
### write message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEis1ib0mGQEd0kMCRnN+5aIgOXlYa
',
###           '7IMmhYWoPfJnLnATHYhvSteQw261rpoLIX5h90zW3hKBSiLoAmmJTGJCNw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEis1ib0mGQEd0kMCRnN+5aIgOXlYa
',
###           '7IMmhYWoPfJnLnATHYhvSteQw261rpoLIX5h90zW3hKBSiLoAmmJTGJCNw==
',
###           '-----END PUBLIC KEY-----
'
### z: '0a9dfb9b07adcfc16d88105bbedbecaba7113191d7e38c0211751eac16e4d91b'
### z: '0a9dfb9b07adcfc16d88105bbedbecaba7113191d7e38c0211751eac16e4d91b'


### noise encrypt
### noise encrypt
### key: '8684d91591e0ad3b8ce3e538c3675a962c50f631faaf98ba4276d38f9d71058b'
### key: '8684d91591e0ad3b8ce3e538c3675a962c50f631faaf98ba4276d38f9d71058b'
### iv: '680088c5abe416a4c02fe415'
### iv: '680088c5abe416a4c02fe415'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '5936b9f392d42290f11be415'
### iv_xor: '5936b9f392d42290f11be415'
### aad: '2554ee1d4744b6e60bd0b107a61978ecad88aa0b37d0a5eb46dc12bb0b767319'
### aad: '2554ee1d4744b6e60bd0b107a61978ecad88aa0b37d0a5eb46dc12bb0b767319'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '6a3c19cf4ec0f5d0'
### ciphertext: '6a3c19cf4ec0f5d0'
### authtag: '1b3e77008d5010c998e3bc2b15853d9c'
### authtag: '1b3e77008d5010c998e3bc2b15853d9c'
### cipherinfo: '834a31363136393034343134501b3e77008d5010c998e3bc2b15853d9c486a3c19cf4ec0f5d0'
### cipherinfo: '834a31363136393034343134501b3e77008d5010c998e3bc2b15853d9c486a3c19cf4ec0f5d0'


### b_msg: '8358210370c658c0b0bd0c01b6db9d69c4ab7c8af03a086d58893cca8418a48ebc95357b5847834a31363136393034343134502322af6076cbdce93b059b6854686b845828f20e7d211d4ed808678fefb7ef580ee4b2363105796b6715d291257494a6c11b269cd509119179ef5826834a31363136393034343134501b3e77008d5010c998e3bc2b15853d9c486a3c19cf4ec0f5d0'
### b_msg: '8358210370c658c0b0bd0c01b6db9d69c4ab7c8af03a086d58893cca8418a48ebc95357b5847834a31363136393034343134502322af6076cbdce93b059b6854686b845828f20e7d211d4ed808678fefb7ef580ee4b2363105796b6715d291257494a6c11b269cd509119179ef5826834a31363136393034343134501b3e77008d5010c998e3bc2b15853d9c486a3c19cf4ec0f5d0'
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0370c658c0b0bd0c01b6db9d69c4ab7c8af03a086d58893cca8418a48ebc95357b"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IXpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","038acd626f498640477490c0919cdfb968880e5e561aec83268585a83df2672e70"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","3de0219d08ffcb8d20b057f34aa89c04121e7e6c8251c6ceeaf3d87adb4ff9ff"),
                                h => pack("H*","328d0e025d405990e188ac6f8a722d695557306e2d7715112cd33b9946bba5fe"),
                                hasK => 1,
                                k => pack("H*","212fe55e7a8ce1ff1603855df88f29ef83a7c09fbd81e7d2259a8c51d794f07d"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","7de9581c883bbfaf9f5e5cd3cb7e02115ef97a82c6a7058a684c32b70dd31b9e"),
  },
  {
    hasK => 1,
    k => pack("H*","9f6a639413611a3a4df82da914943950e893999fb307dad27c6fa679cd9fd9b5"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0370c658c0b0bd0c01b6db9d69c4ab7c8af03a086d58893cca8418a48ebc95357b"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IXpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","038acd626f498640477490c0919cdfb968880e5e561aec83268585a83df2672e70"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","3de0219d08ffcb8d20b057f34aa89c04121e7e6c8251c6ceeaf3d87adb4ff9ff"),
                                h => pack("H*","328d0e025d405990e188ac6f8a722d695557306e2d7715112cd33b9946bba5fe"),
                                hasK => 1,
                                k => pack("H*","212fe55e7a8ce1ff1603855df88f29ef83a7c09fbd81e7d2259a8c51d794f07d"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","7de9581c883bbfaf9f5e5cd3cb7e02115ef97a82c6a7058a684c32b70dd31b9e"),
  },
  {
    hasK => 1,
    k => pack("H*","9f6a639413611a3a4df82da914943950e893999fb307dad27c6fa679cd9fd9b5"),
  },
)


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPBykb7/UZsAsUasNIacSft9535R0m0EUEciv4suIDDOoAoGCCqGSM49
',
###             'AwEHoUQDQgAEis1ib0mGQEd0kMCRnN+5aIgOXlYa7IMmhYWoPfJnLnATHYhvSteQ
',
###             'w261rpoLIX5h90zW3hKBSiLoAmmJTGJCNw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPBykb7/UZsAsUasNIacSft9535R0m0EUEciv4suIDDOoAoGCCqGSM49
',
###             'AwEHoUQDQgAEis1ib0mGQEd0kMCRnN+5aIgOXlYa7IMmhYWoPfJnLnATHYhvSteQ
',
###             'w261rpoLIX5h90zW3hKBSiLoAmmJTGJCNw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEcMZYwLC9DAG2251pxKt8ivA6CG1Y
',
###           'iTzKhBikjryVNXtNLJTaMYCMEvi+H6fcgbyivaNtH8M6hy2JGMv/7Hv9CQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEcMZYwLC9DAG2251pxKt8ivA6CG1Y
',
###           'iTzKhBikjryVNXtNLJTaMYCMEvi+H6fcgbyivaNtH8M6hy2JGMv/7Hv9CQ==
',
###           '-----END PUBLIC KEY-----
'
### z: 'edfae50c04e51d6d797ea0aa8e6e933e676800e67f115495fea47784c0f05187'
### z: 'edfae50c04e51d6d797ea0aa8e6e933e676800e67f115495fea47784c0f05187'


### read message pattern: 'se'
### read message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEcMZYwLC9DAG2251pxKt8ivA6CG1Y
',
###           'iTzKhBikjryVNXtNLJTaMYCMEvi+H6fcgbyivaNtH8M6hy2JGMv/7Hv9CQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEcMZYwLC9DAG2251pxKt8ivA6CG1Y
',
###           'iTzKhBikjryVNXtNLJTaMYCMEvi+H6fcgbyivaNtH8M6hy2JGMv/7Hv9CQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '548d5b17f15bae9cc11ccf2c90c67b58e0f89ebc5cdce2fe905314c346b0513d'
### z: '548d5b17f15bae9cc11ccf2c90c67b58e0f89ebc5cdce2fe905314c346b0513d'


### read message pattern: 's'
### read message pattern: 's'


### noise decrypt
### noise decrypt
### key: '1ec77a3f5ef7be6aab73b5eac8a0f9daf32b3d98c059fc8c314888a33e877caf'
### key: '1ec77a3f5ef7be6aab73b5eac8a0f9daf32b3d98c059fc8c314888a33e877caf'
### iv: '7920b97e607809da84f15c6d'
### iv: '7920b97e607809da84f15c6d'
### aad: '937f8baf6fafdade97de2fb63858281adf9b16b5bfe1a0f0c5a63f89a2384bb7'
### aad: '937f8baf6fafdade97de2fb63858281adf9b16b5bfe1a0f0c5a63f89a2384bb7'
### cipherinfo: '834a31363136393034343134502322af6076cbdce93b059b6854686b845828f20e7d211d4ed808678fefb7ef580ee4b2363105796b6715d291257494a6c11b269cd509119179ef'
### cipherinfo: '834a31363136393034343134502322af6076cbdce93b059b6854686b845828f20e7d211d4ed808678fefb7ef580ee4b2363105796b6715d291257494a6c11b269cd509119179ef'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '4816884859483deeb5c55c6d'
### iv_xor: '4816884859483deeb5c55c6d'
### authtag: '2322af6076cbdce93b059b6854686b84'
### authtag: '2322af6076cbdce93b059b6854686b84'
### ciphertext: 'f20e7d211d4ed808678fefb7ef580ee4b2363105796b6715d291257494a6c11b269cd509119179ef'
### ciphertext: 'f20e7d211d4ed808678fefb7ef580ee4b2363105796b6715d291257494a6c11b269cd509119179ef'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'


### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### read message pattern: 'es'

### read message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPBykb7/UZsAsUasNIacSft9535R0m0EUEciv4suIDDOoAoGCCqGSM49
',
###             'AwEHoUQDQgAEis1ib0mGQEd0kMCRnN+5aIgOXlYa7IMmhYWoPfJnLnATHYhvSteQ
',
###             'w261rpoLIX5h90zW3hKBSiLoAmmJTGJCNw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPBykb7/UZsAsUasNIacSft9535R0m0EUEciv4suIDDOoAoGCCqGSM49
',
###             'AwEHoUQDQgAEis1ib0mGQEd0kMCRnN+5aIgOXlYa7IMmhYWoPfJnLnATHYhvSteQ
',
###             'w261rpoLIX5h90zW3hKBSiLoAmmJTGJCNw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '0a9dfb9b07adcfc16d88105bbedbecaba7113191d7e38c0211751eac16e4d91b'
### z: '0a9dfb9b07adcfc16d88105bbedbecaba7113191d7e38c0211751eac16e4d91b'


### noise decrypt
### noise decrypt
### key: '8684d91591e0ad3b8ce3e538c3675a962c50f631faaf98ba4276d38f9d71058b'
### key: '8684d91591e0ad3b8ce3e538c3675a962c50f631faaf98ba4276d38f9d71058b'
### iv: '680088c5abe416a4c02fe415'
### iv: '680088c5abe416a4c02fe415'
### aad: '2554ee1d4744b6e60bd0b107a61978ecad88aa0b37d0a5eb46dc12bb0b767319'
### aad: '2554ee1d4744b6e60bd0b107a61978ecad88aa0b37d0a5eb46dc12bb0b767319'
### cipherinfo: '834a31363136393034343134501b3e77008d5010c998e3bc2b15853d9c486a3c19cf4ec0f5d0'
### cipherinfo: '834a31363136393034343134501b3e77008d5010c998e3bc2b15853d9c486a3c19cf4ec0f5d0'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '5936b9f392d42290f11be415'
### iv_xor: '5936b9f392d42290f11be415'
### authtag: '1b3e77008d5010c998e3bc2b15853d9c'
### authtag: '1b3e77008d5010c998e3bc2b15853d9c'
### ciphertext: '6a3c19cf4ec0f5d0'
### ciphertext: '6a3c19cf4ec0f5d0'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","038acd626f498640477490c0919cdfb968880e5e561aec83268585a83df2672e70"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IXpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","0370c658c0b0bd0c01b6db9d69c4ab7c8af03a086d58893cca8418a48ebc95357b"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs                     => {
                                pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                              },
    rs_pub                 => "a_rs_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","3de0219d08ffcb8d20b057f34aa89c04121e7e6c8251c6ceeaf3d87adb4ff9ff"),
                                h => pack("H*","328d0e025d405990e188ac6f8a722d695557306e2d7715112cd33b9946bba5fe"),
                                hasK => 1,
                                k => pack("H*","212fe55e7a8ce1ff1603855df88f29ef83a7c09fbd81e7d2259a8c51d794f07d"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","7de9581c883bbfaf9f5e5cd3cb7e02115ef97a82c6a7058a684c32b70dd31b9e"),
  },
  {
    hasK => 1,
    k => pack("H*","9f6a639413611a3a4df82da914943950e893999fb307dad27c6fa679cd9fd9b5"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","038acd626f498640477490c0919cdfb968880e5e561aec83268585a83df2672e70"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e", "s"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IXpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","0370c658c0b0bd0c01b6db9d69c4ab7c8af03a086d58893cca8418a48ebc95357b"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs                     => {
                                pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                              },
    rs_pub                 => "a_rs_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","3de0219d08ffcb8d20b057f34aa89c04121e7e6c8251c6ceeaf3d87adb4ff9ff"),
                                h => pack("H*","328d0e025d405990e188ac6f8a722d695557306e2d7715112cd33b9946bba5fe"),
                                hasK => 1,
                                k => pack("H*","212fe55e7a8ce1ff1603855df88f29ef83a7c09fbd81e7d2259a8c51d794f07d"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","7de9581c883bbfaf9f5e5cd3cb7e02115ef97a82c6a7058a684c32b70dd31b9e"),
  },
  {
    hasK => 1,
    k => pack("H*","9f6a639413611a3a4df82da914943950e893999fb307dad27c6fa679cd9fd9b5"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '2f98dc31b54a06eef5a6145849426f83b69b67df6356b8bd7b5cc5e1512bfd10'
### key: '2f98dc31b54a06eef5a6145849426f83b69b67df6356b8bd7b5cc5e1512bfd10'
### iv: 'f0181cf2915c94b082cb5bb6'
### iv: 'f0181cf2915c94b082cb5bb6'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'c12e2dc4a86ca084b3ff5bb6'
### iv_xor: 'c12e2dc4a86ca084b3ff5bb6'
### aad: '328d0e025d405990e188ac6f8a722d695557306e2d7715112cd33b9946bba5fe'
### aad: '328d0e025d405990e188ac6f8a722d695557306e2d7715112cd33b9946bba5fe'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'fc8765f4e04ad1aca5ae2b02c636a14f5c2cc32f1684157780e344a3ff92e5c2402491aa05b486fbcb76987eef4b4561c91d94'
### ciphertext: 'fc8765f4e04ad1aca5ae2b02c636a14f5c2cc32f1684157780e344a3ff92e5c2402491aa05b486fbcb76987eef4b4561c91d94'
### authtag: '3a2f0a17f651abcac9646adc3fafe46c'
### authtag: '3a2f0a17f651abcac9646adc3fafe46c'
### cipherinfo: '834a31363136393034343134503a2f0a17f651abcac9646adc3fafe46c5833fc8765f4e04ad1aca5ae2b02c636a14f5c2cc32f1684157780e344a3ff92e5c2402491aa05b486fbcb76987eef4b4561c91d94'
### cipherinfo: '834a31363136393034343134503a2f0a17f651abcac9646adc3fafe46c5833fc8765f4e04ad1aca5ae2b02c636a14f5c2cc32f1684157780e344a3ff92e5c2402491aa05b486fbcb76987eef4b4561c91d94'


### b recv comm msg from a
### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '2f98dc31b54a06eef5a6145849426f83b69b67df6356b8bd7b5cc5e1512bfd10'
### key: '2f98dc31b54a06eef5a6145849426f83b69b67df6356b8bd7b5cc5e1512bfd10'
### iv: 'f0181cf2915c94b082cb5bb6'
### iv: 'f0181cf2915c94b082cb5bb6'
### aad: '328d0e025d405990e188ac6f8a722d695557306e2d7715112cd33b9946bba5fe'
### aad: '328d0e025d405990e188ac6f8a722d695557306e2d7715112cd33b9946bba5fe'
### cipherinfo: '834a31363136393034343134503a2f0a17f651abcac9646adc3fafe46c5833fc8765f4e04ad1aca5ae2b02c636a14f5c2cc32f1684157780e344a3ff92e5c2402491aa05b486fbcb76987eef4b4561c91d94'
### cipherinfo: '834a31363136393034343134503a2f0a17f651abcac9646adc3fafe46c5833fc8765f4e04ad1aca5ae2b02c636a14f5c2cc32f1684157780e344a3ff92e5c2402491aa05b486fbcb76987eef4b4561c91d94'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'c12e2dc4a86ca084b3ff5bb6'
### iv_xor: 'c12e2dc4a86ca084b3ff5bb6'
### authtag: '3a2f0a17f651abcac9646adc3fafe46c'
### authtag: '3a2f0a17f651abcac9646adc3fafe46c'
### ciphertext: 'fc8765f4e04ad1aca5ae2b02c636a14f5c2cc32f1684157780e344a3ff92e5c2402491aa05b486fbcb76987eef4b4561c91d94'
### ciphertext: 'fc8765f4e04ad1aca5ae2b02c636a14f5c2cc32f1684157780e344a3ff92e5c2402491aa05b486fbcb76987eef4b4561c91d94'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'

### b to a , plain_b.txt to trans_cipherinfo_b

### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: '53129edbbce1a3dbfb766f052126761b70a96f02869d113406edb5cc08fb88a0'
### key: '53129edbbce1a3dbfb766f052126761b70a96f02869d113406edb5cc08fb88a0'
### iv: 'f636a9b03f6e5b02b121b3c9'
### iv: 'f636a9b03f6e5b02b121b3c9'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'c7009886065e6f368015b3c9'
### iv_xor: 'c7009886065e6f368015b3c9'
### aad: '328d0e025d405990e188ac6f8a722d695557306e2d7715112cd33b9946bba5fe'
### aad: '328d0e025d405990e188ac6f8a722d695557306e2d7715112cd33b9946bba5fe'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'f1f7f47394c8eda4ea9f567b7d9531e7f077cf30bc71430ddc1bb9b9aa2753aa9cb566daaf4b5c01a72d73ecdb7db8'
### ciphertext: 'f1f7f47394c8eda4ea9f567b7d9531e7f077cf30bc71430ddc1bb9b9aa2753aa9cb566daaf4b5c01a72d73ecdb7db8'
### authtag: '10591aeb3b3f414e4b6ee530c60a9969'
### authtag: '10591aeb3b3f414e4b6ee530c60a9969'
### cipherinfo: '834a313631363930343431345010591aeb3b3f414e4b6ee530c60a9969582ff1f7f47394c8eda4ea9f567b7d9531e7f077cf30bc71430ddc1bb9b9aa2753aa9cb566daaf4b5c01a72d73ecdb7db8'
### cipherinfo: '834a313631363930343431345010591aeb3b3f414e4b6ee530c60a9969582ff1f7f47394c8eda4ea9f567b7d9531e7f077cf30bc71430ddc1bb9b9aa2753aa9cb566daaf4b5c01a72d73ecdb7db8'

### a recv comm msg from b

### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: '53129edbbce1a3dbfb766f052126761b70a96f02869d113406edb5cc08fb88a0'
### key: '53129edbbce1a3dbfb766f052126761b70a96f02869d113406edb5cc08fb88a0'
### iv: 'f636a9b03f6e5b02b121b3c9'
### iv: 'f636a9b03f6e5b02b121b3c9'
### aad: '328d0e025d405990e188ac6f8a722d695557306e2d7715112cd33b9946bba5fe'
### aad: '328d0e025d405990e188ac6f8a722d695557306e2d7715112cd33b9946bba5fe'
### cipherinfo: '834a313631363930343431345010591aeb3b3f414e4b6ee530c60a9969582ff1f7f47394c8eda4ea9f567b7d9531e7f077cf30bc71430ddc1bb9b9aa2753aa9cb566daaf4b5c01a72d73ecdb7db8'
### cipherinfo: '834a313631363930343431345010591aeb3b3f414e4b6ee530c60a9969582ff1f7f47394c8eda4ea9f567b7d9531e7f077cf30bc71430ddc1bb9b9aa2753aa9cb566daaf4b5c01a72d73ecdb7db8'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'c7009886065e6f368015b3c9'
### iv_xor: 'c7009886065e6f368015b3c9'
### authtag: '10591aeb3b3f414e4b6ee530c60a9969'
### authtag: '10591aeb3b3f414e4b6ee530c60a9969'
### ciphertext: 'f1f7f47394c8eda4ea9f567b7d9531e7f077cf30bc71430ddc1bb9b9aa2753aa9cb566daaf4b5c01a72d73ecdb7db8'
### ciphertext: 'f1f7f47394c8eda4ea9f567b7d9531e7f077cf30bc71430ddc1bb9b9aa2753aa9cb566daaf4b5c01a72d73ecdb7db8'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'IX',
###                               'test_psk',
###                               0
### -----------end test --------: 'IX',
###                               'test_psk',
###                               0


### -----------start test --------: 'IX',
###                                 'test_psk',
###                                 1
### -----------start test --------: 'IX',
###                                 'test_psk',
###                                 1


### a write message to b
### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IXpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","54b12bf0108f1be22aa1f3a2a728ed42c90bb464fb6f288144d1bba93acd5fd1"),
                              h  => pack("H*","a51366879d1414a6cc66272b9f59c4839472e691700ab1384f392c2ab3495988"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IXpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","54b12bf0108f1be22aa1f3a2a728ed42c90bb464fb6f288144d1bba93acd5fd1"),
                              h  => pack("H*","a51366879d1414a6cc66272b9f59c4839472e691700ab1384f392c2ab3495988"),
                            },
  who                    => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '0243d444503aa6a5ad777978ddc86d09cd578f8c55d8ea522399ce2232b3b49db3'

### public compressed: '0243d444503aa6a5ad777978ddc86d09cd578f8c55d8ea522399ce2232b3b49db3'


### write message pattern: 's'
### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '979446245cf01f10957c7d0a6047517eb93390e9e097fda978ebbbd65af125c2'
### key: '979446245cf01f10957c7d0a6047517eb93390e9e097fda978ebbbd65af125c2'
### iv: 'd66f686e252154531f78e97e'
### iv: 'd66f686e252154531f78e97e'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'e75959581c1160672e4ce97e'
### iv_xor: 'e75959581c1160672e4ce97e'
### aad: '2872e387fb8c6f85ede5255ffc7c802f08675d181a94afaacb79d04bab52cf79'
### aad: '2872e387fb8c6f85ede5255ffc7c802f08675d181a94afaacb79d04bab52cf79'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: '5e6840b887ac23fa84bb61ac37c7b3e58d3c11fe46e8ca4568c5c67de34ca0952ec0e4720b997df2'
### ciphertext: '5e6840b887ac23fa84bb61ac37c7b3e58d3c11fe46e8ca4568c5c67de34ca0952ec0e4720b997df2'
### authtag: 'b8e5a63a7648a5cda9f70d1a437ec022'
### authtag: 'b8e5a63a7648a5cda9f70d1a437ec022'
### cipherinfo: '834a3136313639303434313450b8e5a63a7648a5cda9f70d1a437ec02258285e6840b887ac23fa84bb61ac37c7b3e58d3c11fe46e8ca4568c5c67de34ca0952ec0e4720b997df2'
### cipherinfo: '834a3136313639303434313450b8e5a63a7648a5cda9f70d1a437ec02258285e6840b887ac23fa84bb61ac37c7b3e58d3c11fe46e8ca4568c5c67de34ca0952ec0e4720b997df2'


### write message pattern: 'psk'
### write message pattern: 'psk'


### noise encrypt
### noise encrypt
### key: '8ab69bb8fd9cd4748ad117ae18f29e1dd23348ac3d749fad2e862310beeaf130'
### key: '8ab69bb8fd9cd4748ad117ae18f29e1dd23348ac3d749fad2e862310beeaf130'
### iv: 'c448919336f58642fcee36f3'
### iv: 'c448919336f58642fcee36f3'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'f57ea0a50fc5b276cdda36f3'
### iv_xor: 'f57ea0a50fc5b276cdda36f3'
### aad: '8f5fdfbe9cbc80f69eb3166f73593cdec469aacca45cd1fba05793351b00ead3'
### aad: '8f5fdfbe9cbc80f69eb3166f73593cdec469aacca45cd1fba05793351b00ead3'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '300db658ef039261'
### ciphertext: '300db658ef039261'
### authtag: 'd005a64f2ab0bb9c712c6029347a6c2c'
### authtag: 'd005a64f2ab0bb9c712c6029347a6c2c'
### cipherinfo: '834a3136313639303434313450d005a64f2ab0bb9c712c6029347a6c2c48300db658ef039261'
### cipherinfo: '834a3136313639303434313450d005a64f2ab0bb9c712c6029347a6c2c48300db658ef039261'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghAkPURFA6pqWtd3l43chtCc1Xj4xV2OpSI5nOIjKztJ2zWEeDSjE2MTY5MDQ0MTRQuOWmOnZIpc2p9w0aQ37AIlgoXmhAuIesI/qEu2GsN8ez5Y08Ef5G6MpFaMXGfeNMoJUuwORyC5l98lgmg0oxNjE2OTA0NDE0UNAFpk8qsLuccSxgKTR6bCxIMA22WO8DkmE="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("g1ghAkPURFA6pqWtd3l43chtCc1Xj4xV2OpSI5nOIjKztJ2zWEeDSjE2MTY5MDQ0MTRQuOWmOnZIpc2p9w0aQ37AIlgoXmhAuIesI/qEu2GsN8ez5Y08Ef5G6MpFaMXGfeNMoJUuwORyC5l98lgmg0oxNjE2OTA0NDE0UNAFpk8qsLuccSxgKTR6bCxIMA22WO8DkmE="),
  );
}
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0243d444503aa6a5ad777978ddc86d09cd578f8c55d8ea522399ce2232b3b49db3"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IXpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","d2c0727f06e8ee9ca5f65c0a54a469a14b137ba3a3ae48487f1738a3644d38e0"),
                                h => pack("H*","fcd08a06bc4406b0bed87cb452e5da609c4cff99acc058a7c1bbc55a74050197"),
                                hasK => 1,
                                k => pack("H*","5f3512453082c3901aca093d1e862417c90be41f87a07e5ef57a39bead6c7088"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0243d444503aa6a5ad777978ddc86d09cd578f8c55d8ea522399ce2232b3b49db3"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IXpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","d2c0727f06e8ee9ca5f65c0a54a469a14b137ba3a3ae48487f1738a3644d38e0"),
                                h => pack("H*","fcd08a06bc4406b0bed87cb452e5da609c4cff99acc058a7c1bbc55a74050197"),
                                hasK => 1,
                                k => pack("H*","5f3512453082c3901aca093d1e862417c90be41f87a07e5ef57a39bead6c7088"),
                              },
    who                    => "a",
  },
)


### b read message from a
### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IXpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","54b12bf0108f1be22aa1f3a2a728ed42c90bb464fb6f288144d1bba93acd5fd1"),
                              h  => pack("H*","a51366879d1414a6cc66272b9f59c4839472e691700ab1384f392c2ab3495988"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "IX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_IXpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","54b12bf0108f1be22aa1f3a2a728ed42c90bb464fb6f288144d1bba93acd5fd1"),
                              h  => pack("H*","a51366879d1414a6cc66272b9f59c4839472e691700ab1384f392c2ab3495988"),
                            },
  who                    => "b",
}


### b recv msg from a
### b recv msg from a


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 's'

### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: '979446245cf01f10957c7d0a6047517eb93390e9e097fda978ebbbd65af125c2'
### key: '979446245cf01f10957c7d0a6047517eb93390e9e097fda978ebbbd65af125c2'
### iv: 'd66f686e252154531f78e97e'
### iv: 'd66f686e252154531f78e97e'
### aad: '2872e387fb8c6f85ede5255ffc7c802f08675d181a94afaacb79d04bab52cf79'
### aad: '2872e387fb8c6f85ede5255ffc7c802f08675d181a94afaacb79d04bab52cf79'
### cipherinfo: '834a3136313639303434313450b8e5a63a7648a5cda9f70d1a437ec02258285e6840b887ac23fa84bb61ac37c7b3e58d3c11fe46e8ca4568c5c67de34ca0952ec0e4720b997df2'
### cipherinfo: '834a3136313639303434313450b8e5a63a7648a5cda9f70d1a437ec02258285e6840b887ac23fa84bb61ac37c7b3e58d3c11fe46e8ca4568c5c67de34ca0952ec0e4720b997df2'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'e75959581c1160672e4ce97e'
### iv_xor: 'e75959581c1160672e4ce97e'
### authtag: 'b8e5a63a7648a5cda9f70d1a437ec022'
### authtag: 'b8e5a63a7648a5cda9f70d1a437ec022'
### ciphertext: '5e6840b887ac23fa84bb61ac37c7b3e58d3c11fe46e8ca4568c5c67de34ca0952ec0e4720b997df2'
### ciphertext: '5e6840b887ac23fa84bb61ac37c7b3e58d3c11fe46e8ca4568c5c67de34ca0952ec0e4720b997df2'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'


### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### read message pattern: 'psk'

### read message pattern: 'psk'

### noise decrypt

### noise decrypt
### key: '8ab69bb8fd9cd4748ad117ae18f29e1dd23348ac3d749fad2e862310beeaf130'
### key: '8ab69bb8fd9cd4748ad117ae18f29e1dd23348ac3d749fad2e862310beeaf130'
### iv: 'c448919336f58642fcee36f3'
### iv: 'c448919336f58642fcee36f3'
### aad: '8f5fdfbe9cbc80f69eb3166f73593cdec469aacca45cd1fba05793351b00ead3'
### aad: '8f5fdfbe9cbc80f69eb3166f73593cdec469aacca45cd1fba05793351b00ead3'
### cipherinfo: '834a3136313639303434313450d005a64f2ab0bb9c712c6029347a6c2c48300db658ef039261'
### cipherinfo: '834a3136313639303434313450d005a64f2ab0bb9c712c6029347a6c2c48300db658ef039261'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'f57ea0a50fc5b276cdda36f3'
### iv_xor: 'f57ea0a50fc5b276cdda36f3'
### authtag: 'd005a64f2ab0bb9c712c6029347a6c2c'
### authtag: 'd005a64f2ab0bb9c712c6029347a6c2c'
### ciphertext: '300db658ef039261'
### ciphertext: '300db658ef039261'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IXpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","0243d444503aa6a5ad777978ddc86d09cd578f8c55d8ea522399ce2232b3b49db3"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","d2c0727f06e8ee9ca5f65c0a54a469a14b137ba3a3ae48487f1738a3644d38e0"),
                                h => pack("H*","fcd08a06bc4406b0bed87cb452e5da609c4cff99acc058a7c1bbc55a74050197"),
                                hasK => 1,
                                k => pack("H*","5f3512453082c3901aca093d1e862417c90be41f87a07e5ef57a39bead6c7088"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_IXpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","0243d444503aa6a5ad777978ddc86d09cd578f8c55d8ea522399ce2232b3b49db3"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","d2c0727f06e8ee9ca5f65c0a54a469a14b137ba3a3ae48487f1738a3644d38e0"),
                                h => pack("H*","fcd08a06bc4406b0bed87cb452e5da609c4cff99acc058a7c1bbc55a74050197"),
                                hasK => 1,
                                k => pack("H*","5f3512453082c3901aca093d1e862417c90be41f87a07e5ef57a39bead6c7088"),
                              },
    who                    => "b",
  },
)


### b write_message to a
### b write_message to a
### b send msg to a
### b send msg to a


### write message pattern: 'e'
### write message pattern: 'e'


### public compressed: '028c3da5b344b221b49068aec6d3f7aaa06d19df45147d42f8b004dfdff14b81fc'
### public compressed: '028c3da5b344b221b49068aec6d3f7aaa06d19df45147d42f8b004dfdff14b81fc'

### write message pattern: 'ee'

### write message pattern: 'ee'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICocI2SMEzrYB53emJEzy7/lVjlzwtJT19ky0L+y8zjPoAoGCCqGSM49
',
###             'AwEHoUQDQgAEjD2ls0SyIbSQaK7G0/eqoG0Z30UUfUL4sATf3/FLgfz182CAqXp/
',
###             'gItBdLOi6qPkGNzwEMtQQ4mzRuSD2by6HA==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICocI2SMEzrYB53emJEzy7/lVjlzwtJT19ky0L+y8zjPoAoGCCqGSM49
',
###             'AwEHoUQDQgAEjD2ls0SyIbSQaK7G0/eqoG0Z30UUfUL4sATf3/FLgfz182CAqXp/
',
###             'gItBdLOi6qPkGNzwEMtQQ4mzRuSD2by6HA==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQ9REUDqmpa13eXjdyG0JzVePjFXY
',
###           '6lIjmc4iMrO0nbPI5//aSe58S5qGeiDt0NxZjUlIBuIELvrPxhI05Xe6DA==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQ9REUDqmpa13eXjdyG0JzVePjFXY
',
###           '6lIjmc4iMrO0nbPI5//aSe58S5qGeiDt0NxZjUlIBuIELvrPxhI05Xe6DA==
',
###           '-----END PUBLIC KEY-----
'
### z: 'ad9ddbc316e5ebacb6b46cfcc0676e9f5316cf6a2711c134e01d5dd411b37f97'
### z: 'ad9ddbc316e5ebacb6b46cfcc0676e9f5316cf6a2711c134e01d5dd411b37f97'


### write message pattern: 'se'
### write message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICocI2SMEzrYB53emJEzy7/lVjlzwtJT19ky0L+y8zjPoAoGCCqGSM49
',
###             'AwEHoUQDQgAEjD2ls0SyIbSQaK7G0/eqoG0Z30UUfUL4sATf3/FLgfz182CAqXp/
',
###             'gItBdLOi6qPkGNzwEMtQQ4mzRuSD2by6HA==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEICocI2SMEzrYB53emJEzy7/lVjlzwtJT19ky0L+y8zjPoAoGCCqGSM49
',
###             'AwEHoUQDQgAEjD2ls0SyIbSQaK7G0/eqoG0Z30UUfUL4sATf3/FLgfz182CAqXp/
',
###             'gItBdLOi6qPkGNzwEMtQQ4mzRuSD2by6HA==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'bd7076661829364888d802926302d9d3b8bcba1e62395b4680bfbe9b501218a8'
### z: 'bd7076661829364888d802926302d9d3b8bcba1e62395b4680bfbe9b501218a8'


### write message pattern: 's'
### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '3053a51053e383f2c881de42c05ea524415a0f987d0fcba0c5d702ba046a0412'
### key: '3053a51053e383f2c881de42c05ea524415a0f987d0fcba0c5d702ba046a0412'
### iv: '04edcf464e399a394cba1472'
### iv: '04edcf464e399a394cba1472'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '35dbfe707709ae0d7d8e1472'
### iv_xor: '35dbfe707709ae0d7d8e1472'
### aad: 'd11e04878266752802b16751aabae59d62c5cd2286d38511a6a87386f993de15'
### aad: 'd11e04878266752802b16751aabae59d62c5cd2286d38511a6a87386f993de15'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### ciphertext: 'bbbf7ea4b5de4922cab71883b99e1f672a110bb1cfe9fe0156354c9267cc4c58787e9a78cc03eeef'
### ciphertext: 'bbbf7ea4b5de4922cab71883b99e1f672a110bb1cfe9fe0156354c9267cc4c58787e9a78cc03eeef'
### authtag: 'dabf25cd39689064caea6ebd12c176d2'
### authtag: 'dabf25cd39689064caea6ebd12c176d2'
### cipherinfo: '834a3136313639303434313450dabf25cd39689064caea6ebd12c176d25828bbbf7ea4b5de4922cab71883b99e1f672a110bb1cfe9fe0156354c9267cc4c58787e9a78cc03eeef'
### cipherinfo: '834a3136313639303434313450dabf25cd39689064caea6ebd12c176d25828bbbf7ea4b5de4922cab71883b99e1f672a110bb1cfe9fe0156354c9267cc4c58787e9a78cc03eeef'


### write message pattern: 'es'
### write message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQ9REUDqmpa13eXjdyG0JzVePjFXY
',
###           '6lIjmc4iMrO0nbPI5//aSe58S5qGeiDt0NxZjUlIBuIELvrPxhI05Xe6DA==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQ9REUDqmpa13eXjdyG0JzVePjFXY
',
###           '6lIjmc4iMrO0nbPI5//aSe58S5qGeiDt0NxZjUlIBuIELvrPxhI05Xe6DA==
',
###           '-----END PUBLIC KEY-----
'
### z: '7852572585c4c227fa5f18b0b9e5c15f93e8f614bc4d9ab11e7efd42a41c3f4c'
### z: '7852572585c4c227fa5f18b0b9e5c15f93e8f614bc4d9ab11e7efd42a41c3f4c'


### noise encrypt
### noise encrypt
### key: 'd86d620803c31d1692a1e7137a80161663ffe808157ff21ddf36af8b5f537682'
### key: 'd86d620803c31d1692a1e7137a80161663ffe808157ff21ddf36af8b5f537682'
### iv: '63474c618fbf147af6e45fab'
### iv: '63474c618fbf147af6e45fab'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '52717d57b68f204ec7d05fab'
### iv_xor: '52717d57b68f204ec7d05fab'
### aad: '7ad7c11413db683977f14d5e8f8600ea44bc649c382db6e9f70bae26c65af02a'
### aad: '7ad7c11413db683977f14d5e8f8600ea44bc649c382db6e9f70bae26c65af02a'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '2ccc7366b7b61f6d'
### ciphertext: '2ccc7366b7b61f6d'
### authtag: 'd5715f41f6f4c6bf0818073620faca64'
### authtag: 'd5715f41f6f4c6bf0818073620faca64'
### cipherinfo: '834a3136313639303434313450d5715f41f6f4c6bf0818073620faca64482ccc7366b7b61f6d'
### cipherinfo: '834a3136313639303434313450d5715f41f6f4c6bf0818073620faca64482ccc7366b7b61f6d'


### b_msg: '835821028c3da5b344b221b49068aec6d3f7aaa06d19df45147d42f8b004dfdff14b81fc5847834a3136313639303434313450dabf25cd39689064caea6ebd12c176d25828bbbf7ea4b5de4922cab71883b99e1f672a110bb1cfe9fe0156354c9267cc4c58787e9a78cc03eeef5826834a3136313639303434313450d5715f41f6f4c6bf0818073620faca64482ccc7366b7b61f6d'
### b_msg: '835821028c3da5b344b221b49068aec6d3f7aaa06d19df45147d42f8b004dfdff14b81fc5847834a3136313639303434313450dabf25cd39689064caea6ebd12c176d25828bbbf7ea4b5de4922cab71883b99e1f672a110bb1cfe9fe0156354c9267cc4c58787e9a78cc03eeef5826834a3136313639303434313450d5715f41f6f4c6bf0818073620faca64482ccc7366b7b61f6d'
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","028c3da5b344b221b49068aec6d3f7aaa06d19df45147d42f8b004dfdff14b81fc"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IXpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","0243d444503aa6a5ad777978ddc86d09cd578f8c55d8ea522399ce2232b3b49db3"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","51e0e971f316dd9fd932196bedd5c72c5f1b8bb6677be79fb94a8142ad4b08e2"),
                                h => pack("H*","77e7169e05f9c49f854890118365ce1cea4009c919ed2225fcc8ba73b70f83ae"),
                                hasK => 1,
                                k => pack("H*","79cae985b5740f3c66dda1207830673c0d6f08e16270c9131cf544e527419da5"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","158e8363f2fa0df04b82b4fc60a889d6117fabe85880c97cc88b5c3bb75f4918"),
  },
  {
    hasK => 1,
    k => pack("H*","c8a5ccf42179aa19348ac9b4793eb5061ab64c24b95f0ecb4ec9dcf18a3d4916"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","028c3da5b344b221b49068aec6d3f7aaa06d19df45147d42f8b004dfdff14b81fc"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IXpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","0243d444503aa6a5ad777978ddc86d09cd578f8c55d8ea522399ce2232b3b49db3"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","51e0e971f316dd9fd932196bedd5c72c5f1b8bb6677be79fb94a8142ad4b08e2"),
                                h => pack("H*","77e7169e05f9c49f854890118365ce1cea4009c919ed2225fcc8ba73b70f83ae"),
                                hasK => 1,
                                k => pack("H*","79cae985b5740f3c66dda1207830673c0d6f08e16270c9131cf544e527419da5"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","158e8363f2fa0df04b82b4fc60a889d6117fabe85880c97cc88b5c3bb75f4918"),
  },
  {
    hasK => 1,
    k => pack("H*","c8a5ccf42179aa19348ac9b4793eb5061ab64c24b95f0ecb4ec9dcf18a3d4916"),
  },
)


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b


### read message pattern: 'e'
### read message pattern: 'e'


### read message pattern: 'ee'
### read message pattern: 'ee'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBCJlb30MgUYehtYDE5B36CjvjTWGdDNCwoVqwP16ZGaoAoGCCqGSM49
',
###             'AwEHoUQDQgAEQ9REUDqmpa13eXjdyG0JzVePjFXY6lIjmc4iMrO0nbPI5//aSe58
',
###             'S5qGeiDt0NxZjUlIBuIELvrPxhI05Xe6DA==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBCJlb30MgUYehtYDE5B36CjvjTWGdDNCwoVqwP16ZGaoAoGCCqGSM49
',
###             'AwEHoUQDQgAEQ9REUDqmpa13eXjdyG0JzVePjFXY6lIjmc4iMrO0nbPI5//aSe58
',
###             'S5qGeiDt0NxZjUlIBuIELvrPxhI05Xe6DA==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEjD2ls0SyIbSQaK7G0/eqoG0Z30UU
',
###           'fUL4sATf3/FLgfz182CAqXp/gItBdLOi6qPkGNzwEMtQQ4mzRuSD2by6HA==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEjD2ls0SyIbSQaK7G0/eqoG0Z30UU
',
###           'fUL4sATf3/FLgfz182CAqXp/gItBdLOi6qPkGNzwEMtQQ4mzRuSD2by6HA==
',
###           '-----END PUBLIC KEY-----
'
### z: 'ad9ddbc316e5ebacb6b46cfcc0676e9f5316cf6a2711c134e01d5dd411b37f97'
### z: 'ad9ddbc316e5ebacb6b46cfcc0676e9f5316cf6a2711c134e01d5dd411b37f97'


### read message pattern: 'se'
### read message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEjD2ls0SyIbSQaK7G0/eqoG0Z30UU
',
###           'fUL4sATf3/FLgfz182CAqXp/gItBdLOi6qPkGNzwEMtQQ4mzRuSD2by6HA==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEjD2ls0SyIbSQaK7G0/eqoG0Z30UU
',
###           'fUL4sATf3/FLgfz182CAqXp/gItBdLOi6qPkGNzwEMtQQ4mzRuSD2by6HA==
',
###           '-----END PUBLIC KEY-----
'
### z: 'bd7076661829364888d802926302d9d3b8bcba1e62395b4680bfbe9b501218a8'
### z: 'bd7076661829364888d802926302d9d3b8bcba1e62395b4680bfbe9b501218a8'


### read message pattern: 's'
### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: '3053a51053e383f2c881de42c05ea524415a0f987d0fcba0c5d702ba046a0412'
### key: '3053a51053e383f2c881de42c05ea524415a0f987d0fcba0c5d702ba046a0412'
### iv: '04edcf464e399a394cba1472'
### iv: '04edcf464e399a394cba1472'
### aad: 'd11e04878266752802b16751aabae59d62c5cd2286d38511a6a87386f993de15'
### aad: 'd11e04878266752802b16751aabae59d62c5cd2286d38511a6a87386f993de15'
### cipherinfo: '834a3136313639303434313450dabf25cd39689064caea6ebd12c176d25828bbbf7ea4b5de4922cab71883b99e1f672a110bb1cfe9fe0156354c9267cc4c58787e9a78cc03eeef'
### cipherinfo: '834a3136313639303434313450dabf25cd39689064caea6ebd12c176d25828bbbf7ea4b5de4922cab71883b99e1f672a110bb1cfe9fe0156354c9267cc4c58787e9a78cc03eeef'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '35dbfe707709ae0d7d8e1472'
### iv_xor: '35dbfe707709ae0d7d8e1472'
### authtag: 'dabf25cd39689064caea6ebd12c176d2'
### authtag: 'dabf25cd39689064caea6ebd12c176d2'
### ciphertext: 'bbbf7ea4b5de4922cab71883b99e1f672a110bb1cfe9fe0156354c9267cc4c58787e9a78cc03eeef'
### ciphertext: 'bbbf7ea4b5de4922cab71883b99e1f672a110bb1cfe9fe0156354c9267cc4c58787e9a78cc03eeef'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'


### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'


### read message pattern: 'es'
### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBCJlb30MgUYehtYDE5B36CjvjTWGdDNCwoVqwP16ZGaoAoGCCqGSM49
',
###             'AwEHoUQDQgAEQ9REUDqmpa13eXjdyG0JzVePjFXY6lIjmc4iMrO0nbPI5//aSe58
',
###             'S5qGeiDt0NxZjUlIBuIELvrPxhI05Xe6DA==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBCJlb30MgUYehtYDE5B36CjvjTWGdDNCwoVqwP16ZGaoAoGCCqGSM49
',
###             'AwEHoUQDQgAEQ9REUDqmpa13eXjdyG0JzVePjFXY6lIjmc4iMrO0nbPI5//aSe58
',
###             'S5qGeiDt0NxZjUlIBuIELvrPxhI05Xe6DA==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '7852572585c4c227fa5f18b0b9e5c15f93e8f614bc4d9ab11e7efd42a41c3f4c'
### z: '7852572585c4c227fa5f18b0b9e5c15f93e8f614bc4d9ab11e7efd42a41c3f4c'


### noise decrypt
### noise decrypt
### key: 'd86d620803c31d1692a1e7137a80161663ffe808157ff21ddf36af8b5f537682'
### key: 'd86d620803c31d1692a1e7137a80161663ffe808157ff21ddf36af8b5f537682'
### iv: '63474c618fbf147af6e45fab'
### iv: '63474c618fbf147af6e45fab'
### aad: '7ad7c11413db683977f14d5e8f8600ea44bc649c382db6e9f70bae26c65af02a'
### aad: '7ad7c11413db683977f14d5e8f8600ea44bc649c382db6e9f70bae26c65af02a'
### cipherinfo: '834a3136313639303434313450d5715f41f6f4c6bf0818073620faca64482ccc7366b7b61f6d'
### cipherinfo: '834a3136313639303434313450d5715f41f6f4c6bf0818073620faca64482ccc7366b7b61f6d'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '52717d57b68f204ec7d05fab'
### iv_xor: '52717d57b68f204ec7d05fab'
### authtag: 'd5715f41f6f4c6bf0818073620faca64'
### authtag: 'd5715f41f6f4c6bf0818073620faca64'
### ciphertext: '2ccc7366b7b61f6d'
### ciphertext: '2ccc7366b7b61f6d'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0243d444503aa6a5ad777978ddc86d09cd578f8c55d8ea522399ce2232b3b49db3"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IXpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","028c3da5b344b221b49068aec6d3f7aaa06d19df45147d42f8b004dfdff14b81fc"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs                     => {
                                pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                              },
    rs_pub                 => "a_rs_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","51e0e971f316dd9fd932196bedd5c72c5f1b8bb6677be79fb94a8142ad4b08e2"),
                                h => pack("H*","77e7169e05f9c49f854890118365ce1cea4009c919ed2225fcc8ba73b70f83ae"),
                                hasK => 1,
                                k => pack("H*","79cae985b5740f3c66dda1207830673c0d6f08e16270c9131cf544e527419da5"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","158e8363f2fa0df04b82b4fc60a889d6117fabe85880c97cc88b5c3bb75f4918"),
  },
  {
    hasK => 1,
    k => pack("H*","c8a5ccf42179aa19348ac9b4793eb5061ab64c24b95f0ecb4ec9dcf18a3d4916"),
  },
)
(
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0243d444503aa6a5ad777978ddc86d09cd578f8c55d8ea522399ce2232b3b49db3"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "IX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "s", "psk"], ["e", "ee", "se", "s", "es"]],
    msg_id                 => 2,
    prologue               => "some_info",
    protocol_name          => "Noise_IXpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","028c3da5b344b221b49068aec6d3f7aaa06d19df45147d42f8b004dfdff14b81fc"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs                     => {
                                pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                              },
    rs_pub                 => "a_rs_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","51e0e971f316dd9fd932196bedd5c72c5f1b8bb6677be79fb94a8142ad4b08e2"),
                                h => pack("H*","77e7169e05f9c49f854890118365ce1cea4009c919ed2225fcc8ba73b70f83ae"),
                                hasK => 1,
                                k => pack("H*","79cae985b5740f3c66dda1207830673c0d6f08e16270c9131cf544e527419da5"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","158e8363f2fa0df04b82b4fc60a889d6117fabe85880c97cc88b5c3bb75f4918"),
  },
  {
    hasK => 1,
    k => pack("H*","c8a5ccf42179aa19348ac9b4793eb5061ab64c24b95f0ecb4ec9dcf18a3d4916"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '5e19271b734d4f0cd2f1d973d7bd7c00254fe184b7135682b6a5ed4ef7d1efac'
### key: '5e19271b734d4f0cd2f1d973d7bd7c00254fe184b7135682b6a5ed4ef7d1efac'
### iv: 'fd734b2a8bc12937b99e42a1'
### iv: 'fd734b2a8bc12937b99e42a1'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'cc457a1cb2f11d0388aa42a1'
### iv_xor: 'cc457a1cb2f11d0388aa42a1'
### aad: '77e7169e05f9c49f854890118365ce1cea4009c919ed2225fcc8ba73b70f83ae'
### aad: '77e7169e05f9c49f854890118365ce1cea4009c919ed2225fcc8ba73b70f83ae'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'a23bdc60f4794be521380451770fcbc4dfb6eae6682361c5648b4929d170286979a4cd774baa393b47dce5059dfa2253e3225d'
### ciphertext: 'a23bdc60f4794be521380451770fcbc4dfb6eae6682361c5648b4929d170286979a4cd774baa393b47dce5059dfa2253e3225d'
### authtag: 'fad55cd3e6fa961b4b88b4617486af66'
### authtag: 'fad55cd3e6fa961b4b88b4617486af66'
### cipherinfo: '834a3136313639303434313450fad55cd3e6fa961b4b88b4617486af665833a23bdc60f4794be521380451770fcbc4dfb6eae6682361c5648b4929d170286979a4cd774baa393b47dce5059dfa2253e3225d'
### cipherinfo: '834a3136313639303434313450fad55cd3e6fa961b4b88b4617486af665833a23bdc60f4794be521380451770fcbc4dfb6eae6682361c5648b4929d170286979a4cd774baa393b47dce5059dfa2253e3225d'

### b recv comm msg from a

### b recv comm msg from a

### noise decrypt

### noise decrypt
### key: '5e19271b734d4f0cd2f1d973d7bd7c00254fe184b7135682b6a5ed4ef7d1efac'
### key: '5e19271b734d4f0cd2f1d973d7bd7c00254fe184b7135682b6a5ed4ef7d1efac'
### iv: 'fd734b2a8bc12937b99e42a1'
### iv: 'fd734b2a8bc12937b99e42a1'
### aad: '77e7169e05f9c49f854890118365ce1cea4009c919ed2225fcc8ba73b70f83ae'
### aad: '77e7169e05f9c49f854890118365ce1cea4009c919ed2225fcc8ba73b70f83ae'
### cipherinfo: '834a3136313639303434313450fad55cd3e6fa961b4b88b4617486af665833a23bdc60f4794be521380451770fcbc4dfb6eae6682361c5648b4929d170286979a4cd774baa393b47dce5059dfa2253e3225d'
### cipherinfo: '834a3136313639303434313450fad55cd3e6fa961b4b88b4617486af665833a23bdc60f4794be521380451770fcbc4dfb6eae6682361c5648b4929d170286979a4cd774baa393b47dce5059dfa2253e3225d'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'cc457a1cb2f11d0388aa42a1'
### iv_xor: 'cc457a1cb2f11d0388aa42a1'
### authtag: 'fad55cd3e6fa961b4b88b4617486af66'
### authtag: 'fad55cd3e6fa961b4b88b4617486af66'
### ciphertext: 'a23bdc60f4794be521380451770fcbc4dfb6eae6682361c5648b4929d170286979a4cd774baa393b47dce5059dfa2253e3225d'
### ciphertext: 'a23bdc60f4794be521380451770fcbc4dfb6eae6682361c5648b4929d170286979a4cd774baa393b47dce5059dfa2253e3225d'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'


### b to a , plain_b.txt to trans_cipherinfo_b
### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: 'f14d784b430c0fab52d073332717bfb4895bdc3bffcf2db3f9c40b6e22487a0b'
### key: 'f14d784b430c0fab52d073332717bfb4895bdc3bffcf2db3f9c40b6e22487a0b'
### iv: '692c812f82282a37eace141c'
### iv: '692c812f82282a37eace141c'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '581ab019bb181e03dbfa141c'
### iv_xor: '581ab019bb181e03dbfa141c'
### aad: '77e7169e05f9c49f854890118365ce1cea4009c919ed2225fcc8ba73b70f83ae'
### aad: '77e7169e05f9c49f854890118365ce1cea4009c919ed2225fcc8ba73b70f83ae'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '3ed2c42151cd2bc62f81c37871cd4c4daf1805d7ecece9027074c52980bc18349614da65caa30bb2779491e0f08164'
### ciphertext: '3ed2c42151cd2bc62f81c37871cd4c4daf1805d7ecece9027074c52980bc18349614da65caa30bb2779491e0f08164'
### authtag: '6b2295942ddb0dfdd1087fb311b3767b'
### authtag: '6b2295942ddb0dfdd1087fb311b3767b'
### cipherinfo: '834a31363136393034343134506b2295942ddb0dfdd1087fb311b3767b582f3ed2c42151cd2bc62f81c37871cd4c4daf1805d7ecece9027074c52980bc18349614da65caa30bb2779491e0f08164'
### cipherinfo: '834a31363136393034343134506b2295942ddb0dfdd1087fb311b3767b582f3ed2c42151cd2bc62f81c37871cd4c4daf1805d7ecece9027074c52980bc18349614da65caa30bb2779491e0f08164'


### a recv comm msg from b
### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: 'f14d784b430c0fab52d073332717bfb4895bdc3bffcf2db3f9c40b6e22487a0b'
### key: 'f14d784b430c0fab52d073332717bfb4895bdc3bffcf2db3f9c40b6e22487a0b'
### iv: '692c812f82282a37eace141c'
### iv: '692c812f82282a37eace141c'
### aad: '77e7169e05f9c49f854890118365ce1cea4009c919ed2225fcc8ba73b70f83ae'
### aad: '77e7169e05f9c49f854890118365ce1cea4009c919ed2225fcc8ba73b70f83ae'
### cipherinfo: '834a31363136393034343134506b2295942ddb0dfdd1087fb311b3767b582f3ed2c42151cd2bc62f81c37871cd4c4daf1805d7ecece9027074c52980bc18349614da65caa30bb2779491e0f08164'
### cipherinfo: '834a31363136393034343134506b2295942ddb0dfdd1087fb311b3767b582f3ed2c42151cd2bc62f81c37871cd4c4daf1805d7ecece9027074c52980bc18349614da65caa30bb2779491e0f08164'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '581ab019bb181e03dbfa141c'
### iv_xor: '581ab019bb181e03dbfa141c'
### authtag: '6b2295942ddb0dfdd1087fb311b3767b'
### authtag: '6b2295942ddb0dfdd1087fb311b3767b'
### ciphertext: '3ed2c42151cd2bc62f81c37871cd4c4daf1805d7ecece9027074c52980bc18349614da65caa30bb2779491e0f08164'
### ciphertext: '3ed2c42151cd2bc62f81c37871cd4c4daf1805d7ecece9027074c52980bc18349614da65caa30bb2779491e0f08164'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'IX',
###                               'test_psk',
###                               1
### -----------end test --------: 'IX',
###                               'test_psk',
###                               1


### -----------start test --------: 'XX',
###                                 undef,
###                                 undef
### -----------start test --------: 'XX',
###                                 undef,
###                                 undef

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_XX_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => "Noise_XX_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","774dcdb08916a9cc54826a411a835fef89711c6733e7ecb5cf12e627d9f3a356"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_XX_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => "Noise_XX_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","774dcdb08916a9cc54826a411a835fef89711c6733e7ecb5cf12e627d9f3a356"),
                            },
  who                    => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '0285f10ef8b0a1c9b9a7bdd348900ba1b0d63eccbfd1d4be3f52a9a8bb62321b92'

### public compressed: '0285f10ef8b0a1c9b9a7bdd348900ba1b0d63eccbfd1d4be3f52a9a8bb62321b92'
(
  "a_msg",
  pack("H*","8258210285f10ef8b0a1c9b9a7bdd348900ba1b0d63eccbfd1d4be3f52a9a8bb62321b9248696e69742e73796e"),
)
(
  "a_msg",
  pack("H*","8258210285f10ef8b0a1c9b9a7bdd348900ba1b0d63eccbfd1d4be3f52a9a8bb62321b9248696e69742e73796e"),
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0285f10ef8b0a1c9b9a7bdd348900ba1b0d63eccbfd1d4be3f52a9a8bb62321b92"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_XX_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => "Noise_XX_secp256r1_AESGCM_SHA256",
                                h  => pack("H*","c8062a21ef95c3aa152f3c2dce26d5fa7c9782769521a0b534f1714c4d8969fc"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0285f10ef8b0a1c9b9a7bdd348900ba1b0d63eccbfd1d4be3f52a9a8bb62321b92"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_XX_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => "Noise_XX_secp256r1_AESGCM_SHA256",
                                h  => pack("H*","c8062a21ef95c3aa152f3c2dce26d5fa7c9782769521a0b534f1714c4d8969fc"),
                              },
    who                    => "a",
  },
)


### b read message from a
### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_XX_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => "Noise_XX_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","774dcdb08916a9cc54826a411a835fef89711c6733e7ecb5cf12e627d9f3a356"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_XX_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => "Noise_XX_secp256r1_AESGCM_SHA256",
                              h  => pack("H*","774dcdb08916a9cc54826a411a835fef89711c6733e7ecb5cf12e627d9f3a356"),
                            },
  who                    => "b",
}

### b recv msg from a

### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_XX_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","0285f10ef8b0a1c9b9a7bdd348900ba1b0d63eccbfd1d4be3f52a9a8bb62321b92"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => "Noise_XX_secp256r1_AESGCM_SHA256",
                                h  => pack("H*","c8062a21ef95c3aa152f3c2dce26d5fa7c9782769521a0b534f1714c4d8969fc"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_XX_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","0285f10ef8b0a1c9b9a7bdd348900ba1b0d63eccbfd1d4be3f52a9a8bb62321b92"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => "Noise_XX_secp256r1_AESGCM_SHA256",
                                h  => pack("H*","c8062a21ef95c3aa152f3c2dce26d5fa7c9782769521a0b534f1714c4d8969fc"),
                              },
    who                    => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '0357df2122e7b4d9c64bf95d4b99ff4ec32c191aa4f4fea3d36cccdf8b1c0d6a05'

### public compressed: '0357df2122e7b4d9c64bf95d4b99ff4ec32c191aa4f4fea3d36cccdf8b1c0d6a05'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPH4O25I3qRfPQ20UEbZjwctPlNPRsrsGzMRQeoHVe/xoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV98hIue02cZL+V1Lmf9OwywZGqT0/qPTbMzfixwNagXPXBMwuJY0
',
###             'BFhQJs3aH6BZFdxmQxKb2FaPedMYQe/lNQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPH4O25I3qRfPQ20UEbZjwctPlNPRsrsGzMRQeoHVe/xoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV98hIue02cZL+V1Lmf9OwywZGqT0/qPTbMzfixwNagXPXBMwuJY0
',
###             'BFhQJs3aH6BZFdxmQxKb2FaPedMYQe/lNQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhfEO+LChybmnvdNIkAuhsNY+zL/R
',
###           '1L4/Uqmou2IyG5I7jIx1GzUSfqPHi1p+DEwYTAdsmdzpHUINQilXB+vSyg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhfEO+LChybmnvdNIkAuhsNY+zL/R
',
###           '1L4/Uqmou2IyG5I7jIx1GzUSfqPHi1p+DEwYTAdsmdzpHUINQilXB+vSyg==
',
###           '-----END PUBLIC KEY-----
'
### z: '8e3add1920ceb1adbdb59e2c51973dbd8b19624af2035b817943d37795c5b47d'
### z: '8e3add1920ceb1adbdb59e2c51973dbd8b19624af2035b817943d37795c5b47d'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '9da417b860dfb54ca43147f2c1ecd4167b27e1d2ec3b2e1409438b01e7a02bdd'
### key: '9da417b860dfb54ca43147f2c1ecd4167b27e1d2ec3b2e1409438b01e7a02bdd'
### iv: '8b99b7e49cb0cddd88c7aab4'
### iv: '8b99b7e49cb0cddd88c7aab4'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'baaf86d2a580f9e9b9f3aab4'
### iv_xor: 'baaf86d2a580f9e9b9f3aab4'
### aad: 'ccec8020d13c49c663965bce72c0403453b9d5197ac66e6f55c8fbb7f3bce8eb'
### aad: 'ccec8020d13c49c663965bce72c0403453b9d5197ac66e6f55c8fbb7f3bce8eb'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### ciphertext: '5f2da50c258cac07b8307ee6c2beedc535ec3018874383ab2a21cc93c5d00af5e8af2290620ccd76'
### ciphertext: '5f2da50c258cac07b8307ee6c2beedc535ec3018874383ab2a21cc93c5d00af5e8af2290620ccd76'
### authtag: '19c872ad1c748581e84e6a84366e2f49'
### authtag: '19c872ad1c748581e84e6a84366e2f49'
### cipherinfo: '834a313631363930343431345019c872ad1c748581e84e6a84366e2f4958285f2da50c258cac07b8307ee6c2beedc535ec3018874383ab2a21cc93c5d00af5e8af2290620ccd76'
### cipherinfo: '834a313631363930343431345019c872ad1c748581e84e6a84366e2f4958285f2da50c258cac07b8307ee6c2beedc535ec3018874383ab2a21cc93c5d00af5e8af2290620ccd76'


### write message pattern: 'es'
### write message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhfEO+LChybmnvdNIkAuhsNY+zL/R
',
###           '1L4/Uqmou2IyG5I7jIx1GzUSfqPHi1p+DEwYTAdsmdzpHUINQilXB+vSyg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhfEO+LChybmnvdNIkAuhsNY+zL/R
',
###           '1L4/Uqmou2IyG5I7jIx1GzUSfqPHi1p+DEwYTAdsmdzpHUINQilXB+vSyg==
',
###           '-----END PUBLIC KEY-----
'
### z: '5174a0c3215fff3db123c3acc911ce5c1bcd956c15353a48abc1cfbebdcf0c27'
### z: '5174a0c3215fff3db123c3acc911ce5c1bcd956c15353a48abc1cfbebdcf0c27'


### noise encrypt
### noise encrypt
### key: 'ef2b6d6119ce190f814f85d09cfe2abb5efd488679f7fc0a34f8c215676b988c'
### key: 'ef2b6d6119ce190f814f85d09cfe2abb5efd488679f7fc0a34f8c215676b988c'
### iv: 'b6352ea006ca0cefbcf0a79d'
### iv: 'b6352ea006ca0cefbcf0a79d'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '87031f963ffa38db8dc4a79d'
### iv_xor: '87031f963ffa38db8dc4a79d'
### aad: 'b7e0ac246cd7d476582f4fd0767b5855a39c4a835cb12df7c444bbc620a348bf'
### aad: 'b7e0ac246cd7d476582f4fd0767b5855a39c4a835cb12df7c444bbc620a348bf'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '65b7fbf00a085827'
### ciphertext: '65b7fbf00a085827'
### authtag: '260cfe256ddc9747de0b477b031e8375'
### authtag: '260cfe256ddc9747de0b477b031e8375'
### cipherinfo: '834a3136313639303434313450260cfe256ddc9747de0b477b031e83754865b7fbf00a085827'
### cipherinfo: '834a3136313639303434313450260cfe256ddc9747de0b477b031e83754865b7fbf00a085827'


### b_msg: '8358210357df2122e7b4d9c64bf95d4b99ff4ec32c191aa4f4fea3d36cccdf8b1c0d6a055847834a313631363930343431345019c872ad1c748581e84e6a84366e2f4958285f2da50c258cac07b8307ee6c2beedc535ec3018874383ab2a21cc93c5d00af5e8af2290620ccd765826834a3136313639303434313450260cfe256ddc9747de0b477b031e83754865b7fbf00a085827'
### b_msg: '8358210357df2122e7b4d9c64bf95d4b99ff4ec32c191aa4f4fea3d36cccdf8b1c0d6a055847834a313631363930343431345019c872ad1c748581e84e6a84366e2f4958285f2da50c258cac07b8307ee6c2beedc535ec3018874383ab2a21cc93c5d00af5e8af2290620ccd765826834a3136313639303434313450260cfe256ddc9747de0b477b031e83754865b7fbf00a085827'
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  e                      => {
                              pub => pack("H*","0357df2122e7b4d9c64bf95d4b99ff4ec32c191aa4f4fea3d36cccdf8b1c0d6a05"),
                            },
  e_priv                 => "b_e_priv.pem",
  e_pub                  => "b_e_pub.pem",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 2,
  prologue               => "some_info",
  protocol_name          => "Noise_XX_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  re                     => {
                              pub => pack("H*","0285f10ef8b0a1c9b9a7bdd348900ba1b0d63eccbfd1d4be3f52a9a8bb62321b92"),
                            },
  re_pub                 => "b_re_pub.pem",
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","e3f1c74b4afacf4ddaac1bfa574ae72be0a9744c57c6be91b5de964662c14c5d"),
                              h => pack("H*","e500c9b562d632f831646fb6365bcee17a8fb995fc4cd26235598e02fadf6ac8"),
                              hasK => 1,
                              k => pack("H*","4f383fea5e1424b901ea90663d0a80d12924d2ff8284745e19ce9994ad027c47"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  e                      => {
                              pub => pack("H*","0357df2122e7b4d9c64bf95d4b99ff4ec32c191aa4f4fea3d36cccdf8b1c0d6a05"),
                            },
  e_priv                 => "b_e_priv.pem",
  e_pub                  => "b_e_pub.pem",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 2,
  prologue               => "some_info",
  protocol_name          => "Noise_XX_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  re                     => {
                              pub => pack("H*","0285f10ef8b0a1c9b9a7bdd348900ba1b0d63eccbfd1d4be3f52a9a8bb62321b92"),
                            },
  re_pub                 => "b_re_pub.pem",
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","e3f1c74b4afacf4ddaac1bfa574ae72be0a9744c57c6be91b5de964662c14c5d"),
                              h => pack("H*","e500c9b562d632f831646fb6365bcee17a8fb995fc4cd26235598e02fadf6ac8"),
                              hasK => 1,
                              k => pack("H*","4f383fea5e1424b901ea90663d0a80d12924d2ff8284745e19ce9994ad027c47"),
                            },
  who                    => "b",
}


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBsNX0wYJhQ4F1dqBRcgtgg8kWmSJYuMHJ09mElqLgx+oAoGCCqGSM49
',
###             'AwEHoUQDQgAEhfEO+LChybmnvdNIkAuhsNY+zL/R1L4/Uqmou2IyG5I7jIx1GzUS
',
###             'fqPHi1p+DEwYTAdsmdzpHUINQilXB+vSyg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBsNX0wYJhQ4F1dqBRcgtgg8kWmSJYuMHJ09mElqLgx+oAoGCCqGSM49
',
###             'AwEHoUQDQgAEhfEO+LChybmnvdNIkAuhsNY+zL/R1L4/Uqmou2IyG5I7jIx1GzUS
',
###             'fqPHi1p+DEwYTAdsmdzpHUINQilXB+vSyg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV98hIue02cZL+V1Lmf9OwywZGqT0
',
###           '/qPTbMzfixwNagXPXBMwuJY0BFhQJs3aH6BZFdxmQxKb2FaPedMYQe/lNQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV98hIue02cZL+V1Lmf9OwywZGqT0
',
###           '/qPTbMzfixwNagXPXBMwuJY0BFhQJs3aH6BZFdxmQxKb2FaPedMYQe/lNQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '8e3add1920ceb1adbdb59e2c51973dbd8b19624af2035b817943d37795c5b47d'
### z: '8e3add1920ceb1adbdb59e2c51973dbd8b19624af2035b817943d37795c5b47d'


### read message pattern: 's'
### read message pattern: 's'


### noise decrypt
### noise decrypt
### key: '9da417b860dfb54ca43147f2c1ecd4167b27e1d2ec3b2e1409438b01e7a02bdd'
### key: '9da417b860dfb54ca43147f2c1ecd4167b27e1d2ec3b2e1409438b01e7a02bdd'
### iv: '8b99b7e49cb0cddd88c7aab4'
### iv: '8b99b7e49cb0cddd88c7aab4'
### aad: 'ccec8020d13c49c663965bce72c0403453b9d5197ac66e6f55c8fbb7f3bce8eb'
### aad: 'ccec8020d13c49c663965bce72c0403453b9d5197ac66e6f55c8fbb7f3bce8eb'
### cipherinfo: '834a313631363930343431345019c872ad1c748581e84e6a84366e2f4958285f2da50c258cac07b8307ee6c2beedc535ec3018874383ab2a21cc93c5d00af5e8af2290620ccd76'
### cipherinfo: '834a313631363930343431345019c872ad1c748581e84e6a84366e2f4958285f2da50c258cac07b8307ee6c2beedc535ec3018874383ab2a21cc93c5d00af5e8af2290620ccd76'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'baaf86d2a580f9e9b9f3aab4'
### iv_xor: 'baaf86d2a580f9e9b9f3aab4'
### authtag: '19c872ad1c748581e84e6a84366e2f49'
### authtag: '19c872ad1c748581e84e6a84366e2f49'
### ciphertext: '5f2da50c258cac07b8307ee6c2beedc535ec3018874383ab2a21cc93c5d00af5e8af2290620ccd76'
### ciphertext: '5f2da50c258cac07b8307ee6c2beedc535ec3018874383ab2a21cc93c5d00af5e8af2290620ccd76'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### read message pattern: 'es'

### read message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBsNX0wYJhQ4F1dqBRcgtgg8kWmSJYuMHJ09mElqLgx+oAoGCCqGSM49
',
###             'AwEHoUQDQgAEhfEO+LChybmnvdNIkAuhsNY+zL/R1L4/Uqmou2IyG5I7jIx1GzUS
',
###             'fqPHi1p+DEwYTAdsmdzpHUINQilXB+vSyg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIBsNX0wYJhQ4F1dqBRcgtgg8kWmSJYuMHJ09mElqLgx+oAoGCCqGSM49
',
###             'AwEHoUQDQgAEhfEO+LChybmnvdNIkAuhsNY+zL/R1L4/Uqmou2IyG5I7jIx1GzUS
',
###             'fqPHi1p+DEwYTAdsmdzpHUINQilXB+vSyg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '5174a0c3215fff3db123c3acc911ce5c1bcd956c15353a48abc1cfbebdcf0c27'
### z: '5174a0c3215fff3db123c3acc911ce5c1bcd956c15353a48abc1cfbebdcf0c27'


### noise decrypt
### noise decrypt
### key: 'ef2b6d6119ce190f814f85d09cfe2abb5efd488679f7fc0a34f8c215676b988c'
### key: 'ef2b6d6119ce190f814f85d09cfe2abb5efd488679f7fc0a34f8c215676b988c'
### iv: 'b6352ea006ca0cefbcf0a79d'
### iv: 'b6352ea006ca0cefbcf0a79d'
### aad: 'b7e0ac246cd7d476582f4fd0767b5855a39c4a835cb12df7c444bbc620a348bf'
### aad: 'b7e0ac246cd7d476582f4fd0767b5855a39c4a835cb12df7c444bbc620a348bf'
### cipherinfo: '834a3136313639303434313450260cfe256ddc9747de0b477b031e83754865b7fbf00a085827'
### cipherinfo: '834a3136313639303434313450260cfe256ddc9747de0b477b031e83754865b7fbf00a085827'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '87031f963ffa38db8dc4a79d'
### iv_xor: '87031f963ffa38db8dc4a79d'
### authtag: '260cfe256ddc9747de0b477b031e8375'
### authtag: '260cfe256ddc9747de0b477b031e8375'
### ciphertext: '65b7fbf00a085827'
### ciphertext: '65b7fbf00a085827'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  e                      => {
                              pub => pack("H*","0285f10ef8b0a1c9b9a7bdd348900ba1b0d63eccbfd1d4be3f52a9a8bb62321b92"),
                            },
  e_priv                 => "a_e_priv.pem",
  e_pub                  => "a_e_pub.pem",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 2,
  prologue               => "some_info",
  protocol_name          => "Noise_XX_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  re                     => {
                              pub => pack("H*","0357df2122e7b4d9c64bf95d4b99ff4ec32c191aa4f4fea3d36cccdf8b1c0d6a05"),
                            },
  re_pub                 => "a_re_pub.pem",
  rs                     => {
                              pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                            },
  rs_pub                 => "a_rs_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","e3f1c74b4afacf4ddaac1bfa574ae72be0a9744c57c6be91b5de964662c14c5d"),
                              h => pack("H*","e500c9b562d632f831646fb6365bcee17a8fb995fc4cd26235598e02fadf6ac8"),
                              hasK => 1,
                              k => pack("H*","4f383fea5e1424b901ea90663d0a80d12924d2ff8284745e19ce9994ad027c47"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  e                      => {
                              pub => pack("H*","0285f10ef8b0a1c9b9a7bdd348900ba1b0d63eccbfd1d4be3f52a9a8bb62321b92"),
                            },
  e_priv                 => "a_e_priv.pem",
  e_pub                  => "a_e_pub.pem",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 2,
  prologue               => "some_info",
  protocol_name          => "Noise_XX_secp256r1_AESGCM_SHA256",
  psk                    => undef,
  psk_id                 => undef,
  re                     => {
                              pub => pack("H*","0357df2122e7b4d9c64bf95d4b99ff4ec32c191aa4f4fea3d36cccdf8b1c0d6a05"),
                            },
  re_pub                 => "a_re_pub.pem",
  rs                     => {
                              pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                            },
  rs_pub                 => "a_rs_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","e3f1c74b4afacf4ddaac1bfa574ae72be0a9744c57c6be91b5de964662c14c5d"),
                              h => pack("H*","e500c9b562d632f831646fb6365bcee17a8fb995fc4cd26235598e02fadf6ac8"),
                              hasK => 1,
                              k => pack("H*","4f383fea5e1424b901ea90663d0a80d12924d2ff8284745e19ce9994ad027c47"),
                            },
  who                    => "a",
}


### a send msg to b
### a send msg to b


### $a_msg2_src: 'init.ack'
### $a_msg2_src: 'init.ack'


### write message pattern: 's'
### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: 'ef2b6d6119ce190f814f85d09cfe2abb5efd488679f7fc0a34f8c215676b988c'
### key: 'ef2b6d6119ce190f814f85d09cfe2abb5efd488679f7fc0a34f8c215676b988c'
### iv: 'b6352ea006ca0cefbcf0a79d'
### iv: 'b6352ea006ca0cefbcf0a79d'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '87031f963ffa38db8dc4a79d'
### iv_xor: '87031f963ffa38db8dc4a79d'
### aad: 'e500c9b562d632f831646fb6365bcee17a8fb995fc4cd26235598e02fadf6ac8'
### aad: 'e500c9b562d632f831646fb6365bcee17a8fb995fc4cd26235598e02fadf6ac8'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: '9591fae153311a4f81a420b4813719e3946ddaeefd1489d7eac5e3a2f5967af3b9150eb36ab3897b'
### ciphertext: '9591fae153311a4f81a420b4813719e3946ddaeefd1489d7eac5e3a2f5967af3b9150eb36ab3897b'
### authtag: '314b3d5aca1819ed387727733658e0ef'
### authtag: '314b3d5aca1819ed387727733658e0ef'
### cipherinfo: '834a3136313639303434313450314b3d5aca1819ed387727733658e0ef58289591fae153311a4f81a420b4813719e3946ddaeefd1489d7eac5e3a2f5967af3b9150eb36ab3897b'
### cipherinfo: '834a3136313639303434313450314b3d5aca1819ed387727733658e0ef58289591fae153311a4f81a420b4813719e3946ddaeefd1489d7eac5e3a2f5967af3b9150eb36ab3897b'


### write message pattern: 'se'
### write message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV98hIue02cZL+V1Lmf9OwywZGqT0
',
###           '/qPTbMzfixwNagXPXBMwuJY0BFhQJs3aH6BZFdxmQxKb2FaPedMYQe/lNQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV98hIue02cZL+V1Lmf9OwywZGqT0
',
###           '/qPTbMzfixwNagXPXBMwuJY0BFhQJs3aH6BZFdxmQxKb2FaPedMYQe/lNQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '5643a7e346ef8d6fe3053e860a57565493978d32ef58c563f9978cd5beedcd4f'
### z: '5643a7e346ef8d6fe3053e860a57565493978d32ef58c563f9978cd5beedcd4f'


### noise encrypt
### noise encrypt
### key: 'cce24f4388489c28608e0c22ab7985b2c97d1b7d99d38b612384262ca84f1ee5'
### key: 'cce24f4388489c28608e0c22ab7985b2c97d1b7d99d38b612384262ca84f1ee5'
### iv: '333e8c7c4dde4791b38d939f'
### iv: '333e8c7c4dde4791b38d939f'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '0208bd4a74ee73a582b9939f'
### iv_xor: '0208bd4a74ee73a582b9939f'
### aad: 'cbf8ca04018a3cdf9b14ad6afc38bd19967eb9bb385067f5241c0351995d3ce4'
### aad: 'cbf8ca04018a3cdf9b14ad6afc38bd19967eb9bb385067f5241c0351995d3ce4'
### plaintext: '696e69742e61636b'
### plaintext: '696e69742e61636b'
### ciphertext: '02b37c76f4ccde6e'
### ciphertext: '02b37c76f4ccde6e'
### authtag: 'cedf93087e7ba1b76042be1f92cf72fe'
### authtag: 'cedf93087e7ba1b76042be1f92cf72fe'
### cipherinfo: '834a3136313639303434313450cedf93087e7ba1b76042be1f92cf72fe4802b37c76f4ccde6e'
### cipherinfo: '834a3136313639303434313450cedf93087e7ba1b76042be1f92cf72fe4802b37c76f4ccde6e'


### a_msg2: '825847834a3136313639303434313450314b3d5aca1819ed387727733658e0ef58289591fae153311a4f81a420b4813719e3946ddaeefd1489d7eac5e3a2f5967af3b9150eb36ab3897b5826834a3136313639303434313450cedf93087e7ba1b76042be1f92cf72fe4802b37c76f4ccde6e'
### a_msg2: '825847834a3136313639303434313450314b3d5aca1819ed387727733658e0ef58289591fae153311a4f81a420b4813719e3946ddaeefd1489d7eac5e3a2f5967af3b9150eb36ab3897b5826834a3136313639303434313450cedf93087e7ba1b76042be1f92cf72fe4802b37c76f4ccde6e'
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0285f10ef8b0a1c9b9a7bdd348900ba1b0d63eccbfd1d4be3f52a9a8bb62321b92"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 3,
    prologue               => "some_info",
    protocol_name          => "Noise_XX_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","0357df2122e7b4d9c64bf95d4b99ff4ec32c191aa4f4fea3d36cccdf8b1c0d6a05"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs                     => {
                                pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                              },
    rs_pub                 => "a_rs_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","e014b9ae35c228dcd79b4799e8333487b3f93cdd898b0f9d8d7e33d2bc6502b3"),
                                h => pack("H*","8e047d7fd24240f99b5e0fbfae762f09317f862880df547a18df17cde798abee"),
                                hasK => 1,
                                k => pack("H*","1d8710a7962e1d77e3a4827735cfbf151fdb4dcfb3275af807ca48d795150d92"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","4f61199df6d44e962390ac641c9371d46e3821d024e4fcfb121cfa4a42e082ac"),
  },
  {
    hasK => 1,
    k => pack("H*","602f0977f3d8adfcb4d3266f2c9f29e9097ee94f1ec1b4bcc592d314c924838e"),
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0285f10ef8b0a1c9b9a7bdd348900ba1b0d63eccbfd1d4be3f52a9a8bb62321b92"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 3,
    prologue               => "some_info",
    protocol_name          => "Noise_XX_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","0357df2122e7b4d9c64bf95d4b99ff4ec32c191aa4f4fea3d36cccdf8b1c0d6a05"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs                     => {
                                pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                              },
    rs_pub                 => "a_rs_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","e014b9ae35c228dcd79b4799e8333487b3f93cdd898b0f9d8d7e33d2bc6502b3"),
                                h => pack("H*","8e047d7fd24240f99b5e0fbfae762f09317f862880df547a18df17cde798abee"),
                                hasK => 1,
                                k => pack("H*","1d8710a7962e1d77e3a4827735cfbf151fdb4dcfb3275af807ca48d795150d92"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","4f61199df6d44e962390ac641c9371d46e3821d024e4fcfb121cfa4a42e082ac"),
  },
  {
    hasK => 1,
    k => pack("H*","602f0977f3d8adfcb4d3266f2c9f29e9097ee94f1ec1b4bcc592d314c924838e"),
  },
)


### b recv msg from a
### b recv msg from a


### read message pattern: 's'
### read message pattern: 's'

### noise decrypt

### noise decrypt
### key: 'ef2b6d6119ce190f814f85d09cfe2abb5efd488679f7fc0a34f8c215676b988c'
### key: 'ef2b6d6119ce190f814f85d09cfe2abb5efd488679f7fc0a34f8c215676b988c'
### iv: 'b6352ea006ca0cefbcf0a79d'
### iv: 'b6352ea006ca0cefbcf0a79d'
### aad: 'e500c9b562d632f831646fb6365bcee17a8fb995fc4cd26235598e02fadf6ac8'
### aad: 'e500c9b562d632f831646fb6365bcee17a8fb995fc4cd26235598e02fadf6ac8'
### cipherinfo: '834a3136313639303434313450314b3d5aca1819ed387727733658e0ef58289591fae153311a4f81a420b4813719e3946ddaeefd1489d7eac5e3a2f5967af3b9150eb36ab3897b'
### cipherinfo: '834a3136313639303434313450314b3d5aca1819ed387727733658e0ef58289591fae153311a4f81a420b4813719e3946ddaeefd1489d7eac5e3a2f5967af3b9150eb36ab3897b'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '87031f963ffa38db8dc4a79d'
### iv_xor: '87031f963ffa38db8dc4a79d'
### authtag: '314b3d5aca1819ed387727733658e0ef'
### authtag: '314b3d5aca1819ed387727733658e0ef'
### ciphertext: '9591fae153311a4f81a420b4813719e3946ddaeefd1489d7eac5e3a2f5967af3b9150eb36ab3897b'
### ciphertext: '9591fae153311a4f81a420b4813719e3946ddaeefd1489d7eac5e3a2f5967af3b9150eb36ab3897b'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'


### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'

### read message pattern: 'se'

### read message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPH4O25I3qRfPQ20UEbZjwctPlNPRsrsGzMRQeoHVe/xoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV98hIue02cZL+V1Lmf9OwywZGqT0/qPTbMzfixwNagXPXBMwuJY0
',
###             'BFhQJs3aH6BZFdxmQxKb2FaPedMYQe/lNQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPH4O25I3qRfPQ20UEbZjwctPlNPRsrsGzMRQeoHVe/xoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV98hIue02cZL+V1Lmf9OwywZGqT0/qPTbMzfixwNagXPXBMwuJY0
',
###             'BFhQJs3aH6BZFdxmQxKb2FaPedMYQe/lNQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '5643a7e346ef8d6fe3053e860a57565493978d32ef58c563f9978cd5beedcd4f'
### z: '5643a7e346ef8d6fe3053e860a57565493978d32ef58c563f9978cd5beedcd4f'

### noise decrypt

### noise decrypt
### key: 'cce24f4388489c28608e0c22ab7985b2c97d1b7d99d38b612384262ca84f1ee5'
### key: 'cce24f4388489c28608e0c22ab7985b2c97d1b7d99d38b612384262ca84f1ee5'
### iv: '333e8c7c4dde4791b38d939f'
### iv: '333e8c7c4dde4791b38d939f'
### aad: 'cbf8ca04018a3cdf9b14ad6afc38bd19967eb9bb385067f5241c0351995d3ce4'
### aad: 'cbf8ca04018a3cdf9b14ad6afc38bd19967eb9bb385067f5241c0351995d3ce4'
### cipherinfo: '834a3136313639303434313450cedf93087e7ba1b76042be1f92cf72fe4802b37c76f4ccde6e'
### cipherinfo: '834a3136313639303434313450cedf93087e7ba1b76042be1f92cf72fe4802b37c76f4ccde6e'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '0208bd4a74ee73a582b9939f'
### iv_xor: '0208bd4a74ee73a582b9939f'
### authtag: 'cedf93087e7ba1b76042be1f92cf72fe'
### authtag: 'cedf93087e7ba1b76042be1f92cf72fe'
### ciphertext: '02b37c76f4ccde6e'
### ciphertext: '02b37c76f4ccde6e'
### plaintext: '696e69742e61636b'
### plaintext: '696e69742e61636b'


### b_recv_a_msg2: 'init.ack'
### b_recv_a_msg2: 'init.ack'
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0357df2122e7b4d9c64bf95d4b99ff4ec32c191aa4f4fea3d36cccdf8b1c0d6a05"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 3,
    prologue               => "some_info",
    protocol_name          => "Noise_XX_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","0285f10ef8b0a1c9b9a7bdd348900ba1b0d63eccbfd1d4be3f52a9a8bb62321b92"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","e014b9ae35c228dcd79b4799e8333487b3f93cdd898b0f9d8d7e33d2bc6502b3"),
                                h => pack("H*","8e047d7fd24240f99b5e0fbfae762f09317f862880df547a18df17cde798abee"),
                                hasK => 1,
                                k => pack("H*","1d8710a7962e1d77e3a4827735cfbf151fdb4dcfb3275af807ca48d795150d92"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","4f61199df6d44e962390ac641c9371d46e3821d024e4fcfb121cfa4a42e082ac"),
  },
  {
    hasK => 1,
    k => pack("H*","602f0977f3d8adfcb4d3266f2c9f29e9097ee94f1ec1b4bcc592d314c924838e"),
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0357df2122e7b4d9c64bf95d4b99ff4ec32c191aa4f4fea3d36cccdf8b1c0d6a05"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 3,
    prologue               => "some_info",
    protocol_name          => "Noise_XX_secp256r1_AESGCM_SHA256",
    psk                    => undef,
    psk_id                 => undef,
    re                     => {
                                pub => pack("H*","0285f10ef8b0a1c9b9a7bdd348900ba1b0d63eccbfd1d4be3f52a9a8bb62321b92"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","e014b9ae35c228dcd79b4799e8333487b3f93cdd898b0f9d8d7e33d2bc6502b3"),
                                h => pack("H*","8e047d7fd24240f99b5e0fbfae762f09317f862880df547a18df17cde798abee"),
                                hasK => 1,
                                k => pack("H*","1d8710a7962e1d77e3a4827735cfbf151fdb4dcfb3275af807ca48d795150d92"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","4f61199df6d44e962390ac641c9371d46e3821d024e4fcfb121cfa4a42e082ac"),
  },
  {
    hasK => 1,
    k => pack("H*","602f0977f3d8adfcb4d3266f2c9f29e9097ee94f1ec1b4bcc592d314c924838e"),
  },
)


### a send comm msg to b
### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '817651bd129db8b48435d3e983c531f277c4069aacafe69da277eeff7df029bb'
### key: '817651bd129db8b48435d3e983c531f277c4069aacafe69da277eeff7df029bb'
### iv: '251a12be873c21eaee38e8c9'
### iv: '251a12be873c21eaee38e8c9'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '142c2388be0c15dedf0ce8c9'
### iv_xor: '142c2388be0c15dedf0ce8c9'
### aad: '8e047d7fd24240f99b5e0fbfae762f09317f862880df547a18df17cde798abee'
### aad: '8e047d7fd24240f99b5e0fbfae762f09317f862880df547a18df17cde798abee'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '742e4cab861273180c43ff78ee29557d97947237859dc6796fa6120e8b3cc9a1aa8ee9d4565f07b17bf501e1c3660bc44ef3be'
### ciphertext: '742e4cab861273180c43ff78ee29557d97947237859dc6796fa6120e8b3cc9a1aa8ee9d4565f07b17bf501e1c3660bc44ef3be'
### authtag: '10c531528b49edd73459ef90922ddd3b'
### authtag: '10c531528b49edd73459ef90922ddd3b'
### cipherinfo: '834a313631363930343431345010c531528b49edd73459ef90922ddd3b5833742e4cab861273180c43ff78ee29557d97947237859dc6796fa6120e8b3cc9a1aa8ee9d4565f07b17bf501e1c3660bc44ef3be'
### cipherinfo: '834a313631363930343431345010c531528b49edd73459ef90922ddd3b5833742e4cab861273180c43ff78ee29557d97947237859dc6796fa6120e8b3cc9a1aa8ee9d4565f07b17bf501e1c3660bc44ef3be'


### b recv comm msg from a
### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: '817651bd129db8b48435d3e983c531f277c4069aacafe69da277eeff7df029bb'
### key: '817651bd129db8b48435d3e983c531f277c4069aacafe69da277eeff7df029bb'
### iv: '251a12be873c21eaee38e8c9'
### iv: '251a12be873c21eaee38e8c9'
### aad: '8e047d7fd24240f99b5e0fbfae762f09317f862880df547a18df17cde798abee'
### aad: '8e047d7fd24240f99b5e0fbfae762f09317f862880df547a18df17cde798abee'
### cipherinfo: '834a313631363930343431345010c531528b49edd73459ef90922ddd3b5833742e4cab861273180c43ff78ee29557d97947237859dc6796fa6120e8b3cc9a1aa8ee9d4565f07b17bf501e1c3660bc44ef3be'
### cipherinfo: '834a313631363930343431345010c531528b49edd73459ef90922ddd3b5833742e4cab861273180c43ff78ee29557d97947237859dc6796fa6120e8b3cc9a1aa8ee9d4565f07b17bf501e1c3660bc44ef3be'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '142c2388be0c15dedf0ce8c9'
### iv_xor: '142c2388be0c15dedf0ce8c9'
### authtag: '10c531528b49edd73459ef90922ddd3b'
### authtag: '10c531528b49edd73459ef90922ddd3b'
### ciphertext: '742e4cab861273180c43ff78ee29557d97947237859dc6796fa6120e8b3cc9a1aa8ee9d4565f07b17bf501e1c3660bc44ef3be'
### ciphertext: '742e4cab861273180c43ff78ee29557d97947237859dc6796fa6120e8b3cc9a1aa8ee9d4565f07b17bf501e1c3660bc44ef3be'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'


### b to a , plain_b.txt to trans_cipherinfo_b
### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: 'dda6fc96cd49ee066c42c8b44c9bd4c2f5b741340080353691ab4d9513691541'
### key: 'dda6fc96cd49ee066c42c8b44c9bd4c2f5b741340080353691ab4d9513691541'
### iv: '0b1d5d1d74827dec0f47c1b6'
### iv: '0b1d5d1d74827dec0f47c1b6'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '3a2b6c2b4db249d83e73c1b6'
### iv_xor: '3a2b6c2b4db249d83e73c1b6'
### aad: '8e047d7fd24240f99b5e0fbfae762f09317f862880df547a18df17cde798abee'
### aad: '8e047d7fd24240f99b5e0fbfae762f09317f862880df547a18df17cde798abee'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'c781855795c8619c3a4b3ee73d70cda9883d14f7427343c6ac8d42a5bd11b7350ccde8eb3139f2d6e855a10aa91a0c'
### ciphertext: 'c781855795c8619c3a4b3ee73d70cda9883d14f7427343c6ac8d42a5bd11b7350ccde8eb3139f2d6e855a10aa91a0c'
### authtag: 'ff591d82a1ba7b15db4e295de426f600'
### authtag: 'ff591d82a1ba7b15db4e295de426f600'
### cipherinfo: '834a3136313639303434313450ff591d82a1ba7b15db4e295de426f600582fc781855795c8619c3a4b3ee73d70cda9883d14f7427343c6ac8d42a5bd11b7350ccde8eb3139f2d6e855a10aa91a0c'
### cipherinfo: '834a3136313639303434313450ff591d82a1ba7b15db4e295de426f600582fc781855795c8619c3a4b3ee73d70cda9883d14f7427343c6ac8d42a5bd11b7350ccde8eb3139f2d6e855a10aa91a0c'


### a recv comm msg from b
### a recv comm msg from b

### noise decrypt

### noise decrypt
### key: 'dda6fc96cd49ee066c42c8b44c9bd4c2f5b741340080353691ab4d9513691541'
### key: 'dda6fc96cd49ee066c42c8b44c9bd4c2f5b741340080353691ab4d9513691541'
### iv: '0b1d5d1d74827dec0f47c1b6'
### iv: '0b1d5d1d74827dec0f47c1b6'
### aad: '8e047d7fd24240f99b5e0fbfae762f09317f862880df547a18df17cde798abee'
### aad: '8e047d7fd24240f99b5e0fbfae762f09317f862880df547a18df17cde798abee'
### cipherinfo: '834a3136313639303434313450ff591d82a1ba7b15db4e295de426f600582fc781855795c8619c3a4b3ee73d70cda9883d14f7427343c6ac8d42a5bd11b7350ccde8eb3139f2d6e855a10aa91a0c'
### cipherinfo: '834a3136313639303434313450ff591d82a1ba7b15db4e295de426f600582fc781855795c8619c3a4b3ee73d70cda9883d14f7427343c6ac8d42a5bd11b7350ccde8eb3139f2d6e855a10aa91a0c'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '3a2b6c2b4db249d83e73c1b6'
### iv_xor: '3a2b6c2b4db249d83e73c1b6'
### authtag: 'ff591d82a1ba7b15db4e295de426f600'
### authtag: 'ff591d82a1ba7b15db4e295de426f600'
### ciphertext: 'c781855795c8619c3a4b3ee73d70cda9883d14f7427343c6ac8d42a5bd11b7350ccde8eb3139f2d6e855a10aa91a0c'
### ciphertext: 'c781855795c8619c3a4b3ee73d70cda9883d14f7427343c6ac8d42a5bd11b7350ccde8eb3139f2d6e855a10aa91a0c'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'XX',
###                               undef,
###                               undef
### -----------end test --------: 'XX',
###                               undef,
###                               undef


### -----------start test --------: 'XX',
###                                 'test_psk',
###                                 0
### -----------start test --------: 'XX',
###                                 'test_psk',
###                                 0

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_XXpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","d8aea04050b19a967cd541e3a399096aa6f474a563dfe717cc9a69105f4f7af1"),
                              h  => pack("H*","efdd423b6e50f7ad9fafc771999d800e2f22a80b6c79bf0b9badf1a38bc66fd8"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_XXpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","d8aea04050b19a967cd541e3a399096aa6f474a563dfe717cc9a69105f4f7af1"),
                              h  => pack("H*","efdd423b6e50f7ad9fafc771999d800e2f22a80b6c79bf0b9badf1a38bc66fd8"),
                            },
  who                    => "a",
}

### a send msg to b

### a send msg to b

### write message pattern: 'psk'

### write message pattern: 'psk'

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '02ee88c8f8a4561e83675cf7128a6099d191377674474ff7abe11358f5222d5fa8'

### public compressed: '02ee88c8f8a4561e83675cf7128a6099d191377674474ff7abe11358f5222d5fa8'

### noise encrypt

### noise encrypt
### key: 'a752a13802eed054cdfe253f27cb97324785570dc587ab2a8712292c02020a1e'
### key: 'a752a13802eed054cdfe253f27cb97324785570dc587ab2a8712292c02020a1e'
### iv: '493560d2ce61e85d48a1b3fd'
### iv: '493560d2ce61e85d48a1b3fd'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '780351e4f751dc697995b3fd'
### iv_xor: '780351e4f751dc697995b3fd'
### aad: '5e620af1ebe70b67db1139edff41baa506cd05dd496c7b4c772e228cc16e4214'
### aad: '5e620af1ebe70b67db1139edff41baa506cd05dd496c7b4c772e228cc16e4214'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '079abb56139e36a6'
### ciphertext: '079abb56139e36a6'
### authtag: 'da18f244291a2653627576f3419e61bc'
### authtag: 'da18f244291a2653627576f3419e61bc'
### cipherinfo: '834a3136313639303434313450da18f244291a2653627576f3419e61bc48079abb56139e36a6'
### cipherinfo: '834a3136313639303434313450da18f244291a2653627576f3419e61bc48079abb56139e36a6'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAu6IyPikVh6DZ1z3EopgmdGRN3Z0R0/3q+ETWPUiLV+oWCaDSjE2MTY5MDQ0MTRQ2hjyRCkaJlNidXbzQZ5hvEgHmrtWE542pg=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAu6IyPikVh6DZ1z3EopgmdGRN3Z0R0/3q+ETWPUiLV+oWCaDSjE2MTY5MDQ0MTRQ2hjyRCkaJlNidXbzQZ5hvEgHmrtWE542pg=="),
  );
}
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02ee88c8f8a4561e83675cf7128a6099d191377674474ff7abe11358f5222d5fa8"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_XXpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","097bafa338e9938f67a50f9d78c84feca77f6c200d5b94824d18d12bfe7f504b"),
                                h => pack("H*","51036b10219c6eeb18d110a4e012d3c0b3d08cc68532a3827892f5d04351755b"),
                                hasK => 1,
                                k => pack("H*","bce028474405aeb4037d8fc016316ee4863e74eed2bb543af302c118fa30c74e"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02ee88c8f8a4561e83675cf7128a6099d191377674474ff7abe11358f5222d5fa8"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_XXpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","097bafa338e9938f67a50f9d78c84feca77f6c200d5b94824d18d12bfe7f504b"),
                                h => pack("H*","51036b10219c6eeb18d110a4e012d3c0b3d08cc68532a3827892f5d04351755b"),
                                hasK => 1,
                                k => pack("H*","bce028474405aeb4037d8fc016316ee4863e74eed2bb543af302c118fa30c74e"),
                              },
    who                    => "a",
  },
)


### b read message from a
### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_XXpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","d8aea04050b19a967cd541e3a399096aa6f474a563dfe717cc9a69105f4f7af1"),
                              h  => pack("H*","efdd423b6e50f7ad9fafc771999d800e2f22a80b6c79bf0b9badf1a38bc66fd8"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_XXpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","d8aea04050b19a967cd541e3a399096aa6f474a563dfe717cc9a69105f4f7af1"),
                              h  => pack("H*","efdd423b6e50f7ad9fafc771999d800e2f22a80b6c79bf0b9badf1a38bc66fd8"),
                            },
  who                    => "b",
}


### b recv msg from a
### b recv msg from a


### read message pattern: 'psk'
### read message pattern: 'psk'

### read message pattern: 'e'

### read message pattern: 'e'

### noise decrypt

### noise decrypt
### key: 'a752a13802eed054cdfe253f27cb97324785570dc587ab2a8712292c02020a1e'
### key: 'a752a13802eed054cdfe253f27cb97324785570dc587ab2a8712292c02020a1e'
### iv: '493560d2ce61e85d48a1b3fd'
### iv: '493560d2ce61e85d48a1b3fd'
### aad: '5e620af1ebe70b67db1139edff41baa506cd05dd496c7b4c772e228cc16e4214'
### aad: '5e620af1ebe70b67db1139edff41baa506cd05dd496c7b4c772e228cc16e4214'
### cipherinfo: '834a3136313639303434313450da18f244291a2653627576f3419e61bc48079abb56139e36a6'
### cipherinfo: '834a3136313639303434313450da18f244291a2653627576f3419e61bc48079abb56139e36a6'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '780351e4f751dc697995b3fd'
### iv_xor: '780351e4f751dc697995b3fd'
### authtag: 'da18f244291a2653627576f3419e61bc'
### authtag: 'da18f244291a2653627576f3419e61bc'
### ciphertext: '079abb56139e36a6'
### ciphertext: '079abb56139e36a6'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_XXpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","02ee88c8f8a4561e83675cf7128a6099d191377674474ff7abe11358f5222d5fa8"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","097bafa338e9938f67a50f9d78c84feca77f6c200d5b94824d18d12bfe7f504b"),
                                h => pack("H*","51036b10219c6eeb18d110a4e012d3c0b3d08cc68532a3827892f5d04351755b"),
                                hasK => 1,
                                k => pack("H*","bce028474405aeb4037d8fc016316ee4863e74eed2bb543af302c118fa30c74e"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_XXpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","02ee88c8f8a4561e83675cf7128a6099d191377674474ff7abe11358f5222d5fa8"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","097bafa338e9938f67a50f9d78c84feca77f6c200d5b94824d18d12bfe7f504b"),
                                h => pack("H*","51036b10219c6eeb18d110a4e012d3c0b3d08cc68532a3827892f5d04351755b"),
                                hasK => 1,
                                k => pack("H*","bce028474405aeb4037d8fc016316ee4863e74eed2bb543af302c118fa30c74e"),
                              },
    who                    => "b",
  },
)

### b write_message to a

### b write_message to a
### b send msg to a
### b send msg to a

### write message pattern: 'e'

### write message pattern: 'e'

### public compressed: '03d58521b8f8586ed670f0abdfb196ff8f7a867d3e4dacc293218f1ed7406f6a36'

### public compressed: '03d58521b8f8586ed670f0abdfb196ff8f7a867d3e4dacc293218f1ed7406f6a36'

### write message pattern: 'ee'

### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIIf1miOdlKqWu5XaIgvSttklr3fo3sRgPNZp2sRRrefboAoGCCqGSM49
',
###             'AwEHoUQDQgAE1YUhuPhYbtZw8KvfsZb/j3qGfT5NrMKTIY8e10BvajZ130ciIh/F
',
###             'aiw9kRk241s81B2jphBwoemEfWcji7nYow==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIIf1miOdlKqWu5XaIgvSttklr3fo3sRgPNZp2sRRrefboAoGCCqGSM49
',
###             'AwEHoUQDQgAE1YUhuPhYbtZw8KvfsZb/j3qGfT5NrMKTIY8e10BvajZ130ciIh/F
',
###             'aiw9kRk241s81B2jphBwoemEfWcji7nYow==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE7ojI+KRWHoNnXPcSimCZ0ZE3dnRH
',
###           'T/er4RNY9SItX6iUQYsPu1UyL+b92SBoaRf9UBdPG4ajHgv/S8HgZUBxYg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE7ojI+KRWHoNnXPcSimCZ0ZE3dnRH
',
###           'T/er4RNY9SItX6iUQYsPu1UyL+b92SBoaRf9UBdPG4ajHgv/S8HgZUBxYg==
',
###           '-----END PUBLIC KEY-----
'
### z: '684c4b342d1df11af3438258faeb1d4a5672042ad93293c29f996c7c127d629c'
### z: '684c4b342d1df11af3438258faeb1d4a5672042ad93293c29f996c7c127d629c'


### write message pattern: 's'
### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: 'e7f85b060e02f9f9b98fcb0c3f2d667308d78b12f9566dd018d2367563d7b84b'
### key: 'e7f85b060e02f9f9b98fcb0c3f2d667308d78b12f9566dd018d2367563d7b84b'
### iv: 'c62decba51a2d0e3e4d0b917'
### iv: 'c62decba51a2d0e3e4d0b917'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'f71bdd8c6892e4d7d5e4b917'
### iv_xor: 'f71bdd8c6892e4d7d5e4b917'
### aad: '57ed41726849d904c9cfc1af4753e7340ee1113a73a2c3937ddfc2134c00f664'
### aad: '57ed41726849d904c9cfc1af4753e7340ee1113a73a2c3937ddfc2134c00f664'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### ciphertext: 'e682a222759ef5b5ed2a2b47e319d7371be9c3d3543953033e0dc1558e3e7856c52ef27b88f06e36'
### ciphertext: 'e682a222759ef5b5ed2a2b47e319d7371be9c3d3543953033e0dc1558e3e7856c52ef27b88f06e36'
### authtag: '4d9d19c4d13e6a9fa6103512938b3c6a'
### authtag: '4d9d19c4d13e6a9fa6103512938b3c6a'
### cipherinfo: '834a31363136393034343134504d9d19c4d13e6a9fa6103512938b3c6a5828e682a222759ef5b5ed2a2b47e319d7371be9c3d3543953033e0dc1558e3e7856c52ef27b88f06e36'
### cipherinfo: '834a31363136393034343134504d9d19c4d13e6a9fa6103512938b3c6a5828e682a222759ef5b5ed2a2b47e319d7371be9c3d3543953033e0dc1558e3e7856c52ef27b88f06e36'

### write message pattern: 'es'

### write message pattern: 'es'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE7ojI+KRWHoNnXPcSimCZ0ZE3dnRH
',
###           'T/er4RNY9SItX6iUQYsPu1UyL+b92SBoaRf9UBdPG4ajHgv/S8HgZUBxYg==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE7ojI+KRWHoNnXPcSimCZ0ZE3dnRH
',
###           'T/er4RNY9SItX6iUQYsPu1UyL+b92SBoaRf9UBdPG4ajHgv/S8HgZUBxYg==
',
###           '-----END PUBLIC KEY-----
'
### z: '93a64f8656d310f37015a867c8b02dcc2dde9749215b561aea59c46888dca302'
### z: '93a64f8656d310f37015a867c8b02dcc2dde9749215b561aea59c46888dca302'


### noise encrypt
### noise encrypt
### key: 'd3bfbcc3e334fa29aaebe1884a7826b4d12551da1fd6bc5acee53f4a557f2e95'
### key: 'd3bfbcc3e334fa29aaebe1884a7826b4d12551da1fd6bc5acee53f4a557f2e95'
### iv: '22e2dc06136f09e57558b43b'
### iv: '22e2dc06136f09e57558b43b'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '13d4ed302a5f3dd1446cb43b'
### iv_xor: '13d4ed302a5f3dd1446cb43b'
### aad: '8f273dfb41728b910307e5366597e40520c88ec128c89c863d4265fd88975a97'
### aad: '8f273dfb41728b910307e5366597e40520c88ec128c89c863d4265fd88975a97'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '8aa8b19a520d983e'
### ciphertext: '8aa8b19a520d983e'
### authtag: 'a7eac1a083337745cd673e84179b011b'
### authtag: 'a7eac1a083337745cd673e84179b011b'
### cipherinfo: '834a3136313639303434313450a7eac1a083337745cd673e84179b011b488aa8b19a520d983e'
### cipherinfo: '834a3136313639303434313450a7eac1a083337745cd673e84179b011b488aa8b19a520d983e'


### b_msg: '83582103d58521b8f8586ed670f0abdfb196ff8f7a867d3e4dacc293218f1ed7406f6a365847834a31363136393034343134504d9d19c4d13e6a9fa6103512938b3c6a5828e682a222759ef5b5ed2a2b47e319d7371be9c3d3543953033e0dc1558e3e7856c52ef27b88f06e365826834a3136313639303434313450a7eac1a083337745cd673e84179b011b488aa8b19a520d983e'
### b_msg: '83582103d58521b8f8586ed670f0abdfb196ff8f7a867d3e4dacc293218f1ed7406f6a365847834a31363136393034343134504d9d19c4d13e6a9fa6103512938b3c6a5828e682a222759ef5b5ed2a2b47e319d7371be9c3d3543953033e0dc1558e3e7856c52ef27b88f06e365826834a3136313639303434313450a7eac1a083337745cd673e84179b011b488aa8b19a520d983e'
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  e                      => {
                              pub => pack("H*","03d58521b8f8586ed670f0abdfb196ff8f7a867d3e4dacc293218f1ed7406f6a36"),
                            },
  e_priv                 => "b_e_priv.pem",
  e_pub                  => "b_e_pub.pem",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 2,
  prologue               => "some_info",
  protocol_name          => "Noise_XXpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  re                     => {
                              pub => pack("H*","02ee88c8f8a4561e83675cf7128a6099d191377674474ff7abe11358f5222d5fa8"),
                            },
  re_pub                 => "b_re_pub.pem",
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","b01f2c6ad5f3c4c6a1f450494f8f56d21f78a115788fc4570f7b82d8726c4566"),
                              h => pack("H*","ce9c7eb9cbbdcedec277c0c4363b7ab9080a670921fb615e37983df667256eb3"),
                              hasK => 1,
                              k => pack("H*","2f00241dbed5ab3edfbb503af98ab7add332c26125a8d165b6dea70dca5656d0"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  e                      => {
                              pub => pack("H*","03d58521b8f8586ed670f0abdfb196ff8f7a867d3e4dacc293218f1ed7406f6a36"),
                            },
  e_priv                 => "b_e_priv.pem",
  e_pub                  => "b_e_pub.pem",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 2,
  prologue               => "some_info",
  protocol_name          => "Noise_XXpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  re                     => {
                              pub => pack("H*","02ee88c8f8a4561e83675cf7128a6099d191377674474ff7abe11358f5222d5fa8"),
                            },
  re_pub                 => "b_re_pub.pem",
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","b01f2c6ad5f3c4c6a1f450494f8f56d21f78a115788fc4570f7b82d8726c4566"),
                              h => pack("H*","ce9c7eb9cbbdcedec277c0c4363b7ab9080a670921fb615e37983df667256eb3"),
                              hasK => 1,
                              k => pack("H*","2f00241dbed5ab3edfbb503af98ab7add332c26125a8d165b6dea70dca5656d0"),
                            },
  who                    => "b",
}


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIFnEHO1NMNBIXQ7kn9gV60TG8e0jZYV1mtpsIoXwLnDXoAoGCCqGSM49
',
###             'AwEHoUQDQgAE7ojI+KRWHoNnXPcSimCZ0ZE3dnRHT/er4RNY9SItX6iUQYsPu1Uy
',
###             'L+b92SBoaRf9UBdPG4ajHgv/S8HgZUBxYg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIFnEHO1NMNBIXQ7kn9gV60TG8e0jZYV1mtpsIoXwLnDXoAoGCCqGSM49
',
###             'AwEHoUQDQgAE7ojI+KRWHoNnXPcSimCZ0ZE3dnRHT/er4RNY9SItX6iUQYsPu1Uy
',
###             'L+b92SBoaRf9UBdPG4ajHgv/S8HgZUBxYg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE1YUhuPhYbtZw8KvfsZb/j3qGfT5N
',
###           'rMKTIY8e10BvajZ130ciIh/Faiw9kRk241s81B2jphBwoemEfWcji7nYow==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE1YUhuPhYbtZw8KvfsZb/j3qGfT5N
',
###           'rMKTIY8e10BvajZ130ciIh/Faiw9kRk241s81B2jphBwoemEfWcji7nYow==
',
###           '-----END PUBLIC KEY-----
'
### z: '684c4b342d1df11af3438258faeb1d4a5672042ad93293c29f996c7c127d629c'
### z: '684c4b342d1df11af3438258faeb1d4a5672042ad93293c29f996c7c127d629c'

### read message pattern: 's'

### read message pattern: 's'


### noise decrypt
### noise decrypt
### key: 'e7f85b060e02f9f9b98fcb0c3f2d667308d78b12f9566dd018d2367563d7b84b'
### key: 'e7f85b060e02f9f9b98fcb0c3f2d667308d78b12f9566dd018d2367563d7b84b'
### iv: 'c62decba51a2d0e3e4d0b917'
### iv: 'c62decba51a2d0e3e4d0b917'
### aad: '57ed41726849d904c9cfc1af4753e7340ee1113a73a2c3937ddfc2134c00f664'
### aad: '57ed41726849d904c9cfc1af4753e7340ee1113a73a2c3937ddfc2134c00f664'
### cipherinfo: '834a31363136393034343134504d9d19c4d13e6a9fa6103512938b3c6a5828e682a222759ef5b5ed2a2b47e319d7371be9c3d3543953033e0dc1558e3e7856c52ef27b88f06e36'
### cipherinfo: '834a31363136393034343134504d9d19c4d13e6a9fa6103512938b3c6a5828e682a222759ef5b5ed2a2b47e319d7371be9c3d3543953033e0dc1558e3e7856c52ef27b88f06e36'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'f71bdd8c6892e4d7d5e4b917'
### iv_xor: 'f71bdd8c6892e4d7d5e4b917'
### authtag: '4d9d19c4d13e6a9fa6103512938b3c6a'
### authtag: '4d9d19c4d13e6a9fa6103512938b3c6a'
### ciphertext: 'e682a222759ef5b5ed2a2b47e319d7371be9c3d3543953033e0dc1558e3e7856c52ef27b88f06e36'
### ciphertext: 'e682a222759ef5b5ed2a2b47e319d7371be9c3d3543953033e0dc1558e3e7856c52ef27b88f06e36'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'


### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIFnEHO1NMNBIXQ7kn9gV60TG8e0jZYV1mtpsIoXwLnDXoAoGCCqGSM49
',
###             'AwEHoUQDQgAE7ojI+KRWHoNnXPcSimCZ0ZE3dnRHT/er4RNY9SItX6iUQYsPu1Uy
',
###             'L+b92SBoaRf9UBdPG4ajHgv/S8HgZUBxYg==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIFnEHO1NMNBIXQ7kn9gV60TG8e0jZYV1mtpsIoXwLnDXoAoGCCqGSM49
',
###             'AwEHoUQDQgAE7ojI+KRWHoNnXPcSimCZ0ZE3dnRHT/er4RNY9SItX6iUQYsPu1Uy
',
###             'L+b92SBoaRf9UBdPG4ajHgv/S8HgZUBxYg==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '93a64f8656d310f37015a867c8b02dcc2dde9749215b561aea59c46888dca302'
### z: '93a64f8656d310f37015a867c8b02dcc2dde9749215b561aea59c46888dca302'

### noise decrypt

### noise decrypt
### key: 'd3bfbcc3e334fa29aaebe1884a7826b4d12551da1fd6bc5acee53f4a557f2e95'
### key: 'd3bfbcc3e334fa29aaebe1884a7826b4d12551da1fd6bc5acee53f4a557f2e95'
### iv: '22e2dc06136f09e57558b43b'
### iv: '22e2dc06136f09e57558b43b'
### aad: '8f273dfb41728b910307e5366597e40520c88ec128c89c863d4265fd88975a97'
### aad: '8f273dfb41728b910307e5366597e40520c88ec128c89c863d4265fd88975a97'
### cipherinfo: '834a3136313639303434313450a7eac1a083337745cd673e84179b011b488aa8b19a520d983e'
### cipherinfo: '834a3136313639303434313450a7eac1a083337745cd673e84179b011b488aa8b19a520d983e'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '13d4ed302a5f3dd1446cb43b'
### iv_xor: '13d4ed302a5f3dd1446cb43b'
### authtag: 'a7eac1a083337745cd673e84179b011b'
### authtag: 'a7eac1a083337745cd673e84179b011b'
### ciphertext: '8aa8b19a520d983e'
### ciphertext: '8aa8b19a520d983e'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  e                      => {
                              pub => pack("H*","02ee88c8f8a4561e83675cf7128a6099d191377674474ff7abe11358f5222d5fa8"),
                            },
  e_priv                 => "a_e_priv.pem",
  e_pub                  => "a_e_pub.pem",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 2,
  prologue               => "some_info",
  protocol_name          => "Noise_XXpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  re                     => {
                              pub => pack("H*","03d58521b8f8586ed670f0abdfb196ff8f7a867d3e4dacc293218f1ed7406f6a36"),
                            },
  re_pub                 => "a_re_pub.pem",
  rs                     => {
                              pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                            },
  rs_pub                 => "a_rs_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","b01f2c6ad5f3c4c6a1f450494f8f56d21f78a115788fc4570f7b82d8726c4566"),
                              h => pack("H*","ce9c7eb9cbbdcedec277c0c4363b7ab9080a670921fb615e37983df667256eb3"),
                              hasK => 1,
                              k => pack("H*","2f00241dbed5ab3edfbb503af98ab7add332c26125a8d165b6dea70dca5656d0"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  e                      => {
                              pub => pack("H*","02ee88c8f8a4561e83675cf7128a6099d191377674474ff7abe11358f5222d5fa8"),
                            },
  e_priv                 => "a_e_priv.pem",
  e_pub                  => "a_e_pub.pem",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 2,
  prologue               => "some_info",
  protocol_name          => "Noise_XXpsk0_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 0,
  re                     => {
                              pub => pack("H*","03d58521b8f8586ed670f0abdfb196ff8f7a867d3e4dacc293218f1ed7406f6a36"),
                            },
  re_pub                 => "a_re_pub.pem",
  rs                     => {
                              pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                            },
  rs_pub                 => "a_rs_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","b01f2c6ad5f3c4c6a1f450494f8f56d21f78a115788fc4570f7b82d8726c4566"),
                              h => pack("H*","ce9c7eb9cbbdcedec277c0c4363b7ab9080a670921fb615e37983df667256eb3"),
                              hasK => 1,
                              k => pack("H*","2f00241dbed5ab3edfbb503af98ab7add332c26125a8d165b6dea70dca5656d0"),
                            },
  who                    => "a",
}


### a send msg to b
### a send msg to b


### $a_msg2_src: 'init.ack'
### $a_msg2_src: 'init.ack'


### write message pattern: 's'
### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: 'd3bfbcc3e334fa29aaebe1884a7826b4d12551da1fd6bc5acee53f4a557f2e95'
### key: 'd3bfbcc3e334fa29aaebe1884a7826b4d12551da1fd6bc5acee53f4a557f2e95'
### iv: '22e2dc06136f09e57558b43b'
### iv: '22e2dc06136f09e57558b43b'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '13d4ed302a5f3dd1446cb43b'
### iv_xor: '13d4ed302a5f3dd1446cb43b'
### aad: 'ce9c7eb9cbbdcedec277c0c4363b7ab9080a670921fb615e37983df667256eb3'
### aad: 'ce9c7eb9cbbdcedec277c0c4363b7ab9080a670921fb615e37983df667256eb3'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: '7a8eb08b0b34da560ae80f9caa031872219ac3369b191b00a5947c4b3126f8e15ab8ea416c02ef40'
### ciphertext: '7a8eb08b0b34da560ae80f9caa031872219ac3369b191b00a5947c4b3126f8e15ab8ea416c02ef40'
### authtag: '26583d45afa3de1e7547856a9ec5482f'
### authtag: '26583d45afa3de1e7547856a9ec5482f'
### cipherinfo: '834a313631363930343431345026583d45afa3de1e7547856a9ec5482f58287a8eb08b0b34da560ae80f9caa031872219ac3369b191b00a5947c4b3126f8e15ab8ea416c02ef40'
### cipherinfo: '834a313631363930343431345026583d45afa3de1e7547856a9ec5482f58287a8eb08b0b34da560ae80f9caa031872219ac3369b191b00a5947c4b3126f8e15ab8ea416c02ef40'


### write message pattern: 'se'
### write message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE1YUhuPhYbtZw8KvfsZb/j3qGfT5N
',
###           'rMKTIY8e10BvajZ130ciIh/Faiw9kRk241s81B2jphBwoemEfWcji7nYow==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE1YUhuPhYbtZw8KvfsZb/j3qGfT5N
',
###           'rMKTIY8e10BvajZ130ciIh/Faiw9kRk241s81B2jphBwoemEfWcji7nYow==
',
###           '-----END PUBLIC KEY-----
'
### z: 'da5c0763fc7f954f6f1078672479f70e3f381e0eb91bafa439fb0c40be57d682'
### z: 'da5c0763fc7f954f6f1078672479f70e3f381e0eb91bafa439fb0c40be57d682'


### noise encrypt
### noise encrypt
### key: 'bd87f94ddb6837cf1e0aba4b25f91b2b1a86dcbcef722c811b12162732ee4695'
### key: 'bd87f94ddb6837cf1e0aba4b25f91b2b1a86dcbcef722c811b12162732ee4695'
### iv: 'd59a4a7b0fc64906b1e187ee'
### iv: 'd59a4a7b0fc64906b1e187ee'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'e4ac7b4d36f67d3280d587ee'
### iv_xor: 'e4ac7b4d36f67d3280d587ee'
### aad: 'cec4ed20c9581c2e4310ee9d6380733e3d84e7d07960d21424bf7d8467e34ae9'
### aad: 'cec4ed20c9581c2e4310ee9d6380733e3d84e7d07960d21424bf7d8467e34ae9'
### plaintext: '696e69742e61636b'
### plaintext: '696e69742e61636b'
### ciphertext: '35a14e7926de5c00'
### ciphertext: '35a14e7926de5c00'
### authtag: '4a87472c2e7ccd1626829ac5ee222700'
### authtag: '4a87472c2e7ccd1626829ac5ee222700'
### cipherinfo: '834a31363136393034343134504a87472c2e7ccd1626829ac5ee2227004835a14e7926de5c00'
### cipherinfo: '834a31363136393034343134504a87472c2e7ccd1626829ac5ee2227004835a14e7926de5c00'


### a_msg2: '825847834a313631363930343431345026583d45afa3de1e7547856a9ec5482f58287a8eb08b0b34da560ae80f9caa031872219ac3369b191b00a5947c4b3126f8e15ab8ea416c02ef405826834a31363136393034343134504a87472c2e7ccd1626829ac5ee2227004835a14e7926de5c00'
### a_msg2: '825847834a313631363930343431345026583d45afa3de1e7547856a9ec5482f58287a8eb08b0b34da560ae80f9caa031872219ac3369b191b00a5947c4b3126f8e15ab8ea416c02ef405826834a31363136393034343134504a87472c2e7ccd1626829ac5ee2227004835a14e7926de5c00'
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02ee88c8f8a4561e83675cf7128a6099d191377674474ff7abe11358f5222d5fa8"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 3,
    prologue               => "some_info",
    protocol_name          => "Noise_XXpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","03d58521b8f8586ed670f0abdfb196ff8f7a867d3e4dacc293218f1ed7406f6a36"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs                     => {
                                pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                              },
    rs_pub                 => "a_rs_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","a09e89f8999c9d8bd9ebbb31032ad2060b9b9e074f0bb4a05c2d9c085949ec67"),
                                h => pack("H*","43faf7ec5125c30c5220489ebaca8b5835b0cd38aff0bed270ad56330cbd853a"),
                                hasK => 1,
                                k => pack("H*","c12d90fbcb8ea76bd67c0174eafdcdbbba1264d47db14aff4465eb03529f6d3f"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","4d7c8d3ecfc67c05570a7b6cd7d0a591385a1954a6762b202cc72d597e13f880"),
  },
  {
    hasK => 1,
    k => pack("H*","a087f140d5e266dc3a0e0d5c1b9cbfb20bedf9e4802a0ed0237ead45349ffb12"),
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","02ee88c8f8a4561e83675cf7128a6099d191377674474ff7abe11358f5222d5fa8"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 3,
    prologue               => "some_info",
    protocol_name          => "Noise_XXpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","03d58521b8f8586ed670f0abdfb196ff8f7a867d3e4dacc293218f1ed7406f6a36"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs                     => {
                                pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                              },
    rs_pub                 => "a_rs_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","a09e89f8999c9d8bd9ebbb31032ad2060b9b9e074f0bb4a05c2d9c085949ec67"),
                                h => pack("H*","43faf7ec5125c30c5220489ebaca8b5835b0cd38aff0bed270ad56330cbd853a"),
                                hasK => 1,
                                k => pack("H*","c12d90fbcb8ea76bd67c0174eafdcdbbba1264d47db14aff4465eb03529f6d3f"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","4d7c8d3ecfc67c05570a7b6cd7d0a591385a1954a6762b202cc72d597e13f880"),
  },
  {
    hasK => 1,
    k => pack("H*","a087f140d5e266dc3a0e0d5c1b9cbfb20bedf9e4802a0ed0237ead45349ffb12"),
  },
)


### b recv msg from a
### b recv msg from a


### read message pattern: 's'
### read message pattern: 's'


### noise decrypt
### noise decrypt
### key: 'd3bfbcc3e334fa29aaebe1884a7826b4d12551da1fd6bc5acee53f4a557f2e95'
### key: 'd3bfbcc3e334fa29aaebe1884a7826b4d12551da1fd6bc5acee53f4a557f2e95'
### iv: '22e2dc06136f09e57558b43b'
### iv: '22e2dc06136f09e57558b43b'
### aad: 'ce9c7eb9cbbdcedec277c0c4363b7ab9080a670921fb615e37983df667256eb3'
### aad: 'ce9c7eb9cbbdcedec277c0c4363b7ab9080a670921fb615e37983df667256eb3'
### cipherinfo: '834a313631363930343431345026583d45afa3de1e7547856a9ec5482f58287a8eb08b0b34da560ae80f9caa031872219ac3369b191b00a5947c4b3126f8e15ab8ea416c02ef40'
### cipherinfo: '834a313631363930343431345026583d45afa3de1e7547856a9ec5482f58287a8eb08b0b34da560ae80f9caa031872219ac3369b191b00a5947c4b3126f8e15ab8ea416c02ef40'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '13d4ed302a5f3dd1446cb43b'
### iv_xor: '13d4ed302a5f3dd1446cb43b'
### authtag: '26583d45afa3de1e7547856a9ec5482f'
### authtag: '26583d45afa3de1e7547856a9ec5482f'
### ciphertext: '7a8eb08b0b34da560ae80f9caa031872219ac3369b191b00a5947c4b3126f8e15ab8ea416c02ef40'
### ciphertext: '7a8eb08b0b34da560ae80f9caa031872219ac3369b191b00a5947c4b3126f8e15ab8ea416c02ef40'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'


### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'


### read message pattern: 'se'
### read message pattern: 'se'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIIf1miOdlKqWu5XaIgvSttklr3fo3sRgPNZp2sRRrefboAoGCCqGSM49
',
###             'AwEHoUQDQgAE1YUhuPhYbtZw8KvfsZb/j3qGfT5NrMKTIY8e10BvajZ130ciIh/F
',
###             'aiw9kRk241s81B2jphBwoemEfWcji7nYow==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIIf1miOdlKqWu5XaIgvSttklr3fo3sRgPNZp2sRRrefboAoGCCqGSM49
',
###             'AwEHoUQDQgAE1YUhuPhYbtZw8KvfsZb/j3qGfT5NrMKTIY8e10BvajZ130ciIh/F
',
###             'aiw9kRk241s81B2jphBwoemEfWcji7nYow==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: 'da5c0763fc7f954f6f1078672479f70e3f381e0eb91bafa439fb0c40be57d682'
### z: 'da5c0763fc7f954f6f1078672479f70e3f381e0eb91bafa439fb0c40be57d682'


### noise decrypt
### noise decrypt
### key: 'bd87f94ddb6837cf1e0aba4b25f91b2b1a86dcbcef722c811b12162732ee4695'
### key: 'bd87f94ddb6837cf1e0aba4b25f91b2b1a86dcbcef722c811b12162732ee4695'
### iv: 'd59a4a7b0fc64906b1e187ee'
### iv: 'd59a4a7b0fc64906b1e187ee'
### aad: 'cec4ed20c9581c2e4310ee9d6380733e3d84e7d07960d21424bf7d8467e34ae9'
### aad: 'cec4ed20c9581c2e4310ee9d6380733e3d84e7d07960d21424bf7d8467e34ae9'
### cipherinfo: '834a31363136393034343134504a87472c2e7ccd1626829ac5ee2227004835a14e7926de5c00'
### cipherinfo: '834a31363136393034343134504a87472c2e7ccd1626829ac5ee2227004835a14e7926de5c00'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'e4ac7b4d36f67d3280d587ee'
### iv_xor: 'e4ac7b4d36f67d3280d587ee'
### authtag: '4a87472c2e7ccd1626829ac5ee222700'
### authtag: '4a87472c2e7ccd1626829ac5ee222700'
### ciphertext: '35a14e7926de5c00'
### ciphertext: '35a14e7926de5c00'
### plaintext: '696e69742e61636b'
### plaintext: '696e69742e61636b'


### b_recv_a_msg2: 'init.ack'
### b_recv_a_msg2: 'init.ack'
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03d58521b8f8586ed670f0abdfb196ff8f7a867d3e4dacc293218f1ed7406f6a36"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 3,
    prologue               => "some_info",
    protocol_name          => "Noise_XXpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","02ee88c8f8a4561e83675cf7128a6099d191377674474ff7abe11358f5222d5fa8"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","a09e89f8999c9d8bd9ebbb31032ad2060b9b9e074f0bb4a05c2d9c085949ec67"),
                                h => pack("H*","43faf7ec5125c30c5220489ebaca8b5835b0cd38aff0bed270ad56330cbd853a"),
                                hasK => 1,
                                k => pack("H*","c12d90fbcb8ea76bd67c0174eafdcdbbba1264d47db14aff4465eb03529f6d3f"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","4d7c8d3ecfc67c05570a7b6cd7d0a591385a1954a6762b202cc72d597e13f880"),
  },
  {
    hasK => 1,
    k => pack("H*","a087f140d5e266dc3a0e0d5c1b9cbfb20bedf9e4802a0ed0237ead45349ffb12"),
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","03d58521b8f8586ed670f0abdfb196ff8f7a867d3e4dacc293218f1ed7406f6a36"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["psk", "e"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 3,
    prologue               => "some_info",
    protocol_name          => "Noise_XXpsk0_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 0,
    re                     => {
                                pub => pack("H*","02ee88c8f8a4561e83675cf7128a6099d191377674474ff7abe11358f5222d5fa8"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","a09e89f8999c9d8bd9ebbb31032ad2060b9b9e074f0bb4a05c2d9c085949ec67"),
                                h => pack("H*","43faf7ec5125c30c5220489ebaca8b5835b0cd38aff0bed270ad56330cbd853a"),
                                hasK => 1,
                                k => pack("H*","c12d90fbcb8ea76bd67c0174eafdcdbbba1264d47db14aff4465eb03529f6d3f"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","4d7c8d3ecfc67c05570a7b6cd7d0a591385a1954a6762b202cc72d597e13f880"),
  },
  {
    hasK => 1,
    k => pack("H*","a087f140d5e266dc3a0e0d5c1b9cbfb20bedf9e4802a0ed0237ead45349ffb12"),
  },
)


### a send comm msg to b
### a send comm msg to b

### noise encrypt

### noise encrypt
### key: '94045f54e5a23360c377a8c9299c8d44936b215e1bcaf03317f40b3e50c9bb06'
### key: '94045f54e5a23360c377a8c9299c8d44936b215e1bcaf03317f40b3e50c9bb06'
### iv: '9949c8ee6ba32a56edc4b5f4'
### iv: '9949c8ee6ba32a56edc4b5f4'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'a87ff9d852931e62dcf0b5f4'
### iv_xor: 'a87ff9d852931e62dcf0b5f4'
### aad: '43faf7ec5125c30c5220489ebaca8b5835b0cd38aff0bed270ad56330cbd853a'
### aad: '43faf7ec5125c30c5220489ebaca8b5835b0cd38aff0bed270ad56330cbd853a'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '9ed6890dee9f329944d5967ffd76fc85d8802dc9d8f02ed972ea63a10b2dc8a37b5047cbfa8215423806588bb0e854ab5ba753'
### ciphertext: '9ed6890dee9f329944d5967ffd76fc85d8802dc9d8f02ed972ea63a10b2dc8a37b5047cbfa8215423806588bb0e854ab5ba753'
### authtag: '0708165e534a20d3e7ea6d50adf55ef3'
### authtag: '0708165e534a20d3e7ea6d50adf55ef3'
### cipherinfo: '834a31363136393034343134500708165e534a20d3e7ea6d50adf55ef358339ed6890dee9f329944d5967ffd76fc85d8802dc9d8f02ed972ea63a10b2dc8a37b5047cbfa8215423806588bb0e854ab5ba753'
### cipherinfo: '834a31363136393034343134500708165e534a20d3e7ea6d50adf55ef358339ed6890dee9f329944d5967ffd76fc85d8802dc9d8f02ed972ea63a10b2dc8a37b5047cbfa8215423806588bb0e854ab5ba753'


### b recv comm msg from a
### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: '94045f54e5a23360c377a8c9299c8d44936b215e1bcaf03317f40b3e50c9bb06'
### key: '94045f54e5a23360c377a8c9299c8d44936b215e1bcaf03317f40b3e50c9bb06'
### iv: '9949c8ee6ba32a56edc4b5f4'
### iv: '9949c8ee6ba32a56edc4b5f4'
### aad: '43faf7ec5125c30c5220489ebaca8b5835b0cd38aff0bed270ad56330cbd853a'
### aad: '43faf7ec5125c30c5220489ebaca8b5835b0cd38aff0bed270ad56330cbd853a'
### cipherinfo: '834a31363136393034343134500708165e534a20d3e7ea6d50adf55ef358339ed6890dee9f329944d5967ffd76fc85d8802dc9d8f02ed972ea63a10b2dc8a37b5047cbfa8215423806588bb0e854ab5ba753'
### cipherinfo: '834a31363136393034343134500708165e534a20d3e7ea6d50adf55ef358339ed6890dee9f329944d5967ffd76fc85d8802dc9d8f02ed972ea63a10b2dc8a37b5047cbfa8215423806588bb0e854ab5ba753'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'a87ff9d852931e62dcf0b5f4'
### iv_xor: 'a87ff9d852931e62dcf0b5f4'
### authtag: '0708165e534a20d3e7ea6d50adf55ef3'
### authtag: '0708165e534a20d3e7ea6d50adf55ef3'
### ciphertext: '9ed6890dee9f329944d5967ffd76fc85d8802dc9d8f02ed972ea63a10b2dc8a37b5047cbfa8215423806588bb0e854ab5ba753'
### ciphertext: '9ed6890dee9f329944d5967ffd76fc85d8802dc9d8f02ed972ea63a10b2dc8a37b5047cbfa8215423806588bb0e854ab5ba753'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'


### b to a , plain_b.txt to trans_cipherinfo_b
### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a

### noise encrypt

### noise encrypt
### key: 'f117b66fdd8d673aac644c9798522d36fd4663fa945dd16b3129a77026ed1455'
### key: 'f117b66fdd8d673aac644c9798522d36fd4663fa945dd16b3129a77026ed1455'
### iv: 'bc99763130ad0e36f53b8528'
### iv: 'bc99763130ad0e36f53b8528'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '8daf4707099d3a02c40f8528'
### iv_xor: '8daf4707099d3a02c40f8528'
### aad: '43faf7ec5125c30c5220489ebaca8b5835b0cd38aff0bed270ad56330cbd853a'
### aad: '43faf7ec5125c30c5220489ebaca8b5835b0cd38aff0bed270ad56330cbd853a'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '39e643ef6fbd0303b3f73b28caf0d92386e8a45385848891626ec652b48042afc5d8a9af0096a5fec0e8026294388e'
### ciphertext: '39e643ef6fbd0303b3f73b28caf0d92386e8a45385848891626ec652b48042afc5d8a9af0096a5fec0e8026294388e'
### authtag: '306af604618904204d17e606802a912e'
### authtag: '306af604618904204d17e606802a912e'
### cipherinfo: '834a3136313639303434313450306af604618904204d17e606802a912e582f39e643ef6fbd0303b3f73b28caf0d92386e8a45385848891626ec652b48042afc5d8a9af0096a5fec0e8026294388e'
### cipherinfo: '834a3136313639303434313450306af604618904204d17e606802a912e582f39e643ef6fbd0303b3f73b28caf0d92386e8a45385848891626ec652b48042afc5d8a9af0096a5fec0e8026294388e'


### a recv comm msg from b
### a recv comm msg from b


### noise decrypt
### noise decrypt
### key: 'f117b66fdd8d673aac644c9798522d36fd4663fa945dd16b3129a77026ed1455'
### key: 'f117b66fdd8d673aac644c9798522d36fd4663fa945dd16b3129a77026ed1455'
### iv: 'bc99763130ad0e36f53b8528'
### iv: 'bc99763130ad0e36f53b8528'
### aad: '43faf7ec5125c30c5220489ebaca8b5835b0cd38aff0bed270ad56330cbd853a'
### aad: '43faf7ec5125c30c5220489ebaca8b5835b0cd38aff0bed270ad56330cbd853a'
### cipherinfo: '834a3136313639303434313450306af604618904204d17e606802a912e582f39e643ef6fbd0303b3f73b28caf0d92386e8a45385848891626ec652b48042afc5d8a9af0096a5fec0e8026294388e'
### cipherinfo: '834a3136313639303434313450306af604618904204d17e606802a912e582f39e643ef6fbd0303b3f73b28caf0d92386e8a45385848891626ec652b48042afc5d8a9af0096a5fec0e8026294388e'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '8daf4707099d3a02c40f8528'
### iv_xor: '8daf4707099d3a02c40f8528'
### authtag: '306af604618904204d17e606802a912e'
### authtag: '306af604618904204d17e606802a912e'
### ciphertext: '39e643ef6fbd0303b3f73b28caf0d92386e8a45385848891626ec652b48042afc5d8a9af0096a5fec0e8026294388e'
### ciphertext: '39e643ef6fbd0303b3f73b28caf0d92386e8a45385848891626ec652b48042afc5d8a9af0096a5fec0e8026294388e'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'XX',
###                               'test_psk',
###                               0
### -----------end test --------: 'XX',
###                               'test_psk',
###                               0


### -----------start test --------: 'XX',
###                                 'test_psk',
###                                 1
### -----------start test --------: 'XX',
###                                 'test_psk',
###                                 1

### a write message to b

### a write message to b
### init a_hs
### init a_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_XXpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","621523a8048500f43d58bb7791873ef685d9ab18e9fe740388130f365fda5aff"),
                              h  => pack("H*","4a47c7698d705dc2062eca7415782c6e385cfd3cf464d0e83f5080f5ea026905"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_XXpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "b_s_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","621523a8048500f43d58bb7791873ef685d9ab18e9fe740388130f365fda5aff"),
                              h  => pack("H*","4a47c7698d705dc2062eca7415782c6e385cfd3cf464d0e83f5080f5ea026905"),
                            },
  who                    => "a",
}

### a send msg to b

### a send msg to b


### write message pattern: 'e'
### write message pattern: 'e'

### public compressed: '030a80cbdf3c77f7843c81c1c19e3cd89845a9fe3bdc6befe81174a6aebdadd926'

### public compressed: '030a80cbdf3c77f7843c81c1c19e3cd89845a9fe3bdc6befe81174a6aebdadd926'


### write message pattern: 'psk'
### write message pattern: 'psk'


### noise encrypt
### noise encrypt
### key: '39e2aa31805cca5a4e3e1a9b7a96971ca14fd08c07ab5f1caa2f4adfda3ab85f'
### key: '39e2aa31805cca5a4e3e1a9b7a96971ca14fd08c07ab5f1caa2f4adfda3ab85f'
### iv: '2e26f10090fd9a4be192262e'
### iv: '2e26f10090fd9a4be192262e'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '1f10c036a9cdae7fd0a6262e'
### iv_xor: '1f10c036a9cdae7fd0a6262e'
### aad: 'f68ecbe21b8ab9774996f7489711994a9df726be8205f99fe6535c1943d53720'
### aad: 'f68ecbe21b8ab9774996f7489711994a9df726be8205f99fe6535c1943d53720'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
### ciphertext: '803271d309d1c891'
### ciphertext: '803271d309d1c891'
### authtag: '2001d256774ce08641aeb5c4c8eee8c6'
### authtag: '2001d256774ce08641aeb5c4c8eee8c6'
### cipherinfo: '834a31363136393034343134502001d256774ce08641aeb5c4c8eee8c648803271d309d1c891'
### cipherinfo: '834a31363136393034343134502001d256774ce08641aeb5c4c8eee8c648803271d309d1c891'
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAwqAy988d/eEPIHBwZ482JhFqf473Gvv6BF0pq69rdkmWCaDSjE2MTY5MDQ0MTRQIAHSVndM4IZBrrXEyO7oxkiAMnHTCdHIkQ=="),
  );
}
do {
  require MIME::Base64;
  (
    "a_msg",
    MIME::Base64::decode("glghAwqAy988d/eEPIHBwZ482JhFqf473Gvv6BF0pq69rdkmWCaDSjE2MTY5MDQ0MTRQIAHSVndM4IZBrrXEyO7oxkiAMnHTCdHIkQ=="),
  );
}
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","030a80cbdf3c77f7843c81c1c19e3cd89845a9fe3bdc6befe81174a6aebdadd926"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_XXpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","e57157c7885c2ef43298816426c343538b1160a482e43d4156eead43d433d38d"),
                                h => pack("H*","53b098dc6cf20f5583807286211b43d95702a323af165070e8d6a8f290c2cf52"),
                                hasK => 1,
                                k => pack("H*","7123b9752533a23c7932fc993bf04ae2611aab5f34210b532d6b6a9bea9701c3"),
                              },
    who                    => "a",
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","030a80cbdf3c77f7843c81c1c19e3cd89845a9fe3bdc6befe81174a6aebdadd926"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_XXpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    rs_pub                 => "b_s_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","e57157c7885c2ef43298816426c343538b1160a482e43d4156eead43d433d38d"),
                                h => pack("H*","53b098dc6cf20f5583807286211b43d95702a323af165070e8d6a8f290c2cf52"),
                                hasK => 1,
                                k => pack("H*","7123b9752533a23c7932fc993bf04ae2611aab5f34210b532d6b6a9bea9701c3"),
                              },
    who                    => "a",
  },
)


### b read message from a
### b read message from a
### init b_hs
### init b_hs
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_XXpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","621523a8048500f43d58bb7791873ef685d9ab18e9fe740388130f365fda5aff"),
                              h  => pack("H*","4a47c7698d705dc2062eca7415782c6e385cfd3cf464d0e83f5080f5ea026905"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 0,
  prologue               => "some_info",
  protocol_name          => "Noise_XXpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","621523a8048500f43d58bb7791873ef685d9ab18e9fe740388130f365fda5aff"),
                              h  => pack("H*","4a47c7698d705dc2062eca7415782c6e385cfd3cf464d0e83f5080f5ea026905"),
                            },
  who                    => "b",
}


### b recv msg from a
### b recv msg from a

### read message pattern: 'e'

### read message pattern: 'e'

### read message pattern: 'psk'

### read message pattern: 'psk'

### noise decrypt

### noise decrypt
### key: '39e2aa31805cca5a4e3e1a9b7a96971ca14fd08c07ab5f1caa2f4adfda3ab85f'
### key: '39e2aa31805cca5a4e3e1a9b7a96971ca14fd08c07ab5f1caa2f4adfda3ab85f'
### iv: '2e26f10090fd9a4be192262e'
### iv: '2e26f10090fd9a4be192262e'
### aad: 'f68ecbe21b8ab9774996f7489711994a9df726be8205f99fe6535c1943d53720'
### aad: 'f68ecbe21b8ab9774996f7489711994a9df726be8205f99fe6535c1943d53720'
### cipherinfo: '834a31363136393034343134502001d256774ce08641aeb5c4c8eee8c648803271d309d1c891'
### cipherinfo: '834a31363136393034343134502001d256774ce08641aeb5c4c8eee8c648803271d309d1c891'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '1f10c036a9cdae7fd0a6262e'
### iv_xor: '1f10c036a9cdae7fd0a6262e'
### authtag: '2001d256774ce08641aeb5c4c8eee8c6'
### authtag: '2001d256774ce08641aeb5c4c8eee8c6'
### ciphertext: '803271d309d1c891'
### ciphertext: '803271d309d1c891'
### plaintext: '696e69742e73796e'
### plaintext: '696e69742e73796e'
("b_recv_a_msg", "init.syn")
("b_recv_a_msg", "init.syn")
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_XXpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","030a80cbdf3c77f7843c81c1c19e3cd89845a9fe3bdc6befe81174a6aebdadd926"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","e57157c7885c2ef43298816426c343538b1160a482e43d4156eead43d433d38d"),
                                h => pack("H*","53b098dc6cf20f5583807286211b43d95702a323af165070e8d6a8f290c2cf52"),
                                hasK => 1,
                                k => pack("H*","7123b9752533a23c7932fc993bf04ae2611aab5f34210b532d6b6a9bea9701c3"),
                              },
    who                    => "b",
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 1,
    prologue               => "some_info",
    protocol_name          => "Noise_XXpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","030a80cbdf3c77f7843c81c1c19e3cd89845a9fe3bdc6befe81174a6aebdadd926"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs_pub                 => "a_s_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","e57157c7885c2ef43298816426c343538b1160a482e43d4156eead43d433d38d"),
                                h => pack("H*","53b098dc6cf20f5583807286211b43d95702a323af165070e8d6a8f290c2cf52"),
                                hasK => 1,
                                k => pack("H*","7123b9752533a23c7932fc993bf04ae2611aab5f34210b532d6b6a9bea9701c3"),
                              },
    who                    => "b",
  },
)


### b write_message to a
### b write_message to a
### b send msg to a
### b send msg to a


### write message pattern: 'e'
### write message pattern: 'e'

### public compressed: '0306f8e834655ecb96deb8cdb24e0e732237c2c0361e1263c780383240093565b0'

### public compressed: '0306f8e834655ecb96deb8cdb24e0e732237c2c0361e1263c780383240093565b0'


### write message pattern: 'ee'
### write message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIEhckVrF1aHHYbW33TqMGmYHUcd8fhyEJlIllPfhtu8aoAoGCCqGSM49
',
###             'AwEHoUQDQgAEBvjoNGVey5beuM2yTg5zIjfCwDYeEmPHgDgyQAk1ZbBYr6B4qkJp
',
###             'Tva7Z9kuIAbx8BQO2sWx75Qls6KDthE20w==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIEhckVrF1aHHYbW33TqMGmYHUcd8fhyEJlIllPfhtu8aoAoGCCqGSM49
',
###             'AwEHoUQDQgAEBvjoNGVey5beuM2yTg5zIjfCwDYeEmPHgDgyQAk1ZbBYr6B4qkJp
',
###             'Tva7Z9kuIAbx8BQO2sWx75Qls6KDthE20w==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAECoDL3zx394Q8gcHBnjzYmEWp/jvc
',
###           'a+/oEXSmrr2t2Sb1deK4WbCSizTlJqtYgUWPrsbAQcpwsa0/AqCbXgHdbw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAECoDL3zx394Q8gcHBnjzYmEWp/jvc
',
###           'a+/oEXSmrr2t2Sb1deK4WbCSizTlJqtYgUWPrsbAQcpwsa0/AqCbXgHdbw==
',
###           '-----END PUBLIC KEY-----
'
### z: '699b3c47862f50b6de9590dd363cb201cef6fe97a3095462b851aa6115c2c2d0'
### z: '699b3c47862f50b6de9590dd363cb201cef6fe97a3095462b851aa6115c2c2d0'

### write message pattern: 's'

### write message pattern: 's'

### noise encrypt

### noise encrypt
### key: '6ee94cea55f701ae129e531db28041393daa41181cd82bdff72d243d1d346d79'
### key: '6ee94cea55f701ae129e531db28041393daa41181cd82bdff72d243d1d346d79'
### iv: '0d91e00e671804e504c43167'
### iv: '0d91e00e671804e504c43167'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '3ca7d1385e2830d135f03167'
### iv_xor: '3ca7d1385e2830d135f03167'
### aad: 'd3ec7259d43f04aa0075ce64803a4e6bfbf21999ac66e4be7f4f938c10e3d4b6'
### aad: 'd3ec7259d43f04aa0075ce64803a4e6bfbf21999ac66e4be7f4f938c10e3d4b6'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### ciphertext: 'fbe14b43304adf2bec5e13b4472a206e1e3ef5f8d9e3110de6b0cc0cd0ba336dc2ae31e3e6e1628b'
### ciphertext: 'fbe14b43304adf2bec5e13b4472a206e1e3ef5f8d9e3110de6b0cc0cd0ba336dc2ae31e3e6e1628b'
### authtag: '36a17ccae1e8fa1199545101e3cac736'
### authtag: '36a17ccae1e8fa1199545101e3cac736'
### cipherinfo: '834a313631363930343431345036a17ccae1e8fa1199545101e3cac7365828fbe14b43304adf2bec5e13b4472a206e1e3ef5f8d9e3110de6b0cc0cd0ba336dc2ae31e3e6e1628b'
### cipherinfo: '834a313631363930343431345036a17ccae1e8fa1199545101e3cac7365828fbe14b43304adf2bec5e13b4472a206e1e3ef5f8d9e3110de6b0cc0cd0ba336dc2ae31e3e6e1628b'


### write message pattern: 'es'
### write message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIPm6e/LhSw/HiIjjbKNNjg5HmP76DzSg8MhAN2Zd3R37oAoGCCqGSM49
',
###             'AwEHoUQDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPdUOiJZhDDortMd8wSvzONxYPi
',
###             'BXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAECoDL3zx394Q8gcHBnjzYmEWp/jvc
',
###           'a+/oEXSmrr2t2Sb1deK4WbCSizTlJqtYgUWPrsbAQcpwsa0/AqCbXgHdbw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAECoDL3zx394Q8gcHBnjzYmEWp/jvc
',
###           'a+/oEXSmrr2t2Sb1deK4WbCSizTlJqtYgUWPrsbAQcpwsa0/AqCbXgHdbw==
',
###           '-----END PUBLIC KEY-----
'
### z: '17ea73d48e7877c3d12e3b8c55175ab1048280ae82b612afc376308f4b32409d'
### z: '17ea73d48e7877c3d12e3b8c55175ab1048280ae82b612afc376308f4b32409d'

### noise encrypt

### noise encrypt
### key: '73b2c45617d49b5eeb95892e5ae877c465dc4223f3cd4d64478026964c063da0'
### key: '73b2c45617d49b5eeb95892e5ae877c465dc4223f3cd4d64478026964c063da0'
### iv: '907675ab0b677e2c670d9d89'
### iv: '907675ab0b677e2c670d9d89'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'a140449d32574a1856399d89'
### iv_xor: 'a140449d32574a1856399d89'
### aad: '3c8e5f9aba75da5f2134d9f10759c8449fc6ed3ab136135befe9de7b579003e1'
### aad: '3c8e5f9aba75da5f2134d9f10759c8449fc6ed3ab136135befe9de7b579003e1'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
### ciphertext: '5b16309217672ec3'
### ciphertext: '5b16309217672ec3'
### authtag: '1b291bee970953a95e5bfadef42d6bea'
### authtag: '1b291bee970953a95e5bfadef42d6bea'
### cipherinfo: '834a31363136393034343134501b291bee970953a95e5bfadef42d6bea485b16309217672ec3'
### cipherinfo: '834a31363136393034343134501b291bee970953a95e5bfadef42d6bea485b16309217672ec3'


### b_msg: '8358210306f8e834655ecb96deb8cdb24e0e732237c2c0361e1263c780383240093565b05847834a313631363930343431345036a17ccae1e8fa1199545101e3cac7365828fbe14b43304adf2bec5e13b4472a206e1e3ef5f8d9e3110de6b0cc0cd0ba336dc2ae31e3e6e1628b5826834a31363136393034343134501b291bee970953a95e5bfadef42d6bea485b16309217672ec3'
### b_msg: '8358210306f8e834655ecb96deb8cdb24e0e732237c2c0361e1263c780383240093565b05847834a313631363930343431345036a17ccae1e8fa1199545101e3cac7365828fbe14b43304adf2bec5e13b4472a206e1e3ef5f8d9e3110de6b0cc0cd0ba336dc2ae31e3e6e1628b5826834a31363136393034343134501b291bee970953a95e5bfadef42d6bea485b16309217672ec3'
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  e                      => {
                              pub => pack("H*","0306f8e834655ecb96deb8cdb24e0e732237c2c0361e1263c780383240093565b0"),
                            },
  e_priv                 => "b_e_priv.pem",
  e_pub                  => "b_e_pub.pem",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 2,
  prologue               => "some_info",
  protocol_name          => "Noise_XXpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  re                     => {
                              pub => pack("H*","030a80cbdf3c77f7843c81c1c19e3cd89845a9fe3bdc6befe81174a6aebdadd926"),
                            },
  re_pub                 => "b_re_pub.pem",
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","aa5eaf00a85ca5bd97994ca0ab7cf615034bd0961b00c4143b8431d330cb16b8"),
                              h => pack("H*","408f042331521ea37919067854b070fdb5cd8131eff3c5342d3f3f2fd028179a"),
                              hasK => 1,
                              k => pack("H*","ffbd3d4da486884ecfb74c16ebda002e6ee03ec03a950aaa74861501c3023fa7"),
                            },
  who                    => "b",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  e                      => {
                              pub => pack("H*","0306f8e834655ecb96deb8cdb24e0e732237c2c0361e1263c780383240093565b0"),
                            },
  e_priv                 => "b_e_priv.pem",
  e_pub                  => "b_e_pub.pem",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 0,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 2,
  prologue               => "some_info",
  protocol_name          => "Noise_XXpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  re                     => {
                              pub => pack("H*","030a80cbdf3c77f7843c81c1c19e3cd89845a9fe3bdc6befe81174a6aebdadd926"),
                            },
  re_pub                 => "b_re_pub.pem",
  rs_pub                 => "a_s_pub.pem",
  s_priv                 => "b_s_priv.pem",
  s_pub                  => "b_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
  should_write           => 0,
  ss                     => {
                              ck => pack("H*","aa5eaf00a85ca5bd97994ca0ab7cf615034bd0961b00c4143b8431d330cb16b8"),
                              h => pack("H*","408f042331521ea37919067854b070fdb5cd8131eff3c5342d3f3f2fd028179a"),
                              hasK => 1,
                              k => pack("H*","ffbd3d4da486884ecfb74c16ebda002e6ee03ec03a950aaa74861501c3023fa7"),
                            },
  who                    => "b",
}


### a read_message from b
### a read_message from b
### a recv msg from b
### a recv msg from b


### read message pattern: 'e'
### read message pattern: 'e'

### read message pattern: 'ee'

### read message pattern: 'ee'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOUaUjZySqxmSnXaG1WasLWU9/3ClRft0wbIjOLaJGEPoAoGCCqGSM49
',
###             'AwEHoUQDQgAECoDL3zx394Q8gcHBnjzYmEWp/jvca+/oEXSmrr2t2Sb1deK4WbCS
',
###             'izTlJqtYgUWPrsbAQcpwsa0/AqCbXgHdbw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOUaUjZySqxmSnXaG1WasLWU9/3ClRft0wbIjOLaJGEPoAoGCCqGSM49
',
###             'AwEHoUQDQgAECoDL3zx394Q8gcHBnjzYmEWp/jvca+/oEXSmrr2t2Sb1deK4WbCS
',
###             'izTlJqtYgUWPrsbAQcpwsa0/AqCbXgHdbw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEBvjoNGVey5beuM2yTg5zIjfCwDYe
',
###           'EmPHgDgyQAk1ZbBYr6B4qkJpTva7Z9kuIAbx8BQO2sWx75Qls6KDthE20w==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEBvjoNGVey5beuM2yTg5zIjfCwDYe
',
###           'EmPHgDgyQAk1ZbBYr6B4qkJpTva7Z9kuIAbx8BQO2sWx75Qls6KDthE20w==
',
###           '-----END PUBLIC KEY-----
'
### z: '699b3c47862f50b6de9590dd363cb201cef6fe97a3095462b851aa6115c2c2d0'
### z: '699b3c47862f50b6de9590dd363cb201cef6fe97a3095462b851aa6115c2c2d0'


### read message pattern: 's'
### read message pattern: 's'


### noise decrypt
### noise decrypt
### key: '6ee94cea55f701ae129e531db28041393daa41181cd82bdff72d243d1d346d79'
### key: '6ee94cea55f701ae129e531db28041393daa41181cd82bdff72d243d1d346d79'
### iv: '0d91e00e671804e504c43167'
### iv: '0d91e00e671804e504c43167'
### aad: 'd3ec7259d43f04aa0075ce64803a4e6bfbf21999ac66e4be7f4f938c10e3d4b6'
### aad: 'd3ec7259d43f04aa0075ce64803a4e6bfbf21999ac66e4be7f4f938c10e3d4b6'
### cipherinfo: '834a313631363930343431345036a17ccae1e8fa1199545101e3cac7365828fbe14b43304adf2bec5e13b4472a206e1e3ef5f8d9e3110de6b0cc0cd0ba336dc2ae31e3e6e1628b'
### cipherinfo: '834a313631363930343431345036a17ccae1e8fa1199545101e3cac7365828fbe14b43304adf2bec5e13b4472a206e1e3ef5f8d9e3110de6b0cc0cd0ba336dc2ae31e3e6e1628b'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '3ca7d1385e2830d135f03167'
### iv_xor: '3ca7d1385e2830d135f03167'
### authtag: '36a17ccae1e8fa1199545101e3cac736'
### authtag: '36a17ccae1e8fa1199545101e3cac736'
### ciphertext: 'fbe14b43304adf2bec5e13b4472a206e1e3ef5f8d9e3110de6b0cc0cd0ba336dc2ae31e3e6e1628b'
### ciphertext: 'fbe14b43304adf2bec5e13b4472a206e1e3ef5f8d9e3110de6b0cc0cd0ba336dc2ae31e3e6e1628b'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### plaintext: '82437261775821034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'


### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'
### check pub avail: 'raw',
###                  '034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc'

### read message pattern: 'es'

### read message pattern: 'es'

### ecdh

### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOUaUjZySqxmSnXaG1WasLWU9/3ClRft0wbIjOLaJGEPoAoGCCqGSM49
',
###             'AwEHoUQDQgAECoDL3zx394Q8gcHBnjzYmEWp/jvca+/oEXSmrr2t2Sb1deK4WbCS
',
###             'izTlJqtYgUWPrsbAQcpwsa0/AqCbXgHdbw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIOUaUjZySqxmSnXaG1WasLWU9/3ClRft0wbIjOLaJGEPoAoGCCqGSM49
',
###             'AwEHoUQDQgAECoDL3zx394Q8gcHBnjzYmEWp/jvca+/oEXSmrr2t2Sb1deK4WbCS
',
###             'izTlJqtYgUWPrsbAQcpwsa0/AqCbXgHdbw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES/j2WOIDnOYxo/KPeEGKAE3gYaPd
',
###           'UOiJZhDDortMd8wSvzONxYPiBXBy8tfcEov0XXo8mQHzXL3i0o+VV8DlYQ==
',
###           '-----END PUBLIC KEY-----
'
### z: '17ea73d48e7877c3d12e3b8c55175ab1048280ae82b612afc376308f4b32409d'
### z: '17ea73d48e7877c3d12e3b8c55175ab1048280ae82b612afc376308f4b32409d'


### noise decrypt
### noise decrypt
### key: '73b2c45617d49b5eeb95892e5ae877c465dc4223f3cd4d64478026964c063da0'
### key: '73b2c45617d49b5eeb95892e5ae877c465dc4223f3cd4d64478026964c063da0'
### iv: '907675ab0b677e2c670d9d89'
### iv: '907675ab0b677e2c670d9d89'
### aad: '3c8e5f9aba75da5f2134d9f10759c8449fc6ed3ab136135befe9de7b579003e1'
### aad: '3c8e5f9aba75da5f2134d9f10759c8449fc6ed3ab136135befe9de7b579003e1'
### cipherinfo: '834a31363136393034343134501b291bee970953a95e5bfadef42d6bea485b16309217672ec3'
### cipherinfo: '834a31363136393034343134501b291bee970953a95e5bfadef42d6bea485b16309217672ec3'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'a140449d32574a1856399d89'
### iv_xor: 'a140449d32574a1856399d89'
### authtag: '1b291bee970953a95e5bfadef42d6bea'
### authtag: '1b291bee970953a95e5bfadef42d6bea'
### ciphertext: '5b16309217672ec3'
### ciphertext: '5b16309217672ec3'
### plaintext: '726573702e61636b'
### plaintext: '726573702e61636b'
("a_recv_b_msg", "resp.ack")
("a_recv_b_msg", "resp.ack")
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  e                      => {
                              pub => pack("H*","030a80cbdf3c77f7843c81c1c19e3cd89845a9fe3bdc6befe81174a6aebdadd926"),
                            },
  e_priv                 => "a_e_priv.pem",
  e_pub                  => "a_e_pub.pem",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 2,
  prologue               => "some_info",
  protocol_name          => "Noise_XXpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  re                     => {
                              pub => pack("H*","0306f8e834655ecb96deb8cdb24e0e732237c2c0361e1263c780383240093565b0"),
                            },
  re_pub                 => "a_re_pub.pem",
  rs                     => {
                              pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                            },
  rs_pub                 => "a_rs_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","aa5eaf00a85ca5bd97994ca0ab7cf615034bd0961b00c4143b8431d330cb16b8"),
                              h => pack("H*","408f042331521ea37919067854b070fdb5cd8131eff3c5342d3f3f2fd028179a"),
                              hasK => 1,
                              k => pack("H*","ffbd3d4da486884ecfb74c16ebda002e6ee03ec03a950aaa74861501c3023fa7"),
                            },
  who                    => "a",
}
{
  aead_decrypt_sub       => sub { ... },
  aead_encrypt_sub       => sub { ... },
  authtag_len            => 16,
  cipher_name            => "AESGCM",
  ciphersuite_name       => "secp256r1_AESGCM_SHA256",
  curve_name             => "secp256r1",
  e                      => {
                              pub => pack("H*","030a80cbdf3c77f7843c81c1c19e3cd89845a9fe3bdc6befe81174a6aebdadd926"),
                            },
  e_priv                 => "a_e_priv.pem",
  e_pub                  => "a_e_pub.pem",
  handshake_pattern_name => "XX",
  hash_len               => 32,
  hash_name              => "SHA256",
  hash_sub               => sub { ... },
  initiator              => 1,
  iv_len                 => 12,
  key_len                => 32,
  message_decode_sub     => sub { ... },
  message_encode_sub     => sub { ... },
  message_format         => "cbor",
  message_pattens        => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
  msg_id                 => 2,
  prologue               => "some_info",
  protocol_name          => "Noise_XXpsk1_secp256r1_AESGCM_SHA256",
  psk                    => "test_psk",
  psk_id                 => 1,
  re                     => {
                              pub => pack("H*","0306f8e834655ecb96deb8cdb24e0e732237c2c0361e1263c780383240093565b0"),
                            },
  re_pub                 => "a_re_pub.pem",
  rs                     => {
                              pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                            },
  rs_pub                 => "a_rs_pub.pem",
  s_priv                 => "a_s_priv.pem",
  s_pub                  => "a_s_pub.pem",
  s_pub_info_type        => "raw",
  s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
  should_write           => 1,
  ss                     => {
                              ck => pack("H*","aa5eaf00a85ca5bd97994ca0ab7cf615034bd0961b00c4143b8431d330cb16b8"),
                              h => pack("H*","408f042331521ea37919067854b070fdb5cd8131eff3c5342d3f3f2fd028179a"),
                              hasK => 1,
                              k => pack("H*","ffbd3d4da486884ecfb74c16ebda002e6ee03ec03a950aaa74861501c3023fa7"),
                            },
  who                    => "a",
}


### a send msg to b
### a send msg to b


### $a_msg2_src: 'init.ack'
### $a_msg2_src: 'init.ack'


### write message pattern: 's'
### write message pattern: 's'


### noise encrypt
### noise encrypt
### key: '73b2c45617d49b5eeb95892e5ae877c465dc4223f3cd4d64478026964c063da0'
### key: '73b2c45617d49b5eeb95892e5ae877c465dc4223f3cd4d64478026964c063da0'
### iv: '907675ab0b677e2c670d9d89'
### iv: '907675ab0b677e2c670d9d89'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'a140449d32574a1856399d89'
### iv_xor: 'a140449d32574a1856399d89'
### aad: '408f042331521ea37919067854b070fdb5cd8131eff3c5342d3f3f2fd028179a'
### aad: '408f042331521ea37919067854b070fdb5cd8131eff3c5342d3f3f2fd028179a'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### ciphertext: 'ab3031834e5e6cab89af6a59a40565c5c09bffec6b59f0851931dc37b5e267625f824ad90bcf3bdb'
### ciphertext: 'ab3031834e5e6cab89af6a59a40565c5c09bffec6b59f0851931dc37b5e267625f824ad90bcf3bdb'
### authtag: '566f719ddaa47e7f260243ecc5cda62a'
### authtag: '566f719ddaa47e7f260243ecc5cda62a'
### cipherinfo: '834a3136313639303434313450566f719ddaa47e7f260243ecc5cda62a5828ab3031834e5e6cab89af6a59a40565c5c09bffec6b59f0851931dc37b5e267625f824ad90bcf3bdb'
### cipherinfo: '834a3136313639303434313450566f719ddaa47e7f260243ecc5cda62a5828ab3031834e5e6cab89af6a59a40565c5c09bffec6b59f0851931dc37b5e267625f824ad90bcf3bdb'


### write message pattern: 'se'
### write message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIGwB4D0mackh0XL0nn3bBGJac5Eie5m7CJedeqSIQFaqoAoGCCqGSM49
',
###             'AwEHoUQDQgAEV54lzwxtl4K5ovYaVglFOJk68feZeLUzFXYX0qLq3yDXCCi6hAyg
',
###             'EYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEBvjoNGVey5beuM2yTg5zIjfCwDYe
',
###           'EmPHgDgyQAk1ZbBYr6B4qkJpTva7Z9kuIAbx8BQO2sWx75Qls6KDthE20w==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEBvjoNGVey5beuM2yTg5zIjfCwDYe
',
###           'EmPHgDgyQAk1ZbBYr6B4qkJpTva7Z9kuIAbx8BQO2sWx75Qls6KDthE20w==
',
###           '-----END PUBLIC KEY-----
'
### z: '158ea42962635d4a3ff6f180bfffe0e0ff9fb722ae4def8a824d801ac6b18c0d'
### z: '158ea42962635d4a3ff6f180bfffe0e0ff9fb722ae4def8a824d801ac6b18c0d'


### noise encrypt
### noise encrypt
### key: '1965a1cad6d56aa65927b66784346b35284e736de2d265cfe8cf3f7e3ba1786f'
### key: '1965a1cad6d56aa65927b66784346b35284e736de2d265cfe8cf3f7e3ba1786f'
### iv: '7443e298d6bb4b25c860a97e'
### iv: '7443e298d6bb4b25c860a97e'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '4575d3aeef8b7f11f954a97e'
### iv_xor: '4575d3aeef8b7f11f954a97e'
### aad: 'b7d05a05d8ff921e5a532ee7e525ccf7c8a0a19d7d11dedc0deed14aa61077c6'
### aad: 'b7d05a05d8ff921e5a532ee7e525ccf7c8a0a19d7d11dedc0deed14aa61077c6'
### plaintext: '696e69742e61636b'
### plaintext: '696e69742e61636b'
### ciphertext: '0861d41d12905300'
### ciphertext: '0861d41d12905300'
### authtag: 'd36b1f44baebda81e00f628a95b75545'
### authtag: 'd36b1f44baebda81e00f628a95b75545'
### cipherinfo: '834a3136313639303434313450d36b1f44baebda81e00f628a95b75545480861d41d12905300'
### cipherinfo: '834a3136313639303434313450d36b1f44baebda81e00f628a95b75545480861d41d12905300'


### a_msg2: '825847834a3136313639303434313450566f719ddaa47e7f260243ecc5cda62a5828ab3031834e5e6cab89af6a59a40565c5c09bffec6b59f0851931dc37b5e267625f824ad90bcf3bdb5826834a3136313639303434313450d36b1f44baebda81e00f628a95b75545480861d41d12905300'
### a_msg2: '825847834a3136313639303434313450566f719ddaa47e7f260243ecc5cda62a5828ab3031834e5e6cab89af6a59a40565c5c09bffec6b59f0851931dc37b5e267625f824ad90bcf3bdb5826834a3136313639303434313450d36b1f44baebda81e00f628a95b75545480861d41d12905300'
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","030a80cbdf3c77f7843c81c1c19e3cd89845a9fe3bdc6befe81174a6aebdadd926"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 3,
    prologue               => "some_info",
    protocol_name          => "Noise_XXpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","0306f8e834655ecb96deb8cdb24e0e732237c2c0361e1263c780383240093565b0"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs                     => {
                                pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                              },
    rs_pub                 => "a_rs_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","ec47299adf63ac9c3262e903513a23d0993946ac91267c9858c0fda0e6ca01bd"),
                                h => pack("H*","85d4de110ef7354b5f6266aff4cb8b3b76dcd58a1fa0c5f43a28823b6f635882"),
                                hasK => 1,
                                k => pack("H*","26754737fd69a49da26f4d3a0355038b9cceebdb2a3e10a1f4e7e7f362939b4b"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","c75c6d740193753064eeba2aefae6f028add77a069b51144251dcaac469fc8ca"),
  },
  {
    hasK => 1,
    k => pack("H*","6801fad0c913345a767f6dc495a4cbccf9a13285277ae36355b3070ec1212597"),
  },
)
(
  "a_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","030a80cbdf3c77f7843c81c1c19e3cd89845a9fe3bdc6befe81174a6aebdadd926"),
                              },
    e_priv                 => "a_e_priv.pem",
    e_pub                  => "a_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 1,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 3,
    prologue               => "some_info",
    protocol_name          => "Noise_XXpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","0306f8e834655ecb96deb8cdb24e0e732237c2c0361e1263c780383240093565b0"),
                              },
    re_pub                 => "a_re_pub.pem",
    rs                     => {
                                pub => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
                              },
    rs_pub                 => "a_rs_pub.pem",
    s_priv                 => "a_s_priv.pem",
    s_pub                  => "a_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
    should_write           => 0,
    ss                     => {
                                ck => pack("H*","ec47299adf63ac9c3262e903513a23d0993946ac91267c9858c0fda0e6ca01bd"),
                                h => pack("H*","85d4de110ef7354b5f6266aff4cb8b3b76dcd58a1fa0c5f43a28823b6f635882"),
                                hasK => 1,
                                k => pack("H*","26754737fd69a49da26f4d3a0355038b9cceebdb2a3e10a1f4e7e7f362939b4b"),
                              },
    who                    => "a",
  },
  {
    hasK => 1,
    k => pack("H*","c75c6d740193753064eeba2aefae6f028add77a069b51144251dcaac469fc8ca"),
  },
  {
    hasK => 1,
    k => pack("H*","6801fad0c913345a767f6dc495a4cbccf9a13285277ae36355b3070ec1212597"),
  },
)

### b recv msg from a

### b recv msg from a

### read message pattern: 's'

### read message pattern: 's'


### noise decrypt
### noise decrypt
### key: '73b2c45617d49b5eeb95892e5ae877c465dc4223f3cd4d64478026964c063da0'
### key: '73b2c45617d49b5eeb95892e5ae877c465dc4223f3cd4d64478026964c063da0'
### iv: '907675ab0b677e2c670d9d89'
### iv: '907675ab0b677e2c670d9d89'
### aad: '408f042331521ea37919067854b070fdb5cd8131eff3c5342d3f3f2fd028179a'
### aad: '408f042331521ea37919067854b070fdb5cd8131eff3c5342d3f3f2fd028179a'
### cipherinfo: '834a3136313639303434313450566f719ddaa47e7f260243ecc5cda62a5828ab3031834e5e6cab89af6a59a40565c5c09bffec6b59f0851931dc37b5e267625f824ad90bcf3bdb'
### cipherinfo: '834a3136313639303434313450566f719ddaa47e7f260243ecc5cda62a5828ab3031834e5e6cab89af6a59a40565c5c09bffec6b59f0851931dc37b5e267625f824ad90bcf3bdb'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: 'a140449d32574a1856399d89'
### iv_xor: 'a140449d32574a1856399d89'
### authtag: '566f719ddaa47e7f260243ecc5cda62a'
### authtag: '566f719ddaa47e7f260243ecc5cda62a'
### ciphertext: 'ab3031834e5e6cab89af6a59a40565c5c09bffec6b59f0851931dc37b5e267625f824ad90bcf3bdb'
### ciphertext: 'ab3031834e5e6cab89af6a59a40565c5c09bffec6b59f0851931dc37b5e267625f824ad90bcf3bdb'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### plaintext: '8243726177582103579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'


### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'
### check pub avail: 'raw',
###                  '03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20'


### read message pattern: 'se'
### read message pattern: 'se'


### ecdh
### ecdh
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIEhckVrF1aHHYbW33TqMGmYHUcd8fhyEJlIllPfhtu8aoAoGCCqGSM49
',
###             'AwEHoUQDQgAEBvjoNGVey5beuM2yTg5zIjfCwDYeEmPHgDgyQAk1ZbBYr6B4qkJp
',
###             'Tva7Z9kuIAbx8BQO2sWx75Qls6KDthE20w==
',
###             '-----END EC PRIVATE KEY-----
'
### local_priv: '-----BEGIN EC PRIVATE KEY-----
',
###             'MHcCAQEEIEhckVrF1aHHYbW33TqMGmYHUcd8fhyEJlIllPfhtu8aoAoGCCqGSM49
',
###             'AwEHoUQDQgAEBvjoNGVey5beuM2yTg5zIjfCwDYeEmPHgDgyQAk1ZbBYr6B4qkJp
',
###             'Tva7Z9kuIAbx8BQO2sWx75Qls6KDthE20w==
',
###             '-----END EC PRIVATE KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### peer_pub: '-----BEGIN PUBLIC KEY-----
',
###           'MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEV54lzwxtl4K5ovYaVglFOJk68feZ
',
###           'eLUzFXYX0qLq3yDXCCi6hAygEYbq/MI4n8HnJuVf0Uv2wbq2f38nAzchnw==
',
###           '-----END PUBLIC KEY-----
'
### z: '158ea42962635d4a3ff6f180bfffe0e0ff9fb722ae4def8a824d801ac6b18c0d'
### z: '158ea42962635d4a3ff6f180bfffe0e0ff9fb722ae4def8a824d801ac6b18c0d'


### noise decrypt
### noise decrypt
### key: '1965a1cad6d56aa65927b66784346b35284e736de2d265cfe8cf3f7e3ba1786f'
### key: '1965a1cad6d56aa65927b66784346b35284e736de2d265cfe8cf3f7e3ba1786f'
### iv: '7443e298d6bb4b25c860a97e'
### iv: '7443e298d6bb4b25c860a97e'
### aad: 'b7d05a05d8ff921e5a532ee7e525ccf7c8a0a19d7d11dedc0deed14aa61077c6'
### aad: 'b7d05a05d8ff921e5a532ee7e525ccf7c8a0a19d7d11dedc0deed14aa61077c6'
### cipherinfo: '834a3136313639303434313450d36b1f44baebda81e00f628a95b75545480861d41d12905300'
### cipherinfo: '834a3136313639303434313450d36b1f44baebda81e00f628a95b75545480861d41d12905300'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '4575d3aeef8b7f11f954a97e'
### iv_xor: '4575d3aeef8b7f11f954a97e'
### authtag: 'd36b1f44baebda81e00f628a95b75545'
### authtag: 'd36b1f44baebda81e00f628a95b75545'
### ciphertext: '0861d41d12905300'
### ciphertext: '0861d41d12905300'
### plaintext: '696e69742e61636b'
### plaintext: '696e69742e61636b'


### b_recv_a_msg2: 'init.ack'
### b_recv_a_msg2: 'init.ack'
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0306f8e834655ecb96deb8cdb24e0e732237c2c0361e1263c780383240093565b0"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 3,
    prologue               => "some_info",
    protocol_name          => "Noise_XXpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","030a80cbdf3c77f7843c81c1c19e3cd89845a9fe3bdc6befe81174a6aebdadd926"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","ec47299adf63ac9c3262e903513a23d0993946ac91267c9858c0fda0e6ca01bd"),
                                h => pack("H*","85d4de110ef7354b5f6266aff4cb8b3b76dcd58a1fa0c5f43a28823b6f635882"),
                                hasK => 1,
                                k => pack("H*","26754737fd69a49da26f4d3a0355038b9cceebdb2a3e10a1f4e7e7f362939b4b"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","c75c6d740193753064eeba2aefae6f028add77a069b51144251dcaac469fc8ca"),
  },
  {
    hasK => 1,
    k => pack("H*","6801fad0c913345a767f6dc495a4cbccf9a13285277ae36355b3070ec1212597"),
  },
)
(
  "b_hs",
  {
    aead_decrypt_sub       => sub { ... },
    aead_encrypt_sub       => sub { ... },
    authtag_len            => 16,
    cipher_name            => "AESGCM",
    ciphersuite_name       => "secp256r1_AESGCM_SHA256",
    curve_name             => "secp256r1",
    e                      => {
                                pub => pack("H*","0306f8e834655ecb96deb8cdb24e0e732237c2c0361e1263c780383240093565b0"),
                              },
    e_priv                 => "b_e_priv.pem",
    e_pub                  => "b_e_pub.pem",
    handshake_pattern_name => "XX",
    hash_len               => 32,
    hash_name              => "SHA256",
    hash_sub               => sub { ... },
    initiator              => 0,
    iv_len                 => 12,
    key_len                => 32,
    message_decode_sub     => sub { ... },
    message_encode_sub     => sub { ... },
    message_format         => "cbor",
    message_pattens        => [["e", "psk"], ["e", "ee", "s", "es"], ["s", "se"]],
    msg_id                 => 3,
    prologue               => "some_info",
    protocol_name          => "Noise_XXpsk1_secp256r1_AESGCM_SHA256",
    psk                    => "test_psk",
    psk_id                 => 1,
    re                     => {
                                pub => pack("H*","030a80cbdf3c77f7843c81c1c19e3cd89845a9fe3bdc6befe81174a6aebdadd926"),
                              },
    re_pub                 => "b_re_pub.pem",
    rs                     => {
                                pub => pack("H*","03579e25cf0c6d9782b9a2f61a56094538993af1f79978b533157617d2a2eadf20"),
                              },
    rs_pub                 => "b_rs_pub.pem",
    s_priv                 => "b_s_priv.pem",
    s_pub                  => "b_s_pub.pem",
    s_pub_info_type        => "raw",
    s_pub_info_value       => pack("H*","034bf8f658e2039ce631a3f28f78418a004de061a3dd50e8896610c3a2bb4c77cc"),
    should_write           => 1,
    ss                     => {
                                ck => pack("H*","ec47299adf63ac9c3262e903513a23d0993946ac91267c9858c0fda0e6ca01bd"),
                                h => pack("H*","85d4de110ef7354b5f6266aff4cb8b3b76dcd58a1fa0c5f43a28823b6f635882"),
                                hasK => 1,
                                k => pack("H*","26754737fd69a49da26f4d3a0355038b9cceebdb2a3e10a1f4e7e7f362939b4b"),
                              },
    who                    => "b",
  },
  {
    hasK => 1,
    k => pack("H*","c75c6d740193753064eeba2aefae6f028add77a069b51144251dcaac469fc8ca"),
  },
  {
    hasK => 1,
    k => pack("H*","6801fad0c913345a767f6dc495a4cbccf9a13285277ae36355b3070ec1212597"),
  },
)

### a send comm msg to b

### a send comm msg to b

### noise encrypt

### noise encrypt
### key: 'b4a16268515925f873aaab5a5d41ce43a2f9c418d8998c176b0f843246f74109'
### key: 'b4a16268515925f873aaab5a5d41ce43a2f9c418d8998c176b0f843246f74109'
### iv: '707b913d57ac9bdfa549d558'
### iv: '707b913d57ac9bdfa549d558'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '414da00b6e9cafeb947dd558'
### iv_xor: '414da00b6e9cafeb947dd558'
### aad: '85d4de110ef7354b5f6266aff4cb8b3b76dcd58a1fa0c5f43a28823b6f635882'
### aad: '85d4de110ef7354b5f6266aff4cb8b3b76dcd58a1fa0c5f43a28823b6f635882'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: '2f18b56c78f244fca2f8455187d1ef1e4e314bbc7e5ee7c6eb16261e09860bb5858f1740ab421c008280f4735d3d631cec6474'
### ciphertext: '2f18b56c78f244fca2f8455187d1ef1e4e314bbc7e5ee7c6eb16261e09860bb5858f1740ab421c008280f4735d3d631cec6474'
### authtag: '485977d65dbc473446f3c6e8385cf6f9'
### authtag: '485977d65dbc473446f3c6e8385cf6f9'
### cipherinfo: '834a3136313639303434313450485977d65dbc473446f3c6e8385cf6f958332f18b56c78f244fca2f8455187d1ef1e4e314bbc7e5ee7c6eb16261e09860bb5858f1740ab421c008280f4735d3d631cec6474'
### cipherinfo: '834a3136313639303434313450485977d65dbc473446f3c6e8385cf6f958332f18b56c78f244fca2f8455187d1ef1e4e314bbc7e5ee7c6eb16261e09860bb5858f1740ab421c008280f4735d3d631cec6474'


### b recv comm msg from a
### b recv comm msg from a


### noise decrypt
### noise decrypt
### key: 'b4a16268515925f873aaab5a5d41ce43a2f9c418d8998c176b0f843246f74109'
### key: 'b4a16268515925f873aaab5a5d41ce43a2f9c418d8998c176b0f843246f74109'
### iv: '707b913d57ac9bdfa549d558'
### iv: '707b913d57ac9bdfa549d558'
### aad: '85d4de110ef7354b5f6266aff4cb8b3b76dcd58a1fa0c5f43a28823b6f635882'
### aad: '85d4de110ef7354b5f6266aff4cb8b3b76dcd58a1fa0c5f43a28823b6f635882'
### cipherinfo: '834a3136313639303434313450485977d65dbc473446f3c6e8385cf6f958332f18b56c78f244fca2f8455187d1ef1e4e314bbc7e5ee7c6eb16261e09860bb5858f1740ab421c008280f4735d3d631cec6474'
### cipherinfo: '834a3136313639303434313450485977d65dbc473446f3c6e8385cf6f958332f18b56c78f244fca2f8455187d1ef1e4e314bbc7e5ee7c6eb16261e09860bb5858f1740ab421c008280f4735d3d631cec6474'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '414da00b6e9cafeb947dd558'
### iv_xor: '414da00b6e9cafeb947dd558'
### authtag: '485977d65dbc473446f3c6e8385cf6f9'
### authtag: '485977d65dbc473446f3c6e8385cf6f9'
### ciphertext: '2f18b56c78f244fca2f8455187d1ef1e4e314bbc7e5ee7c6eb16261e09860bb5858f1740ab421c008280f4735d3d631cec6474'
### ciphertext: '2f18b56c78f244fca2f8455187d1ef1e4e314bbc7e5ee7c6eb16261e09860bb5858f1740ab421c008280f4735d3d631cec6474'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '66756a69616e207175616e7a686f75203636363636363636363636363636363636363636363636363636363636363636363636'


### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'
### $b_recv_plaintext_a: 'fujian quanzhou 66666666666666666666666666666666666'


### b to a , plain_b.txt to trans_cipherinfo_b
### b to a , plain_b.txt to trans_cipherinfo_b
### b send comm msg to a
### b send comm msg to a


### noise encrypt
### noise encrypt
### key: 'f8c010c683fc41250ce0ef4eebdc26f55e64c8d9f7e28075a849b56a52be0abf'
### key: 'f8c010c683fc41250ce0ef4eebdc26f55e64c8d9f7e28075a849b56a52be0abf'
### iv: 'abf5c9f825a55b9d85a2519f'
### iv: 'abf5c9f825a55b9d85a2519f'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '9ac3f8ce1c956fa9b496519f'
### iv_xor: '9ac3f8ce1c956fa9b496519f'
### aad: '85d4de110ef7354b5f6266aff4cb8b3b76dcd58a1fa0c5f43a28823b6f635882'
### aad: '85d4de110ef7354b5f6266aff4cb8b3b76dcd58a1fa0c5f43a28823b6f635882'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### ciphertext: 'b91e301163ff2a7cd7c138c6bd553e4bc9cde823cc400a792b2d63f3f2dcffeb22821beb2170070a9fbabf8b4f03b8'
### ciphertext: 'b91e301163ff2a7cd7c138c6bd553e4bc9cde823cc400a792b2d63f3f2dcffeb22821beb2170070a9fbabf8b4f03b8'
### authtag: '08ffb91ceaa6646e5d709cd744fa0be0'
### authtag: '08ffb91ceaa6646e5d709cd744fa0be0'
### cipherinfo: '834a313631363930343431345008ffb91ceaa6646e5d709cd744fa0be0582fb91e301163ff2a7cd7c138c6bd553e4bc9cde823cc400a792b2d63f3f2dcffeb22821beb2170070a9fbabf8b4f03b8'
### cipherinfo: '834a313631363930343431345008ffb91ceaa6646e5d709cd744fa0be0582fb91e301163ff2a7cd7c138c6bd553e4bc9cde823cc400a792b2d63f3f2dcffeb22821beb2170070a9fbabf8b4f03b8'


### a recv comm msg from b
### a recv comm msg from b


### noise decrypt
### noise decrypt
### key: 'f8c010c683fc41250ce0ef4eebdc26f55e64c8d9f7e28075a849b56a52be0abf'
### key: 'f8c010c683fc41250ce0ef4eebdc26f55e64c8d9f7e28075a849b56a52be0abf'
### iv: 'abf5c9f825a55b9d85a2519f'
### iv: 'abf5c9f825a55b9d85a2519f'
### aad: '85d4de110ef7354b5f6266aff4cb8b3b76dcd58a1fa0c5f43a28823b6f635882'
### aad: '85d4de110ef7354b5f6266aff4cb8b3b76dcd58a1fa0c5f43a28823b6f635882'
### cipherinfo: '834a313631363930343431345008ffb91ceaa6646e5d709cd744fa0be0582fb91e301163ff2a7cd7c138c6bd553e4bc9cde823cc400a792b2d63f3f2dcffeb22821beb2170070a9fbabf8b4f03b8'
### cipherinfo: '834a313631363930343431345008ffb91ceaa6646e5d709cd744fa0be0582fb91e301163ff2a7cd7c138c6bd553e4bc9cde823cc400a792b2d63f3f2dcffeb22821beb2170070a9fbabf8b4f03b8'
### time: '31363136393034343134'
### time: '31363136393034343134'
### iv_xor: '9ac3f8ce1c956fa9b496519f'
### iv_xor: '9ac3f8ce1c956fa9b496519f'
### authtag: '08ffb91ceaa6646e5d709cd744fa0be0'
### authtag: '08ffb91ceaa6646e5d709cd744fa0be0'
### ciphertext: 'b91e301163ff2a7cd7c138c6bd553e4bc9cde823cc400a792b2d63f3f2dcffeb22821beb2170070a9fbabf8b4f03b8'
### ciphertext: 'b91e301163ff2a7cd7c138c6bd553e4bc9cde823cc400a792b2d63f3f2dcffeb22821beb2170070a9fbabf8b4f03b8'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'
### plaintext: '616e687569206865666569203636363636363636363636363636363636363636363636363636363636363636363636'


### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'
### $a_recv_plaintext_b: 'anhui hefei 66666666666666666666666666666666666'


### -----------end test --------: 'XX',
###                               'test_psk',
###                               1
### -----------end test --------: 'XX',
###                               'test_psk',
###                               1
